/*! For license information please see main.69417e64.js.LICENSE.txt */
(()=>{"use strict";var e={4:(e,t,n)=>{var r=n(853),i=n(43),o=n(950);function s(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function c(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function l(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function u(e){if(31===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function h(e){if(c(e)!==e)throw Error(s(188))}function d(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=d(e)))return t;e=e.sibling}return null}var f=Object.assign,g=Symbol.for("react.element"),p=Symbol.for("react.transitional.element"),m=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),v=Symbol.for("react.strict_mode"),w=Symbol.for("react.profiler"),b=Symbol.for("react.consumer"),C=Symbol.for("react.context"),k=Symbol.for("react.forward_ref"),S=Symbol.for("react.suspense"),T=Symbol.for("react.suspense_list"),I=Symbol.for("react.memo"),_=Symbol.for("react.lazy");Symbol.for("react.scope");var A=Symbol.for("react.activity");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var E=Symbol.for("react.memo_cache_sentinel");Symbol.for("react.view_transition");var P=Symbol.iterator;function R(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=P&&e[P]||e["@@iterator"])?e:null}var N=Symbol.for("react.client.reference");function O(e){if(null==e)return null;if("function"===typeof e)return e.$$typeof===N?null:e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case y:return"Fragment";case w:return"Profiler";case v:return"StrictMode";case S:return"Suspense";case T:return"SuspenseList";case A:return"Activity"}if("object"===typeof e)switch(e.$$typeof){case m:return"Portal";case C:return e.displayName||"Context";case b:return(e._context.displayName||"Context")+".Consumer";case k:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case I:return null!==(t=e.displayName||null)?t:O(e.type)||"Memo";case _:t=e._payload,e=e._init;try{return O(e(t))}catch(kt){}}return null}var M=Array.isArray,x=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,D=o.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,L={pending:!1,data:null,method:null,action:null},F=[],q=-1;function U(e){return{current:e}}function z(e){0>q||(e.current=F[q],F[q]=null,q--)}function B(e,t){q++,F[q]=e.current,e.current=t}var H,V,j=U(null),K=U(null),G=U(null),Q=U(null);function W(e,t){switch(B(G,t),B(K,e),B(j,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?vh(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=wh(t=vh(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}z(j),B(j,e)}function Y(){z(j),z(K),z(G)}function J(e){null!==e.memoizedState&&B(Q,e);var t=j.current,n=wh(t,e.type);t!==n&&(B(K,e),B(j,n))}function X(e){K.current===e&&(z(j),z(K)),Q.current===e&&(z(Q),hd._currentValue=L)}function $(e){if(void 0===H)try{throw Error()}catch(kt){var t=kt.stack.trim().match(/\n( *(at )?)/);H=t&&t[1]||"",V=-1<kt.stack.indexOf("\n    at")?" (<anonymous>)":-1<kt.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+H+e+V}var Z=!1;function ee(e,t){if(!e||Z)return"";Z=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(t){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[])}catch(kt){var r=kt}Reflect.construct(e,[],n)}else{try{n.call()}catch(i){r=i}e.call(n.prototype)}}else{try{throw Error()}catch(o){r=o}(n=e())&&"function"===typeof n.catch&&n.catch(function(){})}}catch(s){if(s&&r&&"string"===typeof s.stack)return[s.stack,r.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var i=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,"name");i&&i.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var o=r.DetermineComponentFrameRoot(),s=o[0],a=o[1];if(s&&a){var c=s.split("\n"),l=a.split("\n");for(i=r=0;r<c.length&&!c[r].includes("DetermineComponentFrameRoot");)r++;for(;i<l.length&&!l[i].includes("DetermineComponentFrameRoot");)i++;if(r===c.length||i===l.length)for(r=c.length-1,i=l.length-1;1<=r&&0<=i&&c[r]!==l[i];)i--;for(;1<=r&&0<=i;r--,i--)if(c[r]!==l[i]){if(1!==r||1!==i)do{if(r--,0>--i||c[r]!==l[i]){var u="\n"+c[r].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=r&&0<=i);break}}}finally{Z=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?$(n):""}function te(e,t){switch(e.tag){case 26:case 27:case 5:return $(e.type);case 16:return $("Lazy");case 13:return e.child!==t&&null!==t?$("Suspense Fallback"):$("Suspense");case 19:return $("SuspenseList");case 0:case 15:return ee(e.type,!1);case 11:return ee(e.type.render,!1);case 1:return ee(e.type,!0);case 31:return $("Activity");default:return""}}function ne(e){try{var t="",n=null;do{t+=te(e,n),n=e,e=e.return}while(e);return t}catch(kt){return"\nError generating stack: "+kt.message+"\n"+kt.stack}}var re=Object.prototype.hasOwnProperty,ie=r.unstable_scheduleCallback,oe=r.unstable_cancelCallback,se=r.unstable_shouldYield,ae=r.unstable_requestPaint,ce=r.unstable_now,le=r.unstable_getCurrentPriorityLevel,ue=r.unstable_ImmediatePriority,he=r.unstable_UserBlockingPriority,de=r.unstable_NormalPriority,fe=r.unstable_LowPriority,ge=r.unstable_IdlePriority,pe=r.log,me=r.unstable_setDisableYieldValue,ye=null,ve=null;function we(e){if("function"===typeof pe&&me(e),ve&&"function"===typeof ve.setStrictMode)try{ve.setStrictMode(ye,e)}catch(t){}}var be=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(Ce(e)/ke|0)|0},Ce=Math.log,ke=Math.LN2;var Se=256,Te=262144,Ie=4194304;function _e(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return 261888&e;case 262144:case 524288:case 1048576:case 2097152:return 3932160&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Ae(e,t,n){var r=e.pendingLanes;if(0===r)return 0;var i=0,o=e.suspendedLanes,s=e.pingedLanes;e=e.warmLanes;var a=134217727&r;return 0!==a?0!==(r=a&~o)?i=_e(r):0!==(s&=a)?i=_e(s):n||0!==(n=a&~e)&&(i=_e(n)):0!==(a=r&~o)?i=_e(a):0!==s?i=_e(s):n||0!==(n=r&~e)&&(i=_e(n)),0===i?0:0!==t&&t!==i&&0===(t&o)&&((o=i&-i)>=(n=t&-t)||32===o&&0!==(4194048&n))?t:i}function Ee(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function Pe(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function Re(){var e=Ie;return 0===(62914560&(Ie<<=1))&&(Ie=4194304),e}function Ne(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Oe(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Me(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var r=31-be(t);e.entangledLanes|=t,e.entanglements[r]=1073741824|e.entanglements[r]|261930&n}function xe(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-be(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}function De(e,t){var n=t&-t;return 0!==((n=0!==(42&n)?1:Le(n))&(e.suspendedLanes|t))?0:n}function Le(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Fe(e){return 2<(e&=-e)?8<e?0!==(134217727&e)?32:268435456:8:2}function qe(){var e=D.p;return 0!==e?e:void 0===(e=window.event)?32:Ad(e.type)}function Ue(e,t){var n=D.p;try{return D.p=e,t()}finally{D.p=n}}var ze=Math.random().toString(36).slice(2),Be="__reactFiber$"+ze,He="__reactProps$"+ze,Ve="__reactContainer$"+ze,je="__reactEvents$"+ze,Ke="__reactListeners$"+ze,Ge="__reactHandles$"+ze,Qe="__reactResources$"+ze,We="__reactMarker$"+ze;function Ye(e){delete e[Be],delete e[He],delete e[je],delete e[Ke],delete e[Ge]}function Je(e){var t=e[Be];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Ve]||n[Be]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=Fh(e);null!==e;){if(n=e[Be])return n;e=Fh(e)}return t}n=(e=n).parentNode}return null}function Xe(e){if(e=e[Be]||e[Ve]){var t=e.tag;if(5===t||6===t||13===t||31===t||26===t||27===t||3===t)return e}return null}function $e(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(s(33))}function Ze(e){var t=e[Qe];return t||(t=e[Qe]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function et(e){e[We]=!0}var tt=new Set,nt={};function rt(e,t){it(e,t),it(e+"Capture",t)}function it(e,t){for(nt[e]=t,e=0;e<t.length;e++)tt.add(t[e])}var ot=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),st={},at={};function ct(e,t,n){if(i=t,re.call(at,i)||!re.call(st,i)&&(ot.test(i)?at[i]=!0:(st[i]=!0,0)))if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var r=t.toLowerCase().slice(0,5);if("data-"!==r&&"aria-"!==r)return void e.removeAttribute(t)}e.setAttribute(t,""+n)}var i}function lt(e,t,n){if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+n)}}function ut(e,t,n,r){if(null===r)e.removeAttribute(n);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(n)}e.setAttributeNS(t,n,""+r)}}function ht(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function dt(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function ft(e){if(!e._valueTracker){var t=dt(e)?"checked":"value";e._valueTracker=function(e,t,n){var r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&"undefined"!==typeof r&&"function"===typeof r.get&&"function"===typeof r.set){var i=r.get,o=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){n=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e,t,""+e[t])}}function gt(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=dt(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function pt(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var mt=/[\n"\\]/g;function yt(e){return e.replace(mt,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function vt(e,t,n,r,i,o,s,a){e.name="",null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s?e.type=s:e.removeAttribute("type"),null!=t?"number"===s?(0===t&&""===e.value||e.value!=t)&&(e.value=""+ht(t)):e.value!==""+ht(t)&&(e.value=""+ht(t)):"submit"!==s&&"reset"!==s||e.removeAttribute("value"),null!=t?bt(e,s,ht(t)):null!=n?bt(e,s,ht(n)):null!=r&&e.removeAttribute("value"),null==i&&null!=o&&(e.defaultChecked=!!o),null!=i&&(e.checked=i&&"function"!==typeof i&&"symbol"!==typeof i),null!=a&&"function"!==typeof a&&"symbol"!==typeof a&&"boolean"!==typeof a?e.name=""+ht(a):e.removeAttribute("name")}function wt(e,t,n,r,i,o,s,a){if(null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o&&(e.type=o),null!=t||null!=n){if(!("submit"!==o&&"reset"!==o||void 0!==t&&null!==t))return void ft(e);n=null!=n?""+ht(n):"",t=null!=t?""+ht(t):n,a||t===e.value||(e.value=t),e.defaultValue=t}r="function"!==typeof(r=null!=r?r:i)&&"symbol"!==typeof r&&!!r,e.checked=a?e.checked:!!r,e.defaultChecked=!!r,null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s&&(e.name=s),ft(e)}function bt(e,t,n){"number"===t&&pt(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function Ct(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+ht(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function St(e,t,n){null==t||((t=""+ht(t))!==e.value&&(e.value=t),null!=n)?e.defaultValue=null!=n?""+ht(n):"":e.defaultValue!==t&&(e.defaultValue=t)}function Tt(e,t,n,r){if(null==t){if(null!=r){if(null!=n)throw Error(s(92));if(M(r)){if(1<r.length)throw Error(s(93));r=r[0]}n=r}null==n&&(n=""),t=n}n=ht(t),e.defaultValue=n,(r=e.textContent)===n&&""!==r&&null!==r&&(e.value=r),ft(e)}function It(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var _t=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function At(e,t,n){var r=0===t.indexOf("--");null==n||"boolean"===typeof n||""===n?r?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":r?e.setProperty(t,n):"number"!==typeof n||0===n||_t.has(t)?"float"===t?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function Et(e,t,n){if(null!=t&&"object"!==typeof t)throw Error(s(62));if(e=e.style,null!=n){for(var r in n)!n.hasOwnProperty(r)||null!=t&&t.hasOwnProperty(r)||(0===r.indexOf("--")?e.setProperty(r,""):"float"===r?e.cssFloat="":e[r]="");for(var i in t)r=t[i],t.hasOwnProperty(i)&&n[i]!==r&&At(e,i,r)}else for(var o in t)t.hasOwnProperty(o)&&At(e,o,t[o])}function Pt(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Rt=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Nt=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ot(e){return Nt.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Mt(){}var xt=null;function Dt(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Lt=null,Ft=null;function qt(e){var t=Xe(e);if(t&&(e=t.stateNode)){var n=e[He]||null;e:switch(e=t.stateNode,t.type){case"input":if(vt(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+yt(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=r[He]||null;if(!i)throw Error(s(90));vt(r,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name)}}for(t=0;t<n.length;t++)(r=n[t]).form===e.form&&gt(r)}break e;case"textarea":St(e,n.value,n.defaultValue);break e;case"select":null!=(t=n.value)&&Ct(e,!!n.multiple,t,!1)}}}var Ut=!1;function zt(e,t,n){if(Ut)return e(t,n);Ut=!0;try{return e(t)}finally{if(Ut=!1,(null!==Lt||null!==Ft)&&(eu(),Lt&&(t=Lt,e=Ft,Ft=Lt=null,qt(t),e)))for(t=0;t<e.length;t++)qt(e[t])}}function Bt(e,t){var n=e.stateNode;if(null===n)return null;var r=n[He]||null;if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var Ht=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),Vt=!1;if(Ht)try{var jt={};Object.defineProperty(jt,"passive",{get:function(){Vt=!0}}),window.addEventListener("test",jt,jt),window.removeEventListener("test",jt,jt)}catch($d){Vt=!1}var Kt=null,Gt=null,Qt=null;function Wt(){if(Qt)return Qt;var e,t,n=Gt,r=n.length,i="value"in Kt?Kt.value:Kt.textContent,o=i.length;for(e=0;e<r&&n[e]===i[e];e++);var s=r-e;for(t=1;t<=s&&n[r-t]===i[o-t];t++);return Qt=i.slice(e,1<t?1-t:void 0)}function Yt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Jt(){return!0}function Xt(){return!1}function $t(e){function t(t,n,r,i,o){for(var s in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(i):i[s]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?Jt:Xt,this.isPropagationStopped=Xt,this}return f(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Jt)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Jt)},persist:function(){},isPersistent:Jt}),t}var Zt,en,tn,nn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},rn=$t(nn),on=f({},nn,{view:0,detail:0}),sn=$t(on),an=f({},on,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:vn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==tn&&(tn&&"mousemove"===e.type?(Zt=e.screenX-tn.screenX,en=e.screenY-tn.screenY):en=Zt=0,tn=e),Zt)},movementY:function(e){return"movementY"in e?e.movementY:en}}),cn=$t(an),ln=$t(f({},an,{dataTransfer:0})),un=$t(f({},on,{relatedTarget:0})),hn=$t(f({},nn,{animationName:0,elapsedTime:0,pseudoElement:0})),dn=$t(f({},nn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),fn=$t(f({},nn,{data:0})),gn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},pn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},mn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function yn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=mn[e])&&!!t[e]}function vn(){return yn}var wn=$t(f({},on,{key:function(e){if(e.key){var t=gn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Yt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?pn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:vn,charCode:function(e){return"keypress"===e.type?Yt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Yt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),bn=$t(f({},an,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Cn=$t(f({},on,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:vn})),kn=$t(f({},nn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Sn=$t(f({},an,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),Tn=$t(f({},nn,{newState:0,oldState:0})),In=[9,13,27,32],_n=Ht&&"CompositionEvent"in window,An=null;Ht&&"documentMode"in document&&(An=document.documentMode);var En=Ht&&"TextEvent"in window&&!An,Pn=Ht&&(!_n||An&&8<An&&11>=An),Rn=String.fromCharCode(32),Nn=!1;function On(e,t){switch(e){case"keyup":return-1!==In.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Mn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var xn=!1;var Dn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ln(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Dn[e.type]:"textarea"===t}function Fn(e,t,n,r){Lt?Ft?Ft.push(r):Ft=[r]:Lt=r,0<(t=ih(t,"onChange")).length&&(n=new rn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var qn=null,Un=null;function zn(e){Ju(e,0)}function Bn(e){if(gt($e(e)))return e}function Hn(e,t){if("change"===e)return t}var Vn=!1;if(Ht){var jn;if(Ht){var Kn="oninput"in document;if(!Kn){var Gn=document.createElement("div");Gn.setAttribute("oninput","return;"),Kn="function"===typeof Gn.oninput}jn=Kn}else jn=!1;Vn=jn&&(!document.documentMode||9<document.documentMode)}function Qn(){qn&&(qn.detachEvent("onpropertychange",Wn),Un=qn=null)}function Wn(e){if("value"===e.propertyName&&Bn(Un)){var t=[];Fn(t,Un,e,Dt(e)),zt(zn,t)}}function Yn(e,t,n){"focusin"===e?(Qn(),Un=n,(qn=t).attachEvent("onpropertychange",Wn)):"focusout"===e&&Qn()}function Jn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Bn(Un)}function Xn(e,t){if("click"===e)return Bn(t)}function $n(e,t){if("input"===e||"change"===e)return Bn(t)}var Zn="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function er(e,t){if(Zn(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!re.call(t,i)||!Zn(e[i],t[i]))return!1}return!0}function tr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function nr(e,t){var n,r=tr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=tr(r)}}function rr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?rr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function ir(e){for(var t=pt((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=pt((e=t.contentWindow).document)}return t}function or(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var sr=Ht&&"documentMode"in document&&11>=document.documentMode,ar=null,cr=null,lr=null,ur=!1;function hr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;ur||null==ar||ar!==pt(r)||("selectionStart"in(r=ar)&&or(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},lr&&er(lr,r)||(lr=r,0<(r=ih(cr,"onSelect")).length&&(t=new rn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=ar)))}function dr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var fr={animationend:dr("Animation","AnimationEnd"),animationiteration:dr("Animation","AnimationIteration"),animationstart:dr("Animation","AnimationStart"),transitionrun:dr("Transition","TransitionRun"),transitionstart:dr("Transition","TransitionStart"),transitioncancel:dr("Transition","TransitionCancel"),transitionend:dr("Transition","TransitionEnd")},gr={},pr={};function mr(e){if(gr[e])return gr[e];if(!fr[e])return e;var t,n=fr[e];for(t in n)if(n.hasOwnProperty(t)&&t in pr)return gr[e]=n[t];return e}Ht&&(pr=document.createElement("div").style,"AnimationEvent"in window||(delete fr.animationend.animation,delete fr.animationiteration.animation,delete fr.animationstart.animation),"TransitionEvent"in window||delete fr.transitionend.transition);var yr=mr("animationend"),vr=mr("animationiteration"),wr=mr("animationstart"),br=mr("transitionrun"),Cr=mr("transitionstart"),kr=mr("transitioncancel"),Sr=mr("transitionend"),Tr=new Map,Ir="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function _r(e,t){Tr.set(e,t),rt(t,[e])}Ir.push("scrollEnd");var Ar="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},Er=[],Pr=0,Rr=0;function Nr(){for(var e=Pr,t=Rr=Pr=0;t<e;){var n=Er[t];Er[t++]=null;var r=Er[t];Er[t++]=null;var i=Er[t];Er[t++]=null;var o=Er[t];if(Er[t++]=null,null!==r&&null!==i){var s=r.pending;null===s?i.next=i:(i.next=s.next,s.next=i),r.pending=i}0!==o&&Dr(n,i,o)}}function Or(e,t,n,r){Er[Pr++]=e,Er[Pr++]=t,Er[Pr++]=n,Er[Pr++]=r,Rr|=r,e.lanes|=r,null!==(e=e.alternate)&&(e.lanes|=r)}function Mr(e,t,n,r){return Or(e,t,n,r),Lr(e)}function xr(e,t){return Or(e,null,null,t),Lr(e)}function Dr(e,t,n){e.lanes|=n;var r=e.alternate;null!==r&&(r.lanes|=n);for(var i=!1,o=e.return;null!==o;)o.childLanes|=n,null!==(r=o.alternate)&&(r.childLanes|=n),22===o.tag&&(null===(e=o.stateNode)||1&e._visibility||(i=!0)),e=o,o=o.return;return 3===e.tag?(o=e.stateNode,i&&null!==t&&(i=31-be(n),null===(r=(e=o.hiddenUpdates)[i])?e[i]=[t]:r.push(t),t.lane=536870912|n),o):null}function Lr(e){if(50<Kl)throw Kl=0,Gl=null,Error(s(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var Fr={};function qr(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ur(e,t,n,r){return new qr(e,t,n,r)}function zr(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Br(e,t){var n=e.alternate;return null===n?((n=Ur(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=65011712&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function Hr(e,t){e.flags&=65011714;var n=e.alternate;return null===n?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Vr(e,t,n,r,i,o){var a=0;if(r=e,"function"===typeof e)zr(e)&&(a=1);else if("string"===typeof e)a=function(e,t,n){if(1===n||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!==typeof t.precedence||"string"!==typeof t.href||""===t.href)break;return!0;case"link":if("string"!==typeof t.rel||"string"!==typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"===typeof t.precedence&&null==e);case"script":if(t.async&&"function"!==typeof t.async&&"symbol"!==typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"===typeof t.src)return!0}return!1}(e,n,j.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case A:return(e=Ur(31,n,t,i)).elementType=A,e.lanes=o,e;case y:return jr(n.children,i,o,t);case v:a=8,i|=24;break;case w:return(e=Ur(12,n,t,2|i)).elementType=w,e.lanes=o,e;case S:return(e=Ur(13,n,t,i)).elementType=S,e.lanes=o,e;case T:return(e=Ur(19,n,t,i)).elementType=T,e.lanes=o,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case C:a=10;break e;case b:a=9;break e;case k:a=11;break e;case I:a=14;break e;case _:a=16,r=null;break e}a=29,n=Error(s(130,null===e?"null":typeof e,"")),r=null}return(t=Ur(a,n,t,i)).elementType=e,t.type=r,t.lanes=o,t}function jr(e,t,n,r){return(e=Ur(7,e,r,t)).lanes=n,e}function Kr(e,t,n){return(e=Ur(6,e,null,t)).lanes=n,e}function Gr(e){var t=Ur(18,null,null,0);return t.stateNode=e,t}function Qr(e,t,n){return(t=Ur(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Wr=new WeakMap;function Yr(e,t){if("object"===typeof e&&null!==e){var n=Wr.get(e);return void 0!==n?n:(t={value:e,source:t,stack:ne(t)},Wr.set(e,t),t)}return{value:e,source:t,stack:ne(t)}}var Jr=[],Xr=0,$r=null,Zr=0,ei=[],ti=0,ni=null,ri=1,ii="";function oi(e,t){Jr[Xr++]=Zr,Jr[Xr++]=$r,$r=e,Zr=t}function si(e,t,n){ei[ti++]=ri,ei[ti++]=ii,ei[ti++]=ni,ni=e;var r=ri;e=ii;var i=32-be(r)-1;r&=~(1<<i),n+=1;var o=32-be(t)+i;if(30<o){var s=i-i%5;o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,ri=1<<32-be(t)+i|n<<i|r,ii=o+e}else ri=1<<o|n<<i|r,ii=e}function ai(e){null!==e.return&&(oi(e,1),si(e,1,0))}function ci(e){for(;e===$r;)$r=Jr[--Xr],Jr[Xr]=null,Zr=Jr[--Xr],Jr[Xr]=null;for(;e===ni;)ni=ei[--ti],ei[ti]=null,ii=ei[--ti],ei[ti]=null,ri=ei[--ti],ei[ti]=null}function li(e,t){ei[ti++]=ri,ei[ti++]=ii,ei[ti++]=ni,ri=t.id,ii=t.overflow,ni=e}var ui=null,hi=null,di=!1,fi=null,gi=!1,pi=Error(s(519));function mi(e){throw ki(Yr(Error(s(418,1<arguments.length&&void 0!==arguments[1]&&arguments[1]?"text":"HTML","")),e)),pi}function yi(e){var t=e.stateNode,n=e.type,r=e.memoizedProps;switch(t[Be]=e,t[He]=r,n){case"dialog":Xu("cancel",t),Xu("close",t);break;case"iframe":case"object":case"embed":Xu("load",t);break;case"video":case"audio":for(n=0;n<Wu.length;n++)Xu(Wu[n],t);break;case"source":Xu("error",t);break;case"img":case"image":case"link":Xu("error",t),Xu("load",t);break;case"details":Xu("toggle",t);break;case"input":Xu("invalid",t),wt(t,r.value,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name,!0);break;case"select":Xu("invalid",t);break;case"textarea":Xu("invalid",t),Tt(t,r.value,r.defaultValue,r.children)}"string"!==typeof(n=r.children)&&"number"!==typeof n&&"bigint"!==typeof n||t.textContent===""+n||!0===r.suppressHydrationWarning||uh(t.textContent,n)?(null!=r.popover&&(Xu("beforetoggle",t),Xu("toggle",t)),null!=r.onScroll&&Xu("scroll",t),null!=r.onScrollEnd&&Xu("scrollend",t),null!=r.onClick&&(t.onclick=Mt),t=!0):t=!1,t||mi(e,!0)}function vi(e){for(ui=e.return;ui;)switch(ui.tag){case 5:case 31:case 13:return void(gi=!1);case 27:case 3:return void(gi=!0);default:ui=ui.return}}function wi(e){if(e!==ui)return!1;if(!di)return vi(e),di=!0,!1;var t,n=e.tag;if((t=3!==n&&27!==n)&&((t=5===n)&&(t=!("form"!==(t=e.type)&&"button"!==t)||bh(e.type,e.memoizedProps)),t=!t),t&&hi&&mi(e),vi(e),13===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));hi=Lh(e)}else if(31===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));hi=Lh(e)}else 27===n?(n=hi,Ah(e.type)?(e=Dh,Dh=null,hi=e):hi=n):hi=ui?xh(e.stateNode.nextSibling):null;return!0}function bi(){hi=ui=null,di=!1}function Ci(){var e=fi;return null!==e&&(null===Nl?Nl=e:Nl.push.apply(Nl,e),fi=null),e}function ki(e){null===fi?fi=[e]:fi.push(e)}var Si=U(null),Ti=null,Ii=null;function _i(e,t,n){B(Si,t._currentValue),t._currentValue=n}function Ai(e){e._currentValue=Si.current,z(Si)}function Ei(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Pi(e,t,n,r){var i=e.child;for(null!==i&&(i.return=e);null!==i;){var o=i.dependencies;if(null!==o){var a=i.child;o=o.firstContext;e:for(;null!==o;){var c=o;o=i;for(var l=0;l<t.length;l++)if(c.context===t[l]){o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),Ei(o.return,n,e),r||(a=null);break e}o=c.next}}else if(18===i.tag){if(null===(a=i.return))throw Error(s(341));a.lanes|=n,null!==(o=a.alternate)&&(o.lanes|=n),Ei(a,n,e),a=null}else a=i.child;if(null!==a)a.return=i;else for(a=i;null!==a;){if(a===e){a=null;break}if(null!==(i=a.sibling)){i.return=a.return,a=i;break}a=a.return}i=a}}function Ri(e,t,n,r){e=null;for(var i=t,o=!1;null!==i;){if(!o)if(0!==(524288&i.flags))o=!0;else if(0!==(262144&i.flags))break;if(10===i.tag){var a=i.alternate;if(null===a)throw Error(s(387));if(null!==(a=a.memoizedProps)){var c=i.type;Zn(i.pendingProps.value,a.value)||(null!==e?e.push(c):e=[c])}}else if(i===Q.current){if(null===(a=i.alternate))throw Error(s(387));a.memoizedState.memoizedState!==i.memoizedState.memoizedState&&(null!==e?e.push(hd):e=[hd])}i=i.return}null!==e&&Pi(t,e,n,r),t.flags|=262144}function Ni(e){for(e=e.firstContext;null!==e;){if(!Zn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Oi(e){Ti=e,Ii=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function Mi(e){return Di(Ti,e)}function xi(e,t){return null===Ti&&Oi(e),Di(e,t)}function Di(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},null===Ii){if(null===e)throw Error(s(308));Ii=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Ii=Ii.next=t;return n}var Li="undefined"!==typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},Fi=r.unstable_scheduleCallback,qi=r.unstable_NormalPriority,Ui={$$typeof:C,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function zi(){return{controller:new Li,data:new Map,refCount:0}}function Bi(e){e.refCount--,0===e.refCount&&Fi(qi,function(){e.controller.abort()})}var Hi=null,Vi=0,ji=0,Ki=null;function Gi(){if(0===--Vi&&null!==Hi){null!==Ki&&(Ki.status="fulfilled");var e=Hi;Hi=null,ji=0,Ki=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var Qi=x.S;x.S=function(e,t){xl=ce(),"object"===typeof t&&null!==t&&"function"===typeof t.then&&function(e,t){if(null===Hi){var n=Hi=[];Vi=0,ji=Vu(),Ki={status:"pending",value:void 0,then:function(e){n.push(e)}}}Vi++,t.then(Gi,Gi)}(0,t),null!==Qi&&Qi(e,t)};var Wi=U(null);function Yi(){var e=Wi.current;return null!==e?e:pl.pooledCache}function Ji(e,t){B(Wi,null===t?Wi.current:t.pool)}function Xi(){var e=Yi();return null===e?null:{parent:Ui._currentValue,pool:e}}var $i=Error(s(460)),Zi=Error(s(474)),eo=Error(s(542)),to={then:function(){}};function no(e){return"fulfilled"===(e=e.status)||"rejected"===e}function ro(e,t,n){switch(void 0===(n=e[n])?e.push(t):n!==t&&(t.then(Mt,Mt),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw ao(e=t.reason),e;default:if("string"===typeof t.status)t.then(Mt,Mt);else{if(null!==(e=pl)&&100<e.shellSuspendCounter)throw Error(s(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var n=t;n.status="fulfilled",n.value=e}},function(e){if("pending"===t.status){var n=t;n.status="rejected",n.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw ao(e=t.reason),e}throw oo=t,$i}}function io(e){try{return(0,e._init)(e._payload)}catch(kt){if(null!==kt&&"object"===typeof kt&&"function"===typeof kt.then)throw oo=kt,$i;throw kt}}var oo=null;function so(){if(null===oo)throw Error(s(459));var e=oo;return oo=null,e}function ao(e){if(e===$i||e===eo)throw Error(s(483))}var co=null,lo=0;function uo(e){var t=lo;return lo+=1,null===co&&(co=[]),ro(co,e,t)}function ho(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function fo(e,t){if(t.$$typeof===g)throw Error(s(525));throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function go(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function i(e,t){return(e=Br(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=67108866,n):r:(t.flags|=67108866,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function c(e,t,n,r){return null===t||6!==t.tag?((t=Kr(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function l(e,t,n,r){var o=n.type;return o===y?h(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===o||"object"===typeof o&&null!==o&&o.$$typeof===_&&io(o)===t.type)?(ho(t=i(t,n.props),n),t.return=e,t):(ho(t=Vr(n.type,n.key,n.props,null,e.mode,r),n),t.return=e,t)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Qr(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function h(e,t,n,r,o){return null===t||7!==t.tag?((t=jr(n,e.mode,r,o)).return=e,t):((t=i(t,n)).return=e,t)}function d(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t||"bigint"===typeof t)return(t=Kr(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case p:return ho(n=Vr(t.type,t.key,t.props,null,e.mode,n),t),n.return=e,n;case m:return(t=Qr(t,e.mode,n)).return=e,t;case _:return d(e,t=io(t),n)}if(M(t)||R(t))return(t=jr(t,e.mode,n,null)).return=e,t;if("function"===typeof t.then)return d(e,uo(t),n);if(t.$$typeof===C)return d(e,xi(e,t),n);fo(e,t)}return null}function f(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n||"bigint"===typeof n)return null!==i?null:c(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case p:return n.key===i?l(e,t,n,r):null;case m:return n.key===i?u(e,t,n,r):null;case _:return f(e,t,n=io(n),r)}if(M(n)||R(n))return null!==i?null:h(e,t,n,r,null);if("function"===typeof n.then)return f(e,t,uo(n),r);if(n.$$typeof===C)return f(e,t,xi(e,n),r);fo(e,n)}return null}function g(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r||"bigint"===typeof r)return c(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case p:return l(t,e=e.get(null===r.key?n:r.key)||null,r,i);case m:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case _:return g(e,t,n,r=io(r),i)}if(M(r)||R(r))return h(t,e=e.get(n)||null,r,i,null);if("function"===typeof r.then)return g(e,t,n,uo(r),i);if(r.$$typeof===C)return g(e,t,n,xi(t,r),i);fo(t,r)}return null}function v(c,l,u,h){if("object"===typeof u&&null!==u&&u.type===y&&null===u.key&&(u=u.props.children),"object"===typeof u&&null!==u){switch(u.$$typeof){case p:e:{for(var w=u.key;null!==l;){if(l.key===w){if((w=u.type)===y){if(7===l.tag){n(c,l.sibling),(h=i(l,u.props.children)).return=c,c=h;break e}}else if(l.elementType===w||"object"===typeof w&&null!==w&&w.$$typeof===_&&io(w)===l.type){n(c,l.sibling),ho(h=i(l,u.props),u),h.return=c,c=h;break e}n(c,l);break}t(c,l),l=l.sibling}u.type===y?((h=jr(u.props.children,c.mode,h,u.key)).return=c,c=h):(ho(h=Vr(u.type,u.key,u.props,null,c.mode,h),u),h.return=c,c=h)}return a(c);case m:e:{for(w=u.key;null!==l;){if(l.key===w){if(4===l.tag&&l.stateNode.containerInfo===u.containerInfo&&l.stateNode.implementation===u.implementation){n(c,l.sibling),(h=i(l,u.children||[])).return=c,c=h;break e}n(c,l);break}t(c,l),l=l.sibling}(h=Qr(u,c.mode,h)).return=c,c=h}return a(c);case _:return v(c,l,u=io(u),h)}if(M(u))return function(i,s,a,c){for(var l=null,u=null,h=s,p=s=0,m=null;null!==h&&p<a.length;p++){h.index>p?(m=h,h=null):m=h.sibling;var y=f(i,h,a[p],c);if(null===y){null===h&&(h=m);break}e&&h&&null===y.alternate&&t(i,h),s=o(y,s,p),null===u?l=y:u.sibling=y,u=y,h=m}if(p===a.length)return n(i,h),di&&oi(i,p),l;if(null===h){for(;p<a.length;p++)null!==(h=d(i,a[p],c))&&(s=o(h,s,p),null===u?l=h:u.sibling=h,u=h);return di&&oi(i,p),l}for(h=r(h);p<a.length;p++)null!==(m=g(h,i,p,a[p],c))&&(e&&null!==m.alternate&&h.delete(null===m.key?p:m.key),s=o(m,s,p),null===u?l=m:u.sibling=m,u=m);return e&&h.forEach(function(e){return t(i,e)}),di&&oi(i,p),l}(c,l,u,h);if(R(u)){if("function"!==typeof(w=R(u)))throw Error(s(150));return function(i,a,c,l){if(null==c)throw Error(s(151));for(var u=null,h=null,p=a,m=a=0,y=null,v=c.next();null!==p&&!v.done;m++,v=c.next()){p.index>m?(y=p,p=null):y=p.sibling;var w=f(i,p,v.value,l);if(null===w){null===p&&(p=y);break}e&&p&&null===w.alternate&&t(i,p),a=o(w,a,m),null===h?u=w:h.sibling=w,h=w,p=y}if(v.done)return n(i,p),di&&oi(i,m),u;if(null===p){for(;!v.done;m++,v=c.next())null!==(v=d(i,v.value,l))&&(a=o(v,a,m),null===h?u=v:h.sibling=v,h=v);return di&&oi(i,m),u}for(p=r(p);!v.done;m++,v=c.next())null!==(v=g(p,i,m,v.value,l))&&(e&&null!==v.alternate&&p.delete(null===v.key?m:v.key),a=o(v,a,m),null===h?u=v:h.sibling=v,h=v);return e&&p.forEach(function(e){return t(i,e)}),di&&oi(i,m),u}(c,l,u=w.call(u),h)}if("function"===typeof u.then)return v(c,l,uo(u),h);if(u.$$typeof===C)return v(c,l,xi(c,u),h);fo(c,u)}return"string"===typeof u&&""!==u||"number"===typeof u||"bigint"===typeof u?(u=""+u,null!==l&&6===l.tag?(n(c,l.sibling),(h=i(l,u)).return=c,c=h):(n(c,l),(h=Kr(u,c.mode,h)).return=c,c=h),a(c)):n(c,l)}return function(e,t,n,r){try{lo=0;var i=v(e,t,n,r);return co=null,i}catch(kt){if(kt===$i||kt===eo)throw kt;var o=Ur(29,kt,null,e.mode);return o.lanes=r,o.return=e,o}}}var po=go(!0),mo=go(!1),yo=!1;function vo(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function wo(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function bo(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function Co(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&gl)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,t=Lr(e),Dr(e,null,n),t}return Or(e,r,t,n),Lr(e)}function ko(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194048&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,xe(e,n)}}function So(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var s={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};null===o?i=o=s:o=o.next=s,n=n.next}while(null!==n);null===o?i=o=t:o=o.next=t}else i=o=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,callbacks:r.callbacks},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var To=!1;function Io(){if(To){if(null!==Ki)throw Ki}}function _o(e,t,n,r){To=!1;var i=e.updateQueue;yo=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,a=i.shared.pending;if(null!==a){i.shared.pending=null;var c=a,l=c.next;c.next=null,null===s?o=l:s.next=l,s=c;var u=e.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==s&&(null===a?u.firstBaseUpdate=l:a.next=l,u.lastBaseUpdate=c))}if(null!==o){var h=i.baseState;for(s=0,u=l=c=null,a=o;;){var d=-536870913&a.lane,g=d!==a.lane;if(g?(yl&d)===d:(r&d)===d){0!==d&&d===ji&&(To=!0),null!==u&&(u=u.next={lane:0,tag:a.tag,payload:a.payload,callback:null,next:null});e:{var p=e,m=a;d=t;var y=n;switch(m.tag){case 1:if("function"===typeof(p=m.payload)){h=p.call(y,h,d);break e}h=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(d="function"===typeof(p=m.payload)?p.call(y,h,d):p)||void 0===d)break e;h=f({},h,d);break e;case 2:yo=!0}}null!==(d=a.callback)&&(e.flags|=64,g&&(e.flags|=8192),null===(g=i.callbacks)?i.callbacks=[d]:g.push(d))}else g={lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(l=u=g,c=h):u=u.next=g,s|=d;if(null===(a=a.next)){if(null===(a=i.shared.pending))break;a=(g=a).next,g.next=null,i.lastBaseUpdate=g,i.shared.pending=null}}null===u&&(c=h),i.baseState=c,i.firstBaseUpdate=l,i.lastBaseUpdate=u,null===o&&(i.shared.lanes=0),Il|=s,e.lanes=s,e.memoizedState=h}}function Ao(e,t){if("function"!==typeof e)throw Error(s(191,e));e.call(t)}function Eo(e,t){var n=e.callbacks;if(null!==n)for(e.callbacks=null,e=0;e<n.length;e++)Ao(n[e],t)}var Po=U(null),Ro=U(0);function No(e,t){B(Ro,e=Sl),B(Po,t),Sl=e|t.baseLanes}function Oo(){B(Ro,Sl),B(Po,Po.current)}function Mo(){Sl=Ro.current,z(Po),z(Ro)}var xo=U(null),Do=null;function Lo(e){var t=e.alternate;B(Bo,1&Bo.current),B(xo,e),null===Do&&(null===t||null!==Po.current||null!==t.memoizedState)&&(Do=e)}function Fo(e){B(Bo,Bo.current),B(xo,e),null===Do&&(Do=e)}function qo(e){22===e.tag?(B(Bo,Bo.current),B(xo,e),null===Do&&(Do=e)):Uo()}function Uo(){B(Bo,Bo.current),B(xo,xo.current)}function zo(e){z(xo),Do===e&&(Do=null),z(Bo)}var Bo=U(0);function Ho(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||Oh(n)||Mh(n)))return t}else if(19!==t.tag||"forwards"!==t.memoizedProps.revealOrder&&"backwards"!==t.memoizedProps.revealOrder&&"unstable_legacy-backwards"!==t.memoizedProps.revealOrder&&"together"!==t.memoizedProps.revealOrder){if(null!==t.child){t.child.return=t,t=t.child;continue}}else if(0!==(128&t.flags))return t;if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Vo=0,jo=null,Ko=null,Go=null,Qo=!1,Wo=!1,Yo=!1,Jo=0,Xo=0,$o=null,Zo=0;function es(){throw Error(s(321))}function ts(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Zn(e[n],t[n]))return!1;return!0}function ns(e,t,n,r,i,o){return Vo=o,jo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,x.H=null===e||null===e.memoizedState?ya:va,Yo=!1,o=n(r,i),Yo=!1,Wo&&(o=is(t,n,r,i)),rs(e),o}function rs(e){x.H=ma;var t=null!==Ko&&null!==Ko.next;if(Vo=0,Go=Ko=jo=null,Qo=!1,Xo=0,$o=null,t)throw Error(s(300));null===e||xa||null!==(e=e.dependencies)&&Ni(e)&&(xa=!0)}function is(e,t,n,r){jo=e;var i=0;do{if(Wo&&($o=null),Xo=0,Wo=!1,25<=i)throw Error(s(301));if(i+=1,Go=Ko=null,null!=e.updateQueue){var o=e.updateQueue;o.lastEffect=null,o.events=null,o.stores=null,null!=o.memoCache&&(o.memoCache.index=0)}x.H=wa,o=t(n,r)}while(Wo);return o}function os(){var e=x.H,t=e.useState()[0];return t="function"===typeof t.then?hs(t):t,e=e.useState()[0],(null!==Ko?Ko.memoizedState:null)!==e&&(jo.flags|=1024),t}function ss(){var e=0!==Jo;return Jo=0,e}function as(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function cs(e){if(Qo){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}Qo=!1}Vo=0,Go=Ko=jo=null,Wo=!1,Xo=Jo=0,$o=null}function ls(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Go?jo.memoizedState=Go=e:Go=Go.next=e,Go}function us(){if(null===Ko){var e=jo.alternate;e=null!==e?e.memoizedState:null}else e=Ko.next;var t=null===Go?jo.memoizedState:Go.next;if(null!==t)Go=t,Ko=e;else{if(null===e){if(null===jo.alternate)throw Error(s(467));throw Error(s(310))}e={memoizedState:(Ko=e).memoizedState,baseState:Ko.baseState,baseQueue:Ko.baseQueue,queue:Ko.queue,next:null},null===Go?jo.memoizedState=Go=e:Go=Go.next=e}return Go}function hs(e){var t=Xo;return Xo+=1,null===$o&&($o=[]),e=ro($o,e,t),t=jo,null===(null===Go?t.memoizedState:Go.next)&&(t=t.alternate,x.H=null===t||null===t.memoizedState?ya:va),e}function ds(e){if(null!==e&&"object"===typeof e){if("function"===typeof e.then)return hs(e);if(e.$$typeof===C)return Mi(e)}throw Error(s(438,String(e)))}function fs(e){var t=null,n=jo.updateQueue;if(null!==n&&(t=n.memoCache),null==t){var r=jo.alternate;null!==r&&(null!==(r=r.updateQueue)&&(null!=(r=r.memoCache)&&(t={data:r.data.map(function(e){return e.slice()}),index:0})))}if(null==t&&(t={data:[],index:0}),null===n&&(n={lastEffect:null,events:null,stores:null,memoCache:null},jo.updateQueue=n),n.memoCache=t,void 0===(n=t.data[t.index]))for(n=t.data[t.index]=Array(e),r=0;r<e;r++)n[r]=E;return t.index++,n}function gs(e,t){return"function"===typeof t?t(e):t}function ps(e){return ms(us(),Ko,e)}function ms(e,t,n){var r=e.queue;if(null===r)throw Error(s(311));r.lastRenderedReducer=n;var i=e.baseQueue,o=r.pending;if(null!==o){if(null!==i){var a=i.next;i.next=o.next,o.next=a}t.baseQueue=i=o,r.pending=null}if(o=e.baseState,null===i)e.memoizedState=o;else{var c=a=null,l=null,u=t=i.next,h=!1;do{var d=-536870913&u.lane;if(d!==u.lane?(yl&d)===d:(Vo&d)===d){var f=u.revertLane;if(0===f)null!==l&&(l=l.next={lane:0,revertLane:0,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),d===ji&&(h=!0);else{if((Vo&f)===f){u=u.next,f===ji&&(h=!0);continue}d={lane:0,revertLane:u.revertLane,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===l?(c=l=d,a=o):l=l.next=d,jo.lanes|=f,Il|=f}d=u.action,Yo&&n(o,d),o=u.hasEagerState?u.eagerState:n(o,d)}else f={lane:d,revertLane:u.revertLane,gesture:u.gesture,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===l?(c=l=f,a=o):l=l.next=f,jo.lanes|=d,Il|=d;u=u.next}while(null!==u&&u!==t);if(null===l?a=o:l.next=c,!Zn(o,e.memoizedState)&&(xa=!0,h&&null!==(n=Ki)))throw n;e.memoizedState=o,e.baseState=a,e.baseQueue=l,r.lastRenderedState=o}return null===i&&(r.lanes=0),[e.memoizedState,r.dispatch]}function ys(e){var t=us(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(null!==i){n.pending=null;var a=i=i.next;do{o=e(o,a.action),a=a.next}while(a!==i);Zn(o,t.memoizedState)||(xa=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function vs(e,t,n){var r=jo,i=us(),o=di;if(o){if(void 0===n)throw Error(s(407));n=n()}else n=t();var a=!Zn((Ko||i).memoizedState,n);if(a&&(i.memoizedState=n,xa=!0),i=i.queue,Vs(Cs.bind(null,r,i,e),[e]),i.getSnapshot!==t||a||null!==Go&&1&Go.memoizedState.tag){if(r.flags|=2048,qs(9,{destroy:void 0},bs.bind(null,r,i,n,t),null),null===pl)throw Error(s(349));o||0!==(127&Vo)||ws(r,t,n)}return n}function ws(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=jo.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},jo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function bs(e,t,n,r){t.value=n,t.getSnapshot=r,ks(t)&&Ss(e)}function Cs(e,t,n){return n(function(){ks(t)&&Ss(e)})}function ks(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Zn(e,n)}catch(r){return!0}}function Ss(e){var t=xr(e,2);null!==t&&Yl(t,e,2)}function Ts(e){var t=ls();if("function"===typeof e){var n=e;if(e=n(),Yo){we(!0);try{n()}finally{we(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:gs,lastRenderedState:e},t}function Is(e,t,n,r){return e.baseState=n,ms(e,Ko,"function"===typeof r?r:gs)}function _s(e,t,n,r,i){if(fa(e))throw Error(s(485));if(null!==(e=t.action)){var o={payload:i,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){o.listeners.push(e)}};null!==x.T?n(!0):o.isTransition=!1,r(o),null===(n=t.pending)?(o.next=t.pending=o,As(t,o)):(o.next=n.next,t.pending=n.next=o)}}function As(e,t){var n=t.action,r=t.payload,i=e.state;if(t.isTransition){var o=x.T,s={};x.T=s;try{var a=n(i,r),c=x.S;null!==c&&c(s,a),Es(e,t,a)}catch(l){Rs(e,t,l)}finally{null!==o&&null!==s.types&&(o.types=s.types),x.T=o}}else try{Es(e,t,o=n(i,r))}catch(u){Rs(e,t,u)}}function Es(e,t,n){null!==n&&"object"===typeof n&&"function"===typeof n.then?n.then(function(n){Ps(e,t,n)},function(n){return Rs(e,t,n)}):Ps(e,t,n)}function Ps(e,t,n){t.status="fulfilled",t.value=n,Ns(t),e.state=n,null!==(t=e.pending)&&((n=t.next)===t?e.pending=null:(n=n.next,t.next=n,As(e,n)))}function Rs(e,t,n){var r=e.pending;if(e.pending=null,null!==r){r=r.next;do{t.status="rejected",t.reason=n,Ns(t),t=t.next}while(t!==r)}e.action=null}function Ns(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Os(e,t){return t}function Ms(e,t){if(di){var n=pl.formState;if(null!==n){e:{var r=jo;if(di){if(hi){t:{for(var i=hi,o=gi;8!==i.nodeType;){if(!o){i=null;break t}if(null===(i=xh(i.nextSibling))){i=null;break t}}i="F!"===(o=i.data)||"F"===o?i:null}if(i){hi=xh(i.nextSibling),r="F!"===i.data;break e}}mi(r)}r=!1}r&&(t=n[0])}}return(n=ls()).memoizedState=n.baseState=t,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Os,lastRenderedState:t},n.queue=r,n=ua.bind(null,jo,r),r.dispatch=n,r=Ts(!1),o=da.bind(null,jo,!1,r.queue),i={state:t,dispatch:null,action:e,pending:null},(r=ls()).queue=i,n=_s.bind(null,jo,i,o,n),i.dispatch=n,r.memoizedState=e,[t,n,!1]}function xs(e){return Ds(us(),Ko,e)}function Ds(e,t,n){if(t=ms(e,t,Os)[0],e=ps(gs)[0],"object"===typeof t&&null!==t&&"function"===typeof t.then)try{var r=hs(t)}catch(kt){if(kt===$i)throw eo;throw kt}else r=t;var i=(t=us()).queue,o=i.dispatch;return n!==t.memoizedState&&(jo.flags|=2048,qs(9,{destroy:void 0},Ls.bind(null,i,n),null)),[r,o,e]}function Ls(e,t){e.action=t}function Fs(e){var t=us(),n=Ko;if(null!==n)return Ds(t,n,e);us(),t=t.memoizedState;var r=(n=us()).queue.dispatch;return n.memoizedState=e,[t,r,!1]}function qs(e,t,n,r){return e={tag:e,create:n,deps:r,inst:t,next:null},null===(t=jo.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},jo.updateQueue=t),null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Us(){return us().memoizedState}function zs(e,t,n,r){var i=ls();jo.flags|=e,i.memoizedState=qs(1|t,{destroy:void 0},n,void 0===r?null:r)}function Bs(e,t,n,r){var i=us();r=void 0===r?null:r;var o=i.memoizedState.inst;null!==Ko&&null!==r&&ts(r,Ko.memoizedState.deps)?i.memoizedState=qs(t,o,n,r):(jo.flags|=e,i.memoizedState=qs(1|t,o,n,r))}function Hs(e,t){zs(8390656,8,e,t)}function Vs(e,t){Bs(2048,8,e,t)}function js(e){var t=us().memoizedState;return function(e){jo.flags|=4;var t=jo.updateQueue;if(null===t)t={lastEffect:null,events:null,stores:null,memoCache:null},jo.updateQueue=t,t.events=[e];else{var n=t.events;null===n?t.events=[e]:n.push(e)}}({ref:t,nextImpl:e}),function(){if(0!==(2&gl))throw Error(s(440));return t.impl.apply(void 0,arguments)}}function Ks(e,t){return Bs(4,2,e,t)}function Gs(e,t){return Bs(4,4,e,t)}function Qs(e,t){if("function"===typeof t){e=e();var n=t(e);return function(){"function"===typeof n?n():t(null)}}if(null!==t&&void 0!==t)return e=e(),t.current=e,function(){t.current=null}}function Ws(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,Bs(4,4,Qs.bind(null,t,e),n)}function Ys(){}function Js(e,t){var n=us();t=void 0===t?null:t;var r=n.memoizedState;return null!==t&&ts(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Xs(e,t){var n=us();t=void 0===t?null:t;var r=n.memoizedState;if(null!==t&&ts(t,r[1]))return r[0];if(r=e(),Yo){we(!0);try{e()}finally{we(!1)}}return n.memoizedState=[r,t],r}function $s(e,t,n){return void 0===n||0!==(1073741824&Vo)&&0===(261930&yl)?e.memoizedState=t:(e.memoizedState=n,e=Wl(),jo.lanes|=e,Il|=e,n)}function Zs(e,t,n,r){return Zn(n,t)?n:null!==Po.current?(e=$s(e,n,r),Zn(e,t)||(xa=!0),e):0===(42&Vo)||0!==(1073741824&Vo)&&0===(261930&yl)?(xa=!0,e.memoizedState=n):(e=Wl(),jo.lanes|=e,Il|=e,t)}function ea(e,t,n,r,i){var o=D.p;D.p=0!==o&&8>o?o:8;var s=x.T,a={};x.T=a,da(e,!1,t,n);try{var c=i(),l=x.S;if(null!==l&&l(a,c),null!==c&&"object"===typeof c&&"function"===typeof c.then)ha(e,t,function(e,t){var n=[],r={status:"pending",value:null,reason:null,then:function(e){n.push(e)}};return e.then(function(){r.status="fulfilled",r.value=t;for(var e=0;e<n.length;e++)(0,n[e])(t)},function(e){for(r.status="rejected",r.reason=e,e=0;e<n.length;e++)(0,n[e])(void 0)}),r}(c,r),Ql());else ha(e,t,r,Ql())}catch(u){ha(e,t,{then:function(){},status:"rejected",reason:u},Ql())}finally{D.p=o,null!==s&&null!==a.types&&(s.types=a.types),x.T=s}}function ta(){}function na(e,t,n,r){if(5!==e.tag)throw Error(s(476));var i=ra(e).queue;ea(e,i,t,L,null===n?ta:function(){return ia(e),n(r)})}function ra(e){var t=e.memoizedState;if(null!==t)return t;var n={};return(t={memoizedState:L,baseState:L,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:gs,lastRenderedState:L},next:null}).next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:gs,lastRenderedState:n},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function ia(e){var t=ra(e);null===t.next&&(t=e.alternate.memoizedState),ha(e,t.next.queue,{},Ql())}function oa(){return Mi(hd)}function sa(){return us().memoizedState}function aa(){return us().memoizedState}function ca(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var n=Ql(),r=Co(t,e=bo(n),n);return null!==r&&(Yl(r,t,n),ko(r,t,n)),t={cache:zi()},void(e.payload=t)}t=t.return}}function la(e,t,n){var r=Ql();n={lane:r,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},fa(e)?ga(t,n):null!==(n=Mr(e,t,n,r))&&(Yl(n,e,r),pa(n,t,r))}function ua(e,t,n){ha(e,t,n,Ql())}function ha(e,t,n,r){var i={lane:r,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null};if(fa(e))ga(t,i);else{var o=e.alternate;if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var s=t.lastRenderedState,a=o(s,n);if(i.hasEagerState=!0,i.eagerState=a,Zn(a,s))return Or(e,t,i,0),null===pl&&Nr(),!1}catch(c){}if(null!==(n=Mr(e,t,i,r)))return Yl(n,e,r),pa(n,t,r),!0}return!1}function da(e,t,n,r){if(r={lane:2,revertLane:Vu(),gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},fa(e)){if(t)throw Error(s(479))}else null!==(t=Mr(e,n,r,2))&&Yl(t,e,2)}function fa(e){var t=e.alternate;return e===jo||null!==t&&t===jo}function ga(e,t){Wo=Qo=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function pa(e,t,n){if(0!==(4194048&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,xe(e,n)}}var ma={readContext:Mi,use:ds,useCallback:es,useContext:es,useEffect:es,useImperativeHandle:es,useLayoutEffect:es,useInsertionEffect:es,useMemo:es,useReducer:es,useRef:es,useState:es,useDebugValue:es,useDeferredValue:es,useTransition:es,useSyncExternalStore:es,useId:es,useHostTransitionStatus:es,useFormState:es,useActionState:es,useOptimistic:es,useMemoCache:es,useCacheRefresh:es};ma.useEffectEvent=es;var ya={readContext:Mi,use:ds,useCallback:function(e,t){return ls().memoizedState=[e,void 0===t?null:t],e},useContext:Mi,useEffect:Hs,useImperativeHandle:function(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,zs(4194308,4,Qs.bind(null,t,e),n)},useLayoutEffect:function(e,t){return zs(4194308,4,e,t)},useInsertionEffect:function(e,t){zs(4,2,e,t)},useMemo:function(e,t){var n=ls();t=void 0===t?null:t;var r=e();if(Yo){we(!0);try{e()}finally{we(!1)}}return n.memoizedState=[r,t],r},useReducer:function(e,t,n){var r=ls();if(void 0!==n){var i=n(t);if(Yo){we(!0);try{n(t)}finally{we(!1)}}}else i=t;return r.memoizedState=r.baseState=i,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:i},r.queue=e,e=e.dispatch=la.bind(null,jo,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},ls().memoizedState=e},useState:function(e){var t=(e=Ts(e)).queue,n=ua.bind(null,jo,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Ys,useDeferredValue:function(e,t){return $s(ls(),e,t)},useTransition:function(){var e=Ts(!1);return e=ea.bind(null,jo,e.queue,!0,!1),ls().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var r=jo,i=ls();if(di){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===pl)throw Error(s(349));0!==(127&yl)||ws(r,t,n)}i.memoizedState=n;var o={value:n,getSnapshot:t};return i.queue=o,Hs(Cs.bind(null,r,o,e),[e]),r.flags|=2048,qs(9,{destroy:void 0},bs.bind(null,r,o,n,t),null),n},useId:function(){var e=ls(),t=pl.identifierPrefix;if(di){var n=ii;t="_"+t+"R_"+(n=(ri&~(1<<32-be(ri)-1)).toString(32)+n),0<(n=Jo++)&&(t+="H"+n.toString(32)),t+="_"}else t="_"+t+"r_"+(n=Zo++).toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:oa,useFormState:Ms,useActionState:Ms,useOptimistic:function(e){var t=ls();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=da.bind(null,jo,!0,n),n.dispatch=t,[e,t]},useMemoCache:fs,useCacheRefresh:function(){return ls().memoizedState=ca.bind(null,jo)},useEffectEvent:function(e){var t=ls(),n={impl:e};return t.memoizedState=n,function(){if(0!==(2&gl))throw Error(s(440));return n.impl.apply(void 0,arguments)}}},va={readContext:Mi,use:ds,useCallback:Js,useContext:Mi,useEffect:Vs,useImperativeHandle:Ws,useInsertionEffect:Ks,useLayoutEffect:Gs,useMemo:Xs,useReducer:ps,useRef:Us,useState:function(){return ps(gs)},useDebugValue:Ys,useDeferredValue:function(e,t){return Zs(us(),Ko.memoizedState,e,t)},useTransition:function(){var e=ps(gs)[0],t=us().memoizedState;return["boolean"===typeof e?e:hs(e),t]},useSyncExternalStore:vs,useId:sa,useHostTransitionStatus:oa,useFormState:xs,useActionState:xs,useOptimistic:function(e,t){return Is(us(),0,e,t)},useMemoCache:fs,useCacheRefresh:aa};va.useEffectEvent=js;var wa={readContext:Mi,use:ds,useCallback:Js,useContext:Mi,useEffect:Vs,useImperativeHandle:Ws,useInsertionEffect:Ks,useLayoutEffect:Gs,useMemo:Xs,useReducer:ys,useRef:Us,useState:function(){return ys(gs)},useDebugValue:Ys,useDeferredValue:function(e,t){var n=us();return null===Ko?$s(n,e,t):Zs(n,Ko.memoizedState,e,t)},useTransition:function(){var e=ys(gs)[0],t=us().memoizedState;return["boolean"===typeof e?e:hs(e),t]},useSyncExternalStore:vs,useId:sa,useHostTransitionStatus:oa,useFormState:Fs,useActionState:Fs,useOptimistic:function(e,t){var n=us();return null!==Ko?Is(n,0,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:fs,useCacheRefresh:aa};function ba(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:f({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}wa.useEffectEvent=js;var Ca={enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Ql(),i=bo(r);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Co(e,i,r))&&(Yl(t,e,r),ko(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Ql(),i=bo(r);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Co(e,i,r))&&(Yl(t,e,r),ko(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Ql(),r=bo(n);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=Co(e,r,n))&&(Yl(t,e,n),ko(t,e,n))}};function ka(e,t,n,r,i,o,s){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,o,s):!t.prototype||!t.prototype.isPureReactComponent||(!er(n,r)||!er(i,o))}function Sa(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Ca.enqueueReplaceState(t,t.state,null)}function Ta(e,t){var n=t;if("ref"in t)for(var r in n={},t)"ref"!==r&&(n[r]=t[r]);if(e=e.defaultProps)for(var i in n===t&&(n=f({},n)),e)void 0===n[i]&&(n[i]=e[i]);return n}function Ia(e){Ar(e)}function _a(e){console.error(e)}function Aa(e){Ar(e)}function Ea(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(n){setTimeout(function(){throw n})}}function Pa(e,t,n){try{(0,e.onCaughtError)(n.value,{componentStack:n.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(r){setTimeout(function(){throw r})}}function Ra(e,t,n){return(n=bo(n)).tag=3,n.payload={element:null},n.callback=function(){Ea(e,t)},n}function Na(e){return(e=bo(e)).tag=3,e}function Oa(e,t,n,r){var i=n.type.getDerivedStateFromError;if("function"===typeof i){var o=r.value;e.payload=function(){return i(o)},e.callback=function(){Pa(t,n,r)}}var s=n.stateNode;null!==s&&"function"===typeof s.componentDidCatch&&(e.callback=function(){Pa(t,n,r),"function"!==typeof i&&(null===Fl?Fl=new Set([this]):Fl.add(this));var e=r.stack;this.componentDidCatch(r.value,{componentStack:null!==e?e:""})})}var Ma=Error(s(461)),xa=!1;function Da(e,t,n,r){t.child=null===e?mo(t,null,n,r):po(t,e.child,n,r)}function La(e,t,n,r,i){n=n.render;var o=t.ref;if("ref"in r){var s={};for(var a in r)"ref"!==a&&(s[a]=r[a])}else s=r;return Oi(t),r=ns(e,t,n,s,o,i),a=ss(),null===e||xa?(di&&a&&ai(t),t.flags|=1,Da(e,t,r,i),t.child):(as(e,t,i),oc(e,t,i))}function Fa(e,t,n,r,i){if(null===e){var o=n.type;return"function"!==typeof o||zr(o)||void 0!==o.defaultProps||null!==n.compare?((e=Vr(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,qa(e,t,o,r,i))}if(o=e.child,!sc(e,i)){var s=o.memoizedProps;if((n=null!==(n=n.compare)?n:er)(s,r)&&e.ref===t.ref)return oc(e,t,i)}return t.flags|=1,(e=Br(o,r)).ref=t.ref,e.return=t,t.child=e}function qa(e,t,n,r,i){if(null!==e){var o=e.memoizedProps;if(er(o,r)&&e.ref===t.ref){if(xa=!1,t.pendingProps=r=o,!sc(e,i))return t.lanes=e.lanes,oc(e,t,i);0!==(131072&e.flags)&&(xa=!0)}}return Ka(e,t,n,r,i)}function Ua(e,t,n,r){var i=r.children,o=null!==e?e.memoizedState:null;if(null===e&&null===t.stateNode&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),"hidden"===r.mode){if(0!==(128&t.flags)){if(o=null!==o?o.baseLanes|n:n,null!==e){for(r=t.child=e.child,i=0;null!==r;)i=i|r.lanes|r.childLanes,r=r.sibling;r=i&~o}else r=0,t.child=null;return Ba(e,t,o,n,r)}if(0===(536870912&n))return r=t.lanes=536870912,Ba(e,t,null!==o?o.baseLanes|n:n,n,r);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Ji(0,null!==o?o.cachePool:null),null!==o?No(t,o):Oo(),qo(t)}else null!==o?(Ji(0,o.cachePool),No(t,o),Uo(),t.memoizedState=null):(null!==e&&Ji(0,null),Oo(),Uo());return Da(e,t,i,n),t.child}function za(e,t){return null!==e&&22===e.tag||null!==t.stateNode||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function Ba(e,t,n,r,i){var o=Yi();return o=null===o?null:{parent:Ui._currentValue,pool:o},t.memoizedState={baseLanes:n,cachePool:o},null!==e&&Ji(0,null),Oo(),qo(t),null!==e&&Ri(e,t,r,!0),t.childLanes=i,null}function Ha(e,t){return(t=ec({mode:t.mode,children:t.children},e.mode)).ref=e.ref,e.child=t,t.return=e,t}function Va(e,t,n){return po(t,e.child,null,n),(e=Ha(t,t.pendingProps)).flags|=2,zo(t),t.memoizedState=null,e}function ja(e,t){var n=t.ref;if(null===n)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!==typeof n&&"object"!==typeof n)throw Error(s(284));null!==e&&e.ref===n||(t.flags|=4194816)}}function Ka(e,t,n,r,i){return Oi(t),n=ns(e,t,n,r,void 0,i),r=ss(),null===e||xa?(di&&r&&ai(t),t.flags|=1,Da(e,t,n,i),t.child):(as(e,t,i),oc(e,t,i))}function Ga(e,t,n,r,i,o){return Oi(t),t.updateQueue=null,n=is(t,r,n,i),rs(e),r=ss(),null===e||xa?(di&&r&&ai(t),t.flags|=1,Da(e,t,n,o),t.child):(as(e,t,o),oc(e,t,o))}function Qa(e,t,n,r,i){if(Oi(t),null===t.stateNode){var o=Fr,s=n.contextType;"object"===typeof s&&null!==s&&(o=Mi(s)),o=new n(r,o),t.memoizedState=null!==o.state&&void 0!==o.state?o.state:null,o.updater=Ca,t.stateNode=o,o._reactInternals=t,(o=t.stateNode).props=r,o.state=t.memoizedState,o.refs={},vo(t),s=n.contextType,o.context="object"===typeof s&&null!==s?Mi(s):Fr,o.state=t.memoizedState,"function"===typeof(s=n.getDerivedStateFromProps)&&(ba(t,n,s,r),o.state=t.memoizedState),"function"===typeof n.getDerivedStateFromProps||"function"===typeof o.getSnapshotBeforeUpdate||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||(s=o.state,"function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount(),s!==o.state&&Ca.enqueueReplaceState(o,o.state,null),_o(t,r,o,i),Io(),o.state=t.memoizedState),"function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!0}else if(null===e){o=t.stateNode;var a=t.memoizedProps,c=Ta(n,a);o.props=c;var l=o.context,u=n.contextType;s=Fr,"object"===typeof u&&null!==u&&(s=Mi(u));var h=n.getDerivedStateFromProps;u="function"===typeof h||"function"===typeof o.getSnapshotBeforeUpdate,a=t.pendingProps!==a,u||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a||l!==s)&&Sa(t,o,r,s),yo=!1;var d=t.memoizedState;o.state=d,_o(t,r,o,i),Io(),l=t.memoizedState,a||d!==l||yo?("function"===typeof h&&(ba(t,n,h,r),l=t.memoizedState),(c=yo||ka(t,n,c,r,d,l,s))?(u||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),o.props=r,o.state=l,o.context=s,r=c):("function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,wo(e,t),u=Ta(n,s=t.memoizedProps),o.props=u,h=t.pendingProps,d=o.context,l=n.contextType,c=Fr,"object"===typeof l&&null!==l&&(c=Mi(l)),(l="function"===typeof(a=n.getDerivedStateFromProps)||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==h||d!==c)&&Sa(t,o,r,c),yo=!1,d=t.memoizedState,o.state=d,_o(t,r,o,i),Io();var f=t.memoizedState;s!==h||d!==f||yo||null!==e&&null!==e.dependencies&&Ni(e.dependencies)?("function"===typeof a&&(ba(t,n,a,r),f=t.memoizedState),(u=yo||ka(t,n,u,r,d,f,c)||null!==e&&null!==e.dependencies&&Ni(e.dependencies))?(l||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,f,c),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,f,c)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=f),o.props=r,o.state=f,o.context=c,r=u):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),r=!1)}return o=r,ja(e,t),r=0!==(128&t.flags),o||r?(o=t.stateNode,n=r&&"function"!==typeof n.getDerivedStateFromError?null:o.render(),t.flags|=1,null!==e&&r?(t.child=po(t,e.child,null,i),t.child=po(t,null,n,i)):Da(e,t,n,i),t.memoizedState=o.state,e=t.child):e=oc(e,t,i),e}function Wa(e,t,n,r){return bi(),t.flags|=256,Da(e,t,n,r),t.child}var Ya={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Ja(e){return{baseLanes:e,cachePool:Xi()}}function Xa(e,t,n){return e=null!==e?e.childLanes&~n:0,t&&(e|=El),e}function $a(e,t,n){var r,i=t.pendingProps,o=!1,a=0!==(128&t.flags);if((r=a)||(r=(null===e||null!==e.memoizedState)&&0!==(2&Bo.current)),r&&(o=!0,t.flags&=-129),r=0!==(32&t.flags),t.flags&=-33,null===e){if(di){if(o?Lo(t):Uo(),(e=hi)?null!==(e=null!==(e=Nh(e,gi))&&"&"!==e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==ni?{id:ri,overflow:ii}:null,retryLane:536870912,hydrationErrors:null},(n=Gr(e)).return=t,t.child=n,ui=t,hi=null):e=null,null===e)throw mi(t);return Mh(e)?t.lanes=32:t.lanes=536870912,null}var c=i.children;return i=i.fallback,o?(Uo(),c=ec({mode:"hidden",children:c},o=t.mode),i=jr(i,o,n,null),c.return=t,i.return=t,c.sibling=i,t.child=c,(i=t.child).memoizedState=Ja(n),i.childLanes=Xa(e,r,n),t.memoizedState=Ya,za(null,i)):(Lo(t),Za(t,c))}var l=e.memoizedState;if(null!==l&&null!==(c=l.dehydrated)){if(a)256&t.flags?(Lo(t),t.flags&=-257,t=tc(e,t,n)):null!==t.memoizedState?(Uo(),t.child=e.child,t.flags|=128,t=null):(Uo(),c=i.fallback,o=t.mode,i=ec({mode:"visible",children:i.children},o),(c=jr(c,o,n,null)).flags|=2,i.return=t,c.return=t,i.sibling=c,t.child=i,po(t,e.child,null,n),(i=t.child).memoizedState=Ja(n),i.childLanes=Xa(e,r,n),t.memoizedState=Ya,t=za(null,i));else if(Lo(t),Mh(c)){if(r=c.nextSibling&&c.nextSibling.dataset)var u=r.dgst;r=u,(i=Error(s(419))).stack="",i.digest=r,ki({value:i,source:null,stack:null}),t=tc(e,t,n)}else if(xa||Ri(e,t,n,!1),r=0!==(n&e.childLanes),xa||r){if(null!==(r=pl)&&(0!==(i=De(r,n))&&i!==l.retryLane))throw l.retryLane=i,xr(e,i),Yl(r,e,i),Ma;Oh(c)||au(),t=tc(e,t,n)}else Oh(c)?(t.flags|=192,t.child=e.child,t=null):(e=l.treeContext,hi=xh(c.nextSibling),ui=t,di=!0,fi=null,gi=!1,null!==e&&li(t,e),(t=Za(t,i.children)).flags|=4096);return t}return o?(Uo(),c=i.fallback,o=t.mode,u=(l=e.child).sibling,(i=Br(l,{mode:"hidden",children:i.children})).subtreeFlags=65011712&l.subtreeFlags,null!==u?c=Br(u,c):(c=jr(c,o,n,null)).flags|=2,c.return=t,i.return=t,i.sibling=c,t.child=i,za(null,i),i=t.child,null===(c=e.child.memoizedState)?c=Ja(n):(null!==(o=c.cachePool)?(l=Ui._currentValue,o=o.parent!==l?{parent:l,pool:l}:o):o=Xi(),c={baseLanes:c.baseLanes|n,cachePool:o}),i.memoizedState=c,i.childLanes=Xa(e,r,n),t.memoizedState=Ya,za(e.child,i)):(Lo(t),e=(n=e.child).sibling,(n=Br(n,{mode:"visible",children:i.children})).return=t,n.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n)}function Za(e,t){return(t=ec({mode:"visible",children:t},e.mode)).return=e,e.child=t}function ec(e,t){return(e=Ur(22,e,null,t)).lanes=0,e}function tc(e,t,n){return po(t,e.child,null,n),(e=Za(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function nc(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Ei(e.return,t,n)}function rc(e,t,n,r,i,o){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i,treeForkCount:o}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i,s.treeForkCount=o)}function ic(e,t,n){var r=t.pendingProps,i=r.revealOrder,o=r.tail;r=r.children;var s=Bo.current,a=0!==(2&s);if(a?(s=1&s|2,t.flags|=128):s&=1,B(Bo,s),Da(e,t,r,n),r=di?Zr:0,!a&&null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&nc(e,n,t);else if(19===e.tag)nc(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===Ho(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),rc(t,!1,i,n,o,r);break;case"backwards":case"unstable_legacy-backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===Ho(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}rc(t,!0,n,null,o,r);break;case"together":rc(t,!1,null,null,void 0,r);break;default:t.memoizedState=null}return t.child}function oc(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Il|=t.lanes,0===(n&t.childLanes)){if(null===e)return null;if(Ri(e,t,n,!1),0===(n&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Br(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Br(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function sc(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!Ni(e))}function ac(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps)xa=!0;else{if(!sc(e,n)&&0===(128&t.flags))return xa=!1,function(e,t,n){switch(t.tag){case 3:W(t,t.stateNode.containerInfo),_i(0,Ui,e.memoizedState.cache),bi();break;case 27:case 5:J(t);break;case 4:W(t,t.stateNode.containerInfo);break;case 10:_i(0,t.type,t.memoizedProps.value);break;case 31:if(null!==t.memoizedState)return t.flags|=128,Fo(t),null;break;case 13:var r=t.memoizedState;if(null!==r)return null!==r.dehydrated?(Lo(t),t.flags|=128,null):0!==(n&t.child.childLanes)?$a(e,t,n):(Lo(t),null!==(e=oc(e,t,n))?e.sibling:null);Lo(t);break;case 19:var i=0!==(128&e.flags);if((r=0!==(n&t.childLanes))||(Ri(e,t,n,!1),r=0!==(n&t.childLanes)),i){if(r)return ic(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),B(Bo,Bo.current),r)break;return null;case 22:return t.lanes=0,Ua(e,t,n,t.pendingProps);case 24:_i(0,Ui,e.memoizedState.cache)}return oc(e,t,n)}(e,t,n);xa=0!==(131072&e.flags)}else xa=!1,di&&0!==(1048576&t.flags)&&si(t,Zr,t.index);switch(t.lanes=0,t.tag){case 16:e:{var r=t.pendingProps;if(e=io(t.elementType),t.type=e,"function"!==typeof e){if(void 0!==e&&null!==e){var i=e.$$typeof;if(i===k){t.tag=11,t=La(null,t,e,r,n);break e}if(i===I){t.tag=14,t=Fa(null,t,e,r,n);break e}}throw t=O(e)||e,Error(s(306,t,""))}zr(e)?(r=Ta(e,r),t.tag=1,t=Qa(null,t,e,r,n)):(t.tag=0,t=Ka(null,t,e,r,n))}return t;case 0:return Ka(e,t,t.type,t.pendingProps,n);case 1:return Qa(e,t,r=t.type,i=Ta(r,t.pendingProps),n);case 3:e:{if(W(t,t.stateNode.containerInfo),null===e)throw Error(s(387));r=t.pendingProps;var o=t.memoizedState;i=o.element,wo(e,t),_o(t,r,null,n);var a=t.memoizedState;if(r=a.cache,_i(0,Ui,r),r!==o.cache&&Pi(t,[Ui],n,!0),Io(),r=a.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:a.cache},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Wa(e,t,r,n);break e}if(r!==i){ki(i=Yr(Error(s(424)),t)),t=Wa(e,t,r,n);break e}if(9===(e=t.stateNode.containerInfo).nodeType)e=e.body;else e="HTML"===e.nodeName?e.ownerDocument.body:e;for(hi=xh(e.firstChild),ui=t,di=!0,fi=null,gi=!0,n=mo(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(bi(),r===i){t=oc(e,t,n);break e}Da(e,t,r,n)}t=t.child}return t;case 26:return ja(e,t),null===e?(n=Gh(t.type,null,t.pendingProps,null))?t.memoizedState=n:di||(n=t.type,e=t.pendingProps,(r=yh(G.current).createElement(n))[Be]=t,r[He]=e,fh(r,n,e),et(r),t.stateNode=r):t.memoizedState=Gh(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return J(t),null===e&&di&&(r=t.stateNode=qh(t.type,t.pendingProps,G.current),ui=t,gi=!0,i=hi,Ah(t.type)?(Dh=i,hi=xh(r.firstChild)):hi=i),Da(e,t,t.pendingProps.children,n),ja(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&di&&((i=r=hi)&&(null!==(r=function(e,t,n,r){for(;1===e.nodeType;){var i=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!r&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(r){if(!e[We])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(o=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(o!==i.rel||e.getAttribute("href")!==(null==i.href||""===i.href?null:i.href)||e.getAttribute("crossorigin")!==(null==i.crossOrigin?null:i.crossOrigin)||e.getAttribute("title")!==(null==i.title?null:i.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((o=e.getAttribute("src"))!==(null==i.src?null:i.src)||e.getAttribute("type")!==(null==i.type?null:i.type)||e.getAttribute("crossorigin")!==(null==i.crossOrigin?null:i.crossOrigin))&&o&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var o=null==i.name?null:""+i.name;if("hidden"===i.type&&e.getAttribute("name")===o)return e}if(null===(e=xh(e.nextSibling)))break}return null}(r,t.type,t.pendingProps,gi))?(t.stateNode=r,ui=t,hi=xh(r.firstChild),gi=!1,i=!0):i=!1),i||mi(t)),J(t),i=t.type,o=t.pendingProps,a=null!==e?e.memoizedProps:null,r=o.children,bh(i,o)?r=null:null!==a&&bh(i,a)&&(t.flags|=32),null!==t.memoizedState&&(i=ns(e,t,os,null,null,n),hd._currentValue=i),ja(e,t),Da(e,t,r,n),t.child;case 6:return null===e&&di&&((e=n=hi)&&(null!==(n=function(e,t,n){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!n)return null;if(null===(e=xh(e.nextSibling)))return null}return e}(n,t.pendingProps,gi))?(t.stateNode=n,ui=t,hi=null,e=!0):e=!1),e||mi(t)),null;case 13:return $a(e,t,n);case 4:return W(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=po(t,null,r,n):Da(e,t,r,n),t.child;case 11:return La(e,t,t.type,t.pendingProps,n);case 7:return Da(e,t,t.pendingProps,n),t.child;case 8:case 12:return Da(e,t,t.pendingProps.children,n),t.child;case 10:return r=t.pendingProps,_i(0,t.type,r.value),Da(e,t,r.children,n),t.child;case 9:return i=t.type._context,r=t.pendingProps.children,Oi(t),r=r(i=Mi(i)),t.flags|=1,Da(e,t,r,n),t.child;case 14:return Fa(e,t,t.type,t.pendingProps,n);case 15:return qa(e,t,t.type,t.pendingProps,n);case 19:return ic(e,t,n);case 31:return function(e,t,n){var r=t.pendingProps,i=0!==(128&t.flags);if(t.flags&=-129,null===e){if(di){if("hidden"===r.mode)return e=Ha(t,r),t.lanes=536870912,za(null,e);if(Fo(t),(e=hi)?null!==(e=null!==(e=Nh(e,gi))&&"&"===e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==ni?{id:ri,overflow:ii}:null,retryLane:536870912,hydrationErrors:null},(n=Gr(e)).return=t,t.child=n,ui=t,hi=null):e=null,null===e)throw mi(t);return t.lanes=536870912,null}return Ha(t,r)}var o=e.memoizedState;if(null!==o){var a=o.dehydrated;if(Fo(t),i)if(256&t.flags)t.flags&=-257,t=Va(e,t,n);else{if(null===t.memoizedState)throw Error(s(558));t.child=e.child,t.flags|=128,t=null}else if(xa||Ri(e,t,n,!1),i=0!==(n&e.childLanes),xa||i){if(null!==(r=pl)&&0!==(a=De(r,n))&&a!==o.retryLane)throw o.retryLane=a,xr(e,a),Yl(r,e,a),Ma;au(),t=Va(e,t,n)}else e=o.treeContext,hi=xh(a.nextSibling),ui=t,di=!0,fi=null,gi=!1,null!==e&&li(t,e),(t=Ha(t,r)).flags|=4096;return t}return(e=Br(e.child,{mode:r.mode,children:r.children})).ref=t.ref,t.child=e,e.return=t,e}(e,t,n);case 22:return Ua(e,t,n,t.pendingProps);case 24:return Oi(t),r=Mi(Ui),null===e?(null===(i=Yi())&&(i=pl,o=zi(),i.pooledCache=o,o.refCount++,null!==o&&(i.pooledCacheLanes|=n),i=o),t.memoizedState={parent:r,cache:i},vo(t),_i(0,Ui,i)):(0!==(e.lanes&n)&&(wo(e,t),_o(t,null,null,n),Io()),i=e.memoizedState,o=t.memoizedState,i.parent!==r?(i={parent:r,cache:r},t.memoizedState=i,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=i),_i(0,Ui,r)):(r=o.cache,_i(0,Ui,r),r!==i.cache&&Pi(t,[Ui],n,!0))),Da(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(s(156,t.tag))}function cc(e){e.flags|=4}function lc(e,t,n,r,i){if((t=0!==(32&e.mode))&&(t=!1),t){if(e.flags|=16777216,(335544128&i)===i)if(e.stateNode.complete)e.flags|=8192;else{if(!iu())throw oo=to,Zi;e.flags|=8192}}else e.flags&=-16777217}function uc(e,t){if("stylesheet"!==t.type||0!==(4&t.state.loading))e.flags&=-16777217;else if(e.flags|=16777216,!od(t)){if(!iu())throw oo=to,Zi;e.flags|=8192}}function hc(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?Re():536870912,e.lanes|=t,Pl|=t)}function dc(e,t){if(!di)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function fc(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=65011712&i.subtreeFlags,r|=65011712&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function gc(e,t,n){var r=t.pendingProps;switch(ci(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return fc(t),null;case 3:return n=t.stateNode,r=null,null!==e&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),Ai(Ui),Y(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(wi(t)?cc(t):null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,Ci())),fc(t),null;case 26:var i=t.type,o=t.memoizedState;return null===e?(cc(t),null!==o?(fc(t),uc(t,o)):(fc(t),lc(t,i,0,0,n))):o?o!==e.memoizedState?(cc(t),fc(t),uc(t,o)):(fc(t),t.flags&=-16777217):((e=e.memoizedProps)!==r&&cc(t),fc(t),lc(t,i,0,0,n)),null;case 27:if(X(t),n=G.current,i=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==r&&cc(t);else{if(!r){if(null===t.stateNode)throw Error(s(166));return fc(t),null}e=j.current,wi(t)?yi(t):(e=qh(i,r,n),t.stateNode=e,cc(t))}return fc(t),null;case 5:if(X(t),i=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==r&&cc(t);else{if(!r){if(null===t.stateNode)throw Error(s(166));return fc(t),null}if(o=j.current,wi(t))yi(t);else{var a=yh(G.current);switch(o){case 1:o=a.createElementNS("http://www.w3.org/2000/svg",i);break;case 2:o=a.createElementNS("http://www.w3.org/1998/Math/MathML",i);break;default:switch(i){case"svg":o=a.createElementNS("http://www.w3.org/2000/svg",i);break;case"math":o=a.createElementNS("http://www.w3.org/1998/Math/MathML",i);break;case"script":(o=a.createElement("div")).innerHTML="<script><\/script>",o=o.removeChild(o.firstChild);break;case"select":o="string"===typeof r.is?a.createElement("select",{is:r.is}):a.createElement("select"),r.multiple?o.multiple=!0:r.size&&(o.size=r.size);break;default:o="string"===typeof r.is?a.createElement(i,{is:r.is}):a.createElement(i)}}o[Be]=t,o[He]=r;e:for(a=t.child;null!==a;){if(5===a.tag||6===a.tag)o.appendChild(a.stateNode);else if(4!==a.tag&&27!==a.tag&&null!==a.child){a.child.return=a,a=a.child;continue}if(a===t)break e;for(;null===a.sibling;){if(null===a.return||a.return===t)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}t.stateNode=o;e:switch(fh(o,i,r),i){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}r&&cc(t)}}return fc(t),lc(t,t.type,null===e||e.memoizedProps,t.pendingProps,n),null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==r&&cc(t);else{if("string"!==typeof r&&null===t.stateNode)throw Error(s(166));if(e=G.current,wi(t)){if(e=t.stateNode,n=t.memoizedProps,r=null,null!==(i=ui))switch(i.tag){case 27:case 5:r=i.memoizedProps}e[Be]=t,(e=!!(e.nodeValue===n||null!==r&&!0===r.suppressHydrationWarning||uh(e.nodeValue,n)))||mi(t,!0)}else(e=yh(e).createTextNode(r))[Be]=t,t.stateNode=e}return fc(t),null;case 31:if(n=t.memoizedState,null===e||null!==e.memoizedState){if(r=wi(t),null!==n){if(null===e){if(!r)throw Error(s(318));if(!(e=null!==(e=t.memoizedState)?e.dehydrated:null))throw Error(s(557));e[Be]=t}else bi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;fc(t),e=!1}else n=Ci(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=n),e=!0;if(!e)return 256&t.flags?(zo(t),t):(zo(t),null);if(0!==(128&t.flags))throw Error(s(558))}return fc(t),null;case 13:if(r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(i=wi(t),null!==r&&null!==r.dehydrated){if(null===e){if(!i)throw Error(s(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(s(317));i[Be]=t}else bi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;fc(t),i=!1}else i=Ci(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=i),i=!0;if(!i)return 256&t.flags?(zo(t),t):(zo(t),null)}return zo(t),0!==(128&t.flags)?(t.lanes=n,t):(n=null!==r,e=null!==e&&null!==e.memoizedState,n&&(i=null,null!==(r=t.child).alternate&&null!==r.alternate.memoizedState&&null!==r.alternate.memoizedState.cachePool&&(i=r.alternate.memoizedState.cachePool.pool),o=null,null!==r.memoizedState&&null!==r.memoizedState.cachePool&&(o=r.memoizedState.cachePool.pool),o!==i&&(r.flags|=2048)),n!==e&&n&&(t.child.flags|=8192),hc(t,t.updateQueue),fc(t),null);case 4:return Y(),null===e&&eh(t.stateNode.containerInfo),fc(t),null;case 10:return Ai(t.type),fc(t),null;case 19:if(z(Bo),null===(r=t.memoizedState))return fc(t),null;if(i=0!==(128&t.flags),null===(o=r.rendering))if(i)dc(r,!1);else{if(0!==Tl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(o=Ho(e))){for(t.flags|=128,dc(r,!1),e=o.updateQueue,t.updateQueue=e,hc(t,e),t.subtreeFlags=0,e=n,n=t.child;null!==n;)Hr(n,e),n=n.sibling;return B(Bo,1&Bo.current|2),di&&oi(t,r.treeForkCount),t.child}e=e.sibling}null!==r.tail&&ce()>Dl&&(t.flags|=128,i=!0,dc(r,!1),t.lanes=4194304)}else{if(!i)if(null!==(e=Ho(o))){if(t.flags|=128,i=!0,e=e.updateQueue,t.updateQueue=e,hc(t,e),dc(r,!0),null===r.tail&&"hidden"===r.tailMode&&!o.alternate&&!di)return fc(t),null}else 2*ce()-r.renderingStartTime>Dl&&536870912!==n&&(t.flags|=128,i=!0,dc(r,!1),t.lanes=4194304);r.isBackwards?(o.sibling=t.child,t.child=o):(null!==(e=r.last)?e.sibling=o:t.child=o,r.last=o)}return null!==r.tail?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=ce(),e.sibling=null,n=Bo.current,B(Bo,i?1&n|2:1&n),di&&oi(t,r.treeForkCount),e):(fc(t),null);case 22:case 23:return zo(t),Mo(),r=null!==t.memoizedState,null!==e?null!==e.memoizedState!==r&&(t.flags|=8192):r&&(t.flags|=8192),r?0!==(536870912&n)&&0===(128&t.flags)&&(fc(t),6&t.subtreeFlags&&(t.flags|=8192)):fc(t),null!==(n=t.updateQueue)&&hc(t,n.retryQueue),n=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),r=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(r=t.memoizedState.cachePool.pool),r!==n&&(t.flags|=2048),null!==e&&z(Wi),null;case 24:return n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Ai(Ui),fc(t),null;case 25:case 30:return null}throw Error(s(156,t.tag))}function pc(e,t){switch(ci(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ai(Ui),Y(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return X(t),null;case 31:if(null!==t.memoizedState){if(zo(t),null===t.alternate)throw Error(s(340));bi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 13:if(zo(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));bi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return z(Bo),null;case 4:return Y(),null;case 10:return Ai(t.type),null;case 22:case 23:return zo(t),Mo(),null!==e&&z(Wi),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return Ai(Ui),null;default:return null}}function mc(e,t){switch(ci(t),t.tag){case 3:Ai(Ui),Y();break;case 26:case 27:case 5:X(t);break;case 4:Y();break;case 31:null!==t.memoizedState&&zo(t);break;case 13:zo(t);break;case 19:z(Bo);break;case 10:Ai(t.type);break;case 22:case 23:zo(t),Mo(),null!==e&&z(Wi);break;case 24:Ai(Ui)}}function yc(e,t){try{var n=t.updateQueue,r=null!==n?n.lastEffect:null;if(null!==r){var i=r.next;n=i;do{if((n.tag&e)===e){r=void 0;var o=n.create,s=n.inst;r=o(),s.destroy=r}n=n.next}while(n!==i)}}catch(a){Tu(t,t.return,a)}}function vc(e,t,n){try{var r=t.updateQueue,i=null!==r?r.lastEffect:null;if(null!==i){var o=i.next;r=o;do{if((r.tag&e)===e){var s=r.inst,a=s.destroy;if(void 0!==a){s.destroy=void 0,i=t;var c=n,l=a;try{l()}catch(u){Tu(i,c,u)}}}r=r.next}while(r!==o)}}catch(u){Tu(t,t.return,u)}}function wc(e){var t=e.updateQueue;if(null!==t){var n=e.stateNode;try{Eo(t,n)}catch(r){Tu(e,e.return,r)}}}function bc(e,t,n){n.props=Ta(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(r){Tu(e,t,r)}}function Cc(e,t){try{var n=e.ref;if(null!==n){switch(e.tag){case 26:case 27:case 5:var r=e.stateNode;break;default:r=e.stateNode}"function"===typeof n?e.refCleanup=n(r):n.current=r}}catch(i){Tu(e,t,i)}}function kc(e,t){var n=e.ref,r=e.refCleanup;if(null!==n)if("function"===typeof r)try{r()}catch(i){Tu(e,t,i)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"===typeof n)try{n(null)}catch(o){Tu(e,t,o)}else n.current=null}function Sc(e){var t=e.type,n=e.memoizedProps,r=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&r.focus();break e;case"img":n.src?r.src=n.src:n.srcSet&&(r.srcset=n.srcSet)}}catch(i){Tu(e,e.return,i)}}function Tc(e,t,n){try{var r=e.stateNode;!function(e,t,n,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var i=null,o=null,a=null,c=null,l=null,u=null,h=null;for(g in n){var d=n[g];if(n.hasOwnProperty(g)&&null!=d)switch(g){case"checked":case"value":break;case"defaultValue":l=d;default:r.hasOwnProperty(g)||hh(e,t,g,null,r,d)}}for(var f in r){var g=r[f];if(d=n[f],r.hasOwnProperty(f)&&(null!=g||null!=d))switch(f){case"type":o=g;break;case"name":i=g;break;case"checked":u=g;break;case"defaultChecked":h=g;break;case"value":a=g;break;case"defaultValue":c=g;break;case"children":case"dangerouslySetInnerHTML":if(null!=g)throw Error(s(137,t));break;default:g!==d&&hh(e,t,f,g,r,d)}}return void vt(e,a,c,l,u,h,o,i);case"select":for(o in g=a=c=f=null,n)if(l=n[o],n.hasOwnProperty(o)&&null!=l)switch(o){case"value":break;case"multiple":g=l;default:r.hasOwnProperty(o)||hh(e,t,o,null,r,l)}for(i in r)if(o=r[i],l=n[i],r.hasOwnProperty(i)&&(null!=o||null!=l))switch(i){case"value":f=o;break;case"defaultValue":c=o;break;case"multiple":a=o;default:o!==l&&hh(e,t,i,o,r,l)}return t=c,n=a,r=g,void(null!=f?Ct(e,!!n,f,!1):!!r!==!!n&&(null!=t?Ct(e,!!n,t,!0):Ct(e,!!n,n?[]:"",!1)));case"textarea":for(c in g=f=null,n)if(i=n[c],n.hasOwnProperty(c)&&null!=i&&!r.hasOwnProperty(c))switch(c){case"value":case"children":break;default:hh(e,t,c,null,r,i)}for(a in r)if(i=r[a],o=n[a],r.hasOwnProperty(a)&&(null!=i||null!=o))switch(a){case"value":f=i;break;case"defaultValue":g=i;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=i)throw Error(s(91));break;default:i!==o&&hh(e,t,a,i,r,o)}return void St(e,f,g);case"option":for(var p in n)if(f=n[p],n.hasOwnProperty(p)&&null!=f&&!r.hasOwnProperty(p))if("selected"===p)e.selected=!1;else hh(e,t,p,null,r,f);for(l in r)if(f=r[l],g=n[l],r.hasOwnProperty(l)&&f!==g&&(null!=f||null!=g))if("selected"===l)e.selected=f&&"function"!==typeof f&&"symbol"!==typeof f;else hh(e,t,l,f,r,g);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var m in n)f=n[m],n.hasOwnProperty(m)&&null!=f&&!r.hasOwnProperty(m)&&hh(e,t,m,null,r,f);for(u in r)if(f=r[u],g=n[u],r.hasOwnProperty(u)&&f!==g&&(null!=f||null!=g))switch(u){case"children":case"dangerouslySetInnerHTML":if(null!=f)throw Error(s(137,t));break;default:hh(e,t,u,f,r,g)}return;default:if(Pt(t)){for(var y in n)f=n[y],n.hasOwnProperty(y)&&void 0!==f&&!r.hasOwnProperty(y)&&dh(e,t,y,void 0,r,f);for(h in r)f=r[h],g=n[h],!r.hasOwnProperty(h)||f===g||void 0===f&&void 0===g||dh(e,t,h,f,r,g);return}}for(var v in n)f=n[v],n.hasOwnProperty(v)&&null!=f&&!r.hasOwnProperty(v)&&hh(e,t,v,null,r,f);for(d in r)f=r[d],g=n[d],!r.hasOwnProperty(d)||f===g||null==f&&null==g||hh(e,t,d,f,r,g)}(r,e.type,n,t),r[He]=t}catch(i){Tu(e,e.return,i)}}function Ic(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&Ah(e.type)||4===e.tag}function _c(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||Ic(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&Ah(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function Ac(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?(9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).insertBefore(e,t):((t=9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Mt));else if(4!==r&&(27===r&&Ah(e.type)&&(n=e.stateNode,t=null),null!==(e=e.child)))for(Ac(e,t,n),e=e.sibling;null!==e;)Ac(e,t,n),e=e.sibling}function Ec(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&(27===r&&Ah(e.type)&&(n=e.stateNode),null!==(e=e.child)))for(Ec(e,t,n),e=e.sibling;null!==e;)Ec(e,t,n),e=e.sibling}function Pc(e){var t=e.stateNode,n=e.memoizedProps;try{for(var r=e.type,i=t.attributes;i.length;)t.removeAttributeNode(i[0]);fh(t,r,n),t[Be]=e,t[He]=n}catch(o){Tu(e,e.return,o)}}var Rc=!1,Nc=!1,Oc=!1,Mc="function"===typeof WeakSet?WeakSet:Set,xc=null;function Dc(e,t,n){var r=n.flags;switch(n.tag){case 0:case 11:case 15:Yc(e,n),4&r&&yc(5,n);break;case 1:if(Yc(e,n),4&r)if(e=n.stateNode,null===t)try{e.componentDidMount()}catch(s){Tu(n,n.return,s)}else{var i=Ta(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(i,t,e.__reactInternalSnapshotBeforeUpdate)}catch(a){Tu(n,n.return,a)}}64&r&&wc(n),512&r&&Cc(n,n.return);break;case 3:if(Yc(e,n),64&r&&null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 27:case 5:case 1:t=n.child.stateNode}try{Eo(e,t)}catch(s){Tu(n,n.return,s)}}break;case 27:null===t&&4&r&&Pc(n);case 26:case 5:Yc(e,n),null===t&&4&r&&Sc(n),512&r&&Cc(n,n.return);break;case 12:Yc(e,n);break;case 31:Yc(e,n),4&r&&Bc(e,n);break;case 13:Yc(e,n),4&r&&Hc(e,n),64&r&&(null!==(e=n.memoizedState)&&(null!==(e=e.dehydrated)&&function(e,t){var n=e.ownerDocument;if("$~"===e.data)e._reactRetry=t;else if("$?"!==e.data||"loading"!==n.readyState)t();else{var r=function(){t(),n.removeEventListener("DOMContentLoaded",r)};n.addEventListener("DOMContentLoaded",r),e._reactRetry=r}}(e,n=Eu.bind(null,n))));break;case 22:if(!(r=null!==n.memoizedState||Rc)){t=null!==t&&null!==t.memoizedState||Nc,i=Rc;var o=Nc;Rc=r,(Nc=t)&&!o?Xc(e,n,0!==(8772&n.subtreeFlags)):Yc(e,n),Rc=i,Nc=o}break;case 30:break;default:Yc(e,n)}}function Lc(e){var t=e.alternate;null!==t&&(e.alternate=null,Lc(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&Ye(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Fc=null,qc=!1;function Uc(e,t,n){for(n=n.child;null!==n;)zc(e,t,n),n=n.sibling}function zc(e,t,n){if(ve&&"function"===typeof ve.onCommitFiberUnmount)try{ve.onCommitFiberUnmount(ye,n)}catch(o){}switch(n.tag){case 26:Nc||kc(n,t),Uc(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode).parentNode.removeChild(n);break;case 27:Nc||kc(n,t);var r=Fc,i=qc;Ah(n.type)&&(Fc=n.stateNode,qc=!1),Uc(e,t,n),Uh(n.stateNode),Fc=r,qc=i;break;case 5:Nc||kc(n,t);case 6:if(r=Fc,i=qc,Fc=null,Uc(e,t,n),qc=i,null!==(Fc=r))if(qc)try{(9===Fc.nodeType?Fc.body:"HTML"===Fc.nodeName?Fc.ownerDocument.body:Fc).removeChild(n.stateNode)}catch(s){Tu(n,t,s)}else try{Fc.removeChild(n.stateNode)}catch(s){Tu(n,t,s)}break;case 18:null!==Fc&&(qc?(Eh(9===(e=Fc).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,n.stateNode),Kd(e)):Eh(Fc,n.stateNode));break;case 4:r=Fc,i=qc,Fc=n.stateNode.containerInfo,qc=!0,Uc(e,t,n),Fc=r,qc=i;break;case 0:case 11:case 14:case 15:vc(2,n,t),Nc||vc(4,n,t),Uc(e,t,n);break;case 1:Nc||(kc(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount&&bc(n,t,r)),Uc(e,t,n);break;case 21:Uc(e,t,n);break;case 22:Nc=(r=Nc)||null!==n.memoizedState,Uc(e,t,n),Nc=r;break;default:Uc(e,t,n)}}function Bc(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&null!==(e=e.memoizedState))){e=e.dehydrated;try{Kd(e)}catch(n){Tu(t,t.return,n)}}}function Hc(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{Kd(e)}catch(n){Tu(t,t.return,n)}}function Vc(e,t){var n=function(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new Mc),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new Mc),t;default:throw Error(s(435,e.tag))}}(e);t.forEach(function(t){if(!n.has(t)){n.add(t);var r=Pu.bind(null,e,t);t.then(r,r)}})}function jc(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r],o=e,a=t,c=a;e:for(;null!==c;){switch(c.tag){case 27:if(Ah(c.type)){Fc=c.stateNode,qc=!1;break e}break;case 5:Fc=c.stateNode,qc=!1;break e;case 3:case 4:Fc=c.stateNode.containerInfo,qc=!0;break e}c=c.return}if(null===Fc)throw Error(s(160));zc(o,a,i),Fc=null,qc=!1,null!==(o=i.alternate)&&(o.return=null),i.return=null}if(13886&t.subtreeFlags)for(t=t.child;null!==t;)Gc(t,e),t=t.sibling}var Kc=null;function Gc(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:jc(t,e),Qc(e),4&r&&(vc(3,e,e.return),yc(3,e),vc(5,e,e.return));break;case 1:jc(t,e),Qc(e),512&r&&(Nc||null===n||kc(n,n.return)),64&r&&Rc&&(null!==(e=e.updateQueue)&&(null!==(r=e.callbacks)&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===n?r:n.concat(r))));break;case 26:var i=Kc;if(jc(t,e),Qc(e),512&r&&(Nc||null===n||kc(n,n.return)),4&r){var o=null!==n?n.memoizedState:null;if(r=e.memoizedState,null===n)if(null===r)if(null===e.stateNode){e:{r=e.type,n=e.memoizedProps,i=i.ownerDocument||i;t:switch(r){case"title":(!(o=i.getElementsByTagName("title")[0])||o[We]||o[Be]||"http://www.w3.org/2000/svg"===o.namespaceURI||o.hasAttribute("itemprop"))&&(o=i.createElement(r),i.head.insertBefore(o,i.querySelector("head > title"))),fh(o,r,n),o[Be]=e,et(o),r=o;break e;case"link":var a=rd("link","href",i).get(r+(n.href||""));if(a)for(var c=0;c<a.length;c++)if((o=a[c]).getAttribute("href")===(null==n.href||""===n.href?null:n.href)&&o.getAttribute("rel")===(null==n.rel?null:n.rel)&&o.getAttribute("title")===(null==n.title?null:n.title)&&o.getAttribute("crossorigin")===(null==n.crossOrigin?null:n.crossOrigin)){a.splice(c,1);break t}fh(o=i.createElement(r),r,n),i.head.appendChild(o);break;case"meta":if(a=rd("meta","content",i).get(r+(n.content||"")))for(c=0;c<a.length;c++)if((o=a[c]).getAttribute("content")===(null==n.content?null:""+n.content)&&o.getAttribute("name")===(null==n.name?null:n.name)&&o.getAttribute("property")===(null==n.property?null:n.property)&&o.getAttribute("http-equiv")===(null==n.httpEquiv?null:n.httpEquiv)&&o.getAttribute("charset")===(null==n.charSet?null:n.charSet)){a.splice(c,1);break t}fh(o=i.createElement(r),r,n),i.head.appendChild(o);break;default:throw Error(s(468,r))}o[Be]=e,et(o),r=o}e.stateNode=r}else id(i,e.type,e.stateNode);else e.stateNode=$h(i,r,e.memoizedProps);else o!==r?(null===o?null!==n.stateNode&&(n=n.stateNode).parentNode.removeChild(n):o.count--,null===r?id(i,e.type,e.stateNode):$h(i,r,e.memoizedProps)):null===r&&null!==e.stateNode&&Tc(e,e.memoizedProps,n.memoizedProps)}break;case 27:jc(t,e),Qc(e),512&r&&(Nc||null===n||kc(n,n.return)),null!==n&&4&r&&Tc(e,e.memoizedProps,n.memoizedProps);break;case 5:if(jc(t,e),Qc(e),512&r&&(Nc||null===n||kc(n,n.return)),32&e.flags){i=e.stateNode;try{It(i,"")}catch(p){Tu(e,e.return,p)}}4&r&&null!=e.stateNode&&Tc(e,i=e.memoizedProps,null!==n?n.memoizedProps:i),1024&r&&(Oc=!0);break;case 6:if(jc(t,e),Qc(e),4&r){if(null===e.stateNode)throw Error(s(162));r=e.memoizedProps,n=e.stateNode;try{n.nodeValue=r}catch(p){Tu(e,e.return,p)}}break;case 3:if(nd=null,i=Kc,Kc=Hh(t.containerInfo),jc(t,e),Kc=i,Qc(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Kd(t.containerInfo)}catch(p){Tu(e,e.return,p)}Oc&&(Oc=!1,Wc(e));break;case 4:r=Kc,Kc=Hh(e.stateNode.containerInfo),jc(t,e),Qc(e),Kc=r;break;case 12:default:jc(t,e),Qc(e);break;case 31:case 19:jc(t,e),Qc(e),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,Vc(e,r)));break;case 13:jc(t,e),Qc(e),8192&e.child.flags&&null!==e.memoizedState!==(null!==n&&null!==n.memoizedState)&&(Ml=ce()),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,Vc(e,r)));break;case 22:i=null!==e.memoizedState;var l=null!==n&&null!==n.memoizedState,u=Rc,h=Nc;if(Rc=u||i,Nc=h||l,jc(t,e),Nc=h,Rc=u,Qc(e),8192&r)e:for(t=e.stateNode,t._visibility=i?-2&t._visibility:1|t._visibility,i&&(null===n||l||Rc||Nc||Jc(e)),n=null,t=e;;){if(5===t.tag||26===t.tag){if(null===n){l=n=t;try{if(o=l.stateNode,i)"function"===typeof(a=o.style).setProperty?a.setProperty("display","none","important"):a.display="none";else{c=l.stateNode;var d=l.memoizedProps.style,f=void 0!==d&&null!==d&&d.hasOwnProperty("display")?d.display:null;c.style.display=null==f||"boolean"===typeof f?"":(""+f).trim()}}catch(p){Tu(l,l.return,p)}}}else if(6===t.tag){if(null===n){l=t;try{l.stateNode.nodeValue=i?"":l.memoizedProps}catch(p){Tu(l,l.return,p)}}}else if(18===t.tag){if(null===n){l=t;try{var g=l.stateNode;i?Ph(g,!0):Ph(l.stateNode,!1)}catch(p){Tu(l,l.return,p)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}4&r&&(null!==(r=e.updateQueue)&&(null!==(n=r.retryQueue)&&(r.retryQueue=null,Vc(e,n))));case 30:case 21:}}function Qc(e){var t=e.flags;if(2&t){try{for(var n,r=e.return;null!==r;){if(Ic(r)){n=r;break}r=r.return}if(null==n)throw Error(s(160));switch(n.tag){case 27:var i=n.stateNode;Ec(e,_c(e),i);break;case 5:var o=n.stateNode;32&n.flags&&(It(o,""),n.flags&=-33),Ec(e,_c(e),o);break;case 3:case 4:var a=n.stateNode.containerInfo;Ac(e,_c(e),a);break;default:throw Error(s(161))}}catch(c){Tu(e,e.return,c)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Wc(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;Wc(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function Yc(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)Dc(e,t.alternate,t),t=t.sibling}function Jc(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:vc(4,t,t.return),Jc(t);break;case 1:kc(t,t.return);var n=t.stateNode;"function"===typeof n.componentWillUnmount&&bc(t,t.return,n),Jc(t);break;case 27:Uh(t.stateNode);case 26:case 5:kc(t,t.return),Jc(t);break;case 22:null===t.memoizedState&&Jc(t);break;default:Jc(t)}e=e.sibling}}function Xc(e,t,n){for(n=n&&0!==(8772&t.subtreeFlags),t=t.child;null!==t;){var r=t.alternate,i=e,o=t,s=o.flags;switch(o.tag){case 0:case 11:case 15:Xc(i,o,n),yc(4,o);break;case 1:if(Xc(i,o,n),"function"===typeof(i=(r=o).stateNode).componentDidMount)try{i.componentDidMount()}catch(l){Tu(r,r.return,l)}if(null!==(i=(r=o).updateQueue)){var a=r.stateNode;try{var c=i.shared.hiddenCallbacks;if(null!==c)for(i.shared.hiddenCallbacks=null,i=0;i<c.length;i++)Ao(c[i],a)}catch(l){Tu(r,r.return,l)}}n&&64&s&&wc(o),Cc(o,o.return);break;case 27:Pc(o);case 26:case 5:Xc(i,o,n),n&&null===r&&4&s&&Sc(o),Cc(o,o.return);break;case 12:Xc(i,o,n);break;case 31:Xc(i,o,n),n&&4&s&&Bc(i,o);break;case 13:Xc(i,o,n),n&&4&s&&Hc(i,o);break;case 22:null===o.memoizedState&&Xc(i,o,n),Cc(o,o.return);break;case 30:break;default:Xc(i,o,n)}t=t.sibling}}function $c(e,t){var n=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==n&&(null!=e&&e.refCount++,null!=n&&Bi(n))}function Zc(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Bi(e))}function el(e,t,n,r){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)tl(e,t,n,r),t=t.sibling}function tl(e,t,n,r){var i=t.flags;switch(t.tag){case 0:case 11:case 15:el(e,t,n,r),2048&i&&yc(9,t);break;case 1:case 31:case 13:default:el(e,t,n,r);break;case 3:el(e,t,n,r),2048&i&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Bi(e)));break;case 12:if(2048&i){el(e,t,n,r),e=t.stateNode;try{var o=t.memoizedProps,s=o.id,a=o.onPostCommit;"function"===typeof a&&a(s,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(c){Tu(t,t.return,c)}}else el(e,t,n,r);break;case 23:break;case 22:o=t.stateNode,s=t.alternate,null!==t.memoizedState?2&o._visibility?el(e,t,n,r):rl(e,t):2&o._visibility?el(e,t,n,r):(o._visibility|=2,nl(e,t,n,r,0!==(10256&t.subtreeFlags)||!1)),2048&i&&$c(s,t);break;case 24:el(e,t,n,r),2048&i&&Zc(t.alternate,t)}}function nl(e,t,n,r,i){for(i=i&&(0!==(10256&t.subtreeFlags)||!1),t=t.child;null!==t;){var o=e,s=t,a=n,c=r,l=s.flags;switch(s.tag){case 0:case 11:case 15:nl(o,s,a,c,i),yc(8,s);break;case 23:break;case 22:var u=s.stateNode;null!==s.memoizedState?2&u._visibility?nl(o,s,a,c,i):rl(o,s):(u._visibility|=2,nl(o,s,a,c,i)),i&&2048&l&&$c(s.alternate,s);break;case 24:nl(o,s,a,c,i),i&&2048&l&&Zc(s.alternate,s);break;default:nl(o,s,a,c,i)}t=t.sibling}}function rl(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var n=e,r=t,i=r.flags;switch(r.tag){case 22:rl(n,r),2048&i&&$c(r.alternate,r);break;case 24:rl(n,r),2048&i&&Zc(r.alternate,r);break;default:rl(n,r)}t=t.sibling}}var il=8192;function ol(e,t,n){if(e.subtreeFlags&il)for(e=e.child;null!==e;)sl(e,t,n),e=e.sibling}function sl(e,t,n){switch(e.tag){case 26:ol(e,t,n),e.flags&il&&null!==e.memoizedState&&function(e,t,n,r){if("stylesheet"===n.type&&("string"!==typeof r.media||!1!==matchMedia(r.media).matches)&&0===(4&n.state.loading)){if(null===n.instance){var i=Qh(r.href),o=t.querySelector(Wh(i));if(o)return null!==(t=o._p)&&"object"===typeof t&&"function"===typeof t.then&&(e.count++,e=ad.bind(e),t.then(e,e)),n.state.loading|=4,n.instance=o,void et(o);o=t.ownerDocument||t,r=Yh(r),(i=zh.get(i))&&ed(r,i),et(o=o.createElement("link"));var s=o;s._p=new Promise(function(e,t){s.onload=e,s.onerror=t}),fh(o,"link",r),n.instance=o}null===e.stylesheets&&(e.stylesheets=new Map),e.stylesheets.set(n,t),(t=n.state.preload)&&0===(3&n.state.loading)&&(e.count++,n=ad.bind(e),t.addEventListener("load",n),t.addEventListener("error",n))}}(n,Kc,e.memoizedState,e.memoizedProps);break;case 5:default:ol(e,t,n);break;case 3:case 4:var r=Kc;Kc=Hh(e.stateNode.containerInfo),ol(e,t,n),Kc=r;break;case 22:null===e.memoizedState&&(null!==(r=e.alternate)&&null!==r.memoizedState?(r=il,il=16777216,ol(e,t,n),il=r):ol(e,t,n))}}function al(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function cl(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];xc=r,hl(r,e)}al(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)ll(e),e=e.sibling}function ll(e){switch(e.tag){case 0:case 11:case 15:cl(e),2048&e.flags&&vc(9,e,e.return);break;case 3:case 12:default:cl(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,ul(e)):cl(e)}}function ul(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];xc=r,hl(r,e)}al(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:vc(8,t,t.return),ul(t);break;case 22:2&(n=t.stateNode)._visibility&&(n._visibility&=-3,ul(t));break;default:ul(t)}e=e.sibling}}function hl(e,t){for(;null!==xc;){var n=xc;switch(n.tag){case 0:case 11:case 15:vc(8,n,t);break;case 23:case 22:if(null!==n.memoizedState&&null!==n.memoizedState.cachePool){var r=n.memoizedState.cachePool.pool;null!=r&&r.refCount++}break;case 24:Bi(n.memoizedState.cache)}if(null!==(r=n.child))r.return=n,xc=r;else e:for(n=e;null!==xc;){var i=(r=xc).sibling,o=r.return;if(Lc(r),r===n){xc=null;break e}if(null!==i){i.return=o,xc=i;break e}xc=o}}}var dl={getCacheForType:function(e){var t=Mi(Ui),n=t.data.get(e);return void 0===n&&(n=e(),t.data.set(e,n)),n},cacheSignal:function(){return Mi(Ui).controller.signal}},fl="function"===typeof WeakMap?WeakMap:Map,gl=0,pl=null,ml=null,yl=0,vl=0,wl=null,bl=!1,Cl=!1,kl=!1,Sl=0,Tl=0,Il=0,_l=0,Al=0,El=0,Pl=0,Rl=null,Nl=null,Ol=!1,Ml=0,xl=0,Dl=1/0,Ll=null,Fl=null,ql=0,Ul=null,zl=null,Bl=0,Hl=0,Vl=null,jl=null,Kl=0,Gl=null;function Ql(){return 0!==(2&gl)&&0!==yl?yl&-yl:null!==x.T?Vu():qe()}function Wl(){if(0===El)if(0===(536870912&yl)||di){var e=Te;0===(3932160&(Te<<=1))&&(Te=262144),El=e}else El=536870912;return null!==(e=xo.current)&&(e.flags|=32),El}function Yl(e,t,n){(e!==pl||2!==vl&&9!==vl)&&null===e.cancelPendingCommit||(nu(e,0),Zl(e,yl,El,!1)),Oe(e,n),0!==(2&gl)&&e===pl||(e===pl&&(0===(2&gl)&&(_l|=n),4===Tl&&Zl(e,yl,El,!1)),Lu(e))}function Jl(e,t,n){if(0!==(6&gl))throw Error(s(327));for(var r=!n&&0===(127&t)&&0===(t&e.expiredLanes)||Ee(e,t),i=r?function(e,t){var n=gl;gl|=2;var r=ou(),i=su();pl!==e||yl!==t?(Ll=null,Dl=ce()+500,nu(e,t)):Cl=Ee(e,t);e:for(;;)try{if(0!==vl&&null!==ml){t=ml;var o=wl;t:switch(vl){case 1:vl=0,wl=null,fu(e,t,o,1);break;case 2:case 9:if(no(o)){vl=0,wl=null,du(t);break}t=function(){2!==vl&&9!==vl||pl!==e||(vl=7),Lu(e)},o.then(t,t);break e;case 3:vl=7;break e;case 4:vl=5;break e;case 7:no(o)?(vl=0,wl=null,du(t)):(vl=0,wl=null,fu(e,t,o,7));break;case 5:var a=null;switch(ml.tag){case 26:a=ml.memoizedState;case 5:case 27:var c=ml;if(a?od(a):c.stateNode.complete){vl=0,wl=null;var l=c.sibling;if(null!==l)ml=l;else{var u=c.return;null!==u?(ml=u,gu(u)):ml=null}break t}}vl=0,wl=null,fu(e,t,o,5);break;case 6:vl=0,wl=null,fu(e,t,o,6);break;case 8:tu(),Tl=6;break e;default:throw Error(s(462))}}uu();break}catch(h){ru(e,h)}return Ii=Ti=null,x.H=r,x.A=i,gl=n,null!==ml?0:(pl=null,yl=0,Nr(),Tl)}(e,t):cu(e,t,!0),o=r;;){if(0===i){Cl&&!r&&Zl(e,t,0,!1);break}if(n=e.current.alternate,!o||$l(n)){if(2===i){if(o=t,e.errorRecoveryDisabledLanes&o)var a=0;else a=0!==(a=-536870913&e.pendingLanes)?a:536870912&a?536870912:0;if(0!==a){t=a;e:{var c=e;i=Rl;var l=c.current.memoizedState.isDehydrated;if(l&&(nu(c,a).flags|=256),2!==(a=cu(c,a,!1))){if(kl&&!l){c.errorRecoveryDisabledLanes|=o,_l|=o,i=4;break e}o=Nl,Nl=i,null!==o&&(null===Nl?Nl=o:Nl.push.apply(Nl,o))}i=a}if(o=!1,2!==i)continue}}if(1===i){nu(e,0),Zl(e,t,0,!0);break}e:{switch(r=e,o=i){case 0:case 1:throw Error(s(345));case 4:if((4194048&t)!==t)break;case 6:Zl(r,t,El,!bl);break e;case 2:Nl=null;break;case 3:case 5:break;default:throw Error(s(329))}if((62914560&t)===t&&10<(i=Ml+300-ce())){if(Zl(r,t,El,!bl),0!==Ae(r,0,!0))break e;Bl=t,r.timeoutHandle=kh(Xl.bind(null,r,n,Nl,Ll,Ol,t,El,_l,Pl,bl,o,"Throttled",-0,0),i)}else Xl(r,n,Nl,Ll,Ol,t,El,_l,Pl,bl,o,null,-0,0)}break}i=cu(e,t,!1),o=!1}Lu(e)}function Xl(e,t,n,r,i,o,s,a,c,l,u,h,d,f){if(e.timeoutHandle=-1,8192&(h=t.subtreeFlags)||16785408===(16785408&h)){sl(t,o,h={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Mt});var g=(62914560&o)===o?Ml-ce():(4194048&o)===o?xl-ce():0;if(g=function(e,t){return e.stylesheets&&0===e.count&&ld(e,e.stylesheets),0<e.count||0<e.imgCount?function(n){var r=setTimeout(function(){if(e.stylesheets&&ld(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}},6e4+t);0<e.imgBytes&&0===sd&&(sd=62500*function(){if("function"===typeof performance.getEntriesByType){for(var e=0,t=0,n=performance.getEntriesByType("resource"),r=0;r<n.length;r++){var i=n[r],o=i.transferSize,s=i.initiatorType,a=i.duration;if(o&&a&&gh(s)){for(s=0,a=i.responseEnd,r+=1;r<n.length;r++){var c=n[r],l=c.startTime;if(l>a)break;var u=c.transferSize,h=c.initiatorType;u&&gh(h)&&(s+=u*((c=c.responseEnd)<a?1:(a-l)/(c-l)))}if(--r,t+=8*(o+s)/(i.duration/1e3),10<++e)break}}if(0<e)return t/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,"number"===typeof e)?e:5}());var i=setTimeout(function(){if(e.waitingForImages=!1,0===e.count&&(e.stylesheets&&ld(e,e.stylesheets),e.unsuspend)){var t=e.unsuspend;e.unsuspend=null,t()}},(e.imgBytes>sd?50:800)+t);return e.unsuspend=n,function(){e.unsuspend=null,clearTimeout(r),clearTimeout(i)}}:null}(h,g),null!==g)return Bl=o,e.cancelPendingCommit=g(mu.bind(null,e,t,o,n,r,i,s,a,c,u,h,null,d,f)),void Zl(e,o,s,!l)}mu(e,t,o,n,r,i,s,a,c)}function $l(e){for(var t=e;;){var n=t.tag;if((0===n||11===n||15===n)&&16384&t.flags&&(null!==(n=t.updateQueue)&&null!==(n=n.stores)))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!Zn(o(),i))return!1}catch(s){return!1}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Zl(e,t,n,r){t&=~Al,t&=~_l,e.suspendedLanes|=t,e.pingedLanes&=~t,r&&(e.warmLanes|=t),r=e.expirationTimes;for(var i=t;0<i;){var o=31-be(i),s=1<<o;r[o]=-1,i&=~s}0!==n&&Me(e,n,t)}function eu(){return 0!==(6&gl)||(Fu(0,!1),!1)}function tu(){if(null!==ml){if(0===vl)var e=ml.return;else Ii=Ti=null,cs(e=ml),co=null,lo=0,e=ml;for(;null!==e;)mc(e.alternate,e),e=e.return;ml=null}}function nu(e,t){var n=e.timeoutHandle;-1!==n&&(e.timeoutHandle=-1,Sh(n)),null!==(n=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,n()),Bl=0,tu(),pl=e,ml=n=Br(e.current,null),yl=t,vl=0,wl=null,bl=!1,Cl=Ee(e,t),kl=!1,Pl=El=Al=_l=Il=Tl=0,Nl=Rl=null,Ol=!1,0!==(8&t)&&(t|=32&t);var r=e.entangledLanes;if(0!==r)for(e=e.entanglements,r&=t;0<r;){var i=31-be(r),o=1<<i;t|=e[i],r&=~o}return Sl=t,Nr(),n}function ru(e,t){jo=null,x.H=ma,t===$i||t===eo?(t=so(),vl=3):t===Zi?(t=so(),vl=4):vl=t===Ma?8:null!==t&&"object"===typeof t&&"function"===typeof t.then?6:1,wl=t,null===ml&&(Tl=1,Ea(e,Yr(t,e.current)))}function iu(){var e=xo.current;return null===e||((4194048&yl)===yl?null===Do:((62914560&yl)===yl||0!==(536870912&yl))&&e===Do)}function ou(){var e=x.H;return x.H=ma,null===e?ma:e}function su(){var e=x.A;return x.A=dl,e}function au(){Tl=4,bl||(4194048&yl)!==yl&&null!==xo.current||(Cl=!0),0===(134217727&Il)&&0===(134217727&_l)||null===pl||Zl(pl,yl,El,!1)}function cu(e,t,n){var r=gl;gl|=2;var i=ou(),o=su();pl===e&&yl===t||(Ll=null,nu(e,t)),t=!1;var s=Tl;e:for(;;)try{if(0!==vl&&null!==ml){var a=ml,c=wl;switch(vl){case 8:tu(),s=6;break e;case 3:case 2:case 9:case 6:null===xo.current&&(t=!0);var l=vl;if(vl=0,wl=null,fu(e,a,c,l),n&&Cl){s=0;break e}break;default:l=vl,vl=0,wl=null,fu(e,a,c,l)}}lu(),s=Tl;break}catch(u){ru(e,u)}return t&&e.shellSuspendCounter++,Ii=Ti=null,gl=r,x.H=i,x.A=o,null===ml&&(pl=null,yl=0,Nr()),s}function lu(){for(;null!==ml;)hu(ml)}function uu(){for(;null!==ml&&!se();)hu(ml)}function hu(e){var t=ac(e.alternate,e,Sl);e.memoizedProps=e.pendingProps,null===t?gu(e):ml=t}function du(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=Ga(n,t,t.pendingProps,t.type,void 0,yl);break;case 11:t=Ga(n,t,t.pendingProps,t.type.render,t.ref,yl);break;case 5:cs(t);default:mc(n,t),t=ac(n,t=ml=Hr(t,Sl),Sl)}e.memoizedProps=e.pendingProps,null===t?gu(e):ml=t}function fu(e,t,n,r){Ii=Ti=null,cs(t),co=null,lo=0;var i=t.return;try{if(function(e,t,n,r,i){if(n.flags|=32768,null!==r&&"object"===typeof r&&"function"===typeof r.then){if(null!==(t=n.alternate)&&Ri(t,n,i,!0),null!==(n=xo.current)){switch(n.tag){case 31:case 13:return null===Do?au():null===n.alternate&&0===Tl&&(Tl=3),n.flags&=-257,n.flags|=65536,n.lanes=i,r===to?n.flags|=16384:(null===(t=n.updateQueue)?n.updateQueue=new Set([r]):t.add(r),Iu(e,r,i)),!1;case 22:return n.flags|=65536,r===to?n.flags|=16384:(null===(t=n.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([r])},n.updateQueue=t):null===(n=t.retryQueue)?t.retryQueue=new Set([r]):n.add(r),Iu(e,r,i)),!1}throw Error(s(435,n.tag))}return Iu(e,r,i),au(),!1}if(di)return null!==(t=xo.current)?(0===(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=i,r!==pi&&ki(Yr(e=Error(s(422),{cause:r}),n))):(r!==pi&&ki(Yr(t=Error(s(423),{cause:r}),n)),(e=e.current.alternate).flags|=65536,i&=-i,e.lanes|=i,r=Yr(r,n),So(e,i=Ra(e.stateNode,r,i)),4!==Tl&&(Tl=2)),!1;var o=Error(s(520),{cause:r});if(o=Yr(o,n),null===Rl?Rl=[o]:Rl.push(o),4!==Tl&&(Tl=2),null===t)return!0;r=Yr(r,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=i&-i,n.lanes|=e,So(n,e=Ra(n.stateNode,r,e)),!1;case 1:if(t=n.type,o=n.stateNode,0===(128&n.flags)&&("function"===typeof t.getDerivedStateFromError||null!==o&&"function"===typeof o.componentDidCatch&&(null===Fl||!Fl.has(o))))return n.flags|=65536,i&=-i,n.lanes|=i,Oa(i=Na(i),e,n,r),So(n,i),!1}n=n.return}while(null!==n);return!1}(e,i,t,n,yl))return Tl=1,Ea(e,Yr(n,e.current)),void(ml=null)}catch(o){if(null!==i)throw ml=i,o;return Tl=1,Ea(e,Yr(n,e.current)),void(ml=null)}32768&t.flags?(di||1===r?e=!0:Cl||0!==(536870912&yl)?e=!1:(bl=e=!0,(2===r||9===r||3===r||6===r)&&(null!==(r=xo.current)&&13===r.tag&&(r.flags|=16384))),pu(t,e)):gu(t)}function gu(e){var t=e;do{if(0!==(32768&t.flags))return void pu(t,bl);e=t.return;var n=gc(t.alternate,t,Sl);if(null!==n)return void(ml=n);if(null!==(t=t.sibling))return void(ml=t);ml=t=e}while(null!==t);0===Tl&&(Tl=5)}function pu(e,t){do{var n=pc(e.alternate,e);if(null!==n)return n.flags&=32767,void(ml=n);if(null!==(n=e.return)&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&null!==(e=e.sibling))return void(ml=e);ml=e=n}while(null!==e);Tl=6,ml=null}function mu(e,t,n,r,i,o,a,c,l){e.cancelPendingCommit=null;do{Cu()}while(0!==ql);if(0!==(6&gl))throw Error(s(327));if(null!==t){if(t===e.current)throw Error(s(177));if(o=t.lanes|t.childLanes,function(e,t,n,r,i,o){var s=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var a=e.entanglements,c=e.expirationTimes,l=e.hiddenUpdates;for(n=s&~n;0<n;){var u=31-be(n),h=1<<u;a[u]=0,c[u]=-1;var d=l[u];if(null!==d)for(l[u]=null,u=0;u<d.length;u++){var f=d[u];null!==f&&(f.lane&=-536870913)}n&=~h}0!==r&&Me(e,r,0),0!==o&&0===i&&0!==e.tag&&(e.suspendedLanes|=o&~(s&~t))}(e,n,o|=Rr,a,c,l),e===pl&&(ml=pl=null,yl=0),zl=t,Ul=e,Bl=n,Hl=o,Vl=i,jl=r,0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?(e.callbackNode=null,e.callbackPriority=0,ie(de,function(){return ku(),null})):(e.callbackNode=null,e.callbackPriority=0),r=0!==(13878&t.flags),0!==(13878&t.subtreeFlags)||r){r=x.T,x.T=null,i=D.p,D.p=2,a=gl,gl|=4;try{!function(e,t){if(e=e.containerInfo,ph=bd,or(e=ir(e))){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(m){n=null;break e}var a=0,c=-1,l=-1,u=0,h=0,d=e,f=null;t:for(;;){for(var g;d!==n||0!==i&&3!==d.nodeType||(c=a+i),d!==o||0!==r&&3!==d.nodeType||(l=a+r),3===d.nodeType&&(a+=d.nodeValue.length),null!==(g=d.firstChild);)f=d,d=g;for(;;){if(d===e)break t;if(f===n&&++u===i&&(c=a),f===o&&++h===r&&(l=a),null!==(g=d.nextSibling))break;f=(d=f).parentNode}d=g}n=-1===c||-1===l?null:{start:c,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(mh={focusedElem:e,selectionRange:n},bd=!1,xc=t;null!==xc;)if(e=(t=xc).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,xc=e;else for(;null!==xc;){switch(o=(t=xc).alternate,e=t.flags,t.tag){case 0:if(0!==(4&e)&&null!==(e=null!==(e=t.updateQueue)?e.events:null))for(n=0;n<e.length;n++)(i=e[n]).ref.impl=i.nextImpl;break;case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(0!==(1024&e)&&null!==o){e=void 0,n=t,i=o.memoizedProps,o=o.memoizedState,r=n.stateNode;try{var p=Ta(n.type,i);e=r.getSnapshotBeforeUpdate(p,o),r.__reactInternalSnapshotBeforeUpdate=e}catch(y){Tu(n,n.return,y)}}break;case 3:if(0!==(1024&e))if(9===(n=(e=t.stateNode.containerInfo).nodeType))Rh(e);else if(1===n)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Rh(e);break;default:e.textContent=""}break;default:if(0!==(1024&e))throw Error(s(163))}if(null!==(e=t.sibling)){e.return=t.return,xc=e;break}xc=t.return}}(e,t)}finally{gl=a,D.p=i,x.T=r}}ql=1,yu(),vu(),wu()}}function yu(){if(1===ql){ql=0;var e=Ul,t=zl,n=0!==(13878&t.flags);if(0!==(13878&t.subtreeFlags)||n){n=x.T,x.T=null;var r=D.p;D.p=2;var i=gl;gl|=4;try{Gc(t,e);var o=mh,s=ir(e.containerInfo),a=o.focusedElem,c=o.selectionRange;if(s!==a&&a&&a.ownerDocument&&rr(a.ownerDocument.documentElement,a)){if(null!==c&&or(a)){var l=c.start,u=c.end;if(void 0===u&&(u=l),"selectionStart"in a)a.selectionStart=l,a.selectionEnd=Math.min(u,a.value.length);else{var h=a.ownerDocument||document,d=h&&h.defaultView||window;if(d.getSelection){var f=d.getSelection(),g=a.textContent.length,p=Math.min(c.start,g),m=void 0===c.end?p:Math.min(c.end,g);!f.extend&&p>m&&(s=m,m=p,p=s);var y=nr(a,p),v=nr(a,m);if(y&&v&&(1!==f.rangeCount||f.anchorNode!==y.node||f.anchorOffset!==y.offset||f.focusNode!==v.node||f.focusOffset!==v.offset)){var w=h.createRange();w.setStart(y.node,y.offset),f.removeAllRanges(),p>m?(f.addRange(w),f.extend(v.node,v.offset)):(w.setEnd(v.node,v.offset),f.addRange(w))}}}}for(h=[],f=a;f=f.parentNode;)1===f.nodeType&&h.push({element:f,left:f.scrollLeft,top:f.scrollTop});for("function"===typeof a.focus&&a.focus(),a=0;a<h.length;a++){var b=h[a];b.element.scrollLeft=b.left,b.element.scrollTop=b.top}}bd=!!ph,mh=ph=null}finally{gl=i,D.p=r,x.T=n}}e.current=t,ql=2}}function vu(){if(2===ql){ql=0;var e=Ul,t=zl,n=0!==(8772&t.flags);if(0!==(8772&t.subtreeFlags)||n){n=x.T,x.T=null;var r=D.p;D.p=2;var i=gl;gl|=4;try{Dc(e,t.alternate,t)}finally{gl=i,D.p=r,x.T=n}}ql=3}}function wu(){if(4===ql||3===ql){ql=0,ae();var e=Ul,t=zl,n=Bl,r=jl;0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?ql=5:(ql=0,zl=Ul=null,bu(e,e.pendingLanes));var i=e.pendingLanes;if(0===i&&(Fl=null),Fe(n),t=t.stateNode,ve&&"function"===typeof ve.onCommitFiberRoot)try{ve.onCommitFiberRoot(ye,t,void 0,128===(128&t.current.flags))}catch(c){}if(null!==r){t=x.T,i=D.p,D.p=2,x.T=null;try{for(var o=e.onRecoverableError,s=0;s<r.length;s++){var a=r[s];o(a.value,{componentStack:a.stack})}}finally{x.T=t,D.p=i}}0!==(3&Bl)&&Cu(),Lu(e),i=e.pendingLanes,0!==(261930&n)&&0!==(42&i)?e===Gl?Kl++:(Kl=0,Gl=e):Kl=0,Fu(0,!1)}}function bu(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,Bi(t)))}function Cu(){return yu(),vu(),wu(),ku()}function ku(){if(5!==ql)return!1;var e=Ul,t=Hl;Hl=0;var n=Fe(Bl),r=x.T,i=D.p;try{D.p=32>n?32:n,x.T=null,n=Vl,Vl=null;var o=Ul,a=Bl;if(ql=0,zl=Ul=null,Bl=0,0!==(6&gl))throw Error(s(331));var c=gl;if(gl|=4,ll(o.current),tl(o,o.current,a,n),gl=c,Fu(0,!1),ve&&"function"===typeof ve.onPostCommitFiberRoot)try{ve.onPostCommitFiberRoot(ye,o)}catch(l){}return!0}finally{D.p=i,x.T=r,bu(e,t)}}function Su(e,t,n){t=Yr(n,t),null!==(e=Co(e,t=Ra(e.stateNode,t,2),2))&&(Oe(e,2),Lu(e))}function Tu(e,t,n){if(3===e.tag)Su(e,e,n);else for(;null!==t;){if(3===t.tag){Su(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Fl||!Fl.has(r))){e=Yr(n,e),null!==(r=Co(t,n=Na(2),2))&&(Oa(n,r,t,e),Oe(r,2),Lu(r));break}}t=t.return}}function Iu(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new fl;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(kl=!0,i.add(n),e=_u.bind(null,e,t,n),t.then(e,e))}function _u(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,pl===e&&(yl&n)===n&&(4===Tl||3===Tl&&(62914560&yl)===yl&&300>ce()-Ml?0===(2&gl)&&nu(e,0):Al|=n,Pl===yl&&(Pl=0)),Lu(e)}function Au(e,t){0===t&&(t=Re()),null!==(e=xr(e,t))&&(Oe(e,t),Lu(e))}function Eu(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Au(e,n)}function Pu(e,t){var n=0;switch(e.tag){case 31:case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;case 22:r=e.stateNode._retryCache;break;default:throw Error(s(314))}null!==r&&r.delete(t),Au(e,n)}var Ru=null,Nu=null,Ou=!1,Mu=!1,xu=!1,Du=0;function Lu(e){e!==Nu&&null===e.next&&(null===Nu?Ru=Nu=e:Nu=Nu.next=e),Mu=!0,Ou||(Ou=!0,Ih(function(){0!==(6&gl)?ie(ue,qu):Uu()}))}function Fu(e,t){if(!xu&&Mu){xu=!0;do{for(var n=!1,r=Ru;null!==r;){if(!t)if(0!==e){var i=r.pendingLanes;if(0===i)var o=0;else{var s=r.suspendedLanes,a=r.pingedLanes;o=(1<<31-be(42|e)+1)-1,o=201326741&(o&=i&~(s&~a))?201326741&o|1:o?2|o:0}0!==o&&(n=!0,Hu(r,o))}else o=yl,0===(3&(o=Ae(r,r===pl?o:0,null!==r.cancelPendingCommit||-1!==r.timeoutHandle)))||Ee(r,o)||(n=!0,Hu(r,o));r=r.next}}while(n);xu=!1}}function qu(){Uu()}function Uu(){Mu=Ou=!1;var e=0;0!==Du&&function(){var e=window.event;if(e&&"popstate"===e.type)return e!==Ch&&(Ch=e,!0);return Ch=null,!1}()&&(e=Du);for(var t=ce(),n=null,r=Ru;null!==r;){var i=r.next,o=zu(r,t);0===o?(r.next=null,null===n?Ru=i:n.next=i,null===i&&(Nu=n)):(n=r,(0!==e||0!==(3&o))&&(Mu=!0)),r=i}0!==ql&&5!==ql||Fu(e,!1),0!==Du&&(Du=0)}function zu(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,o=-62914561&e.pendingLanes;0<o;){var s=31-be(o),a=1<<s,c=i[s];-1===c?0!==(a&n)&&0===(a&r)||(i[s]=Pe(a,t)):c<=t&&(e.expiredLanes|=a),o&=~a}if(n=yl,n=Ae(e,e===(t=pl)?n:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),r=e.callbackNode,0===n||e===t&&(2===vl||9===vl)||null!==e.cancelPendingCommit)return null!==r&&null!==r&&oe(r),e.callbackNode=null,e.callbackPriority=0;if(0===(3&n)||Ee(e,n)){if((t=n&-n)===e.callbackPriority)return t;switch(null!==r&&oe(r),Fe(n)){case 2:case 8:n=he;break;case 32:default:n=de;break;case 268435456:n=ge}return r=Bu.bind(null,e),n=ie(n,r),e.callbackPriority=t,e.callbackNode=n,t}return null!==r&&null!==r&&oe(r),e.callbackPriority=2,e.callbackNode=null,2}function Bu(e,t){if(0!==ql&&5!==ql)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(Cu()&&e.callbackNode!==n)return null;var r=yl;return 0===(r=Ae(e,e===pl?r:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(Jl(e,r,t),zu(e,ce()),null!=e.callbackNode&&e.callbackNode===n?Bu.bind(null,e):null)}function Hu(e,t){if(Cu())return null;Jl(e,t,!0)}function Vu(){if(0===Du){var e=ji;0===e&&(e=Se,0===(261888&(Se<<=1))&&(Se=256)),Du=e}return Du}function ju(e){return null==e||"symbol"===typeof e||"boolean"===typeof e?null:"function"===typeof e?e:Ot(""+e)}function Ku(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}for(var Gu=0;Gu<Ir.length;Gu++){var Qu=Ir[Gu];_r(Qu.toLowerCase(),"on"+(Qu[0].toUpperCase()+Qu.slice(1)))}_r(yr,"onAnimationEnd"),_r(vr,"onAnimationIteration"),_r(wr,"onAnimationStart"),_r("dblclick","onDoubleClick"),_r("focusin","onFocus"),_r("focusout","onBlur"),_r(br,"onTransitionRun"),_r(Cr,"onTransitionStart"),_r(kr,"onTransitionCancel"),_r(Sr,"onTransitionEnd"),it("onMouseEnter",["mouseout","mouseover"]),it("onMouseLeave",["mouseout","mouseover"]),it("onPointerEnter",["pointerout","pointerover"]),it("onPointerLeave",["pointerout","pointerover"]),rt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),rt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),rt("onBeforeInput",["compositionend","keypress","textInput","paste"]),rt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),rt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),rt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Wu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Yu=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Wu));function Ju(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var s=r.length-1;0<=s;s--){var a=r[s],c=a.instance,l=a.currentTarget;if(a=a.listener,c!==o&&i.isPropagationStopped())break e;o=a,i.currentTarget=l;try{o(i)}catch(u){Ar(u)}i.currentTarget=null,o=c}else for(s=0;s<r.length;s++){if(c=(a=r[s]).instance,l=a.currentTarget,a=a.listener,c!==o&&i.isPropagationStopped())break e;o=a,i.currentTarget=l;try{o(i)}catch(u){Ar(u)}i.currentTarget=null,o=c}}}}function Xu(e,t){var n=t[je];void 0===n&&(n=t[je]=new Set);var r=e+"__bubble";n.has(r)||(th(t,e,2,!1),n.add(r))}function $u(e,t,n){var r=0;t&&(r|=4),th(n,e,r,t)}var Zu="_reactListening"+Math.random().toString(36).slice(2);function eh(e){if(!e[Zu]){e[Zu]=!0,tt.forEach(function(t){"selectionchange"!==t&&(Yu.has(t)||$u(t,!1,e),$u(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Zu]||(t[Zu]=!0,$u("selectionchange",!1,t))}}function th(e,t,n,r){switch(Ad(t)){case 2:var i=Cd;break;case 8:i=kd;break;default:i=Sd}n=i.bind(null,t,n,e),i=void 0,!Vt||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function nh(e,t,n,r,i){var o=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var s=r.tag;if(3===s||4===s){var a=r.stateNode.containerInfo;if(a===i)break;if(4===s)for(s=r.return;null!==s;){var l=s.tag;if((3===l||4===l)&&s.stateNode.containerInfo===i)return;s=s.return}for(;null!==a;){if(null===(s=Je(a)))return;if(5===(l=s.tag)||6===l||26===l||27===l){r=o=s;continue e}a=a.parentNode}}r=r.return}zt(function(){var r=o,i=Dt(n),s=[];e:{var a=Tr.get(e);if(void 0!==a){var l=rn,u=e;switch(e){case"keypress":if(0===Yt(n))break e;case"keydown":case"keyup":l=wn;break;case"focusin":u="focus",l=un;break;case"focusout":u="blur",l=un;break;case"beforeblur":case"afterblur":l=un;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=cn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=ln;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Cn;break;case yr:case vr:case wr:l=hn;break;case Sr:l=kn;break;case"scroll":case"scrollend":l=sn;break;case"wheel":l=Sn;break;case"copy":case"cut":case"paste":l=dn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=bn;break;case"toggle":case"beforetoggle":l=Tn}var h=0!==(4&t),d=!h&&("scroll"===e||"scrollend"===e),f=h?null!==a?a+"Capture":null:a;h=[];for(var g,p=r;null!==p;){var m=p;if(g=m.stateNode,5!==(m=m.tag)&&26!==m&&27!==m||null===g||null===f||null!=(m=Bt(p,f))&&h.push(rh(p,m,g)),d)break;p=p.return}0<h.length&&(a=new l(a,u,null,n,i),s.push({event:a,listeners:h}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===xt||!(u=n.relatedTarget||n.fromElement)||!Je(u)&&!u[Ve])&&(l||a)&&(a=i.window===i?i:(a=i.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=r,null!==(u=(u=n.relatedTarget||n.toElement)?Je(u):null)&&(d=c(u),h=u.tag,u!==d||5!==h&&27!==h&&6!==h)&&(u=null)):(l=null,u=r),l!==u)){if(h=cn,m="onMouseLeave",f="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(h=bn,m="onPointerLeave",f="onPointerEnter",p="pointer"),d=null==l?a:$e(l),g=null==u?a:$e(u),(a=new h(m,p+"leave",l,n,i)).target=d,a.relatedTarget=g,m=null,Je(i)===r&&((h=new h(f,p+"enter",u,n,i)).target=g,h.relatedTarget=d,m=h),d=m,l&&u)e:{for(h=oh,p=u,g=0,m=f=l;m;m=h(m))g++;m=0;for(var y=p;y;y=h(y))m++;for(;0<g-m;)f=h(f),g--;for(;0<m-g;)p=h(p),m--;for(;g--;){if(f===p||null!==p&&f===p.alternate){h=f;break e}f=h(f),p=h(p)}h=null}else h=null;null!==l&&sh(s,a,l,h,!1),null!==u&&null!==d&&sh(s,d,u,h,!0)}if("select"===(l=(a=r?$e(r):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var v=Hn;else if(Ln(a))if(Vn)v=$n;else{v=Jn;var w=Yn}else!(l=a.nodeName)||"input"!==l.toLowerCase()||"checkbox"!==a.type&&"radio"!==a.type?r&&Pt(r.elementType)&&(v=Hn):v=Xn;switch(v&&(v=v(e,r))?Fn(s,v,n,i):(w&&w(e,a,r),"focusout"===e&&r&&"number"===a.type&&null!=r.memoizedProps.value&&bt(a,"number",a.value)),w=r?$e(r):window,e){case"focusin":(Ln(w)||"true"===w.contentEditable)&&(ar=w,cr=r,lr=null);break;case"focusout":lr=cr=ar=null;break;case"mousedown":ur=!0;break;case"contextmenu":case"mouseup":case"dragend":ur=!1,hr(s,n,i);break;case"selectionchange":if(sr)break;case"keydown":case"keyup":hr(s,n,i)}var b;if(_n)e:{switch(e){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else xn?On(e,n)&&(C="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(C="onCompositionStart");C&&(Pn&&"ko"!==n.locale&&(xn||"onCompositionStart"!==C?"onCompositionEnd"===C&&xn&&(b=Wt()):(Gt="value"in(Kt=i)?Kt.value:Kt.textContent,xn=!0)),0<(w=ih(r,C)).length&&(C=new fn(C,e,null,n,i),s.push({event:C,listeners:w}),b?C.data=b:null!==(b=Mn(n))&&(C.data=b))),(b=En?function(e,t){switch(e){case"compositionend":return Mn(t);case"keypress":return 32!==t.which?null:(Nn=!0,Rn);case"textInput":return(e=t.data)===Rn&&Nn?null:e;default:return null}}(e,n):function(e,t){if(xn)return"compositionend"===e||!_n&&On(e,t)?(e=Wt(),Qt=Gt=Kt=null,xn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Pn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(C=ih(r,"onBeforeInput")).length&&(w=new fn("onBeforeInput","beforeinput",null,n,i),s.push({event:w,listeners:C}),w.data=b)),function(e,t,n,r,i){if("submit"===t&&n&&n.stateNode===i){var o=ju((i[He]||null).action),s=r.submitter;s&&null!==(t=(t=s[He]||null)?ju(t.formAction):s.getAttribute("formAction"))&&(o=t,s=null);var a=new rn("action","action",null,r,i);e.push({event:a,listeners:[{instance:null,listener:function(){if(r.defaultPrevented){if(0!==Du){var e=s?Ku(i,s):new FormData(i);na(n,{pending:!0,data:e,method:i.method,action:o},null,e)}}else"function"===typeof o&&(a.preventDefault(),e=s?Ku(i,s):new FormData(i),na(n,{pending:!0,data:e,method:i.method,action:o},o,e))},currentTarget:i}]})}}(s,e,r,n,i)}Ju(s,t)})}function rh(e,t,n){return{instance:e,listener:t,currentTarget:n}}function ih(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,o=i.stateNode;if(5!==(i=i.tag)&&26!==i&&27!==i||null===o||(null!=(i=Bt(e,n))&&r.unshift(rh(e,i,o)),null!=(i=Bt(e,t))&&r.push(rh(e,i,o))),3===e.tag)return r;e=e.return}return[]}function oh(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function sh(e,t,n,r,i){for(var o=t._reactName,s=[];null!==n&&n!==r;){var a=n,c=a.alternate,l=a.stateNode;if(a=a.tag,null!==c&&c===r)break;5!==a&&26!==a&&27!==a||null===l||(c=l,i?null!=(l=Bt(n,o))&&s.unshift(rh(n,l,c)):i||null!=(l=Bt(n,o))&&s.push(rh(n,l,c))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}var ah=/\r\n?/g,ch=/\u0000|\uFFFD/g;function lh(e){return("string"===typeof e?e:""+e).replace(ah,"\n").replace(ch,"")}function uh(e,t){return t=lh(t),lh(e)===t}function hh(e,t,n,r,i,o){switch(n){case"children":"string"===typeof r?"body"===t||"textarea"===t&&""===r||It(e,r):("number"===typeof r||"bigint"===typeof r)&&"body"!==t&&It(e,""+r);break;case"className":lt(e,"class",r);break;case"tabIndex":lt(e,"tabindex",r);break;case"dir":case"role":case"viewBox":case"width":case"height":lt(e,n,r);break;case"style":Et(e,r,o);break;case"data":if("object"!==t){lt(e,"data",r);break}case"src":case"href":if(""===r&&("a"!==t||"href"!==n)){e.removeAttribute(n);break}if(null==r||"function"===typeof r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(n);break}r=Ot(""+r),e.setAttribute(n,r);break;case"action":case"formAction":if("function"===typeof r){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"===typeof o&&("formAction"===n?("input"!==t&&hh(e,t,"name",i.name,i,null),hh(e,t,"formEncType",i.formEncType,i,null),hh(e,t,"formMethod",i.formMethod,i,null),hh(e,t,"formTarget",i.formTarget,i,null)):(hh(e,t,"encType",i.encType,i,null),hh(e,t,"method",i.method,i,null),hh(e,t,"target",i.target,i,null))),null==r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(n);break}r=Ot(""+r),e.setAttribute(n,r);break;case"onClick":null!=r&&(e.onclick=Mt);break;case"onScroll":null!=r&&Xu("scroll",e);break;case"onScrollEnd":null!=r&&Xu("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(s(61));if(null!=(n=r.__html)){if(null!=i.children)throw Error(s(60));e.innerHTML=n}}break;case"multiple":e.multiple=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"muted":e.muted=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==r||"function"===typeof r||"boolean"===typeof r||"symbol"===typeof r){e.removeAttribute("xlink:href");break}n=Ot(""+r),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,""+r):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":!0===r?e.setAttribute(n,""):!1!==r&&null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,r):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":null!=r&&"function"!==typeof r&&"symbol"!==typeof r&&!isNaN(r)&&1<=r?e.setAttribute(n,r):e.removeAttribute(n);break;case"rowSpan":case"start":null==r||"function"===typeof r||"symbol"===typeof r||isNaN(r)?e.removeAttribute(n):e.setAttribute(n,r);break;case"popover":Xu("beforetoggle",e),Xu("toggle",e),ct(e,"popover",r);break;case"xlinkActuate":ut(e,"http://www.w3.org/1999/xlink","xlink:actuate",r);break;case"xlinkArcrole":ut(e,"http://www.w3.org/1999/xlink","xlink:arcrole",r);break;case"xlinkRole":ut(e,"http://www.w3.org/1999/xlink","xlink:role",r);break;case"xlinkShow":ut(e,"http://www.w3.org/1999/xlink","xlink:show",r);break;case"xlinkTitle":ut(e,"http://www.w3.org/1999/xlink","xlink:title",r);break;case"xlinkType":ut(e,"http://www.w3.org/1999/xlink","xlink:type",r);break;case"xmlBase":ut(e,"http://www.w3.org/XML/1998/namespace","xml:base",r);break;case"xmlLang":ut(e,"http://www.w3.org/XML/1998/namespace","xml:lang",r);break;case"xmlSpace":ut(e,"http://www.w3.org/XML/1998/namespace","xml:space",r);break;case"is":ct(e,"is",r);break;case"innerText":case"textContent":break;default:(!(2<n.length)||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])&&ct(e,n=Rt.get(n)||n,r)}}function dh(e,t,n,r,i,o){switch(n){case"style":Et(e,r,o);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(s(61));if(null!=(n=r.__html)){if(null!=i.children)throw Error(s(60));e.innerHTML=n}}break;case"children":"string"===typeof r?It(e,r):("number"===typeof r||"bigint"===typeof r)&&It(e,""+r);break;case"onScroll":null!=r&&Xu("scroll",e);break;case"onScrollEnd":null!=r&&Xu("scrollend",e);break;case"onClick":null!=r&&(e.onclick=Mt);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:nt.hasOwnProperty(n)||("o"!==n[0]||"n"!==n[1]||(i=n.endsWith("Capture"),t=n.slice(2,i?n.length-7:void 0),"function"===typeof(o=null!=(o=e[He]||null)?o[n]:null)&&e.removeEventListener(t,o,i),"function"!==typeof r)?n in e?e[n]=r:!0===r?e.setAttribute(n,""):ct(e,n,r):("function"!==typeof o&&null!==o&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,r,i)))}}function fh(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Xu("error",e),Xu("load",e);var r,i=!1,o=!1;for(r in n)if(n.hasOwnProperty(r)){var a=n[r];if(null!=a)switch(r){case"src":i=!0;break;case"srcSet":o=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,t));default:hh(e,t,r,a,n,null)}}return o&&hh(e,t,"srcSet",n.srcSet,n,null),void(i&&hh(e,t,"src",n.src,n,null));case"input":Xu("invalid",e);var c=r=a=o=null,l=null,u=null;for(i in n)if(n.hasOwnProperty(i)){var h=n[i];if(null!=h)switch(i){case"name":o=h;break;case"type":a=h;break;case"checked":l=h;break;case"defaultChecked":u=h;break;case"value":r=h;break;case"defaultValue":c=h;break;case"children":case"dangerouslySetInnerHTML":if(null!=h)throw Error(s(137,t));break;default:hh(e,t,i,h,n,null)}}return void wt(e,r,c,l,u,a,o,!1);case"select":for(o in Xu("invalid",e),i=a=r=null,n)if(n.hasOwnProperty(o)&&null!=(c=n[o]))switch(o){case"value":r=c;break;case"defaultValue":a=c;break;case"multiple":i=c;default:hh(e,t,o,c,n,null)}return t=r,n=a,e.multiple=!!i,void(null!=t?Ct(e,!!i,t,!1):null!=n&&Ct(e,!!i,n,!0));case"textarea":for(a in Xu("invalid",e),r=o=i=null,n)if(n.hasOwnProperty(a)&&null!=(c=n[a]))switch(a){case"value":i=c;break;case"defaultValue":o=c;break;case"children":r=c;break;case"dangerouslySetInnerHTML":if(null!=c)throw Error(s(91));break;default:hh(e,t,a,c,n,null)}return void Tt(e,i,o,r);case"option":for(l in n)if(n.hasOwnProperty(l)&&null!=(i=n[l]))if("selected"===l)e.selected=i&&"function"!==typeof i&&"symbol"!==typeof i;else hh(e,t,l,i,n,null);return;case"dialog":Xu("beforetoggle",e),Xu("toggle",e),Xu("cancel",e),Xu("close",e);break;case"iframe":case"object":Xu("load",e);break;case"video":case"audio":for(i=0;i<Wu.length;i++)Xu(Wu[i],e);break;case"image":Xu("error",e),Xu("load",e);break;case"details":Xu("toggle",e);break;case"embed":case"source":case"link":Xu("error",e),Xu("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in n)if(n.hasOwnProperty(u)&&null!=(i=n[u]))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,t));default:hh(e,t,u,i,n,null)}return;default:if(Pt(t)){for(h in n)n.hasOwnProperty(h)&&(void 0!==(i=n[h])&&dh(e,t,h,i,n,void 0));return}}for(c in n)n.hasOwnProperty(c)&&(null!=(i=n[c])&&hh(e,t,c,i,n,null))}function gh(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}var ph=null,mh=null;function yh(e){return 9===e.nodeType?e:e.ownerDocument}function vh(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function wh(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function bh(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"bigint"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var Ch=null;var kh="function"===typeof setTimeout?setTimeout:void 0,Sh="function"===typeof clearTimeout?clearTimeout:void 0,Th="function"===typeof Promise?Promise:void 0,Ih="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof Th?function(e){return Th.resolve(null).then(e).catch(_h)}:kh;function _h(e){setTimeout(function(){throw e})}function Ah(e){return"head"===e}function Eh(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)||"/&"===n){if(0===r)return e.removeChild(i),void Kd(t);r--}else if("$"===n||"$?"===n||"$~"===n||"$!"===n||"&"===n)r++;else if("html"===n)Uh(e.ownerDocument.documentElement);else if("head"===n){Uh(n=e.ownerDocument.head);for(var o=n.firstChild;o;){var s=o.nextSibling,a=o.nodeName;o[We]||"SCRIPT"===a||"STYLE"===a||"LINK"===a&&"stylesheet"===o.rel.toLowerCase()||n.removeChild(o),o=s}}else"body"===n&&Uh(e.ownerDocument.body);n=i}while(n);Kd(t)}function Ph(e,t){var n=e;e=0;do{var r=n.nextSibling;if(1===n.nodeType?t?(n._stashedDisplay=n.style.display,n.style.display="none"):(n.style.display=n._stashedDisplay||"",""===n.getAttribute("style")&&n.removeAttribute("style")):3===n.nodeType&&(t?(n._stashedText=n.nodeValue,n.nodeValue=""):n.nodeValue=n._stashedText||""),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===e)break;e--}else"$"!==n&&"$?"!==n&&"$~"!==n&&"$!"!==n||e++;n=r}while(n)}function Rh(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":Rh(n),Ye(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===n.rel.toLowerCase())continue}e.removeChild(n)}}function Nh(e,t){for(;8!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!t)return null;if(null===(e=xh(e.nextSibling)))return null}return e}function Oh(e){return"$?"===e.data||"$~"===e.data}function Mh(e){return"$!"===e.data||"$?"===e.data&&"loading"!==e.ownerDocument.readyState}function xh(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"$~"===t||"&"===t||"F!"===t||"F"===t)break;if("/$"===t||"/&"===t)return null}}return e}var Dh=null;function Lh(e){e=e.nextSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n||"/&"===n){if(0===t)return xh(e.nextSibling);t--}else"$"!==n&&"$!"!==n&&"$?"!==n&&"$~"!==n&&"&"!==n||t++}e=e.nextSibling}return null}function Fh(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n||"$~"===n||"&"===n){if(0===t)return e;t--}else"/$"!==n&&"/&"!==n||t++}e=e.previousSibling}return null}function qh(e,t,n){switch(t=yh(n),e){case"html":if(!(e=t.documentElement))throw Error(s(452));return e;case"head":if(!(e=t.head))throw Error(s(453));return e;case"body":if(!(e=t.body))throw Error(s(454));return e;default:throw Error(s(451))}}function Uh(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Ye(e)}var zh=new Map,Bh=new Set;function Hh(e){return"function"===typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var Vh=D.d;D.d={f:function(){var e=Vh.f(),t=eu();return e||t},r:function(e){var t=Xe(e);null!==t&&5===t.tag&&"form"===t.type?ia(t):Vh.r(e)},D:function(e){Vh.D(e),Kh("dns-prefetch",e,null)},C:function(e,t){Vh.C(e,t),Kh("preconnect",e,t)},L:function(e,t,n){Vh.L(e,t,n);var r=jh;if(r&&e&&t){var i='link[rel="preload"][as="'+yt(t)+'"]';"image"===t&&n&&n.imageSrcSet?(i+='[imagesrcset="'+yt(n.imageSrcSet)+'"]',"string"===typeof n.imageSizes&&(i+='[imagesizes="'+yt(n.imageSizes)+'"]')):i+='[href="'+yt(e)+'"]';var o=i;switch(t){case"style":o=Qh(e);break;case"script":o=Jh(e)}zh.has(o)||(e=f({rel:"preload",href:"image"===t&&n&&n.imageSrcSet?void 0:e,as:t},n),zh.set(o,e),null!==r.querySelector(i)||"style"===t&&r.querySelector(Wh(o))||"script"===t&&r.querySelector(Xh(o))||(fh(t=r.createElement("link"),"link",e),et(t),r.head.appendChild(t)))}},m:function(e,t){Vh.m(e,t);var n=jh;if(n&&e){var r=t&&"string"===typeof t.as?t.as:"script",i='link[rel="modulepreload"][as="'+yt(r)+'"][href="'+yt(e)+'"]',o=i;switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":o=Jh(e)}if(!zh.has(o)&&(e=f({rel:"modulepreload",href:e},t),zh.set(o,e),null===n.querySelector(i))){switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Xh(o)))return}fh(r=n.createElement("link"),"link",e),et(r),n.head.appendChild(r)}}},X:function(e,t){Vh.X(e,t);var n=jh;if(n&&e){var r=Ze(n).hoistableScripts,i=Jh(e),o=r.get(i);o||((o=n.querySelector(Xh(i)))||(e=f({src:e,async:!0},t),(t=zh.get(i))&&td(e,t),et(o=n.createElement("script")),fh(o,"link",e),n.head.appendChild(o)),o={type:"script",instance:o,count:1,state:null},r.set(i,o))}},S:function(e,t,n){Vh.S(e,t,n);var r=jh;if(r&&e){var i=Ze(r).hoistableStyles,o=Qh(e);t=t||"default";var s=i.get(o);if(!s){var a={loading:0,preload:null};if(s=r.querySelector(Wh(o)))a.loading=5;else{e=f({rel:"stylesheet",href:e,"data-precedence":t},n),(n=zh.get(o))&&ed(e,n);var c=s=r.createElement("link");et(c),fh(c,"link",e),c._p=new Promise(function(e,t){c.onload=e,c.onerror=t}),c.addEventListener("load",function(){a.loading|=1}),c.addEventListener("error",function(){a.loading|=2}),a.loading|=4,Zh(s,t,r)}s={type:"stylesheet",instance:s,count:1,state:a},i.set(o,s)}}},M:function(e,t){Vh.M(e,t);var n=jh;if(n&&e){var r=Ze(n).hoistableScripts,i=Jh(e),o=r.get(i);o||((o=n.querySelector(Xh(i)))||(e=f({src:e,async:!0,type:"module"},t),(t=zh.get(i))&&td(e,t),et(o=n.createElement("script")),fh(o,"link",e),n.head.appendChild(o)),o={type:"script",instance:o,count:1,state:null},r.set(i,o))}}};var jh="undefined"===typeof document?null:document;function Kh(e,t,n){var r=jh;if(r&&"string"===typeof t&&t){var i=yt(t);i='link[rel="'+e+'"][href="'+i+'"]',"string"===typeof n&&(i+='[crossorigin="'+n+'"]'),Bh.has(i)||(Bh.add(i),e={rel:e,crossOrigin:n,href:t},null===r.querySelector(i)&&(fh(t=r.createElement("link"),"link",e),et(t),r.head.appendChild(t)))}}function Gh(e,t,n,r){var i,o,a,c,l=(l=G.current)?Hh(l):null;if(!l)throw Error(s(446));switch(e){case"meta":case"title":return null;case"style":return"string"===typeof n.precedence&&"string"===typeof n.href?(t=Qh(n.href),(r=(n=Ze(l).hoistableStyles).get(t))||(r={type:"style",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===n.rel&&"string"===typeof n.href&&"string"===typeof n.precedence){e=Qh(n.href);var u=Ze(l).hoistableStyles,h=u.get(e);if(h||(l=l.ownerDocument||l,h={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},u.set(e,h),(u=l.querySelector(Wh(e)))&&!u._p&&(h.instance=u,h.state.loading=5),zh.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},zh.set(e,n),u||(i=l,o=e,a=n,c=h.state,i.querySelector('link[rel="preload"][as="style"]['+o+"]")?c.loading=1:(o=i.createElement("link"),c.preload=o,o.addEventListener("load",function(){return c.loading|=1}),o.addEventListener("error",function(){return c.loading|=2}),fh(o,"link",a),et(o),i.head.appendChild(o))))),t&&null===r)throw Error(s(528,""));return h}if(t&&null!==r)throw Error(s(529,""));return null;case"script":return t=n.async,"string"===typeof(n=n.src)&&t&&"function"!==typeof t&&"symbol"!==typeof t?(t=Jh(n),(r=(n=Ze(l).hoistableScripts).get(t))||(r={type:"script",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,e))}}function Qh(e){return'href="'+yt(e)+'"'}function Wh(e){return'link[rel="stylesheet"]['+e+"]"}function Yh(e){return f({},e,{"data-precedence":e.precedence,precedence:null})}function Jh(e){return'[src="'+yt(e)+'"]'}function Xh(e){return"script[async]"+e}function $h(e,t,n){if(t.count++,null===t.instance)switch(t.type){case"style":var r=e.querySelector('style[data-href~="'+yt(n.href)+'"]');if(r)return t.instance=r,et(r),r;var i=f({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return et(r=(e.ownerDocument||e).createElement("style")),fh(r,"style",i),Zh(r,n.precedence,e),t.instance=r;case"stylesheet":i=Qh(n.href);var o=e.querySelector(Wh(i));if(o)return t.state.loading|=4,t.instance=o,et(o),o;r=Yh(n),(i=zh.get(i))&&ed(r,i),et(o=(e.ownerDocument||e).createElement("link"));var a=o;return a._p=new Promise(function(e,t){a.onload=e,a.onerror=t}),fh(o,"link",r),t.state.loading|=4,Zh(o,n.precedence,e),t.instance=o;case"script":return o=Jh(n.src),(i=e.querySelector(Xh(o)))?(t.instance=i,et(i),i):(r=n,(i=zh.get(o))&&td(r=f({},n),i),et(i=(e=e.ownerDocument||e).createElement("script")),fh(i,"link",r),e.head.appendChild(i),t.instance=i);case"void":return null;default:throw Error(s(443,t.type))}else"stylesheet"===t.type&&0===(4&t.state.loading)&&(r=t.instance,t.state.loading|=4,Zh(r,n.precedence,e));return t.instance}function Zh(e,t,n){for(var r=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),i=r.length?r[r.length-1]:null,o=i,s=0;s<r.length;s++){var a=r[s];if(a.dataset.precedence===t)o=a;else if(o!==i)break}o?o.parentNode.insertBefore(e,o.nextSibling):(t=9===n.nodeType?n.head:n).insertBefore(e,t.firstChild)}function ed(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function td(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var nd=null;function rd(e,t,n){if(null===nd){var r=new Map,i=nd=new Map;i.set(n,r)}else(r=(i=nd).get(n))||(r=new Map,i.set(n,r));if(r.has(e))return r;for(r.set(e,null),n=n.getElementsByTagName(e),i=0;i<n.length;i++){var o=n[i];if(!(o[We]||o[Be]||"link"===e&&"stylesheet"===o.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==o.namespaceURI){var s=o.getAttribute(t)||"";s=e+s;var a=r.get(s);a?a.push(o):r.set(s,[o])}}return r}function id(e,t,n){(e=e.ownerDocument||e).head.insertBefore(n,"title"===t?e.querySelector("head > title"):null)}function od(e){return"stylesheet"!==e.type||0!==(3&e.state.loading)}var sd=0;function ad(){if(this.count--,0===this.count&&(0===this.imgCount||!this.waitingForImages))if(this.stylesheets)ld(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var cd=null;function ld(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,cd=new Map,t.forEach(ud,e),cd=null,ad.call(e))}function ud(e,t){if(!(4&t.state.loading)){var n=cd.get(e);if(n)var r=n.get(null);else{n=new Map,cd.set(e,n);for(var i=e.querySelectorAll("link[data-precedence],style[data-precedence]"),o=0;o<i.length;o++){var s=i[o];"LINK"!==s.nodeName&&"not all"===s.getAttribute("media")||(n.set(s.dataset.precedence,s),r=s)}r&&n.set(null,r)}s=(i=t.instance).getAttribute("data-precedence"),(o=n.get(s)||r)===r&&n.set(null,i),n.set(s,i),this.count++,r=ad.bind(this),i.addEventListener("load",r),i.addEventListener("error",r),o?o.parentNode.insertBefore(i,o.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(i,e.firstChild),t.state.loading|=4}}var hd={$$typeof:C,Provider:null,Consumer:null,_currentValue:L,_currentValue2:L,_threadCount:0};function dd(e,t,n,r,i,o,s,a,c){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ne(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ne(0),this.hiddenUpdates=Ne(null),this.identifierPrefix=r,this.onUncaughtError=i,this.onCaughtError=o,this.onRecoverableError=s,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=c,this.incompleteTransitions=new Map}function fd(e,t,n,r,i,o,s,a,c,l,u,h){return e=new dd(e,t,n,s,c,l,u,h,a),t=1,!0===o&&(t|=24),o=Ur(3,null,null,t),e.current=o,o.stateNode=e,(t=zi()).refCount++,e.pooledCache=t,t.refCount++,o.memoizedState={element:r,isDehydrated:n,cache:t},vo(o),e}function gd(e){return e?e=Fr:Fr}function pd(e,t,n,r,i,o){i=gd(i),null===r.context?r.context=i:r.pendingContext=i,(r=bo(t)).payload={element:n},null!==(o=void 0===o?null:o)&&(r.callback=o),null!==(n=Co(e,r,t))&&(Yl(n,0,t),ko(n,e,t))}function md(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function yd(e,t){md(e,t),(e=e.alternate)&&md(e,t)}function vd(e){if(13===e.tag||31===e.tag){var t=xr(e,67108864);null!==t&&Yl(t,0,67108864),yd(e,67108864)}}function wd(e){if(13===e.tag||31===e.tag){var t=Ql(),n=xr(e,t=Le(t));null!==n&&Yl(n,0,t),yd(e,t)}}var bd=!0;function Cd(e,t,n,r){var i=x.T;x.T=null;var o=D.p;try{D.p=2,Sd(e,t,n,r)}finally{D.p=o,x.T=i}}function kd(e,t,n,r){var i=x.T;x.T=null;var o=D.p;try{D.p=8,Sd(e,t,n,r)}finally{D.p=o,x.T=i}}function Sd(e,t,n,r){if(bd){var i=Td(r);if(null===i)nh(e,t,r,Id,n),Ld(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return Pd=Fd(Pd,e,t,n,r,i),!0;case"dragenter":return Rd=Fd(Rd,e,t,n,r,i),!0;case"mouseover":return Nd=Fd(Nd,e,t,n,r,i),!0;case"pointerover":var o=i.pointerId;return Od.set(o,Fd(Od.get(o)||null,e,t,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,Md.set(o,Fd(Md.get(o)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Ld(e,r),4&t&&-1<Dd.indexOf(e)){for(;null!==i;){var o=Xe(i);if(null!==o)switch(o.tag){case 3:if((o=o.stateNode).current.memoizedState.isDehydrated){var s=_e(o.pendingLanes);if(0!==s){var a=o;for(a.pendingLanes|=2,a.entangledLanes|=2;s;){var c=1<<31-be(s);a.entanglements[1]|=c,s&=~c}Lu(o),0===(6&gl)&&(Dl=ce()+500,Fu(0,!1))}}break;case 31:case 13:null!==(a=xr(o,2))&&Yl(a,0,2),eu(),yd(o,2)}if(null===(o=Td(r))&&nh(e,t,r,Id,n),o===i)break;i=o}null!==i&&r.stopPropagation()}else nh(e,t,r,null,n)}}function Td(e){return _d(e=Dt(e))}var Id=null;function _d(e){if(Id=null,null!==(e=Je(e))){var t=c(e);if(null===t)e=null;else{var n=t.tag;if(13===n){if(null!==(e=l(t)))return e;e=null}else if(31===n){if(null!==(e=u(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Id=e,null}function Ad(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(le()){case ue:return 2;case he:return 8;case de:case fe:return 32;case ge:return 268435456;default:return 32}default:return 32}}var Ed=!1,Pd=null,Rd=null,Nd=null,Od=new Map,Md=new Map,xd=[],Dd="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Ld(e,t){switch(e){case"focusin":case"focusout":Pd=null;break;case"dragenter":case"dragleave":Rd=null;break;case"mouseover":case"mouseout":Nd=null;break;case"pointerover":case"pointerout":Od.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Md.delete(t.pointerId)}}function Fd(e,t,n,r,i,o){return null===e||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},null!==t&&(null!==(t=Xe(t))&&vd(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function qd(e){var t=Je(e.target);if(null!==t){var n=c(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=l(n)))return e.blockedOn=t,void Ue(e.priority,function(){wd(n)})}else if(31===t){if(null!==(t=u(n)))return e.blockedOn=t,void Ue(e.priority,function(){wd(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ud(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Td(e.nativeEvent);if(null!==n)return null!==(t=Xe(n))&&vd(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);xt=r,n.target.dispatchEvent(r),xt=null,t.shift()}return!0}function zd(e,t,n){Ud(e)&&n.delete(t)}function Bd(){Ed=!1,null!==Pd&&Ud(Pd)&&(Pd=null),null!==Rd&&Ud(Rd)&&(Rd=null),null!==Nd&&Ud(Nd)&&(Nd=null),Od.forEach(zd),Md.forEach(zd)}function Hd(e,t){e.blockedOn===t&&(e.blockedOn=null,Ed||(Ed=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Bd)))}var Vd=null;function jd(e){Vd!==e&&(Vd=e,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){Vd===e&&(Vd=null);for(var t=0;t<e.length;t+=3){var n=e[t],r=e[t+1],i=e[t+2];if("function"!==typeof r){if(null===_d(r||n))continue;break}var o=Xe(n);null!==o&&(e.splice(t,3),t-=3,na(o,{pending:!0,data:i,method:n.method,action:r},r,i))}}))}function Kd(e){function t(t){return Hd(t,e)}null!==Pd&&Hd(Pd,e),null!==Rd&&Hd(Rd,e),null!==Nd&&Hd(Nd,e),Od.forEach(t),Md.forEach(t);for(var n=0;n<xd.length;n++){var r=xd[n];r.blockedOn===e&&(r.blockedOn=null)}for(;0<xd.length&&null===(n=xd[0]).blockedOn;)qd(n),null===n.blockedOn&&xd.shift();if(null!=(n=(e.ownerDocument||e).$$reactFormReplay))for(r=0;r<n.length;r+=3){var i=n[r],o=n[r+1],s=i[He]||null;if("function"===typeof o)s||jd(n);else if(s){var a=null;if(o&&o.hasAttribute("formAction")){if(i=o,s=o[He]||null)a=s.formAction;else if(null!==_d(i))continue}else a=s.action;"function"===typeof a?n[r+1]=a:(n.splice(r,3),r-=3),jd(n)}}}function Gd(){function e(e){e.canIntercept&&"react-transition"===e.info&&e.intercept({handler:function(){return new Promise(function(e){return i=e})},focusReset:"manual",scroll:"manual"})}function t(){null!==i&&(i(),i=null),r||setTimeout(n,20)}function n(){if(!r&&!navigation.transition){var e=navigation.currentEntry;e&&null!=e.url&&navigation.navigate(e.url,{state:e.getState(),info:"react-transition",history:"replace"})}}if("object"===typeof navigation){var r=!1,i=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(n,100),function(){r=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),null!==i&&(i(),i=null)}}}function Qd(e){this._internalRoot=e}function Wd(e){this._internalRoot=e}Wd.prototype.render=Qd.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));pd(t.current,Ql(),e,t,null,null)},Wd.prototype.unmount=Qd.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;pd(e.current,2,null,e,null,null),eu(),t[Ve]=null}},Wd.prototype.unstable_scheduleHydration=function(e){if(e){var t=qe();e={blockedOn:null,target:e,priority:t};for(var n=0;n<xd.length&&0!==t&&t<xd[n].priority;n++);xd.splice(n,0,e),0===n&&qd(e)}};var Yd=i.version;if("19.2.0"!==Yd)throw Error(s(527,Yd,"19.2.0"));D.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=c(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return h(i),e;if(o===r)return h(i),t;o=o.sibling}throw Error(s(188))}if(n.return!==r.return)n=i,r=o;else{for(var a=!1,l=i.child;l;){if(l===n){a=!0,n=i,r=o;break}if(l===r){a=!0,r=i,n=o;break}l=l.sibling}if(!a){for(l=o.child;l;){if(l===n){a=!0,n=o,r=i;break}if(l===r){a=!0,r=o,n=i;break}l=l.sibling}if(!a)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(t),e=null===(e=null!==e?d(e):null)?null:e.stateNode};var Jd={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:x,reconcilerVersion:"19.2.0"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Xd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Xd.isDisabled&&Xd.supportsFiber)try{ye=Xd.inject(Jd),ve=Xd}catch(Zd){}}t.createRoot=function(e,t){if(!a(e))throw Error(s(299));var n=!1,r="",i=Ia,o=_a,c=Aa;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onUncaughtError&&(i=t.onUncaughtError),void 0!==t.onCaughtError&&(o=t.onCaughtError),void 0!==t.onRecoverableError&&(c=t.onRecoverableError)),t=fd(e,1,!1,null,0,n,r,null,i,o,c,Gd),e[Ve]=t.current,eh(e),new Qd(t)},t.hydrateRoot=function(e,t,n){if(!a(e))throw Error(s(299));var r=!1,i="",o=Ia,c=_a,l=Aa,u=null;return null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(i=n.identifierPrefix),void 0!==n.onUncaughtError&&(o=n.onUncaughtError),void 0!==n.onCaughtError&&(c=n.onCaughtError),void 0!==n.onRecoverableError&&(l=n.onRecoverableError),void 0!==n.formState&&(u=n.formState)),(t=fd(e,1,!0,t,0,r,i,u,o,c,l,Gd)).context=gd(null),n=t.current,(i=bo(r=Le(r=Ql()))).callback=null,Co(n,i,r),n=r,t.current.lanes=n,Oe(t,n),Lu(t),e[Ve]=t.current,eh(e),new Wd(t)},t.version="19.2.0"},43:(e,t,n)=>{e.exports=n(288)},288:(e,t)=>{var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),c=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.for("react.activity"),g=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,y={};function v(e,t,n){this.props=e,this.context=t,this.refs=y,this.updater=n||p}function w(){}function b(e,t,n){this.props=e,this.context=t,this.refs=y,this.updater=n||p}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},w.prototype=v.prototype;var C=b.prototype=new w;C.constructor=b,m(C,v.prototype),C.isPureReactComponent=!0;var k=Array.isArray;function S(){}var T={H:null,A:null,T:null,S:null},I=Object.prototype.hasOwnProperty;function _(e,t,r){var i=r.ref;return{$$typeof:n,type:e,key:t,ref:void 0!==i?i:null,props:r}}function A(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var E=/\/+/g;function P(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function R(e,t,i,o,s){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var c,l,u=!1;if(null===e)u=!0;else switch(a){case"bigint":case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case n:case r:u=!0;break;case d:return R((u=e._init)(e._payload),t,i,o,s)}}if(u)return s=s(e),u=""===o?"."+P(e,0):o,k(s)?(i="",null!=u&&(i=u.replace(E,"$&/")+"/"),R(s,t,i,"",function(e){return e})):null!=s&&(A(s)&&(c=s,l=i+(null==s.key||e&&e.key===s.key?"":(""+s.key).replace(E,"$&/")+"/")+u,s=_(c.type,l,c.props)),t.push(s)),1;u=0;var h,f=""===o?".":o+":";if(k(e))for(var p=0;p<e.length;p++)u+=R(o=e[p],t,i,a=f+P(o,p),s);else if("function"===typeof(p=null===(h=e)||"object"!==typeof h?null:"function"===typeof(h=g&&h[g]||h["@@iterator"])?h:null))for(e=p.call(e),p=0;!(o=e.next()).done;)u+=R(o=o.value,t,i,a=f+P(o,p++),s);else if("object"===a){if("function"===typeof e.then)return R(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"===typeof e.status?e.then(S,S):(e.status="pending",e.then(function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)},function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(e),t,i,o,s);throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return u}function N(e,t,n){if(null==e)return e;var r=[],i=0;return R(e,r,"","",function(e){return t.call(n,e,i++)}),r}function O(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var M="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},x={map:N,forEach:function(e,t,n){N(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return N(e,function(){t++}),t},toArray:function(e){return N(e,function(e){return e})||[]},only:function(e){if(!A(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};t.Activity=f,t.Children=x,t.Component=v,t.Fragment=i,t.Profiler=s,t.PureComponent=b,t.StrictMode=o,t.Suspense=u,t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=T,t.__COMPILER_RUNTIME={__proto__:null,c:function(e){return T.H.useMemoCache(e)}},t.cache=function(e){return function(){return e.apply(null,arguments)}},t.cacheSignal=function(){return null},t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("The argument must be a React element, but you passed "+e+".");var r=m({},e.props),i=e.key;if(null!=t)for(o in void 0!==t.key&&(i=""+t.key),t)!I.call(t,o)||"key"===o||"__self"===o||"__source"===o||"ref"===o&&void 0===t.ref||(r[o]=t[o]);var o=arguments.length-2;if(1===o)r.children=n;else if(1<o){for(var s=Array(o),a=0;a<o;a++)s[a]=arguments[a+2];r.children=s}return _(e.type,i,r)},t.createContext=function(e){return(e={$$typeof:c,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:a,_context:e},e},t.createElement=function(e,t,n){var r,i={},o=null;if(null!=t)for(r in void 0!==t.key&&(o=""+t.key),t)I.call(t,r)&&"key"!==r&&"__self"!==r&&"__source"!==r&&(i[r]=t[r]);var s=arguments.length-2;if(1===s)i.children=n;else if(1<s){for(var a=Array(s),c=0;c<s;c++)a[c]=arguments[c+2];i.children=a}if(e&&e.defaultProps)for(r in s=e.defaultProps)void 0===i[r]&&(i[r]=s[r]);return _(e,o,i)},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:l,render:e}},t.isValidElement=A,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:O}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=T.T,n={};T.T=n;try{var r=e(),i=T.S;null!==i&&i(n,r),"object"===typeof r&&null!==r&&"function"===typeof r.then&&r.then(S,M)}catch(o){M(o)}finally{null!==t&&null!==n.types&&(t.types=n.types),T.T=t}},t.unstable_useCacheRefresh=function(){return T.H.useCacheRefresh()},t.use=function(e){return T.H.use(e)},t.useActionState=function(e,t,n){return T.H.useActionState(e,t,n)},t.useCallback=function(e,t){return T.H.useCallback(e,t)},t.useContext=function(e){return T.H.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e,t){return T.H.useDeferredValue(e,t)},t.useEffect=function(e,t){return T.H.useEffect(e,t)},t.useEffectEvent=function(e){return T.H.useEffectEvent(e)},t.useId=function(){return T.H.useId()},t.useImperativeHandle=function(e,t,n){return T.H.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return T.H.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return T.H.useLayoutEffect(e,t)},t.useMemo=function(e,t){return T.H.useMemo(e,t)},t.useOptimistic=function(e,t){return T.H.useOptimistic(e,t)},t.useReducer=function(e,t,n){return T.H.useReducer(e,t,n)},t.useRef=function(e){return T.H.useRef(e)},t.useState=function(e){return T.H.useState(e)},t.useSyncExternalStore=function(e,t,n){return T.H.useSyncExternalStore(e,t,n)},t.useTransition=function(){return T.H.useTransition()},t.version="19.2.0"},391:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(4)},579:(e,t,n)=>{e.exports=n(799)},672:(e,t,n)=>{var r=n(43);function i(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(){}var s={d:{f:o,r:function(){throw Error(i(522))},D:o,C:o,L:o,m:o,X:o,S:o,M:o},p:0,findDOMNode:null},a=Symbol.for("react.portal");var c=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(e,t){return"font"===e?"":"string"===typeof t?"use-credentials"===t?t:"":void 0}t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)throw Error(i(299));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:a,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.flushSync=function(e){var t=c.T,n=s.p;try{if(c.T=null,s.p=2,e)return e()}finally{c.T=t,s.p=n,s.d.f()}},t.preconnect=function(e,t){"string"===typeof e&&(t?t="string"===typeof(t=t.crossOrigin)?"use-credentials"===t?t:"":void 0:t=null,s.d.C(e,t))},t.prefetchDNS=function(e){"string"===typeof e&&s.d.D(e)},t.preinit=function(e,t){if("string"===typeof e&&t&&"string"===typeof t.as){var n=t.as,r=l(n,t.crossOrigin),i="string"===typeof t.integrity?t.integrity:void 0,o="string"===typeof t.fetchPriority?t.fetchPriority:void 0;"style"===n?s.d.S(e,"string"===typeof t.precedence?t.precedence:void 0,{crossOrigin:r,integrity:i,fetchPriority:o}):"script"===n&&s.d.X(e,{crossOrigin:r,integrity:i,fetchPriority:o,nonce:"string"===typeof t.nonce?t.nonce:void 0})}},t.preinitModule=function(e,t){if("string"===typeof e)if("object"===typeof t&&null!==t){if(null==t.as||"script"===t.as){var n=l(t.as,t.crossOrigin);s.d.M(e,{crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0})}}else null==t&&s.d.M(e)},t.preload=function(e,t){if("string"===typeof e&&"object"===typeof t&&null!==t&&"string"===typeof t.as){var n=t.as,r=l(n,t.crossOrigin);s.d.L(e,n,{crossOrigin:r,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0,type:"string"===typeof t.type?t.type:void 0,fetchPriority:"string"===typeof t.fetchPriority?t.fetchPriority:void 0,referrerPolicy:"string"===typeof t.referrerPolicy?t.referrerPolicy:void 0,imageSrcSet:"string"===typeof t.imageSrcSet?t.imageSrcSet:void 0,imageSizes:"string"===typeof t.imageSizes?t.imageSizes:void 0,media:"string"===typeof t.media?t.media:void 0})}},t.preloadModule=function(e,t){if("string"===typeof e)if(t){var n=l(t.as,t.crossOrigin);s.d.m(e,{as:"string"===typeof t.as&&"script"!==t.as?t.as:void 0,crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0})}else s.d.m(e)},t.requestFormReset=function(e){s.d.r(e)},t.unstable_batchedUpdates=function(e,t){return e(t)},t.useFormState=function(e,t,n){return c.H.useFormState(e,t,n)},t.useFormStatus=function(){return c.H.useHostTransitionStatus()},t.version="19.2.0"},799:(e,t)=>{var n=Symbol.for("react.transitional.element");function r(e,t,r){var i=null;if(void 0!==r&&(i=""+r),void 0!==t.key&&(i=""+t.key),"key"in t)for(var o in r={},t)"key"!==o&&(r[o]=t[o]);else r=t;return t=r.ref,{$$typeof:n,type:e,key:i,ref:void 0!==t?t:null,props:r}}Symbol.for("react.fragment"),t.jsx=r,t.jsxs=r},853:(e,t,n)=>{e.exports=n(896)},896:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<o(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,s=i>>>1;r<s;){var a=2*(r+1)-1,c=e[a],l=a+1,u=e[l];if(0>o(c,n))l<i&&0>o(u,c)?(e[r]=u,e[l]=n,r=l):(e[r]=c,e[a]=n,r=a);else{if(!(l<i&&0>o(u,n)))break e;e[r]=u,e[l]=n,r=l}}}return t}function o(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if(t.unstable_now=void 0,"object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,c=a.now();t.unstable_now=function(){return a.now()-c}}var l=[],u=[],h=1,d=null,f=3,g=!1,p=!1,m=!1,y=!1,v="function"===typeof setTimeout?setTimeout:null,w="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function C(e){for(var t=r(u);null!==t;){if(null===t.callback)i(u);else{if(!(t.startTime<=e))break;i(u),t.sortIndex=t.expirationTime,n(l,t)}t=r(u)}}function k(e){if(m=!1,C(e),!p)if(null!==r(l))p=!0,T||(T=!0,S());else{var t=r(u);null!==t&&O(k,t.startTime-e)}}var S,T=!1,I=-1,_=5,A=-1;function E(){return!!y||!(t.unstable_now()-A<_)}function P(){if(y=!1,T){var e=t.unstable_now();A=e;var n=!0;try{e:{p=!1,m&&(m=!1,w(I),I=-1),g=!0;var o=f;try{t:{for(C(e),d=r(l);null!==d&&!(d.expirationTime>e&&E());){var s=d.callback;if("function"===typeof s){d.callback=null,f=d.priorityLevel;var a=s(d.expirationTime<=e);if(e=t.unstable_now(),"function"===typeof a){d.callback=a,C(e),n=!0;break t}d===r(l)&&i(l),C(e)}else i(l);d=r(l)}if(null!==d)n=!0;else{var c=r(u);null!==c&&O(k,c.startTime-e),n=!1}}break e}finally{d=null,f=o,g=!1}n=void 0}}finally{n?S():T=!1}}}if("function"===typeof b)S=function(){b(P)};else if("undefined"!==typeof MessageChannel){var R=new MessageChannel,N=R.port2;R.port1.onmessage=P,S=function(){N.postMessage(null)}}else S=function(){v(P,0)};function O(e,n){I=v(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_requestPaint=function(){y=!0},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,i,o){var s=t.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?s+o:s:o=s,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:h++,callback:i,priorityLevel:e,startTime:o,expirationTime:a=o+a,sortIndex:-1},o>s?(e.sortIndex=o,n(u,e),null===r(l)&&e===r(u)&&(m?(w(I),I=-1):m=!0,O(k,o-s))):(e.sortIndex=a,n(l,e),p||g||(p=!0,T||(T=!0,S()))),e},t.unstable_shouldYield=E,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},950:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(672)}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.m=e,n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce((t,r)=>(n.f[r](e,t),t),[])),n.u=e=>"static/js/"+e+".ba65950f.chunk.js",n.miniCssF=e=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="pangram-cos-350:";n.l=(r,i,o,s)=>{if(e[r])e[r].push(i);else{var a,c;if(void 0!==o)for(var l=document.getElementsByTagName("script"),u=0;u<l.length;u++){var h=l[u];if(h.getAttribute("src")==r||h.getAttribute("data-webpack")==t+o){a=h;break}}a||(c=!0,(a=document.createElement("script")).charset="utf-8",n.nc&&a.setAttribute("nonce",n.nc),a.setAttribute("data-webpack",t+o),a.src=r),e[r]=[i];var d=(t,n)=>{a.onerror=a.onload=null,clearTimeout(f);var i=e[r];if(delete e[r],a.parentNode&&a.parentNode.removeChild(a),i&&i.forEach(e=>e(n)),t)return t(n)},f=setTimeout(d.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=d.bind(null,a.onerror),a.onload=d.bind(null,a.onload),c&&document.head.appendChild(a)}}})(),n.p="/",(()=>{var e={792:0};n.f.j=(t,r)=>{var i=n.o(e,t)?e[t]:void 0;if(0!==i)if(i)r.push(i[2]);else{var o=new Promise((n,r)=>i=e[t]=[n,r]);r.push(i[2]=o);var s=n.p+n.u(t),a=new Error;n.l(s,r=>{if(n.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var o=r&&("load"===r.type?"missing":r.type),s=r&&r.target&&r.target.src;a.message="Loading chunk "+t+" failed.\n("+o+": "+s+")",a.name="ChunkLoadError",a.type=o,a.request=s,i[1](a)}},"chunk-"+t,t)}};var t=(t,r)=>{var i,o,[s,a,c]=r,l=0;if(s.some(t=>0!==e[t])){for(i in a)n.o(a,i)&&(n.m[i]=a[i]);if(c)c(n)}for(t&&t(r);l<s.length;l++)o=s[l],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0},r=self.webpackChunkpangram_cos_350=self.webpackChunkpangram_cos_350||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var r=n(43),i=n(391);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function s(e){var t=function(e,t){if("object"!=o(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==o(t)?t:t+""}function a(e,t,n){return(t=s(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach(function(t){a(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}const u=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},h={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<e.length;i+=3){const t=e[i],o=i+1<e.length,s=o?e[i+1]:0,a=i+2<e.length,c=a?e[i+2]:0,l=t>>2,u=(3&t)<<4|s>>4;let h=(15&s)<<2|c>>6,d=63&c;a||(d=64,o||(h=64)),r.push(n[l],n[u],n[h],n[d])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(u(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const o=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){const o=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(o>>10)),t[r++]=String.fromCharCode(56320+(1023&o))}else{const o=e[n++],s=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<e.length;){const t=n[e.charAt(i++)],o=i<e.length?n[e.charAt(i)]:0;++i;const s=i<e.length?n[e.charAt(i)]:64;++i;const a=i<e.length?n[e.charAt(i)]:64;if(++i,null==t||null==o||null==s||null==a)throw new d;const c=t<<2|o>>4;if(r.push(c),64!==s){const e=o<<4&240|s>>2;if(r.push(e),64!==a){const e=s<<6&192|a;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class d extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const f=function(e){return function(e){const t=u(e);return h.encodeByteArray(t,!0)}(e).replace(/\./g,"")},g=function(e){try{return h.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function p(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}const m=()=>{try{return p().__FIREBASE_DEFAULTS__||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_PANGRAM_API_KEY:"9fef1204-68dd-4f5d-880c-04b1a33a7cb3",REACT_APP_API_BASE_URL:"https://us-central1-pangram-tolu.cloudfunctions.net/app",REACT_APP_LOGIN_IDS:"ta3928,aa6604,sa1535,ca4655,au_CharlotteAredal,ta6754,jb7936,db9599,xb4719,rb5709,lc2583,ac9406,kc0233,janeec,lc0110,mc2971,pc6487,jc4120,au_gabychoucrallah,au_alancohen,bd0855,hd0216,au_rogerdreher,td5828,au_JenniferFeddern,au_TamaraFranklin,sg4509,yg4888,rg0200,jh3315,eh1994,au_ShariHellman,eh5775,kh8407,dh3163,aj6117,jj9832,au_RituKhandelwal,korolova,dl3780,au_AlanLieberman,cl3125,al3544,pl3522,tl5559,el4923,km5839,km8443,fm8564,pn0346,arvindn,rn8333,to6377,to4203,vp9508,dp9798,dp0782,dr1547,kr5379,ar6078,jr0664,ss6363,es8155,ls0757,as6915,ms3554,js2261,rs9856,ct9762,ht1756,ov8142,aw3483,lw3501,au_watrous,bw6931,au_stevenweiss,kw8166,sw4021,jw7893,ay3776,dy5251,my4652,dy1418,arzeng,bz5989,jz4391",REACT_APP_MAX_WORDS:"1001",REACT_APP_MAX_USAGE:"40",REACT_APP_FIREBASE_API_KEY:"AIzaSyBNcE_KHhQd-7kiOSw5f8-uBWT2ci5B0HU",REACT_APP_FIREBASE_AUTH_DOMAIN:"pangram-tolu.firebaseapp.com",REACT_APP_FIREBASE_PROJECT_ID:"pangram-tolu",REACT_APP_FIREBASE_STORAGE_BUCKET:"pangram-tolu.firebasestorage.app",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"501572215138",REACT_APP_FIREBASE_APP_ID:"1:501572215138:web:31c8d183dccd93520b4c3b",REACT_APP_FIREBASE_MEASUREMENT_ID:"G-SZF1NVTZ7B",REACT_APP_FIREBASE_FIRESTORE_COLLECTION:"usage",REACT_APP_ALERT_EMAILS:"to6377@princeton.edu,janeec@princeton.edu,patty.liu@princeton.edu,kincaid@princeton.edu,korolova@princeton.edu,arvindn@cs.princeton.edu",REACT_APP_ALERT_THRESHOLD:"1000",REACT_APP_ALERT_STEP:"100",REACT_APP_AZURE_CLIENT_ID:"95003701-76d5-48e0-aed6-c65c429356bd",REACT_APP_AZURE_TENANT_ID:"2ff60116-7431-425d-b5af-077d7791bda4",REACT_APP_AZURE_REDIRECT_URI:"https://cos350pangram.princetonhci.social/"}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const t=e&&g(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(e))}},y=e=>{const t=(e=>{var t;return null===(t=m())||void 0===t||null===(t=t.emulatorHosts)||void 0===t?void 0:t[e]})(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error("Invalid host ".concat(t," with no separate hostname and port!"));const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]},v=()=>{var e;return null===(e=m())||void 0===e?void 0:e.config};class w{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}function b(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch(t){return!1}}const C={};let k=!1;function S(e,t){if("undefined"===typeof window||"undefined"===typeof document||!b(window.location.host)||C[e]===t||C[e]||k)return;function n(e){return"__firebase__banner__".concat(e)}C[e]=t;const r="__firebase__banner",i=function(){const e={prod:[],emulator:[]};for(const t of Object.keys(C))C[t]?e.emulator.push(t):e.prod.push(t);return e}().prod.length>0;function o(){const e=document.createElement("span");return e.style.cursor="pointer",e.style.marginLeft="16px",e.style.fontSize="24px",e.innerHTML=" &times;",e.onclick=()=>{k=!0,function(){const e=document.getElementById(r);e&&e.remove()}()},e}function s(){const e=function(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),n=!0),{created:n,element:t}}(r),t=n("text"),s=document.getElementById(t)||document.createElement("span"),a=n("learnmore"),c=document.getElementById(a)||document.createElement("a"),l=n("preprendIcon"),u=document.getElementById(l)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(e.created){const t=e.element;!function(e){e.style.display="flex",e.style.background="#7faaf0",e.style.position="fixed",e.style.bottom="5px",e.style.left="5px",e.style.padding=".5em",e.style.borderRadius="5px",e.style.alignItems="center"}(t),function(e,t){e.setAttribute("id",t),e.innerText="Learn more",e.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",e.setAttribute("target","__blank"),e.style.paddingLeft="5px",e.style.textDecoration="underline"}(c,a);const n=o();!function(e,t){e.setAttribute("width","24"),e.setAttribute("id",t),e.setAttribute("height","24"),e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("fill","none"),e.style.marginLeft="-6px"}(u,l),t.append(u,s,c,n),document.body.appendChild(t)}i?(s.innerText="Preview backend disconnected.",u.innerHTML='<g clip-path="url(#clip0_6013_33858)">\n<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6013_33858">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>'):(u.innerHTML='<g clip-path="url(#clip0_6083_34804)">\n<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6083_34804">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>',s.innerText="Preview backend running in this workspace."),s.setAttribute("id",t)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",s):s()}function T(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function I(){var e;const t=null===(e=m())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(r){return!1}}function _(){return!I()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function A(){try{return"object"===typeof indexedDB}catch(e){return!1}}class E extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,E.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,P.prototype.create)}}class P{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],i=r?function(e,t){return e.replace(R,(e,n)=>{const r=t[n];return null!=r?String(r):"<".concat(n,"?>")})}(r,t):"Error",o="".concat(this.serviceName,": ").concat(i," (").concat(n,").");return new E(n,o,t)}}const R=/\{\$([^}]+)}/g;function N(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],o=t[i];if(O(n)&&O(o)){if(!N(n,o))return!1}else if(n!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function O(e){return null!==e&&"object"===typeof e}function M(e){return e&&e._delegate?e._delegate:e}class x{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const D="[DEFAULT]";class L{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new w;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(n){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:D})}catch(t){}for(const[e,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:r});n.resolve(e)}catch(t){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error("".concat(this.name,"(").concat(n,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[i,o]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(i)&&o.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const o=this.instances.get(r);return o&&e(o,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch(r){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===D?void 0:i),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch(o){}var i;return r||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D;return this.component?this.component.multipleInstances?e:D:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class F{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new L(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const q=[];var U;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(U||(U={}));const z={debug:U.DEBUG,verbose:U.VERBOSE,info:U.INFO,warn:U.WARN,error:U.ERROR,silent:U.SILENT},B=U.INFO,H={[U.DEBUG]:"log",[U.VERBOSE]:"log",[U.INFO]:"info",[U.WARN]:"warn",[U.ERROR]:"error"},V=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),r=H[t];if(!r)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var i=arguments.length,o=new Array(i>2?i-2:0),s=2;s<i;s++)o[s-2]=arguments[s];console[r]("[".concat(n,"]  ").concat(e.name,":"),...o)};class j{constructor(e){this.name=e,this._logLevel=B,this._logHandler=V,this._userLogHandler=null,q.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in U))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?z[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,U.DEBUG,...t),this._logHandler(this,U.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,U.VERBOSE,...t),this._logHandler(this,U.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,U.INFO,...t),this._logHandler(this,U.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,U.WARN,...t),this._logHandler(this,U.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,U.ERROR,...t),this._logHandler(this,U.ERROR,...t)}}let K,G;const Q=new WeakMap,W=new WeakMap,Y=new WeakMap,J=new WeakMap,X=new WeakMap;let $={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return W.get(e);if("objectStoreNames"===t)return e.objectStoreNames||Y.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return te(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function Z(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(G||(G=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(ne(this),n),te(Q.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return te(e.apply(ne(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const o=e.call(ne(this),t,...r);return Y.set(o,t.sort?t.sort():[t]),te(o)}}function ee(e){return"function"===typeof e?Z(e):(e instanceof IDBTransaction&&function(e){if(W.has(e))return;const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",o),e.removeEventListener("abort",o)},i=()=>{t(),r()},o=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",o),e.addEventListener("abort",o)});W.set(e,t)}(e),t=e,(K||(K=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(e=>t instanceof e)?new Proxy(e,$):e);var t}function te(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",o)},i=()=>{t(te(e.result)),r()},o=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",o)});return t.then(t=>{t instanceof IDBCursor&&Q.set(t,e)}).catch(()=>{}),X.set(t,e),t}(e);if(J.has(e))return J.get(e);const t=ee(e);return t!==e&&(J.set(e,t),X.set(t,e)),t}const ne=e=>X.get(e);const re=["get","getKey","getAll","getAllKeys","count"],ie=["put","add","delete","clear"],oe=new Map;function se(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(oe.get(t))return oe.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=ie.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!re.includes(n))return;const o=async function(e){const t=this.transaction(e,i?"readwrite":"readonly");let o=t.store;for(var s=arguments.length,a=new Array(s>1?s-1:0),c=1;c<s;c++)a[c-1]=arguments[c];return r&&(o=o.index(a.shift())),(await Promise.all([o[n](...a),i&&t.done]))[0]};return oe.set(t,o),o}$=(e=>l(l({},e),{},{get:(t,n,r)=>se(t,n)||e.get(t,n,r),has:(t,n)=>!!se(t,n)||e.has(t,n)}))($);class ae{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null}).filter(e=>e).join(" ")}}const ce="@firebase/app",le="0.14.6",ue=new j("@firebase/app"),he="@firebase/app-compat",de="@firebase/analytics-compat",fe="@firebase/analytics",ge="@firebase/app-check-compat",pe="@firebase/app-check",me="@firebase/auth",ye="@firebase/auth-compat",ve="@firebase/database",we="@firebase/data-connect",be="@firebase/database-compat",Ce="@firebase/functions",ke="@firebase/functions-compat",Se="@firebase/installations",Te="@firebase/installations-compat",Ie="@firebase/messaging",_e="@firebase/messaging-compat",Ae="@firebase/performance",Ee="@firebase/performance-compat",Pe="@firebase/remote-config",Re="@firebase/remote-config-compat",Ne="@firebase/storage",Oe="@firebase/storage-compat",Me="@firebase/firestore",xe="@firebase/ai",De="@firebase/firestore-compat",Le="firebase",Fe="[DEFAULT]",qe={[ce]:"fire-core",[he]:"fire-core-compat",[fe]:"fire-analytics",[de]:"fire-analytics-compat",[pe]:"fire-app-check",[ge]:"fire-app-check-compat",[me]:"fire-auth",[ye]:"fire-auth-compat",[ve]:"fire-rtdb",[we]:"fire-data-connect",[be]:"fire-rtdb-compat",[Ce]:"fire-fn",[ke]:"fire-fn-compat",[Se]:"fire-iid",[Te]:"fire-iid-compat",[Ie]:"fire-fcm",[_e]:"fire-fcm-compat",[Ae]:"fire-perf",[Ee]:"fire-perf-compat",[Pe]:"fire-rc",[Re]:"fire-rc-compat",[Ne]:"fire-gcs",[Oe]:"fire-gcs-compat",[Me]:"fire-fst",[De]:"fire-fst-compat",[xe]:"fire-vertex","fire-js":"fire-js",[Le]:"fire-js-all"},Ue=new Map,ze=new Map,Be=new Map;function He(e,t){try{e.container.addComponent(t)}catch(n){ue.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function Ve(e){const t=e.name;if(Be.has(t))return ue.debug("There were multiple attempts to register component ".concat(t,".")),!1;Be.set(t,e);for(const n of Ue.values())He(n,e);for(const n of ze.values())He(n,e);return!0}function je(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}const Ke=new P("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class Ge{constructor(e,t,n){this._isDeleted=!1,this._options=l({},e),this._config=l({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new x("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ke.create("app-deleted",{appName:this._name})}}function Qe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const r=l({name:Fe,automaticDataCollectionEnabled:!0},t),i=r.name;if("string"!==typeof i||!i)throw Ke.create("bad-app-name",{appName:String(i)});if(n||(n=v()),!n)throw Ke.create("no-options");const o=Ue.get(i);if(o){if(N(n,o.options)&&N(r,o.config))return o;throw Ke.create("duplicate-app",{appName:i})}const s=new F(i);for(const c of Be.values())s.addComponent(c);const a=new Ge(n,r,s);return Ue.set(i,a),a}function We(e,t,n){var r;let i=null!==(r=qe[e])&&void 0!==r?r:e;n&&(i+="-".concat(n));const o=i.match(/\s|\//),s=t.match(/\s|\//);if(o||s){const e=['Unable to register library "'.concat(i,'" with version "').concat(t,'":')];return o&&e.push('library name "'.concat(i,'" contains illegal characters (whitespace or "/")')),o&&s&&e.push("and"),s&&e.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void ue.warn(e.join(" "))}Ve(new x("".concat(i,"-version"),()=>({library:i,version:t}),"VERSION"))}const Ye="firebase-heartbeat-store";let Je=null;function Xe(){return Je||(Je=function(e,t){let{blocked:n,upgrade:r,blocking:i,terminated:o}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const s=indexedDB.open(e,t),a=te(s);return r&&s.addEventListener("upgradeneeded",e=>{r(te(s.result),e.oldVersion,e.newVersion,te(s.transaction),e)}),n&&s.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),a.then(e=>{o&&e.addEventListener("close",()=>o()),i&&e.addEventListener("versionchange",e=>i(e.oldVersion,e.newVersion,e))}).catch(()=>{}),a}("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(Ye)}catch(n){console.warn(n)}}}).catch(e=>{throw Ke.create("idb-open",{originalErrorMessage:e.message})})),Je}async function $e(e,t){try{const n=(await Xe()).transaction(Ye,"readwrite"),r=n.objectStore(Ye);await r.put(t,Ze(e)),await n.done}catch(n){if(n instanceof E)ue.warn(n.message);else{const e=Ke.create("idb-set",{originalErrorMessage:null===n||void 0===n?void 0:n.message});ue.warn(e.message)}}}function Ze(e){return"".concat(e.name,"!").concat(e.options.appId)}class et{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new nt(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){try{var e;const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=tt();var t;if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats))if(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats))return;if(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(e=>e.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats.length>30){const e=function(e){if(0===e.length)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){ue.warn(n)}}async getHeartbeatsHeader(){try{var e;if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=tt(),{heartbeatsToSend:n,unsentEntries:r}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=e.slice();for(const i of e){const e=n.find(e=>e.agent===i.agent);if(e){if(e.dates.push(i.date),rt(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),rt(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),i=f(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return ue.warn(t),""}}}function tt(){return(new Date).toISOString().substring(0,10)}class nt{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!A()&&new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}}).then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await Xe()).transaction(Ye),n=await t.objectStore(Ye).get(Ze(e));return await t.done,n}catch(t){if(t instanceof E)ue.warn(t.message);else{const e=Ke.create("idb-get",{originalErrorMessage:null===t||void 0===t?void 0:t.message});ue.warn(e.message)}}}(this.app);return null!==e&&void 0!==e&&e.heartbeats?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){var t;const n=await this.read();return $e(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){if(await this._canUseIndexedDBPromise){var t;const n=await this.read();return $e(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function rt(e){return f(JSON.stringify({version:2,heartbeats:e})).length}var it;it="",Ve(new x("platform-logger",e=>new ae(e),"PRIVATE")),Ve(new x("heartbeat",e=>new et(e),"PRIVATE")),We(ce,le,it),We(ce,le,"esm2020"),We("fire-js","");var ot,st,at="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:{},ct={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}function n(e,t,n){n||(n=0);const r=Array(16);if("string"===typeof t)for(var i=0;i<16;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;i<16;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];let o,s=e.g[3];o=t+(s^n&(i^s))+r[0]+3614090360&4294967295,o=s+(i^(t=n+(o<<7&4294967295|o>>>25))&(n^i))+r[1]+3905402710&4294967295,s=t+(o<<12&4294967295|o>>>20),o=i+(n^s&(t^n))+r[2]+606105819&4294967295,o=n+(t^(i=s+(o<<17&4294967295|o>>>15))&(s^t))+r[3]+3250441966&4294967295,o=t+(s^(n=i+(o<<22&4294967295|o>>>10))&(i^s))+r[4]+4118548399&4294967295,o=s+(i^(t=n+(o<<7&4294967295|o>>>25))&(n^i))+r[5]+1200080426&4294967295,s=t+(o<<12&4294967295|o>>>20),o=i+(n^s&(t^n))+r[6]+2821735955&4294967295,o=n+(t^(i=s+(o<<17&4294967295|o>>>15))&(s^t))+r[7]+4249261313&4294967295,o=t+(s^(n=i+(o<<22&4294967295|o>>>10))&(i^s))+r[8]+1770035416&4294967295,o=s+(i^(t=n+(o<<7&4294967295|o>>>25))&(n^i))+r[9]+2336552879&4294967295,s=t+(o<<12&4294967295|o>>>20),o=i+(n^s&(t^n))+r[10]+4294925233&4294967295,o=n+(t^(i=s+(o<<17&4294967295|o>>>15))&(s^t))+r[11]+2304563134&4294967295,o=t+(s^(n=i+(o<<22&4294967295|o>>>10))&(i^s))+r[12]+1804603682&4294967295,o=s+(i^(t=n+(o<<7&4294967295|o>>>25))&(n^i))+r[13]+4254626195&4294967295,s=t+(o<<12&4294967295|o>>>20),o=i+(n^s&(t^n))+r[14]+2792965006&4294967295,o=n+(t^(i=s+(o<<17&4294967295|o>>>15))&(s^t))+r[15]+1236535329&4294967295,o=t+(i^s&((n=i+(o<<22&4294967295|o>>>10))^i))+r[1]+4129170786&4294967295,o=s+(n^i&((t=n+(o<<5&4294967295|o>>>27))^n))+r[6]+3225465664&4294967295,s=t+(o<<9&4294967295|o>>>23),o=i+(t^n&(s^t))+r[11]+643717713&4294967295,o=n+(s^t&((i=s+(o<<14&4294967295|o>>>18))^s))+r[0]+3921069994&4294967295,o=t+(i^s&((n=i+(o<<20&4294967295|o>>>12))^i))+r[5]+3593408605&4294967295,o=s+(n^i&((t=n+(o<<5&4294967295|o>>>27))^n))+r[10]+38016083&4294967295,s=t+(o<<9&4294967295|o>>>23),o=i+(t^n&(s^t))+r[15]+3634488961&4294967295,o=n+(s^t&((i=s+(o<<14&4294967295|o>>>18))^s))+r[4]+3889429448&4294967295,o=t+(i^s&((n=i+(o<<20&4294967295|o>>>12))^i))+r[9]+568446438&4294967295,o=s+(n^i&((t=n+(o<<5&4294967295|o>>>27))^n))+r[14]+3275163606&4294967295,s=t+(o<<9&4294967295|o>>>23),o=i+(t^n&(s^t))+r[3]+4107603335&4294967295,o=n+(s^t&((i=s+(o<<14&4294967295|o>>>18))^s))+r[8]+1163531501&4294967295,o=t+(i^s&((n=i+(o<<20&4294967295|o>>>12))^i))+r[13]+2850285829&4294967295,o=s+(n^i&((t=n+(o<<5&4294967295|o>>>27))^n))+r[2]+4243563512&4294967295,s=t+(o<<9&4294967295|o>>>23),o=i+(t^n&(s^t))+r[7]+1735328473&4294967295,o=n+(s^t&((i=s+(o<<14&4294967295|o>>>18))^s))+r[12]+2368359562&4294967295,o=t+((n=i+(o<<20&4294967295|o>>>12))^i^s)+r[5]+4294588738&4294967295,o=s+((t=n+(o<<4&4294967295|o>>>28))^n^i)+r[8]+2272392833&4294967295,s=t+(o<<11&4294967295|o>>>21),o=i+(s^t^n)+r[11]+1839030562&4294967295,o=n+((i=s+(o<<16&4294967295|o>>>16))^s^t)+r[14]+4259657740&4294967295,o=t+((n=i+(o<<23&4294967295|o>>>9))^i^s)+r[1]+2763975236&4294967295,o=s+((t=n+(o<<4&4294967295|o>>>28))^n^i)+r[4]+1272893353&4294967295,s=t+(o<<11&4294967295|o>>>21),o=i+(s^t^n)+r[7]+4139469664&4294967295,o=n+((i=s+(o<<16&4294967295|o>>>16))^s^t)+r[10]+3200236656&4294967295,o=t+((n=i+(o<<23&4294967295|o>>>9))^i^s)+r[13]+681279174&4294967295,o=s+((t=n+(o<<4&4294967295|o>>>28))^n^i)+r[0]+3936430074&4294967295,s=t+(o<<11&4294967295|o>>>21),o=i+(s^t^n)+r[3]+3572445317&4294967295,o=n+((i=s+(o<<16&4294967295|o>>>16))^s^t)+r[6]+76029189&4294967295,o=t+((n=i+(o<<23&4294967295|o>>>9))^i^s)+r[9]+3654602809&4294967295,o=s+((t=n+(o<<4&4294967295|o>>>28))^n^i)+r[12]+3873151461&4294967295,s=t+(o<<11&4294967295|o>>>21),o=i+(s^t^n)+r[15]+530742520&4294967295,o=n+((i=s+(o<<16&4294967295|o>>>16))^s^t)+r[2]+3299628645&4294967295,o=t+(i^((n=i+(o<<23&4294967295|o>>>9))|~s))+r[0]+4096336452&4294967295,o=s+(n^((t=n+(o<<6&4294967295|o>>>26))|~i))+r[7]+1126891415&4294967295,s=t+(o<<10&4294967295|o>>>22),o=i+(t^(s|~n))+r[14]+2878612391&4294967295,o=n+(s^((i=s+(o<<15&4294967295|o>>>17))|~t))+r[5]+4237533241&4294967295,o=t+(i^((n=i+(o<<21&4294967295|o>>>11))|~s))+r[12]+1700485571&4294967295,o=s+(n^((t=n+(o<<6&4294967295|o>>>26))|~i))+r[3]+2399980690&4294967295,s=t+(o<<10&4294967295|o>>>22),o=i+(t^(s|~n))+r[10]+4293915773&4294967295,o=n+(s^((i=s+(o<<15&4294967295|o>>>17))|~t))+r[1]+2240044497&4294967295,o=t+(i^((n=i+(o<<21&4294967295|o>>>11))|~s))+r[8]+1873313359&4294967295,o=s+(n^((t=n+(o<<6&4294967295|o>>>26))|~i))+r[15]+4264355552&4294967295,s=t+(o<<10&4294967295|o>>>22),o=i+(t^(s|~n))+r[6]+2734768916&4294967295,o=n+(s^((i=s+(o<<15&4294967295|o>>>17))|~t))+r[13]+1309151649&4294967295,o=t+(i^((n=i+(o<<21&4294967295|o>>>11))|~s))+r[4]+4149444226&4294967295,o=s+(n^((t=n+(o<<6&4294967295|o>>>26))|~i))+r[11]+3174756917&4294967295,s=t+(o<<10&4294967295|o>>>22),o=i+(t^(s|~n))+r[2]+718787259&4294967295,o=n+(s^((i=s+(o<<15&4294967295|o>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+s&4294967295}function r(e,t){this.h=t;const n=[];let r=!0;for(let i=e.length-1;i>=0;i--){const o=0|e[i];r&&o==t||(n[i]=o,r=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.F=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.D=function(e,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return t.prototype[n].apply(e,i)}}(t,function(){this.blockSize=-1}),t.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.v=function(e,t){void 0===t&&(t=e.length);const r=t-this.blockSize,i=this.C;let o=this.h,s=0;for(;s<t;){if(0==o)for(;s<=r;)n(this,e,s),s+=this.blockSize;if("string"===typeof e){for(;s<t;)if(i[o++]=e.charCodeAt(s++),o==this.blockSize){n(this,i),o=0;break}}else for(;s<t;)if(i[o++]=e[s++],o==this.blockSize){n(this,i),o=0;break}}this.h=o,this.o+=t},t.prototype.A=function(){var e=Array((this.h<56?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;t=8*this.o;for(var n=e.length-8;n<e.length;++n)e[n]=255&t,t/=256;for(this.v(e),e=Array(16),t=0,n=0;n<4;++n)for(let r=0;r<32;r+=8)e[t++]=this.g[n]>>>r&255;return e};var i={};function o(e){return-128<=e&&e<128?function(e,t){var n=i;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,function(e){return new r([0|e],e<0?-1:0)}):new r([0|e],e<0?-1:0)}function s(e){if(isNaN(e)||!isFinite(e))return a;if(e<0)return d(s(-e));const t=[];let n=1;for(let r=0;e>=n;r++)t[r]=e/n|0,n*=4294967296;return new r(t,0)}var a=o(0),c=o(1),l=o(16777216);function u(e){if(0!=e.h)return!1;for(let t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function h(e){return-1==e.h}function d(e){const t=e.g.length,n=[];for(let r=0;r<t;r++)n[r]=~e.g[r];return new r(n,~e.h).add(c)}function f(e,t){return e.add(d(t))}function g(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function p(e,t){this.g=e,this.h=t}function m(e,t){if(u(t))throw Error("division by zero");if(u(e))return new p(a,a);if(h(e))return t=m(d(e),t),new p(d(t.g),d(t.h));if(h(t))return t=m(e,d(t)),new p(d(t.g),t.h);if(e.g.length>30){if(h(e)||h(t))throw Error("slowDivide_ only works with positive integers.");for(var n=c,r=t;r.l(e)<=0;)n=y(n),r=y(r);var i=v(n,1),o=v(r,1);for(r=v(r,2),n=v(n,2);!u(r);){var l=o.add(r);l.l(e)<=0&&(i=i.add(n),o=l),r=v(r,1),n=v(n,1)}return t=f(e,i.j(t)),new p(i,t)}for(i=a;e.l(t)>=0;){for(n=Math.max(1,Math.floor(e.m()/t.m())),r=(r=Math.ceil(Math.log(n)/Math.LN2))<=48?1:Math.pow(2,r-48),l=(o=s(n)).j(t);h(l)||l.l(e)>0;)l=(o=s(n-=r)).j(t);u(o)&&(o=c),i=i.add(o),e=f(e,l)}return new p(i,e)}function y(e){const t=e.g.length+1,n=[];for(let r=0;r<t;r++)n[r]=e.i(r)<<1|e.i(r-1)>>>31;return new r(n,e.h)}function v(e,t){const n=t>>5;t%=32;const i=e.g.length-n,o=[];for(let r=0;r<i;r++)o[r]=t>0?e.i(r+n)>>>t|e.i(r+n+1)<<32-t:e.i(r+n);return new r(o,e.h)}(e=r.prototype).m=function(){if(h(this))return-d(this).m();let e=0,t=1;for(let n=0;n<this.g.length;n++){const r=this.i(n);e+=(r>=0?r:4294967296+r)*t,t*=4294967296}return e},e.toString=function(e){if((e=e||10)<2||36<e)throw Error("radix out of range: "+e);if(u(this))return"0";if(h(this))return"-"+d(this).toString(e);const t=s(Math.pow(e,6));var n=this;let r="";for(;;){const i=m(n,t).g;let o=(((n=f(n,i.j(t))).g.length>0?n.g[0]:n.h)>>>0).toString(e);if(u(n=i))return o+r;for(;o.length<6;)o="0"+o;r=o+r}},e.i=function(e){return e<0?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return h(e=f(this,e))?-1:u(e)?0:1},e.abs=function(){return h(this)?d(this):this},e.add=function(e){const t=Math.max(this.g.length,e.g.length),n=[];let i=0;for(let r=0;r<=t;r++){let t=i+(65535&this.i(r))+(65535&e.i(r)),o=(t>>>16)+(this.i(r)>>>16)+(e.i(r)>>>16);i=o>>>16,t&=65535,o&=65535,n[r]=o<<16|t}return new r(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(u(this)||u(e))return a;if(h(this))return h(e)?d(this).j(d(e)):d(d(this).j(e));if(h(e))return d(this.j(d(e)));if(this.l(l)<0&&e.l(l)<0)return s(this.m()*e.m());const t=this.g.length+e.g.length,n=[];for(var i=0;i<2*t;i++)n[i]=0;for(i=0;i<this.g.length;i++)for(let t=0;t<e.g.length;t++){const r=this.i(i)>>>16,o=65535&this.i(i),s=e.i(t)>>>16,a=65535&e.i(t);n[2*i+2*t]+=o*a,g(n,2*i+2*t),n[2*i+2*t+1]+=r*a,g(n,2*i+2*t+1),n[2*i+2*t+1]+=o*s,g(n,2*i+2*t+1),n[2*i+2*t+2]+=r*s,g(n,2*i+2*t+2)}for(e=0;e<t;e++)n[e]=n[2*e+1]<<16|n[2*e];for(e=t;e<2*t;e++)n[e]=0;return new r(n,0)},e.B=function(e){return m(this,e).h},e.and=function(e){const t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)&e.i(r);return new r(n,this.h&e.h)},e.or=function(e){const t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)|e.i(r);return new r(n,this.h|e.h)},e.xor=function(e){const t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)^e.i(r);return new r(n,this.h^e.h)},t.prototype.digest=t.prototype.A,t.prototype.reset=t.prototype.u,t.prototype.update=t.prototype.v,st=ct.Md5=t,r.prototype.add=r.prototype.add,r.prototype.multiply=r.prototype.j,r.prototype.modulo=r.prototype.B,r.prototype.compare=r.prototype.l,r.prototype.toNumber=r.prototype.m,r.prototype.toString=r.prototype.toString,r.prototype.getBits=r.prototype.i,r.fromNumber=s,r.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if((n=n||10)<2||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return d(e(t.substring(1),n));if(t.indexOf("-")>=0)throw Error('number format error: interior "-" character');const r=s(Math.pow(n,8));let i=a;for(let a=0;a<t.length;a+=8){var o=Math.min(8,t.length-a);const e=parseInt(t.substring(a,a+o),n);o<8?(o=s(Math.pow(n,o)),i=i.j(o).add(s(e))):(i=i.j(r),i=i.add(s(e)))}return i},ot=ct.Integer=r}).apply("undefined"!==typeof at?at:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});var lt,ut,ht,dt,ft,gt,pt,mt,yt="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:{},vt={};(function(){var e,t=Object.defineProperty;var n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof yt&&yt];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);function r(e,r){if(r)e:{var i=n;e=e.split(".");for(var o=0;o<e.length-1;o++){var s=e[o];if(!(s in i))break e;i=i[s]}(r=r(o=i[e=e[e.length-1]]))!=o&&null!=r&&t(i,e,{configurable:!0,writable:!0,value:r})}}r("Symbol.dispose",function(e){return e||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(e){return e||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(e){return e||function(e){var t,n=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.push([t,e[t]]);return n}});var i=i||{},o=this||self;function s(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function a(e,t,n){return e.call.apply(e.bind,arguments)}function c(e,t,n){return(c=a).apply(null,arguments)}function l(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function u(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Ob=function(e,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return t.prototype[n].apply(e,i)}}var h="undefined"!==typeof AsyncContext&&"function"===typeof AsyncContext.Snapshot?e=>e&&AsyncContext.Snapshot.wrap(e):e=>e;function d(e){const t=e.length;if(t>0){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function f(e,t){for(let r=1;r<arguments.length;r++){const t=arguments[r];var n=typeof t;if("array"==(n="object"!=n?n:t?Array.isArray(t)?"array":n:"null")||"object"==n&&"number"==typeof t.length){n=e.length||0;const r=t.length||0;e.length=n+r;for(let i=0;i<r;i++)e[n+i]=t[i]}else e.push(t)}}function g(e){o.setTimeout(()=>{throw e},0)}function p(){var e=b;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var m=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return this.h>0?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new y,e=>e.reset());class y{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let v,w=!1,b=new class{constructor(){this.h=this.g=null}add(e,t){const n=m.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},C=()=>{const e=Promise.resolve(void 0);v=()=>{e.then(k)}};function k(){for(var e;e=p();){try{e.h.call(e.g)}catch(n){g(n)}var t=m;t.j(e),t.h<100&&(t.h++,e.next=t.g,t.g=e)}w=!1}function S(){this.u=this.u,this.C=this.C}function T(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}S.prototype.u=!1,S.prototype.dispose=function(){this.u||(this.u=!0,this.N())},S.prototype[Symbol.dispose]=function(){this.dispose()},S.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},T.prototype.h=function(){this.defaultPrevented=!0};var I=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};o.addEventListener("test",e,t),o.removeEventListener("test",e,t)}catch(n){}return e}();function _(e){return/^[\s\xa0]*$/.test(e)}function A(e,t){T.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e&&this.init(e,t)}u(A,T),A.prototype.init=function(e,t){const n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;this.target=e.target||e.srcElement,this.g=t,(t=e.relatedTarget)||("mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement)),this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=e.pointerType,this.state=e.state,this.i=e,e.defaultPrevented&&A.Z.h.call(this)},A.prototype.h=function(){A.Z.h.call(this);const e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var E="closure_listenable_"+(1e6*Math.random()|0),P=0;function R(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=i,this.key=++P,this.da=this.fa=!1}function N(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function O(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function M(e){const t={};for(const n in e)t[n]=e[n];return t}const x="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function D(e,t){let n,r;for(let i=1;i<arguments.length;i++){for(n in r=arguments[i],r)e[n]=r[n];for(let t=0;t<x.length;t++)n=x[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function L(e){this.src=e,this.g={},this.h=0}function F(e,t){const n=t.type;if(n in e.g){var r,i=e.g[n],o=Array.prototype.indexOf.call(i,t,void 0);(r=o>=0)&&Array.prototype.splice.call(i,o,1),r&&(N(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function q(e,t,n,r){for(let i=0;i<e.length;++i){const o=e[i];if(!o.da&&o.listener==t&&o.capture==!!n&&o.ha==r)return i}return-1}L.prototype.add=function(e,t,n,r,i){const o=e.toString();(e=this.g[o])||(e=this.g[o]=[],this.h++);const s=q(e,t,r,i);return s>-1?(t=e[s],n||(t.fa=!1)):((t=new R(t,this.src,o,!!r,i)).fa=n,e.push(t)),t};var U="closure_lm_"+(1e6*Math.random()|0),z={};function B(e,t,n,r,i){if(r&&r.once)return V(e,t,n,r,i);if(Array.isArray(t)){for(let o=0;o<t.length;o++)B(e,t[o],n,r,i);return null}return n=J(n),e&&e[E]?e.J(t,n,s(r)?!!r.capture:!!r,i):H(e,t,n,!1,r,i)}function H(e,t,n,r,i,o){if(!t)throw Error("Invalid event type");const a=s(i)?!!i.capture:!!i;let c=W(e);if(c||(e[U]=c=new L(e)),(n=c.add(t,n,r,a,o)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=Q;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)I||(i=a),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(G(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function V(e,t,n,r,i){if(Array.isArray(t)){for(let o=0;o<t.length;o++)V(e,t[o],n,r,i);return null}return n=J(n),e&&e[E]?e.K(t,n,s(r)?!!r.capture:!!r,i):H(e,t,n,!0,r,i)}function j(e,t,n,r,i){if(Array.isArray(t))for(var o=0;o<t.length;o++)j(e,t[o],n,r,i);else r=s(r)?!!r.capture:!!r,n=J(n),e&&e[E]?(e=e.i,(o=String(t).toString())in e.g&&((n=q(t=e.g[o],n,r,i))>-1&&(N(t[n]),Array.prototype.splice.call(t,n,1),0==t.length&&(delete e.g[o],e.h--)))):e&&(e=W(e))&&(t=e.g[t.toString()],e=-1,t&&(e=q(t,n,r,i)),(n=e>-1?t[e]:null)&&K(n))}function K(e){if("number"!==typeof e&&e&&!e.da){var t=e.src;if(t&&t[E])F(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(G(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=W(t))?(F(n,e),0==n.h&&(n.src=null,t[U]=null)):N(e)}}}function G(e){return e in z?z[e]:z[e]="on"+e}function Q(e,t){if(e.da)e=!0;else{t=new A(t,this);const n=e.listener,r=e.ha||e.src;e.fa&&K(e),e=n.call(r,t)}return e}function W(e){return(e=e[U])instanceof L?e:null}var Y="__closure_events_fn_"+(1e9*Math.random()>>>0);function J(e){return"function"===typeof e?e:(e[Y]||(e[Y]=function(t){return e.handleEvent(t)}),e[Y])}function X(){S.call(this),this.i=new L(this),this.M=this,this.G=null}function $(e,t){var n,r=e.G;if(r)for(n=[];r;r=r.G)n.push(r);if(e=e.M,r=t.type||t,"string"===typeof t)t=new T(t,e);else if(t instanceof T)t.target=t.target||e;else{var i=t;D(t=new T(r,e),i)}let o,s;if(i=!0,n)for(s=n.length-1;s>=0;s--)o=t.g=n[s],i=Z(o,r,!0,t)&&i;if(o=t.g=e,i=Z(o,r,!0,t)&&i,i=Z(o,r,!1,t)&&i,n)for(s=0;s<n.length;s++)o=t.g=n[s],i=Z(o,r,!1,t)&&i}function Z(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();let i=!0;for(let o=0;o<t.length;++o){const s=t[o];if(s&&!s.da&&s.capture==n){const t=s.listener,n=s.ha||s.src;s.fa&&F(e.i,s),i=!1!==t.call(n,r)&&i}}return i&&!r.defaultPrevented}function ee(e){e.g=function(e,t){if("function"!==typeof e){if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=c(e.handleEvent,e)}return Number(t)>2147483647?-1:o.setTimeout(e,t||0)}(()=>{e.g=null,e.i&&(e.i=!1,ee(e))},e.l);const t=e.h;e.h=null,e.m.apply(null,t)}u(X,S),X.prototype[E]=!0,X.prototype.removeEventListener=function(e,t,n,r){j(this,e,t,n,r)},X.prototype.N=function(){if(X.Z.N.call(this),this.i){var e=this.i;for(const t in e.g){const n=e.g[t];for(let e=0;e<n.length;e++)N(n[e]);delete e.g[t],e.h--}}this.G=null},X.prototype.J=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},X.prototype.K=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};class te extends S{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:ee(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ne(e){S.call(this),this.h=e,this.g={}}u(ne,S);var re=[];function ie(e){O(e.g,function(e,t){this.g.hasOwnProperty(t)&&K(e)},e),e.g={}}ne.prototype.N=function(){ne.Z.N.call(this),ie(this)},ne.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var oe=o.JSON.stringify,se=o.JSON.parse,ae=class{stringify(e){return o.JSON.stringify(e,void 0)}parse(e){return o.JSON.parse(e,void 0)}};function ce(){}function le(){}var ue={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function he(){T.call(this,"d")}function de(){T.call(this,"c")}u(he,T),u(de,T);var fe={},ge=null;function pe(){return ge=ge||new X}function me(e){T.call(this,fe.Ia,e)}function ye(e){const t=pe();$(t,new me(t))}function ve(e,t){T.call(this,fe.STAT_EVENT,e),this.stat=t}function we(e){const t=pe();$(t,new ve(t,e))}function be(e,t){T.call(this,fe.Ja,e),this.size=t}function Ce(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){e()},t)}function ke(){this.g=!0}function Se(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{const o=JSON.parse(t);if(o)for(e=0;e<o.length;e++)if(Array.isArray(o[e])){var n=o[e];if(!(n.length<2)){var r=n[1];if(Array.isArray(r)&&!(r.length<1)){var i=r[0];if("noop"!=i&&"stop"!=i&&"close"!=i)for(let e=1;e<r.length;e++)r[e]=""}}}return oe(o)}catch(o){return t}}(e,n)+(r?" "+r:"")})}fe.Ia="serverreachability",u(me,T),fe.STAT_EVENT="statevent",u(ve,T),fe.Ja="timingevent",u(be,T),ke.prototype.ua=function(){this.g=!1},ke.prototype.info=function(){};var Te,Ie={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},_e={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"};function Ae(){}function Ee(e){return encodeURIComponent(String(e))}function Pe(e){var t=1;e=e.split(":");const n=[];for(;t>0&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function Re(e,t,n,r){this.j=e,this.i=t,this.l=n,this.S=r||1,this.V=new ne(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Ne}function Ne(){this.i=null,this.g="",this.h=!1}u(Ae,ce),Ae.prototype.g=function(){return new XMLHttpRequest},Te=new Ae;var Oe={},Me={};function xe(e,t,n){e.M=1,e.A=ot(et(t)),e.u=n,e.R=!0,De(e,null)}function De(e,t){e.F=Date.now(),qe(e),e.B=et(e.A);var n=e.B,r=e.S;Array.isArray(r)||(r=[String(r)]),Rt(n.i,"t",r),e.C=0,n=e.j.L,e.h=new Ne,e.g=vn(e.j,n?t:null,!e.u),e.P>0&&(e.O=new te(c(e.Y,e,e.g),e.P)),t=e.V,n=e.g,r=e.ba;var i="readystatechange";Array.isArray(i)||(i&&(re[0]=i.toString()),i=re);for(let o=0;o<i.length;o++){const e=B(n,i[o],r||t.handleEvent,!1,t.h||t);if(!e)break;t.g[e.key]=e}t=e.J?M(e.J):{},e.u?(e.v||(e.v="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.B,e.v,e.u,t)):(e.v="GET",e.g.ea(e.B,e.v,null,t)),ye(),function(e,t,n,r,i,o){e.info(function(){if(e.g)if(o){var s="",a=o.split("&");for(let e=0;e<a.length;e++){var c=a[e].split("=");if(c.length>1){const e=c[0];c=c[1];const t=e.split("_");s=t.length>=2&&"type"==t[1]?s+(e+"=")+c+"&":s+(e+"=redacted&")}}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+s})}(e.i,e.v,e.B,e.l,e.S,e.u)}function Le(e){return!!e.g&&("GET"==e.v&&2!=e.M&&e.j.Aa)}function Fe(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?Me:(n=Number(t.substring(n,r)),isNaN(n)?Oe:(r+=1)+n>t.length?Me:(t=t.slice(r,r+n),e.C=r+n,t))}function qe(e){e.T=Date.now()+e.H,Ue(e,e.H)}function Ue(e,t){if(null!=e.D)throw Error("WatchDog timer not null");e.D=Ce(c(e.aa,e),t)}function ze(e){e.D&&(o.clearTimeout(e.D),e.D=null)}function Be(e){0==e.j.I||e.K||fn(e.j,e)}function He(e){ze(e);var t=e.O;t&&"function"==typeof t.dispose&&t.dispose(),e.O=null,ie(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.dispose())}function Ve(e,t){try{var n=e.j;if(0!=n.I&&(n.g==e||We(n.h,e)))if(!e.L&&We(n.h,e)&&3==n.I){try{var r=n.Ba.g.parse(t)}catch(u){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.v){if(n.g){if(!(n.g.F+3e3<e.F))break e;dn(n),tn(n)}ln(n),we(18)}}else n.xa=i[1],0<n.xa-n.K&&i[2]<37500&&n.F&&0==n.A&&!n.C&&(n.C=Ce(c(n.Va,n),6e3));Qe(n.h)<=1&&n.ta&&(n.ta=void 0)}else pn(n,11)}else if((e.L||n.g==e)&&dn(n),!_(t))for(i=n.Ba.g.parse(t),t=0;t<i.length;t++){let c=i[t];const u=c[0];if(!(u<=n.K))if(n.K=u,c=c[1],2==n.I)if("c"==c[0]){n.M=c[1],n.ba=c[2];const t=c[3];null!=t&&(n.ka=t,n.j.info("VER="+n.ka));const i=c[4];null!=i&&(n.za=i,n.j.info("SVER="+n.za));const u=c[5];null!=u&&"number"===typeof u&&u>0&&(r=1.5*u,n.O=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const h=e.g;if(h){const e=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var o=r.h;o.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(o.j=o.l,o.g=new Set,o.h&&(Ye(o,o.h),o.h=null))}if(r.G){const e=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.wa=e,it(r.J,r.G,e))}}n.I=3,n.l&&n.l.ra(),n.aa&&(n.T=Date.now()-e.F,n.j.info("Handshake RTT: "+n.T+"ms"));var s=e;if((r=n).na=yn(r,r.L?r.ba:null,r.W),s.L){Je(r.h,s);var a=s,l=r.O;l&&(a.H=l),a.D&&(ze(a),qe(a)),r.g=s}else cn(r);n.i.length>0&&rn(n)}else"stop"!=c[0]&&"close"!=c[0]||pn(n,7);else 3==n.I&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?pn(n,7):en(n):"noop"!=c[0]&&n.l&&n.l.qa(c),n.A=0)}ye()}catch(u){}}Re.prototype.ba=function(e){e=e.target;const t=this.O;t&&3==Yt(e)?t.j():this.Y(e)},Re.prototype.Y=function(e){try{if(e==this.g)e:{const c=Yt(this.g),l=this.g.ya();this.g.ca();if(!(c<3)&&(3!=c||this.g&&(this.h.h||this.g.la()||Jt(this.g)))){this.K||4!=c||7==l||ye(),ze(this);var t=this.g.ca();this.X=t;var n=function(e){if(!Le(e))return e.g.la();const t=Jt(e.g);if(""===t)return"";let n="";const r=t.length,i=4==Yt(e.g);if(!e.h.i){if("undefined"===typeof TextDecoder)return He(e),Be(e),"";e.h.i=new o.TextDecoder}for(let o=0;o<r;o++)e.h.h=!0,n+=e.h.i.decode(t[o],{stream:!(i&&o==r-1)});return t.length=0,e.h.g+=n,e.C=0,e.h.g}(this);if(this.o=200==t,function(e,t,n,r,i,o,s){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+o+" "+s})}(this.i,this.v,this.B,this.l,this.S,c,t),this.o){if(this.U&&!this.L){t:{if(this.g){var r,i=this.g;if((r=i.g?i.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!_(r)){var s=r;break t}}s=null}if(!(e=s)){this.o=!1,this.m=3,we(12),He(this),Be(this);break e}Se(this.i,this.l,e,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Ve(this,e)}if(this.R){let t;for(e=!0;!this.K&&this.C<n.length;){if(t=Fe(this,n),t==Me){4==c&&(this.m=4,we(14),e=!1),Se(this.i,this.l,null,"[Incomplete Response]");break}if(t==Oe){this.m=4,we(15),Se(this.i,this.l,n,"[Invalid Chunk]"),e=!1;break}Se(this.i,this.l,t,null),Ve(this,t)}if(Le(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=c||0!=n.length||this.h.h||(this.m=1,we(16),e=!1),this.o=this.o&&e,e){if(n.length>0&&!this.W){this.W=!0;var a=this.j;a.g==this&&a.aa&&!a.P&&(a.j.info("Great, no buffering proxy detected. Bytes received: "+n.length),un(a),a.P=!0,we(11))}}else Se(this.i,this.l,n,"[Invalid Chunked Response]"),He(this),Be(this)}else Se(this.i,this.l,n,null),Ve(this,n);4==c&&He(this),this.o&&!this.K&&(4==c?fn(this.j,this):(this.o=!1,qe(this)))}else(function(e){const t={};e=(e.g&&Yt(e)>=2&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(_(e[r]))continue;var n=Pe(e[r]);const i=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const o=t[i]||[];t[i]=o,o.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,function(e){return e.join(", ")})})(this.g),400==t&&n.indexOf("Unknown SID")>0?(this.m=3,we(12)):(this.m=0,we(13)),He(this),Be(this)}}}catch($t){}},Re.prototype.cancel=function(){this.K=!0,He(this)},Re.prototype.aa=function(){this.D=null;const e=Date.now();e-this.T>=0?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.i,this.B),2!=this.M&&(ye(),we(17)),He(this),this.m=2,Be(this)):Ue(this,this.T-e)};var je=class{constructor(e,t){this.g=e,this.map=t}};function Ke(e){this.l=e||10,o.PerformanceNavigationTiming?e=(e=o.performance.getEntriesByType("navigation")).length>0&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Ge(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Qe(e){return e.h?1:e.g?e.g.size:0}function We(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function Ye(e,t){e.g?e.g.add(t):e.h=t}function Je(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function Xe(e){if(null!=e.h)return e.i.concat(e.h.G);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.G);return t}return d(e.i)}Ke.prototype.cancel=function(){if(this.i=Xe(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var $e=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ze(e){let t;this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1,e instanceof Ze?(this.l=e.l,tt(this,e.j),this.o=e.o,this.g=e.g,nt(this,e.u),this.h=e.h,rt(this,Nt(e.i)),this.m=e.m):e&&(t=String(e).match($e))?(this.l=!1,tt(this,t[1]||"",!0),this.o=st(t[2]||""),this.g=st(t[3]||"",!0),nt(this,t[4]),this.h=st(t[5]||"",!0),rt(this,t[6]||"",!0),this.m=st(t[7]||"")):(this.l=!1,this.i=new It(null,this.l))}function et(e){return new Ze(e)}function tt(e,t,n){e.j=n?st(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function nt(e,t){if(t){if(t=Number(t),isNaN(t)||t<0)throw Error("Bad port number "+t);e.u=t}else e.u=null}function rt(e,t,n){t instanceof It?(e.i=t,function(e,t){t&&!e.j&&(_t(e),e.i=null,e.g.forEach(function(e,t){const n=t.toLowerCase();t!=n&&(At(this,t),Rt(this,n,e))},e)),e.j=t}(e.i,e.l)):(n||(t=at(t,St)),e.i=new It(t,e.l))}function it(e,t,n){e.i.set(t,n)}function ot(e){return it(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function st(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function at(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,ct),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function ct(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}Ze.prototype.toString=function(){const e=[];var t=this.j;t&&e.push(at(t,wt,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(at(t,wt,!0),"@"),e.push(Ee(n).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.u)&&e.push(":",String(n))),(n=this.h)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(at(n,"/"==n.charAt(0)?kt:Ct,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",at(n,Tt)),e.join("")},Ze.prototype.resolve=function(e){const t=et(this);let n=!!e.j;n?tt(t,e.j):n=!!e.o,n?t.o=e.o:n=!!e.g,n?t.g=e.g:n=null!=e.u;var r=e.h;if(n)nt(t,e.u);else if(n=!!e.h){if("/"!=r.charAt(0))if(this.g&&!this.h)r="/"+r;else{var i=t.h.lastIndexOf("/");-1!=i&&(r=t.h.slice(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(-1!=i.indexOf("./")||-1!=i.indexOf("/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");const e=[];for(let t=0;t<i.length;){const n=i[t++];"."==n?r&&t==i.length&&e.push(""):".."==n?((e.length>1||1==e.length&&""!=e[0])&&e.pop(),r&&t==i.length&&e.push("")):(e.push(n),r=!0)}r=e.join("/")}else r=i}return n?t.h=r:n=""!==e.i.toString(),n?rt(t,Nt(e.i)):n=!!e.m,n&&(t.m=e.m),t};var wt=/[#\/\?@]/g,Ct=/[#\?:]/g,kt=/[#\?]/g,St=/[#\?@]/g,Tt=/#/g;function It(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function _t(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(let n=0;n<e.length;n++){const r=e[n].indexOf("=");let i,o=null;r>=0?(i=e[n].substring(0,r),o=e[n].substring(r+1)):i=e[n],t(i,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function At(e,t){_t(e),t=Ot(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Et(e,t){return _t(e),t=Ot(e,t),e.g.has(t)}function Pt(e,t){_t(e);let n=[];if("string"===typeof t)Et(e,t)&&(n=n.concat(e.g.get(Ot(e,t))));else for(e=Array.from(e.g.values()),t=0;t<e.length;t++)n=n.concat(e[t]);return n}function Rt(e,t,n){At(e,t),n.length>0&&(e.i=null,e.g.set(Ot(e,t),d(n)),e.h+=n.length)}function Nt(e){const t=new It;return t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),t}function Ot(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function Mt(e,t,n,r,i){try{i&&(i.onload=null,i.onerror=null,i.onabort=null,i.ontimeout=null),r(n)}catch(o){}}function xt(){this.g=new ae}function Dt(e){this.i=e.Sb||null,this.h=e.ab||!1}function Lt(e,t){X.call(this),this.H=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}function Ft(e){e.j.read().then(e.Ma.bind(e)).catch(e.ga.bind(e))}function qt(e){e.readyState=4,e.l=null,e.j=null,e.B=null,Ut(e)}function Ut(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function zt(e){let t="";return O(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}function Bt(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=zt(n),"string"===typeof e?null!=n&&Ee(n):it(e,t,n))}function Ht(e){X.call(this),this.headers=new Map,this.L=e||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}(e=It.prototype).add=function(e,t){_t(this),this.i=null,e=Ot(this,e);let n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){_t(this),this.g.forEach(function(n,r){n.forEach(function(n){e.call(t,n,r,this)},this)},this)},e.set=function(e,t){return _t(this),this.i=null,Et(this,e=Ot(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&(e=Pt(this,e)).length>0?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(let r=0;r<t.length;r++){var n=t[r];const i=Ee(n);n=Pt(this,n);for(let t=0;t<n.length;t++){let r=i;""!==n[t]&&(r+="="+Ee(n[t])),e.push(r)}}return this.i=e.join("&")},u(Dt,ce),Dt.prototype.g=function(){return new Lt(this.i,this.h)},u(Lt,X),(e=Lt.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.F=e,this.D=t,this.readyState=1,Ut(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const t={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};e&&(t.body=e),(this.H||o).fetch(new Request(this.D,t)).then(this.Pa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&4!=this.readyState&&(this.g=!1,qt(this)),this.readyState=0},e.Pa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Ut(this)),this.g&&(this.readyState=3,Ut(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if("undefined"!==typeof o.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Ft(this)}else e.text().then(this.Oa.bind(this),this.ga.bind(this))},e.Ma=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.B.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?qt(this):Ut(this),3==this.readyState&&Ft(this)}},e.Oa=function(e){this.g&&(this.response=this.responseText=e,qt(this))},e.Na=function(e){this.g&&(this.response=e,qt(this))},e.ga=function(){this.g&&qt(this)},e.setRequestHeader=function(e,t){this.A.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Lt.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),u(Ht,X);var Vt=/^https?$/i,jt=["POST","PUT"];function Kt(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.o=5,Gt(e),Wt(e)}function Gt(e){e.A||(e.A=!0,$(e,"complete"),$(e,"error"))}function Qt(e){if(e.h&&"undefined"!=typeof i)if(e.v&&4==Yt(e))setTimeout(e.Ca.bind(e),0);else if($(e,"readystatechange"),4==Yt(e)){e.h=!1;try{const i=e.ca();e:switch(i){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var r;if(r=0===i){let t=String(e.D).match($e)[1]||null;!t&&o.self&&o.self.location&&(t=o.self.location.protocol.slice(0,-1)),r=!Vt.test(t?t.toLowerCase():"")}n=r}if(n)$(e,"complete"),$(e,"success");else{e.o=6;try{var s=Yt(e)>2?e.g.statusText:""}catch(a){s=""}e.l=s+" ["+e.ca()+"]",Gt(e)}}finally{Wt(e)}}}function Wt(e,t){if(e.g){e.m&&(clearTimeout(e.m),e.m=null);const r=e.g;e.g=null,t||$(e,"ready");try{r.onreadystatechange=null}catch(n){}}}function Yt(e){return e.g?e.g.readyState:0}function Jt(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.F){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function Xt(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Zt(e){this.za=0,this.i=[],this.j=new ke,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Xt("failFast",!1,e),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Xt("baseRetryDelayMs",5e3,e),this.Za=Xt("retryDelaySeedMs",1e4,e),this.Ta=Xt("forwardChannelMaxRetries",2,e),this.va=Xt("forwardChannelRequestTimeoutMs",2e4,e),this.ma=e&&e.xmlHttpFactory||void 0,this.Ua=e&&e.Rb||void 0,this.Aa=e&&e.useFetchStreams||!1,this.O=void 0,this.L=e&&e.supportsCrossDomainXhr||!1,this.M="",this.h=new Ke(e&&e.concurrentRequestLimit),this.Ba=new xt,this.S=e&&e.fastHandshake||!1,this.R=e&&e.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=e&&e.Pb||!1,e&&e.ua&&this.j.ua(),e&&e.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&e&&e.detectBufferingProxy||!1,this.ia=void 0,e&&e.longPollingTimeout&&e.longPollingTimeout>0&&(this.ia=e.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}function en(e){if(nn(e),3==e.I){var t=e.V++,n=et(e.J);if(it(n,"SID",e.M),it(n,"RID",t),it(n,"TYPE","terminate"),sn(e,n),(t=new Re(e,e.j,t)).M=2,t.A=ot(et(n)),n=!1,o.navigator&&o.navigator.sendBeacon)try{n=o.navigator.sendBeacon(t.A.toString(),"")}catch(r){}!n&&o.Image&&((new Image).src=t.A,n=!0),n||(t.g=vn(t.j,null),t.g.ea(t.A)),t.F=Date.now(),qe(t)}mn(e)}function tn(e){e.g&&(un(e),e.g.cancel(),e.g=null)}function nn(e){tn(e),e.v&&(o.clearTimeout(e.v),e.v=null),dn(e),e.h.cancel(),e.m&&("number"===typeof e.m&&o.clearTimeout(e.m),e.m=null)}function rn(e){if(!Ge(e.h)&&!e.m){e.m=!0;var t=e.Ea;v||C(),w||(v(),w=!0),b.add(t,e),e.D=0}}function on(e,t){var n;n=t?t.l:e.V++;const r=et(e.J);it(r,"SID",e.M),it(r,"RID",n),it(r,"AID",e.K),sn(e,r),e.u&&e.o&&Bt(r,e.u,e.o),n=new Re(e,e.j,n,e.D+1),null===e.u&&(n.J=e.o),t&&(e.i=t.G.concat(e.i)),t=an(e,n,1e3),n.H=Math.round(.5*e.va)+Math.round(.5*e.va*Math.random()),Ye(e.h,n),xe(n,r,t)}function sn(e,t){e.H&&O(e.H,function(e,n){it(t,n,e)}),e.l&&O({},function(e,n){it(t,n,e)})}function an(e,t,n){n=Math.min(e.i.length,n);const r=e.l?c(e.l.Ka,e.l,e):null;e:{var i=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?n>0?(t=i[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let c=!0;for(let l=0;l<n;l++){var o=i[l].g;const n=i[l].map;if((o-=t)<0)t=Math.max(0,i[l].g-100),c=!1;else try{o="req"+o+"_"||0;try{var a=n instanceof Map?n:Object.entries(n);for(const[t,n]of a){let r=n;s(n)&&(r=oe(n)),e.push(o+t+"="+encodeURIComponent(r))}}catch(bt){throw e.push(o+"type="+encodeURIComponent("_badmap")),bt}}catch(bt){r&&r(n)}}if(c){a=e.join("&");break e}}a=void 0}return e=e.i.splice(0,n),t.G=e,a}function cn(e){if(!e.g&&!e.v){e.Y=1;var t=e.Da;v||C(),w||(v(),w=!0),b.add(t,e),e.A=0}}function ln(e){return!(e.g||e.v||e.A>=3)&&(e.Y++,e.v=Ce(c(e.Da,e),gn(e,e.A)),e.A++,!0)}function un(e){null!=e.B&&(o.clearTimeout(e.B),e.B=null)}function hn(e){e.g=new Re(e,e.j,"rpc",e.Y),null===e.u&&(e.g.J=e.o),e.g.P=0;var t=et(e.na);it(t,"RID","rpc"),it(t,"SID",e.M),it(t,"AID",e.K),it(t,"CI",e.F?"0":"1"),!e.F&&e.ia&&it(t,"TO",e.ia),it(t,"TYPE","xmlhttp"),sn(e,t),e.u&&e.o&&Bt(t,e.u,e.o),e.O&&(e.g.H=e.O);var n=e.g;e=e.ba,n.M=1,n.A=ot(et(t)),n.u=null,n.R=!0,De(n,e)}function dn(e){null!=e.C&&(o.clearTimeout(e.C),e.C=null)}function fn(e,t){var n=null;if(e.g==t){dn(e),un(e),e.g=null;var r=2}else{if(!We(e.h,t))return;n=t.G,Je(e.h,t),r=1}if(0!=e.I)if(t.o)if(1==r){n=t.u?t.u.length:0,t=Date.now()-t.F;var i=e.D;$(r=pe(),new be(r,n)),rn(e)}else cn(e);else if(3==(i=t.m)||0==i&&t.X>0||!(1==r&&function(e,t){return!(Qe(e.h)>=e.h.j-(e.m?1:0))&&(e.m?(e.i=t.G.concat(e.i),!0):!(1==e.I||2==e.I||e.D>=(e.Sa?0:e.Ta))&&(e.m=Ce(c(e.Ea,e,t),gn(e,e.D)),e.D++,!0))}(e,t)||2==r&&ln(e)))switch(n&&n.length>0&&(t=e.h,t.i=t.i.concat(n)),i){case 1:pn(e,5);break;case 4:pn(e,10);break;case 3:pn(e,6);break;default:pn(e,2)}}function gn(e,t){let n=e.Qa+Math.floor(Math.random()*e.Za);return e.isActive()||(n*=2),n*t}function pn(e,t){if(e.j.info("Error code "+t),2==t){var n=c(e.bb,e),r=e.Ua;const t=!r;r=new Ze(r||"//www.google.com/images/cleardot.gif"),o.location&&"http"==o.location.protocol||tt(r,"https"),ot(r),t?function(e,t){const n=new ke;if(o.Image){const r=new Image;r.onload=l(Mt,n,"TestLoadImage: loaded",!0,t,r),r.onerror=l(Mt,n,"TestLoadImage: error",!1,t,r),r.onabort=l(Mt,n,"TestLoadImage: abort",!1,t,r),r.ontimeout=l(Mt,n,"TestLoadImage: timeout",!1,t,r),o.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(r.toString(),n):function(e,t){new ke;const n=new AbortController,r=setTimeout(()=>{n.abort(),Mt(0,0,!1,t)},1e4);fetch(e,{signal:n.signal}).then(e=>{clearTimeout(r),e.ok?Mt(0,0,!0,t):Mt(0,0,!1,t)}).catch(()=>{clearTimeout(r),Mt(0,0,!1,t)})}(r.toString(),n)}else we(2);e.I=0,e.l&&e.l.pa(t),mn(e),nn(e)}function mn(e){if(e.I=0,e.ja=[],e.l){const t=Xe(e.h);0==t.length&&0==e.i.length||(f(e.ja,t),f(e.ja,e.i),e.h.i.length=0,d(e.i),e.i.length=0),e.l.oa()}}function yn(e,t,n){var r=n instanceof Ze?et(n):new Ze(n);if(""!=r.g)t&&(r.g=t+"."+r.g),nt(r,r.u);else{var i=o.location;r=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;const e=new Ze(null);r&&tt(e,r),t&&(e.g=t),i&&nt(e,i),n&&(e.h=n),r=e}return n=e.G,t=e.wa,n&&t&&it(r,n,t),it(r,"VER",e.ka),sn(e,r),r}function vn(e,t,n){if(t&&!e.L)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Aa&&!e.ma?new Ht(new Dt({ab:n})):new Ht(e.ma)).Fa(e.L),t}function wn(){}function bn(){}function Cn(e,t){X.call(this),this.g=new Zt(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.sa&&(e?e["X-WebChannel-Client-Profile"]=t.sa:e={"X-WebChannel-Client-Profile":t.sa}),this.g.U=e,(e=t&&t.Qb)&&!_(e)&&(this.g.u=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!_(t)&&(this.g.G=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new Tn(this)}function kn(e){he.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function Sn(){de.call(this),this.status=1}function Tn(e){this.g=e}(e=Ht.prototype).Fa=function(e){this.H=e},e.ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Te.g(),this.g.onreadystatechange=h(c(this.Ca,this));try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(s){return void Kt(this,s)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find(e=>"content-type"==e.toLowerCase()),i=o.FormData&&e instanceof o.FormData,!(Array.prototype.indexOf.call(jt,t,void 0)>=0)||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[o,a]of n)this.g.setRequestHeader(o,a);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(e),this.v=!1}catch(s){Kt(this,s)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=e||7,$(this,"complete"),$(this,"abort"),Wt(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Wt(this,!0)),Ht.Z.N.call(this)},e.Ca=function(){this.u||(this.B||this.v||this.j?Qt(this):this.Xa())},e.Xa=function(){Qt(this)},e.isActive=function(){return!!this.g},e.ca=function(){try{return Yt(this)>2?this.g.status:-1}catch(e){return-1}},e.la=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},e.La=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),se(t)}},e.ya=function(){return this.o},e.Ha=function(){return"string"===typeof this.l?this.l:String(this.l)},(e=Zt.prototype).ka=8,e.I=1,e.connect=function(e,t,n,r){we(0),this.W=e,this.H=t||{},n&&void 0!==r&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.J=yn(this,null,this.W),rn(this)},e.Ea=function(e){if(this.m)if(this.m=null,1==this.I){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;const i=new Re(this,this.j,e);let o=this.o;if(this.U&&(o?(o=M(o),D(o,this.U)):o=this.U),null!==this.u||this.R||(i.J=o,o=null),this.S)e:{for(var t=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.map&&"string"===typeof(r=r.map.__data__)?r.length:void 0))break;if((t+=r)>4096){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=an(this,i,t),it(n=et(this.J),"RID",e),it(n,"CVER",22),this.G&&it(n,"X-HTTP-Session-Id",this.G),sn(this,n),o&&(this.R?t="headers="+Ee(zt(o))+"&"+t:this.u&&Bt(n,this.u,o)),Ye(this.h,i),this.Ra&&it(n,"TYPE","init"),this.S?(it(n,"$req",t),it(n,"SID","null"),i.U=!0,xe(i,n,null)):xe(i,n,t),this.I=2}}else 3==this.I&&(e?on(this,e):0==this.i.length||Ge(this.h)||on(this))},e.Da=function(){if(this.v=null,hn(this),this.aa&&!(this.P||null==this.g||this.T<=0)){var e=4*this.T;this.j.info("BP detection timer enabled: "+e),this.B=Ce(c(this.Wa,this),e)}},e.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,we(10),tn(this),hn(this))},e.Va=function(){null!=this.C&&(this.C=null,tn(this),ln(this),we(19))},e.bb=function(e){e?(this.j.info("Successfully pinged google.com"),we(2)):(this.j.info("Failed to ping google.com"),we(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=wn.prototype).ra=function(){},e.qa=function(){},e.pa=function(){},e.oa=function(){},e.isActive=function(){return!0},e.Ka=function(){},bn.prototype.g=function(e,t){return new Cn(e,t)},u(Cn,X),Cn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Cn.prototype.close=function(){en(this.g)},Cn.prototype.o=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=oe(e),e=n);t.i.push(new je(t.Ya++,e)),3==t.I&&rn(t)},Cn.prototype.N=function(){this.g.l=null,delete this.j,en(this.g),delete this.g,Cn.Z.N.call(this)},u(kn,he),u(Sn,de),u(Tn,wn),Tn.prototype.ra=function(){$(this.g,"a")},Tn.prototype.qa=function(e){$(this.g,new kn(e))},Tn.prototype.pa=function(e){$(this.g,new Sn)},Tn.prototype.oa=function(){$(this.g,"b")},bn.prototype.createWebChannel=bn.prototype.g,Cn.prototype.send=Cn.prototype.o,Cn.prototype.open=Cn.prototype.m,Cn.prototype.close=Cn.prototype.close,mt=vt.createWebChannelTransport=function(){return new bn},pt=vt.getStatEventTarget=function(){return pe()},gt=vt.Event=fe,ft=vt.Stat={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Ie.NO_ERROR=0,Ie.TIMEOUT=8,Ie.HTTP_ERROR=6,dt=vt.ErrorCode=Ie,_e.COMPLETE="complete",ht=vt.EventType=_e,le.EventType=ue,ue.OPEN="a",ue.CLOSE="b",ue.ERROR="c",ue.MESSAGE="d",X.prototype.listen=X.prototype.J,ut=vt.WebChannel=le,vt.FetchXmlHttpFactory=Dt,Ht.prototype.listenOnce=Ht.prototype.K,Ht.prototype.getLastError=Ht.prototype.Ha,Ht.prototype.getLastErrorCode=Ht.prototype.ya,Ht.prototype.getStatus=Ht.prototype.ca,Ht.prototype.getResponseJson=Ht.prototype.La,Ht.prototype.getResponseText=Ht.prototype.la,Ht.prototype.send=Ht.prototype.ea,Ht.prototype.setWithCredentials=Ht.prototype.Fa,lt=vt.XhrIo=Ht}).apply("undefined"!==typeof yt?yt:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});const wt="@firebase/firestore",bt="4.9.2";class Ct{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ct.UNAUTHENTICATED=new Ct(null),Ct.GOOGLE_CREDENTIALS=new Ct("google-credentials-uid"),Ct.FIRST_PARTY=new Ct("first-party-uid"),Ct.MOCK_USER=new Ct("mock-user");let kt="12.3.0";const St=new j("@firebase/firestore");function Tt(){return St.logLevel}function It(e){if(St.logLevel<=U.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(Et);St.debug("Firestore (".concat(kt,"): ").concat(e),...i)}}function _t(e){if(St.logLevel<=U.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(Et);St.error("Firestore (".concat(kt,"): ").concat(e),...i)}}function At(e){if(St.logLevel<=U.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(Et);St.warn("Firestore (".concat(kt,"): ").concat(e),...i)}}function Et(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function Pt(e,t,n){let r="Unexpected state";"string"==typeof t?r=t:n=t,Rt(e,r,n)}function Rt(e,t,n){let r="FIRESTORE (".concat(kt,") INTERNAL ASSERTION FAILED: ").concat(t," (ID: ").concat(e.toString(16),")");if(void 0!==n)try{r+=" CONTEXT: "+JSON.stringify(n)}catch(e){r+=" CONTEXT: "+n}throw _t(r),new Error(r)}function Nt(e,t,n,r){let i="Unexpected state";"string"==typeof n?i=n:r=n,e||Rt(t,i,r)}function Ot(e,t){return e}const Mt={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class xt extends E{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>"".concat(this.name,": [code=").concat(this.code,"]: ").concat(this.message)}}class Dt{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class Lt{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(e))}}class Ft{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Ct.UNAUTHENTICATED))}shutdown(){}}class qt{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class Ut{constructor(e){this.t=e,this.currentUser=Ct.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Nt(void 0===this.o,42304);let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new Dt;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Dt,e.enqueueRetryable(()=>r(this.currentUser))};const o=()=>{const t=i;e.enqueueRetryable(async()=>{await t.promise,await r(this.currentUser)})},s=e=>{It("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(e=>s(e)),setTimeout(()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?s(e):(It("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Dt)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(It("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(Nt("string"==typeof t.accessToken,31837,{l:t}),new Lt(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Nt(null===e||"string"==typeof e,2055,{h:e}),new Ct(e)}}class zt{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=Ct.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Bt{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new zt(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Ct.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Ht{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Vt{constructor(e,t){var n;this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,null!==(n=e)&&void 0!==n&&void 0!==n.settings&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Nt(void 0===this.o,3512);const n=e=>{null!=e.error&&It("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));const n=e.token!==this.m;return this.m=e.token,It("FirebaseAppCheckTokenProvider","Received ".concat(n?"new":"existing"," token.")),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>n(t))};const r=e=>{It("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(e=>r(e)),setTimeout(()=>{if(!this.appCheck){const e=this.V.getImmediate({optional:!0});e?r(e):It("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Ht(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(Nt("string"==typeof e.token,44558,{tokenResult:e}),this.m=e.token,new Ht(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function jt(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}class Kt{static newId(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const n=jt(40);for(let r=0;r<n.length;++r)t.length<20&&n[r]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[r]%62))}return t}}function Gt(e,t){return e<t?-1:e>t?1:0}function Qt(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.charAt(r),i=t.charAt(r);if(n!==i)return Jt(n)===Jt(i)?Gt(n,i):Jt(n)?1:-1}return Gt(e.length,t.length)}const Wt=55296,Yt=57343;function Jt(e){const t=e.charCodeAt(0);return t>=Wt&&t<=Yt}function Xt(e,t,n){return e.length===t.length&&e.every((e,r)=>n(e,t[r]))}const $t="__name__";class Zt{constructor(e,t,n){void 0===t?t=0:t>e.length&&Pt(637,{offset:t,range:e.length}),void 0===n?n=e.length-t:n>e.length-t&&Pt(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===Zt.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Zt?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=Zt.compareSegments(e.get(r),t.get(r));if(0!==n)return n}return Gt(e.length,t.length)}static compareSegments(e,t){const n=Zt.isNumericId(e),r=Zt.isNumericId(t);return n&&!r?-1:!n&&r?1:n&&r?Zt.extractNumericId(e).compare(Zt.extractNumericId(t)):Qt(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ot.fromString(e.substring(4,e.length-2))}}class en extends Zt{construct(e,t,n){return new en(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n){if(i.indexOf("//")>=0)throw new xt(Mt.INVALID_ARGUMENT,"Invalid segment (".concat(i,"). Paths must not contain // in them."));e.push(...i.split("/").filter(e=>e.length>0))}return new en(e)}static emptyPath(){return new en([])}}const tn=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class nn extends Zt{construct(e,t,n){return new nn(e,t,n)}static isValidIdentifier(e){return tn.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),nn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===$t}static keyField(){return new nn([$t])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new xt(Mt.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(n),n=""};let o=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new xt(Mt.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new xt(Mt.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(o=!o,r++):"."!==t||o?(n+=t,r++):(i(),r++)}if(i(),o)throw new xt(Mt.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new nn(t)}static emptyPath(){return new nn([])}}class rn{constructor(e){this.path=e}static fromPath(e){return new rn(en.fromString(e))}static fromName(e){return new rn(en.fromString(e).popFirst(5))}static empty(){return new rn(en.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===en.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return en.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new rn(new en(e.slice()))}}function on(e,t,n){if(!n)throw new xt(Mt.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function sn(e){if(!rn.isDocumentKey(e))throw new xt(Mt.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function an(e){if(rn.isDocumentKey(e))throw new xt(Mt.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function cn(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}function ln(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?"a custom ".concat(t," object"):"an object"}}return"function"==typeof e?"a function":Pt(12329,{type:typeof e})}function un(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new xt(Mt.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=ln(e);throw new xt(Mt.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}}return e}function hn(e,t){const n={typeString:e};return t&&(n.value=t),n}function dn(e,t){if(!cn(e))throw new xt(Mt.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in t)if(t[r]){const i=t[r].typeString,o="value"in t[r]?{value:t[r].value}:void 0;if(!(r in e)){n="JSON missing required field: '".concat(r,"'");break}const s=e[r];if(i&&typeof s!==i){n="JSON field '".concat(r,"' must be a ").concat(i,".");break}if(void 0!==o&&s!==o.value){n="Expected '".concat(r,"' field to equal '").concat(o.value,"'");break}}if(n)throw new xt(Mt.INVALID_ARGUMENT,n);return!0}const fn=-62135596800,gn=1e6;class pn{static now(){return pn.fromMillis(Date.now())}static fromDate(e){return pn.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*gn);return new pn(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new xt(Mt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new xt(Mt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<fn)throw new xt(Mt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new xt(Mt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/gn}_compareTo(e){return this.seconds===e.seconds?Gt(this.nanoseconds,e.nanoseconds):Gt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:pn._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(dn(e,pn._jsonSchema))return new pn(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-fn;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}pn._jsonSchemaVersion="firestore/timestamp/1.0",pn._jsonSchema={type:hn("string",pn._jsonSchemaVersion),seconds:hn("number"),nanoseconds:hn("number")};class mn{static fromTimestamp(e){return new mn(e)}static min(){return new mn(new pn(0,0))}static max(){return new mn(new pn(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const yn=-1;class vn{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}vn.UNKNOWN_ID=-1;function wn(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=mn.fromTimestamp(1e9===r?new pn(n+1,0):new pn(n,r));return new Cn(i,rn.empty(),t)}function bn(e){return new Cn(e.readTime,e.key,yn)}class Cn{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Cn(mn.min(),rn.empty(),yn)}static max(){return new Cn(mn.max(),rn.empty(),yn)}}function kn(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=rn.comparator(e.documentKey,t.documentKey),0!==n?n:Gt(e.largestBatchId,t.largestBatchId))}const Sn="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Tn{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function In(e){if(e.code!==Mt.FAILED_PRECONDITION||e.message!==Sn)throw e;It("LocalStore","Unexpectedly lost primary lease")}class _n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Pt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new _n((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof _n?t:_n.resolve(t)}catch(e){return _n.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):_n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):_n.reject(t)}static resolve(e){return new _n((t,n)=>{t(e)})}static reject(e){return new _n((t,n)=>{n(e)})}static waitFor(e){return new _n((t,n)=>{let r=0,i=0,o=!1;e.forEach(e=>{++r,e.next(()=>{++i,o&&i===r&&t()},e=>n(e))}),o=!0,i===r&&t()})}static or(e){let t=_n.resolve(!1);for(const n of e)t=t.next(e=>e?_n.resolve(e):n());return t}static forEach(e,t){const n=[];return e.forEach((e,r)=>{n.push(t.call(this,e,r))}),this.waitFor(n)}static mapArray(e,t){return new _n((n,r)=>{const i=e.length,o=new Array(i);let s=0;for(let a=0;a<i;a++){const c=a;t(e[c]).next(e=>{o[c]=e,++s,s===i&&n(o)},e=>r(e))}})}static doWhile(e,t){return new _n((n,r)=>{const i=()=>{!0===e()?t().next(()=>{i()},r):n()};i()})}}function An(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function En(e){return"IndexedDbTransactionError"===e.name}class Pn{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ae(e),this.ue=e=>t.writeSequenceNumber(e))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Pn.ce=-1;const Rn=-1;function Nn(e){return null==e}function On(e){return 0===e&&1/e==-1/0}function Mn(e){return"number"==typeof e&&Number.isInteger(e)&&!On(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}const xn="\x01";function Dn(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=Fn(t)),t=Ln(e.get(n),t);return Fn(t)}function Ln(e,t){let n=t;const r=e.length;for(let i=0;i<r;i++){const t=e.charAt(i);switch(t){case"\0":n+="\x01\x10";break;case xn:n+="\x01\x11";break;default:n+=t}}return n}function Fn(e){return e+xn+"\x01"}const qn="remoteDocuments",Un="owner",zn="mutationQueues",Bn="mutations";const Hn="documentMutations",Vn="remoteDocumentsV14",jn="remoteDocumentGlobal",Kn="targets",Gn="targetDocuments",Qn="targetGlobal",Wn="collectionParents",Yn="clientMetadata",Jn="bundles",Xn="namedQueries",$n="indexConfiguration",Zn="indexState",er="indexEntries",tr="documentOverlays",nr="globals",rr=[zn,Bn,Hn,qn,Kn,Un,Qn,Gn,Yn,jn,Wn,Jn,Xn],ir=[zn,Bn,Hn,Vn,Kn,Un,Qn,Gn,Yn,jn,Wn,Jn,Xn,tr],or=ir,sr=[...or,$n,Zn,er];function ar(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function cr(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function lr(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class ur{constructor(e,t){this.comparator=e,this.root=t||dr.EMPTY}insert(e,t){return new ur(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,dr.BLACK,null,null))}remove(e){return new ur(this.comparator,this.root.remove(e,this.comparator).copy(null,null,dr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push("".concat(t,":").concat(n)),!1)),"{".concat(e.join(", "),"}")}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new hr(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new hr(this.root,e,this.comparator,!1)}getReverseIterator(){return new hr(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new hr(this.root,e,this.comparator,!0)}}class hr{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class dr{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:dr.RED,this.left=null!=r?r:dr.EMPTY,this.right=null!=i?i:dr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new dr(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return dr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return dr.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,dr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,dr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Pt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Pt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Pt(27949);return e+(this.isRed()?0:1)}}dr.EMPTY=null,dr.RED=!0,dr.BLACK=!1,dr.EMPTY=new class{constructor(){this.size=0}get key(){throw Pt(57766)}get value(){throw Pt(16141)}get color(){throw Pt(16727)}get left(){throw Pt(29726)}get right(){throw Pt(36894)}copy(e,t,n,r,i){return this}insert(e,t,n){return new dr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class fr{constructor(e){this.comparator=e,this.data=new ur(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new gr(this.data.getIterator())}getIteratorFrom(e){return new gr(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof fr))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new fr(this.comparator);return t.data=e,t}}class gr{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class pr{constructor(e){this.fields=e,e.sort(nn.comparator)}static empty(){return new pr([])}unionWith(e){let t=new fr(nn.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new pr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Xt(this.fields,e.fields,(e,t)=>e.isEqual(t))}}class mr extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class yr{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new mr("Invalid base64 string: "+e):e}}(e);return new yr(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new yr(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Gt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}yr.EMPTY_BYTE_STRING=new yr("");const vr=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function wr(e){if(Nt(!!e,39018),"string"==typeof e){let t=0;const n=vr.exec(e);if(Nt(!!n,46558,{timestamp:e}),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:br(e.seconds),nanos:br(e.nanos)}}function br(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Cr(e){return"string"==typeof e?yr.fromBase64String(e):yr.fromUint8Array(e)}const kr="server_timestamp",Sr="__type__",Tr="__previous_value__",Ir="__local_write_time__";function _r(e){var t,n;return(null===(t=((null===e||void 0===e||null===(n=e.mapValue)||void 0===n?void 0:n.fields)||{})[Sr])||void 0===t?void 0:t.stringValue)===kr}function Ar(e){const t=e.mapValue.fields[Tr];return _r(t)?Ar(t):t}function Er(e){const t=wr(e.mapValue.fields[Ir].timestampValue);return new pn(t.seconds,t.nanos)}class Pr{constructor(e,t,n,r,i,o,s,a,c,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.longPollingOptions=a,this.useFetchStreams=c,this.isUsingEmulator=l}}const Rr="(default)";class Nr{constructor(e,t){this.projectId=e,this.database=t||Rr}static empty(){return new Nr("","")}get isDefaultDatabase(){return this.database===Rr}isEqual(e){return e instanceof Nr&&e.projectId===this.projectId&&e.database===this.database}}const Or="__type__",Mr="__max__",xr={mapValue:{fields:{__type__:{stringValue:Mr}}}},Dr="__vector__",Lr="value";function Fr(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?_r(e)?4:Zr(e)?9007199254740991:Xr(e)?10:11:Pt(28295,{value:e})}function qr(e,t){if(e===t)return!0;const n=Fr(e);if(n!==Fr(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Er(e).isEqual(Er(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=wr(e.timestampValue),r=wr(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return Cr(e.bytesValue).isEqual(Cr(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return br(e.geoPointValue.latitude)===br(t.geoPointValue.latitude)&&br(e.geoPointValue.longitude)===br(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return br(e.integerValue)===br(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=br(e.doubleValue),r=br(t.doubleValue);return n===r?On(n)===On(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return Xt(e.arrayValue.values||[],t.arrayValue.values||[],qr);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(ar(n)!==ar(r))return!1;for(const i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!qr(n[i],r[i])))return!1;return!0}(e,t);default:return Pt(52216,{left:e})}}function Ur(e,t){return void 0!==(e.values||[]).find(e=>qr(e,t))}function zr(e,t){if(e===t)return 0;const n=Fr(e),r=Fr(t);if(n!==r)return Gt(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Gt(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=br(e.integerValue||e.doubleValue),r=br(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return Br(e.timestampValue,t.timestampValue);case 4:return Br(Er(e),Er(t));case 5:return Qt(e.stringValue,t.stringValue);case 6:return function(e,t){const n=Cr(e),r=Cr(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let i=0;i<n.length&&i<r.length;i++){const e=Gt(n[i],r[i]);if(0!==e)return e}return Gt(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=Gt(br(e.latitude),br(t.latitude));return 0!==n?n:Gt(br(e.longitude),br(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return Hr(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n,r,i,o;const s=e.fields||{},a=t.fields||{},c=null===(n=s[Lr])||void 0===n?void 0:n.arrayValue,l=null===(r=a[Lr])||void 0===r?void 0:r.arrayValue,u=Gt((null===c||void 0===c||null===(i=c.values)||void 0===i?void 0:i.length)||0,(null===l||void 0===l||null===(o=l.values)||void 0===o?void 0:o.length)||0);return 0!==u?u:Hr(c,l)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===xr.mapValue&&t===xr.mapValue)return 0;if(e===xr.mapValue)return 1;if(t===xr.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),i=t.fields||{},o=Object.keys(i);r.sort(),o.sort();for(let s=0;s<r.length&&s<o.length;++s){const e=Qt(r[s],o[s]);if(0!==e)return e;const t=zr(n[r[s]],i[o[s]]);if(0!==t)return t}return Gt(r.length,o.length)}(e.mapValue,t.mapValue);default:throw Pt(23264,{he:n})}}function Br(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return Gt(e,t);const n=wr(e),r=wr(t),i=Gt(n.seconds,r.seconds);return 0!==i?i:Gt(n.nanos,r.nanos)}function Hr(e,t){const n=e.values||[],r=t.values||[];for(let i=0;i<n.length&&i<r.length;++i){const e=zr(n[i],r[i]);if(e)return e}return Gt(n.length,r.length)}function Vr(e){return jr(e)}function jr(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=wr(e);return"time(".concat(t.seconds,",").concat(t.nanos,")")}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return Cr(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return rn.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return"geo(".concat(e.latitude,",").concat(e.longitude,")")}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=jr(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+="".concat(i,":").concat(jr(e.fields[i]));return n+"}"}(e.mapValue):Pt(61005,{value:e})}function Kr(e){switch(Fr(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=Ar(e);return t?16+Kr(t):16;case 5:return 2*e.stringValue.length;case 6:return Cr(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(e){return(e.values||[]).reduce((e,t)=>e+Kr(t),0)}(e.arrayValue);case 10:case 11:return function(e){let t=0;return cr(e.fields,(e,n)=>{t+=e.length+Kr(n)}),t}(e.mapValue);default:throw Pt(13486,{value:e})}}function Gr(e){return!!e&&"integerValue"in e}function Qr(e){return!!e&&"arrayValue"in e}function Wr(e){return!!e&&"nullValue"in e}function Yr(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Jr(e){return!!e&&"mapValue"in e}function Xr(e){var t,n;return(null===(t=((null===e||void 0===e||null===(n=e.mapValue)||void 0===n?void 0:n.fields)||{})[Or])||void 0===t?void 0:t.stringValue)===Dr}function $r(e){if(e.geoPointValue)return{geoPointValue:l({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:l({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return cr(e.mapValue.fields,(e,n)=>t.mapValue.fields[e]=$r(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=$r(e.arrayValue.values[n]);return t}return l({},e)}function Zr(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===Mr}class ei{constructor(e){this.value=e}static empty(){return new ei({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Jr(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=$r(t)}setAll(e){let t=nn.emptyPath(),n={},r=[];e.forEach((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=$r(e):r.push(i.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());Jr(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return qr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];Jr(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){cr(t,(t,n)=>e[t]=n);for(const r of n)delete e[r]}clone(){return new ei($r(this.value))}}function ti(e){const t=[];return cr(e.fields,(e,n)=>{const r=new nn([e]);if(Jr(n)){const e=ti(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)}),new pr(t)}class ni{constructor(e,t,n,r,i,o,s){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=o,this.documentState=s}static newInvalidDocument(e){return new ni(e,0,mn.min(),mn.min(),mn.min(),ei.empty(),0)}static newFoundDocument(e,t,n,r){return new ni(e,1,t,mn.min(),n,r,0)}static newNoDocument(e,t){return new ni(e,2,t,mn.min(),mn.min(),ei.empty(),0)}static newUnknownDocument(e,t){return new ni(e,3,t,mn.min(),mn.min(),ei.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(mn.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ei.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ei.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=mn.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof ni&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ni(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}class ri{constructor(e,t){this.position=e,this.inclusive=t}}function ii(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const o=t[i],s=e.position[i];if(r=o.field.isKeyField()?rn.comparator(rn.fromName(s.referenceValue),n.key):zr(s,n.data.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return r}function oi(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!qr(e.position[n],t.position[n]))return!1;return!0}class si{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function ai(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class ci{}class li extends ci{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new yi(e,t,n):"array-contains"===t?new Ci(e,n):"in"===t?new ki(e,n):"not-in"===t?new Si(e,n):"array-contains-any"===t?new Ti(e,n):new li(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new vi(e,n):new wi(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&void 0===t.nullValue&&this.matchesComparison(zr(t,this.value)):null!==t&&Fr(this.value)===Fr(t)&&this.matchesComparison(zr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Pt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ui extends ci{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new ui(e,t)}matches(e){return hi(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.Pe||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function hi(e){return"and"===e.op}function di(e){return fi(e)&&hi(e)}function fi(e){for(const t of e.filters)if(t instanceof ui)return!1;return!0}function gi(e){if(e instanceof li)return e.field.canonicalString()+e.op.toString()+Vr(e.value);if(di(e))return e.filters.map(e=>gi(e)).join(",");{const t=e.filters.map(e=>gi(e)).join(",");return"".concat(e.op,"(").concat(t,")")}}function pi(e,t){return e instanceof li?function(e,t){return t instanceof li&&e.op===t.op&&e.field.isEqual(t.field)&&qr(e.value,t.value)}(e,t):e instanceof ui?function(e,t){return t instanceof ui&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((e,n,r)=>e&&pi(n,t.filters[r]),!0)}(e,t):void Pt(19439)}function mi(e){return e instanceof li?function(e){return"".concat(e.field.canonicalString()," ").concat(e.op," ").concat(Vr(e.value))}(e):e instanceof ui?function(e){return e.op.toString()+" {"+e.getFilters().map(mi).join(" ,")+"}"}(e):"Filter"}class yi extends li{constructor(e,t,n){super(e,t,n),this.key=rn.fromName(n.referenceValue)}matches(e){const t=rn.comparator(e.key,this.key);return this.matchesComparison(t)}}class vi extends li{constructor(e,t){super(e,"in",t),this.keys=bi("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class wi extends li{constructor(e,t){super(e,"not-in",t),this.keys=bi("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function bi(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(e=>rn.fromName(e.referenceValue))}class Ci extends li{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Qr(t)&&Ur(t.arrayValue,this.value)}}class ki extends li{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Ur(this.value.arrayValue,t)}}class Si extends li{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ur(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&void 0===t.nullValue&&!Ur(this.value.arrayValue,t)}}class Ti extends li{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Qr(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>Ur(this.value.arrayValue,e))}}class Ii{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.Te=null}}function _i(e){return new Ii(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function Ai(e){const t=Ot(e);if(null===t.Te){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>gi(e)).join(","),e+="|ob:",e+=t.orderBy.map(e=>function(e){return e.field.canonicalString()+e.dir}(e)).join(","),Nn(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(e=>Vr(e)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(e=>Vr(e)).join(",")),t.Te=e}return t.Te}function Ei(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!ai(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!pi(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!oi(e.startAt,t.startAt)&&oi(e.endAt,t.endAt)}function Pi(e){return rn.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class Ri{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=a,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function Ni(e,t,n,r,i,o,s,a){return new Ri(e,t,n,r,i,o,s,a)}function Oi(e){return new Ri(e)}function Mi(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function xi(e){return null!==e.collectionGroup}function Di(e){const t=Ot(e);if(null===t.Ie){t.Ie=[];const e=new Set;for(const i of t.explicitOrderBy)t.Ie.push(i),e.add(i.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new fr(nn.comparator);return e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(t=t.add(e.field))})}),t}(t);r.forEach(r=>{e.has(r.canonicalString())||r.isKeyField()||t.Ie.push(new si(r,n))}),e.has(nn.keyField().canonicalString())||t.Ie.push(new si(nn.keyField(),n))}return t.Ie}function Li(e){const t=Ot(e);return t.Ee||(t.Ee=Fi(t,Di(e))),t.Ee}function Fi(e,t){if("F"===e.limitType)return _i(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(e=>{const t="desc"===e.dir?"asc":"desc";return new si(e.field,t)});const n=e.endAt?new ri(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new ri(e.startAt.position,e.startAt.inclusive):null;return _i(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function qi(e,t,n){return new Ri(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Ui(e,t){return Ei(Li(e),Li(t))&&e.limitType===t.limitType}function zi(e){return"".concat(Ai(Li(e)),"|lt:").concat(e.limitType)}function Bi(e){return"Query(target=".concat(function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map(e=>mi(e)).join(", "),"]")),Nn(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map(e=>function(e){return"".concat(e.field.canonicalString()," (").concat(e.dir,")")}(e)).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>Vr(e)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>Vr(e)).join(",")),"Target(".concat(t,")")}(Li(e)),"; limitType=").concat(e.limitType,")")}function Hi(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):rn.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of Di(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=ii(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,Di(e),t))&&!(e.endAt&&!function(e,t,n){const r=ii(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,Di(e),t))}(e,t)}function Vi(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function ji(e){return(t,n)=>{let r=!1;for(const i of Di(e)){const e=Ki(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function Ki(e,t,n){const r=e.field.isKeyField()?rn.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?zr(r,i):Pt(42886)}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return Pt(19790,{direction:e.dir})}}class Gi{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,i]of n)if(this.equalsFn(r,e))return i}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){cr(this.inner,(t,n)=>{for(const[r,i]of n)e(r,i)})}isEmpty(){return lr(this.inner)}size(){return this.innerSize}}const Qi=new ur(rn.comparator);function Wi(){return Qi}const Yi=new ur(rn.comparator);function Ji(){let e=Yi;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.insert(i.key,i);return e}function Xi(e){let t=Yi;return e.forEach((e,n)=>t=t.insert(e,n.overlayedDocument)),t}function $i(){return eo()}function Zi(){return eo()}function eo(){return new Gi(e=>e.toString(),(e,t)=>e.isEqual(t))}const to=new ur(rn.comparator),no=new fr(rn.comparator);function ro(){let e=no;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.add(i);return e}const io=new fr(Gt);function oo(){return io}function so(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:On(t)?"-0":t}}function ao(e){return{integerValue:""+e}}function co(e,t){return Mn(t)?ao(t):so(e,t)}class lo{constructor(){this._=void 0}}function uo(e,t,n){return e instanceof go?function(e,t){const n={fields:{[Sr]:{stringValue:kr},[Ir]:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&_r(t)&&(t=Ar(t)),t&&(n.fields[Tr]=t),{mapValue:n}}(n,t):e instanceof po?mo(e,t):e instanceof yo?vo(e,t):function(e,t){const n=fo(e,t),r=bo(n)+bo(e.Ae);return Gr(n)&&Gr(e.Ae)?ao(r):so(e.serializer,r)}(e,t)}function ho(e,t,n){return e instanceof po?mo(e,t):e instanceof yo?vo(e,t):n}function fo(e,t){return e instanceof wo?function(e){return Gr(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class go extends lo{}class po extends lo{constructor(e){super(),this.elements=e}}function mo(e,t){const n=Co(t);for(const r of e.elements)n.some(e=>qr(e,r))||n.push(r);return{arrayValue:{values:n}}}class yo extends lo{constructor(e){super(),this.elements=e}}function vo(e,t){let n=Co(t);for(const r of e.elements)n=n.filter(e=>!qr(e,r));return{arrayValue:{values:n}}}class wo extends lo{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function bo(e){return br(e.integerValue||e.doubleValue)}function Co(e){return Qr(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class ko{constructor(e,t){this.version=e,this.transformResults=t}}class So{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new So}static exists(e){return new So(void 0,e)}static updateTime(e){return new So(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function To(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Io{}function _o(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Lo(e.key,So.none()):new No(e.key,e.data,So.none());{const n=e.data,r=ei.empty();let i=new fr(nn.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new Oo(e.key,r,new pr(i.toArray()),So.none())}}function Ao(e,t,n){e instanceof No?function(e,t,n){const r=e.value.clone(),i=xo(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof Oo?function(e,t,n){if(!To(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=xo(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(Mo(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function Eo(e,t,n,r){return e instanceof No?function(e,t,n,r){if(!To(e.precondition,t))return n;const i=e.value.clone(),o=Do(e.fieldTransforms,r,t);return i.setAll(o),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof Oo?function(e,t,n,r){if(!To(e.precondition,t))return n;const i=Do(e.fieldTransforms,r,t),o=t.data;return o.setAll(Mo(e)),o.setAll(i),t.convertToFoundDocument(t.version,o).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,n,r):function(e,t,n){return To(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function Po(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=fo(r.transform,e||null);null!=i&&(null===n&&(n=ei.empty()),n.set(r.field,i))}return n||null}function Ro(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&Xt(e,t,(e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof po&&t instanceof po||e instanceof yo&&t instanceof yo?Xt(e.elements,t.elements,qr):e instanceof wo&&t instanceof wo?qr(e.Ae,t.Ae):e instanceof go&&t instanceof go}(e.transform,t.transform)}(e,t))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class No extends Io{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Oo extends Io{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Mo(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function xo(e,t,n){const r=new Map;Nt(e.length===n.length,32656,{Re:n.length,Ve:e.length});for(let i=0;i<n.length;i++){const o=e[i],s=o.transform,a=t.data.field(o.field);r.set(o.field,ho(s,a,n[i]))}return r}function Do(e,t,n){const r=new Map;for(const i of e){const e=i.transform,o=n.data.field(i.field);r.set(i.field,uo(e,o,t))}return r}class Lo extends Io{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Fo extends Io{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class qo{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&Ao(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Eo(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Eo(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Zi();return this.mutations.forEach(r=>{const i=e.get(r.key),o=i.overlayedDocument;let s=this.applyToLocalView(o,i.mutatedFields);s=t.has(r.key)?null:s;const a=_o(o,s);null!==a&&n.set(r.key,a),o.isValidDocument()||o.convertToNoDocument(mn.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),ro())}isEqual(e){return this.batchId===e.batchId&&Xt(this.mutations,e.mutations,(e,t)=>Ro(e,t))&&Xt(this.baseMutations,e.baseMutations,(e,t)=>Ro(e,t))}}class Uo{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){Nt(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let r=to;const i=e.mutations;for(let o=0;o<i.length;o++)r=r.insert(i[o].key,n[o].version);return new Uo(e,t,n,r)}}class zo{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}class Bo{constructor(e,t){this.count=e,this.unchangedNames=t}}var Ho,Vo;function jo(e){switch(e){case Mt.OK:return Pt(64938);case Mt.CANCELLED:case Mt.UNKNOWN:case Mt.DEADLINE_EXCEEDED:case Mt.RESOURCE_EXHAUSTED:case Mt.INTERNAL:case Mt.UNAVAILABLE:case Mt.UNAUTHENTICATED:return!1;case Mt.INVALID_ARGUMENT:case Mt.NOT_FOUND:case Mt.ALREADY_EXISTS:case Mt.PERMISSION_DENIED:case Mt.FAILED_PRECONDITION:case Mt.ABORTED:case Mt.OUT_OF_RANGE:case Mt.UNIMPLEMENTED:case Mt.DATA_LOSS:return!0;default:return Pt(15467,{code:e})}}function Ko(e){if(void 0===e)return _t("GRPC error has no .code"),Mt.UNKNOWN;switch(e){case Ho.OK:return Mt.OK;case Ho.CANCELLED:return Mt.CANCELLED;case Ho.UNKNOWN:return Mt.UNKNOWN;case Ho.DEADLINE_EXCEEDED:return Mt.DEADLINE_EXCEEDED;case Ho.RESOURCE_EXHAUSTED:return Mt.RESOURCE_EXHAUSTED;case Ho.INTERNAL:return Mt.INTERNAL;case Ho.UNAVAILABLE:return Mt.UNAVAILABLE;case Ho.UNAUTHENTICATED:return Mt.UNAUTHENTICATED;case Ho.INVALID_ARGUMENT:return Mt.INVALID_ARGUMENT;case Ho.NOT_FOUND:return Mt.NOT_FOUND;case Ho.ALREADY_EXISTS:return Mt.ALREADY_EXISTS;case Ho.PERMISSION_DENIED:return Mt.PERMISSION_DENIED;case Ho.FAILED_PRECONDITION:return Mt.FAILED_PRECONDITION;case Ho.ABORTED:return Mt.ABORTED;case Ho.OUT_OF_RANGE:return Mt.OUT_OF_RANGE;case Ho.UNIMPLEMENTED:return Mt.UNIMPLEMENTED;case Ho.DATA_LOSS:return Mt.DATA_LOSS;default:return Pt(39323,{code:e})}}(Vo=Ho||(Ho={}))[Vo.OK=0]="OK",Vo[Vo.CANCELLED=1]="CANCELLED",Vo[Vo.UNKNOWN=2]="UNKNOWN",Vo[Vo.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Vo[Vo.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Vo[Vo.NOT_FOUND=5]="NOT_FOUND",Vo[Vo.ALREADY_EXISTS=6]="ALREADY_EXISTS",Vo[Vo.PERMISSION_DENIED=7]="PERMISSION_DENIED",Vo[Vo.UNAUTHENTICATED=16]="UNAUTHENTICATED",Vo[Vo.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Vo[Vo.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Vo[Vo.ABORTED=10]="ABORTED",Vo[Vo.OUT_OF_RANGE=11]="OUT_OF_RANGE",Vo[Vo.UNIMPLEMENTED=12]="UNIMPLEMENTED",Vo[Vo.INTERNAL=13]="INTERNAL",Vo[Vo.UNAVAILABLE=14]="UNAVAILABLE",Vo[Vo.DATA_LOSS=15]="DATA_LOSS";let Go=null;function Qo(){return new TextEncoder}const Wo=new ot([4294967295,4294967295],0);function Yo(e){const t=Qo().encode(e),n=new st;return n.update(t),new Uint8Array(n.digest())}function Jo(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),o=t.getUint32(12,!0);return[new ot([n,r],0),new ot([i,o],0)]}class Xo{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new $o("Invalid padding: ".concat(t));if(n<0)throw new $o("Invalid hash count: ".concat(n));if(e.length>0&&0===this.hashCount)throw new $o("Invalid hash count: ".concat(n));if(0===e.length&&0!==t)throw new $o("Invalid padding when bitmap length is 0: ".concat(t));this.ge=8*e.length-t,this.pe=ot.fromNumber(this.ge)}ye(e,t,n){let r=e.add(t.multiply(ot.fromNumber(n)));return 1===r.compare(Wo)&&(r=new ot([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.ge)return!1;const t=Yo(e),[n,r]=Jo(t);for(let i=0;i<this.hashCount;i++){const e=this.ye(n,r,i);if(!this.we(e))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Xo(i,r,t);return n.forEach(e=>o.insert(e)),o}insert(e){if(0===this.ge)return;const t=Yo(e),[n,r]=Jo(t);for(let i=0;i<this.hashCount;i++){const e=this.ye(n,r,i);this.Se(e)}}Se(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class $o extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Zo{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,es.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new Zo(mn.min(),r,new ur(Gt),Wi(),ro())}}class es{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new es(n,t,ro(),ro(),ro())}}class ts{constructor(e,t,n,r){this.be=e,this.removedTargetIds=t,this.key=n,this.De=r}}class ns{constructor(e,t){this.targetId=e,this.Ce=t}}class rs{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:yr.EMPTY_BYTE_STRING,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class is{constructor(){this.ve=0,this.Fe=as(),this.Me=yr.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return 0!==this.ve}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=ro(),t=ro(),n=ro();return this.Fe.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:Pt(38017,{changeType:i})}}),new es(this.Me,this.xe,e,t,n)}qe(){this.Oe=!1,this.Fe=as()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Nt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class os{constructor(e){this.Ge=e,this.ze=new Map,this.je=Wi(),this.Je=ss(),this.He=ss(),this.Ye=new ur(Gt)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{const n=this.nt(t);switch(e.state){case 0:this.rt(t)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),n.Le(e.resumeToken));break;default:Pt(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((e,n)=>{this.rt(n)&&t(n)})}st(e){const t=e.targetId,n=e.Ce.count,r=this.ot(t);if(r){const o=r.target;if(Pi(o))if(0===n){const e=new rn(o.path);this.et(t,e,ni.newNoDocument(e,mn.min()))}else Nt(1===n,20013,{expectedCount:n});else{const r=this._t(t);if(r!==n){var i;const n=this.ut(e),o=n?this.ct(n,e,r):1;if(0!==o){this.it(t);const e=2===o?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,e)}null===(i=Go)||void 0===i||i.lt(function(e,t,n,r,i){var o,s,a,c,l;const u={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},h=t.unchangedNames;return h&&(u.bloomFilter={applied:0===i,hashCount:null!==(o=null===h||void 0===h?void 0:h.hashCount)&&void 0!==o?o:0,bitmapLength:null!==(s=null===h||void 0===h||null===(a=h.bits)||void 0===a||null===(a=a.bitmap)||void 0===a?void 0:a.length)&&void 0!==s?s:0,padding:null!==(c=null===h||void 0===h||null===(l=h.bits)||void 0===l?void 0:l.padding)&&void 0!==c?c:0,mightContain:e=>{var t;return null!==(t=null===r||void 0===r?void 0:r.mightContain(e))&&void 0!==t&&t}}),u}(r,e.Ce,this.Ge.ht(),n,o))}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:i=0}=t;let o,s;try{o=Cr(n).toUint8Array()}catch(e){if(e instanceof mr)return At("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{s=new Xo(o,r,i)}catch(e){return At(e instanceof $o?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===s.ge?null:s}ct(e,t,n){return t.Ce.count===n-this.Pt(e,t.targetId)?0:2}Pt(e,t){const n=this.Ge.getRemoteKeysForTarget(t);let r=0;return n.forEach(n=>{const i=this.Ge.ht(),o="projects/".concat(i.projectId,"/databases/").concat(i.database,"/documents/").concat(n.path.canonicalString());e.mightContain(o)||(this.et(t,n,null),r++)}),r}Tt(e){const t=new Map;this.ze.forEach((n,r)=>{const i=this.ot(r);if(i){if(n.current&&Pi(i.target)){const t=new rn(i.target.path);this.It(t).has(r)||this.Et(r,t)||this.et(r,t,ni.newNoDocument(t,e))}n.Be&&(t.set(r,n.ke()),n.qe())}});let n=ro();this.He.forEach((e,t)=>{let r=!0;t.forEachWhile(e=>{const t=this.ot(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)}),r&&(n=n.add(e))}),this.je.forEach((t,n)=>n.setReadTime(e));const r=new Zo(e,t,this.Ye,this.je,n);return this.je=Wi(),this.Je=ss(),this.He=ss(),this.Ye=new ur(Gt),r}Xe(e,t){if(!this.rt(e))return;const n=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,n),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,n){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,t)?r.Qe(t,1):r.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),n&&(this.je=this.je.insert(t,n))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new is,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new fr(Gt),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new fr(Gt),this.Je=this.Je.insert(e,t)),t}rt(e){const t=null!==this.ot(e);return t||It("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new is),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function ss(){return new ur(rn.comparator)}function as(){return new ur(rn.comparator)}const cs={asc:"ASCENDING",desc:"DESCENDING"},ls={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},us={and:"AND",or:"OR"};class hs{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function ds(e,t){return e.useProto3Json||Nn(t)?t:{value:t}}function fs(e,t){return e.useProto3Json?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function gs(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function ps(e,t){return fs(e,t.toTimestamp())}function ms(e){return Nt(!!e,49232),mn.fromTimestamp(function(e){const t=wr(e);return new pn(t.seconds,t.nanos)}(e))}function ys(e,t){return vs(e,t).canonicalString()}function vs(e,t){const n=function(e){return new en(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function ws(e){const t=en.fromString(e);return Nt(Us(t),10190,{key:t.toString()}),t}function bs(e,t){return ys(e.databaseId,t.path)}function Cs(e,t){const n=ws(t);if(n.get(1)!==e.databaseId.projectId)throw new xt(Mt.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new xt(Mt.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new rn(Is(n))}function ks(e,t){return ys(e.databaseId,t)}function Ss(e){const t=ws(e);return 4===t.length?en.emptyPath():Is(t)}function Ts(e){return new en(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Is(e){return Nt(e.length>4&&"documents"===e.get(4),29091,{key:e.toString()}),e.popFirst(5)}function _s(e,t,n){return{name:bs(e,t),fields:n.value.mapValue.fields}}function As(e,t){let n;if(t instanceof No)n={update:_s(e,t.key,t.value)};else if(t instanceof Lo)n={delete:bs(e,t.key)};else if(t instanceof Oo)n={update:_s(e,t.key,t.data),updateMask:qs(t.fieldMask)};else{if(!(t instanceof Fo))return Pt(16599,{Vt:t.type});n={verify:bs(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(e=>function(e,t){const n=t.transform;if(n instanceof go)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof po)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof yo)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof wo)return{fieldPath:t.field.canonicalString(),increment:n.Ae};throw Pt(20930,{transform:t.transform})}(0,e))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:ps(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Pt(27497)}(e,t.precondition)),n}function Es(e,t){return{documents:[ks(e,t.path)]}}function Ps(e,t){const n={structuredQuery:{}},r=t.path;let i;null!==t.collectionGroup?(i=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=ks(e,i);const o=function(e){if(0!==e.length)return Fs(ui.create(e,"and"))}(t.filters);o&&(n.structuredQuery.where=o);const s=function(e){if(0!==e.length)return e.map(e=>function(e){return{field:Ds(e.field),direction:Os(e.dir)}}(e))}(t.orderBy);s&&(n.structuredQuery.orderBy=s);const a=ds(e,t.limit);return null!==a&&(n.structuredQuery.limit=a),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{ft:n,parent:i}}function Rs(e){let t=Ss(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Nt(1===r,65062);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let o=[];n.where&&(o=function(e){const t=Ns(e);return t instanceof ui&&di(t)?t.getFilters():[t]}(n.where));let s=[];n.orderBy&&(s=function(e){return e.map(e=>function(e){return new si(Ls(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e))}(n.orderBy));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,Nn(t)?null:t}(n.limit));let c=null;n.startAt&&(c=function(e){const t=!!e.before,n=e.values||[];return new ri(n,t)}(n.startAt));let l=null;return n.endAt&&(l=function(e){const t=!e.before,n=e.values||[];return new ri(n,t)}(n.endAt)),Ni(t,i,s,o,a,"F",c,l)}function Ns(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Ls(e.unaryFilter.field);return li.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=Ls(e.unaryFilter.field);return li.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Ls(e.unaryFilter.field);return li.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=Ls(e.unaryFilter.field);return li.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Pt(61313);default:return Pt(60726)}}(e):void 0!==e.fieldFilter?function(e){return li.create(Ls(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Pt(58110);default:return Pt(50506)}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return ui.create(e.compositeFilter.filters.map(e=>Ns(e)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return Pt(1026)}}(e.compositeFilter.op))}(e):Pt(30097,{filter:e})}function Os(e){return cs[e]}function Ms(e){return ls[e]}function xs(e){return us[e]}function Ds(e){return{fieldPath:e.canonicalString()}}function Ls(e){return nn.fromServerFormat(e.fieldPath)}function Fs(e){return e instanceof li?function(e){if("=="===e.op){if(Yr(e.value))return{unaryFilter:{field:Ds(e.field),op:"IS_NAN"}};if(Wr(e.value))return{unaryFilter:{field:Ds(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Yr(e.value))return{unaryFilter:{field:Ds(e.field),op:"IS_NOT_NAN"}};if(Wr(e.value))return{unaryFilter:{field:Ds(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ds(e.field),op:Ms(e.op),value:e.value}}}(e):e instanceof ui?function(e){const t=e.getFilters().map(e=>Fs(e));return 1===t.length?t[0]:{compositeFilter:{op:xs(e.op),filters:t}}}(e):Pt(54877,{filter:e})}function qs(e){const t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function Us(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class zs{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:mn.min(),o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:mn.min(),s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:yr.EMPTY_BYTE_STRING,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s,this.expectedCount=a}withSequenceNumber(e){return new zs(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new zs(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new zs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new zs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Bs{constructor(e){this.yt=e}}function Hs(e){const t=Rs({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?qi(t,t.limit,"L"):t}class Vs{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(br(e.integerValue));else if("doubleValue"in e){const n=br(e.doubleValue);isNaN(n)?this.Ft(t,13):(this.Ft(t,15),On(n)?t.Mt(0):t.Mt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Ft(t,20),"string"==typeof n&&(n=wr(n)),t.xt("".concat(n.seconds||"")),t.Mt(n.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Cr(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Ft(t,45),t.Mt(n.latitude||0),t.Mt(n.longitude||0)}else"mapValue"in e?Zr(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):Xr(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Pt(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const n=e.fields||{};this.Ft(t,55);for(const r of Object.keys(n))this.Ot(r,t),this.Ct(n[r],t)}kt(e,t){var n;const r=e.fields||{};this.Ft(t,53);const i=Lr,o=(null===(n=r[i].arrayValue)||void 0===n||null===(n=n.values)||void 0===n?void 0:n.length)||0;this.Ft(t,15),t.Mt(br(o)),this.Ot(i,t),this.Ct(r[i],t)}Qt(e,t){const n=e.values||[];this.Ft(t,50);for(const r of n)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),rn.fromName(e).path.forEach(e=>{this.Ft(t,60),this.Ut(e,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}Vs.Kt=new Vs;class js{constructor(){this.Cn=new Ks}addToCollectionParentIndex(e,t){return this.Cn.add(t),_n.resolve()}getCollectionParents(e,t){return _n.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return _n.resolve()}deleteFieldIndex(e,t){return _n.resolve()}deleteAllFieldIndexes(e){return _n.resolve()}createTargetIndexes(e,t){return _n.resolve()}getDocumentsMatchingTarget(e,t){return _n.resolve(null)}getIndexType(e,t){return _n.resolve(0)}getFieldIndexes(e,t){return _n.resolve([])}getNextCollectionGroupToUpdate(e){return _n.resolve(null)}getMinOffset(e,t){return _n.resolve(Cn.min())}getMinOffsetFromCollectionGroup(e,t){return _n.resolve(Cn.min())}updateCollectionGroup(e,t,n){return _n.resolve()}updateIndexEntries(e,t){return _n.resolve()}}class Ks{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new fr(en.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new fr(en.comparator)).toArray()}}new Uint8Array(0);const Gs={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Qs=41943040;class Ws{static withCacheSize(e){return new Ws(e,Ws.DEFAULT_COLLECTION_PERCENTILE,Ws.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}Ws.DEFAULT_COLLECTION_PERCENTILE=10,Ws.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ws.DEFAULT=new Ws(Qs,Ws.DEFAULT_COLLECTION_PERCENTILE,Ws.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ws.DISABLED=new Ws(-1,0,0);class Ys{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Ys(0)}static cr(){return new Ys(-1)}}const Js="LruGarbageCollector",Xs=1048576;function $s(e,t){let[n,r]=e,[i,o]=t;const s=Gt(n,i);return 0===s?Gt(r,o):s}class Zs{constructor(e){this.Ir=e,this.buffer=new fr($s),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();$s(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class ea{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return null!==this.Rr}Vr(e){It(Js,"Garbage collection scheduled in ".concat(e,"ms")),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){En(e)?It(Js,"Ignoring IndexedDB error during garbage collection: ",e):await In(e)}await this.Vr(3e5)})}}class ta{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(e=>Math.floor(t/100*e))}nthSequenceNumber(e,t){if(0===t)return _n.resolve(Pn.ce);const n=new Zs(t);return this.mr.forEachTarget(e,e=>n.Ar(e.sequenceNumber)).next(()=>this.mr.pr(e,e=>n.Ar(e))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.mr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(It("LruGarbageCollector","Garbage collection skipped; disabled"),_n.resolve(Gs)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(It("LruGarbageCollector","Garbage collection skipped; Cache size ".concat(n," is lower than threshold ").concat(this.params.cacheSizeCollectionThreshold)),Gs):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let n,r,i,o,s,a,c;const l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(t=>(t>this.params.maximumSequenceNumbersToCollect?(It("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of ".concat(this.params.maximumSequenceNumbersToCollect," from ").concat(t)),r=this.params.maximumSequenceNumbersToCollect):r=t,o=Date.now(),this.nthSequenceNumber(e,r))).next(r=>(n=r,s=Date.now(),this.removeTargets(e,n,t))).next(t=>(i=t,a=Date.now(),this.removeOrphanedDocuments(e,n))).next(e=>(c=Date.now(),Tt()<=U.DEBUG&&It("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in ".concat(o-l,"ms\n\tDetermined least recently used ").concat(r," in ")+(s-o)+"ms\n"+"\tRemoved ".concat(i," targets in ")+(a-s)+"ms\n"+"\tRemoved ".concat(e," documents in ")+(c-a)+"ms\n"+"Total Duration: ".concat(c-l,"ms")),_n.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e})))}}function na(e,t){return new ta(e,t)}class ra{constructor(){this.changes=new Gi(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ni.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?_n.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class ia{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class oa{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==n&&Eo(n.mutation,e,pr.empty(),pn.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,ro()).next(()=>t))}getLocalViewOfDocuments(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ro();const r=$i();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(e=>{let t=Ji();return e.forEach((e,n)=>{t=t.insert(e,n.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){const n=$i();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,ro()))}populateOverlays(e,t,n){const r=[];return n.forEach(e=>{t.has(e)||r.push(e)}),this.documentOverlayCache.getOverlays(e,r).next(e=>{e.forEach((e,n)=>{t.set(e,n)})})}computeViews(e,t,n,r){let i=Wi();const o=eo(),s=eo();return t.forEach((e,t)=>{const s=n.get(t.key);r.has(t.key)&&(void 0===s||s.mutation instanceof Oo)?i=i.insert(t.key,t):void 0!==s?(o.set(t.key,s.mutation.getFieldMask()),Eo(s.mutation,t,s.mutation.getFieldMask(),pn.now())):o.set(t.key,pr.empty())}),this.recalculateAndSaveOverlays(e,i).next(e=>(e.forEach((e,t)=>o.set(e,t)),t.forEach((e,t)=>{var n;return s.set(e,new ia(t,null!==(n=o.get(e))&&void 0!==n?n:null))}),s))}recalculateAndSaveOverlays(e,t){const n=eo();let r=new ur((e,t)=>e-t),i=ro();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(const i of e)i.keys().forEach(e=>{const o=t.get(e);if(null===o)return;let s=n.get(e)||pr.empty();s=i.applyToLocalView(o,s),n.set(e,s);const a=(r.get(i.batchId)||ro()).add(e);r=r.insert(i.batchId,a)})}).next(()=>{const o=[],s=r.getReverseIterator();for(;s.hasNext();){const r=s.getNext(),a=r.key,c=r.value,l=Zi();c.forEach(e=>{if(!i.has(e)){const r=_o(t.get(e),n.get(e));null!==r&&l.set(e,r),i=i.add(e)}}),o.push(this.documentOverlayCache.saveOverlays(e,a,l))}return _n.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return rn.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):xi(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(i=>{const o=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):_n.resolve($i());let s=yn,a=i;return o.next(t=>_n.forEach(t,(t,n)=>(s<n.largestBatchId&&(s=n.largestBatchId),i.get(t)?_n.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{a=a.insert(t,e)}))).next(()=>this.populateOverlays(e,t,i)).next(()=>this.computeViews(e,a,t,ro())).next(e=>({batchId:s,changes:Xi(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new rn(t)).next(e=>{let t=Ji();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const i=t.collectionGroup;let o=Ji();return this.indexManager.getCollectionParents(e,i).next(s=>_n.forEach(s,s=>{const a=function(e,t){return new Ri(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,s.child(i));return this.getDocumentsMatchingCollectionQuery(e,a,n,r).next(e=>{e.forEach((e,t)=>{o=o.insert(e,t)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r))).next(e=>{i.forEach((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,ni.newInvalidDocument(r)))});let n=Ji();return e.forEach((e,r)=>{const o=i.get(e);void 0!==o&&Eo(o.mutation,r,pr.empty(),pn.now()),Hi(t,r)&&(n=n.insert(e,r))}),n})}}class sa{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return _n.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:ms(e.createTime)}}(t)),_n.resolve()}getNamedQuery(e,t){return _n.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,function(e){return{name:e.name,query:Hs(e.bundledQuery),readTime:ms(e.readTime)}}(t)),_n.resolve()}}class aa{constructor(){this.overlays=new ur(rn.comparator),this.qr=new Map}getOverlay(e,t){return _n.resolve(this.overlays.get(t))}getOverlays(e,t){const n=$i();return _n.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((n,r)=>{this.St(e,t,r)}),_n.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.qr.get(n);return void 0!==r&&(r.forEach(e=>this.overlays=this.overlays.remove(e)),this.qr.delete(n)),_n.resolve()}getOverlaysForCollection(e,t,n){const r=$i(),i=t.length+1,o=new rn(t.child("")),s=this.overlays.getIteratorFrom(o);for(;s.hasNext();){const e=s.getNext().value,o=e.getKey();if(!t.isPrefixOf(o.path))break;o.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return _n.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new ur((e,t)=>e-t);const o=this.overlays.getIterator();for(;o.hasNext();){const e=o.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=$i(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const s=$i(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach((e,t)=>s.set(e,t)),!(s.size()>=r)););return _n.resolve(s)}St(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.qr.get(r.largestBatchId).delete(n.key);this.qr.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new zo(t,n));let i=this.qr.get(t);void 0===i&&(i=ro(),this.qr.set(t,i)),this.qr.set(t,i.add(n.key))}}class ca{constructor(){this.sessionToken=yr.EMPTY_BYTE_STRING}getSessionToken(e){return _n.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,_n.resolve()}}class la{constructor(){this.Qr=new fr(ua.$r),this.Ur=new fr(ua.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const n=new ua(e,t);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.Gr(new ua(e,t))}zr(e,t){e.forEach(e=>this.removeReference(e,t))}jr(e){const t=new rn(new en([])),n=new ua(t,e),r=new ua(t,e+1),i=[];return this.Ur.forEachInRange([n,r],e=>{this.Gr(e),i.push(e.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new rn(new en([])),n=new ua(t,e),r=new ua(t,e+1);let i=ro();return this.Ur.forEachInRange([n,r],e=>{i=i.add(e.key)}),i}containsKey(e){const t=new ua(e,0),n=this.Qr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class ua{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return rn.comparator(e.key,t.key)||Gt(e.Yr,t.Yr)}static Kr(e,t){return Gt(e.Yr,t.Yr)||rn.comparator(e.key,t.key)}}class ha{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new fr(ua.$r)}checkEmpty(e){return _n.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new qo(i,t,n,r);this.mutationQueue.push(o);for(const s of r)this.Zr=this.Zr.add(new ua(s.key,i)),this.indexManager.addToCollectionParentIndex(e,s.key.path.popLast());return _n.resolve(o)}lookupMutationBatch(e,t){return _n.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.ei(n),i=r<0?0:r;return _n.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return _n.resolve(0===this.mutationQueue.length?Rn:this.tr-1)}getAllMutationBatches(e){return _n.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new ua(t,0),r=new ua(t,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([n,r],e=>{const t=this.Xr(e.Yr);i.push(t)}),_n.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new fr(Gt);return t.forEach(e=>{const t=new ua(e,0),r=new ua(e,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([t,r],e=>{n=n.add(e.Yr)})}),_n.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;rn.isDocumentKey(i)||(i=i.child(""));const o=new ua(new rn(i),0);let s=new fr(Gt);return this.Zr.forEachWhile(e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(s=s.add(e.Yr)),!0)},o),_n.resolve(this.ti(s))}ti(e){const t=[];return e.forEach(e=>{const n=this.Xr(e);null!==n&&t.push(n)}),t}removeMutationBatch(e,t){Nt(0===this.ni(t.batchId,"removed"),55003),this.mutationQueue.shift();let n=this.Zr;return _n.forEach(t.mutations,r=>{const i=new ua(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,t){const n=new ua(t,0),r=this.Zr.firstAfterOrEqual(n);return _n.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,_n.resolve()}ni(e,t){return this.ei(e)}ei(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class da{constructor(e){this.ri=e,this.docs=new ur(rn.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,o=this.ri(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return _n.resolve(n?n.document.mutableCopy():ni.newInvalidDocument(t))}getEntries(e,t){let n=Wi();return t.forEach(e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():ni.newInvalidDocument(e))}),_n.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=Wi();const o=t.path,s=new rn(o.child("__id-9223372036854775808__")),a=this.docs.getIteratorFrom(s);for(;a.hasNext();){const{key:e,value:{document:s}}=a.getNext();if(!o.isPrefixOf(e.path))break;e.path.length>o.length+1||kn(bn(s),n)<=0||(r.has(s.key)||Hi(t,s))&&(i=i.insert(s.key,s.mutableCopy()))}return _n.resolve(i)}getAllFromCollectionGroup(e,t,n,r){Pt(9500)}ii(e,t){return _n.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new fa(this)}getSize(e){return _n.resolve(this.size)}}class fa extends ra{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(n)}),_n.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class ga{constructor(e){this.persistence=e,this.si=new Gi(e=>Ai(e),Ei),this.lastRemoteSnapshotVersion=mn.min(),this.highestTargetId=0,this.oi=0,this._i=new la,this.targetCount=0,this.ai=Ys.ur()}forEachTarget(e,t){return this.si.forEach((e,n)=>t(n)),_n.resolve()}getLastRemoteSnapshotVersion(e){return _n.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return _n.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),_n.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.oi&&(this.oi=t),_n.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Ys(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,_n.resolve()}updateTargetData(e,t){return this.Pr(t),_n.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,_n.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.si.forEach((o,s)=>{s.sequenceNumber<=t&&null===n.get(s.targetId)&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,s.targetId)),r++)}),_n.waitFor(i).next(()=>r)}getTargetCount(e){return _n.resolve(this.targetCount)}getTargetData(e,t){const n=this.si.get(t)||null;return _n.resolve(n)}addMatchingKeys(e,t,n){return this._i.Wr(t,n),_n.resolve()}removeMatchingKeys(e,t,n){this._i.zr(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(t=>{i.push(r.markPotentiallyOrphaned(e,t))}),_n.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),_n.resolve()}getMatchingKeysForTargetId(e,t){const n=this._i.Hr(t);return _n.resolve(n)}containsKey(e,t){return _n.resolve(this._i.containsKey(t))}}class pa{constructor(e,t){this.ui={},this.overlays={},this.ci=new Pn(0),this.li=!1,this.li=!0,this.hi=new ca,this.referenceDelegate=e(this),this.Pi=new ga(this),this.indexManager=new js,this.remoteDocumentCache=function(e){return new da(e)}(e=>this.referenceDelegate.Ti(e)),this.serializer=new Bs(t),this.Ii=new sa(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new aa,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ui[e.toKey()];return n||(n=new ha(t,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,n){It("MemoryPersistence","Starting transaction:",e);const r=new ma(this.ci.next());return this.referenceDelegate.Ei(),n(r).next(e=>this.referenceDelegate.di(r).next(()=>e)).toPromise().then(e=>(r.raiseOnCommittedEvent(),e))}Ai(e,t){return _n.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,t)))}}class ma extends Tn{constructor(e){super(),this.currentSequenceNumber=e}}class ya{constructor(e){this.persistence=e,this.Ri=new la,this.Vi=null}static mi(e){return new ya(e)}get fi(){if(this.Vi)return this.Vi;throw Pt(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.fi.delete(n.toString()),_n.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.fi.add(n.toString()),_n.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),_n.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(e=>this.fi.add(e.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.fi.add(e.toString()))}).next(()=>n.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return _n.forEach(this.fi,n=>{const r=rn.fromPath(n);return this.gi(e,r).next(e=>{e||t.removeEntry(r,mn.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(e=>{e?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return _n.or([()=>_n.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class va{constructor(e,t){this.persistence=e,this.pi=new Gi(e=>Dn(e.path),(e,t)=>e.isEqual(t)),this.garbageCollector=na(this,t)}static mi(e,t){return new va(e,t)}Ei(){}di(e){return _n.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}wr(e){let t=0;return this.pr(e,e=>{t++}).next(()=>t)}pr(e,t){return _n.forEach(this.pi,(n,r)=>this.br(e,n,r).next(e=>e?_n.resolve():t(r)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.ii(e,r=>this.br(e,r,t).next(e=>{e||(n++,i.removeEntry(r,mn.min()))})).next(()=>i.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),_n.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),_n.resolve()}removeReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),_n.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),_n.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Kr(e.data.value)),t}br(e,t,n){return _n.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const e=this.pi.get(t);return _n.resolve(void 0!==e&&e>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class wa{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Es=n,this.ds=r}static As(e,t){let n=ro(),r=ro();for(const i of t.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new wa(e,t.fromCache,n,r)}}class ba{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class Ca{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=_()?8:An(T())>0?6:4}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,r){const i={result:null};return this.ys(e,t).next(e=>{i.result=e}).next(()=>{if(!i.result)return this.ws(e,t,r,n).next(e=>{i.result=e})}).next(()=>{if(i.result)return;const n=new ba;return this.Ss(e,t,n).next(r=>{if(i.result=r,this.Vs)return this.bs(e,t,n,r.size)})}).next(()=>i.result)}bs(e,t,n,r){return n.documentReadCount<this.fs?(Tt()<=U.DEBUG&&It("QueryEngine","SDK will not create cache indexes for query:",Bi(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),_n.resolve()):(Tt()<=U.DEBUG&&It("QueryEngine","Query:",Bi(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.gs*r?(Tt()<=U.DEBUG&&It("QueryEngine","The SDK decides to create cache indexes for query:",Bi(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Li(t))):_n.resolve())}ys(e,t){if(Mi(t))return _n.resolve(null);let n=Li(t);return this.indexManager.getIndexType(e,n).next(r=>0===r?null:(null!==t.limit&&1===r&&(t=qi(t,null,"F"),n=Li(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(r=>{const i=ro(...r);return this.ps.getDocuments(e,i).next(r=>this.indexManager.getMinOffset(e,n).next(n=>{const o=this.Ds(t,r);return this.Cs(t,o,i,n.readTime)?this.ys(e,qi(t,null,"F")):this.vs(e,o,t,n)}))})))}ws(e,t,n,r){return Mi(t)||r.isEqual(mn.min())?_n.resolve(null):this.ps.getDocuments(e,n).next(i=>{const o=this.Ds(t,i);return this.Cs(t,o,n,r)?_n.resolve(null):(Tt()<=U.DEBUG&&It("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Bi(t)),this.vs(e,o,t,wn(r,yn)).next(e=>e))})}Ds(e,t){let n=new fr(ji(e));return t.forEach((t,r)=>{Hi(e,r)&&(n=n.add(r))}),n}Cs(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ss(e,t,n){return Tt()<=U.DEBUG&&It("QueryEngine","Using full collection scan to execute query:",Bi(t)),this.ps.getDocumentsMatchingQuery(e,t,Cn.min(),n)}vs(e,t,n,r){return this.ps.getDocumentsMatchingQuery(e,n,r).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}const ka="LocalStore";class Sa{constructor(e,t,n,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new ur(Gt),this.xs=new Gi(e=>Ai(e),Ei),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new oa(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}}function Ta(e,t,n,r){return new Sa(e,t,n,r)}async function Ia(e,t){const n=Ot(e);return await n.persistence.runTransaction("Handle user change","readonly",e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next(i=>(r=i,n.Bs(t),n.mutationQueue.getAllMutationBatches(e))).next(t=>{const i=[],o=[];let s=ro();for(const e of r){i.push(e.batchId);for(const t of e.mutations)s=s.add(t.key)}for(const e of t){o.push(e.batchId);for(const t of e.mutations)s=s.add(t.key)}return n.localDocuments.getDocuments(e,s).next(e=>({Ls:e,removedBatchIds:i,addedBatchIds:o}))})})}function _a(e){const t=Ot(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Pi.getLastRemoteSnapshotVersion(e))}function Aa(e,t,n){let r=ro(),i=ro();return n.forEach(e=>r=r.add(e)),t.getEntries(e,r).next(e=>{let r=Wi();return n.forEach((n,o)=>{const s=e.get(n);o.isFoundDocument()!==s.isFoundDocument()&&(i=i.add(n)),o.isNoDocument()&&o.version.isEqual(mn.min())?(t.removeEntry(n,o.readTime),r=r.insert(n,o)):!s.isValidDocument()||o.version.compareTo(s.version)>0||0===o.version.compareTo(s.version)&&s.hasPendingWrites?(t.addEntry(o),r=r.insert(n,o)):It(ka,"Ignoring outdated watch update for ",n,". Current version:",s.version," Watch version:",o.version)}),{ks:r,qs:i}})}function Ea(e,t){const n=Ot(e);return n.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=Rn),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)))}function Pa(e,t){const n=Ot(e);return n.persistence.runTransaction("Allocate target","readwrite",e=>{let r;return n.Pi.getTargetData(e,t).next(i=>i?(r=i,_n.resolve(r)):n.Pi.allocateTargetId(e).next(i=>(r=new zs(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.Pi.addTargetData(e,r).next(()=>r))))}).then(e=>{const r=n.Ms.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(e.targetId,e),n.xs.set(t,e.targetId)),e})}async function Ra(e,t,n){const r=Ot(e),i=r.Ms.get(t),o=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",o,e=>r.persistence.referenceDelegate.removeTarget(e,i))}catch(e){if(!En(e))throw e;It(ka,"Failed to update sequence numbers for target ".concat(t,": ").concat(e))}r.Ms=r.Ms.remove(t),r.xs.delete(i.target)}function Na(e,t,n){const r=Ot(e);let i=mn.min(),o=ro();return r.persistence.runTransaction("Execute query","readwrite",e=>function(e,t,n){const r=Ot(e),i=r.xs.get(n);return void 0!==i?_n.resolve(r.Ms.get(i)):r.Pi.getTargetData(t,n)}(r,e,Li(t)).next(t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(e,t.targetId).next(e=>{o=e})}).next(()=>r.Fs.getDocumentsMatchingQuery(e,t,n?i:mn.min(),n?o:ro())).next(e=>(Oa(r,Vi(t),e),{documents:e,Qs:o})))}function Oa(e,t,n){let r=e.Os.get(t)||mn.min();n.forEach((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)}),e.Os.set(t,r)}class Ma{constructor(){this.activeTargetIds=oo()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class xa{constructor(){this.Mo=new Ma,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,n){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Ma,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Da{Oo(e){}shutdown(){}}const La="ConnectivityMonitor";class Fa{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){It(La,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){It(La,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let qa=null;function Ua(){return null===qa?qa=268435456+Math.round(2147483648*Math.random()):qa++,"0x"+qa.toString(16)}const za="RestConnection",Ba={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Ha{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko="projects/".concat(n,"/databases/").concat(r),this.Wo=this.databaseId.database===Rr?"project_id=".concat(n):"project_id=".concat(n,"&database_id=").concat(r)}Go(e,t,n,r,i){const o=Ua(),s=this.zo(e,t.toUriEncodedString());It(za,"Sending RPC '".concat(e,"' ").concat(o,":"),s,n);const a={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(a,r,i);const{host:c}=new URL(s),l=b(c);return this.Jo(e,s,a,n,l).then(t=>(It(za,"Received RPC '".concat(e,"' ").concat(o,": "),t),t),t=>{throw At(za,"RPC '".concat(e,"' ").concat(o," failed with error: "),t,"url: ",s,"request:",n),t})}Ho(e,t,n,r,i,o){return this.Go(e,t,n,r,i)}jo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+kt,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,n)=>e[n]=t),n&&n.headers.forEach((t,n)=>e[n]=t)}zo(e,t){const n=Ba[e];return"".concat(this.Uo,"/v1/").concat(t,":").concat(n)}terminate(){}}class Va{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const ja="WebChannelConnection";class Ka extends Ha{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,r,i){const o=Ua();return new Promise((i,s)=>{const a=new lt;a.setWithCredentials(!0),a.listenOnce(ht.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case dt.NO_ERROR:const n=a.getResponseJson();It(ja,"XHR for RPC '".concat(e,"' ").concat(o," received:"),JSON.stringify(n)),i(n);break;case dt.TIMEOUT:It(ja,"RPC '".concat(e,"' ").concat(o," timed out")),s(new xt(Mt.DEADLINE_EXCEEDED,"Request time out"));break;case dt.HTTP_ERROR:const r=a.getStatus();if(It(ja,"RPC '".concat(e,"' ").concat(o," failed with status:"),r,"response text:",a.getResponseText()),r>0){var t;let e=a.getResponseJson();Array.isArray(e)&&(e=e[0]);const n=null===(t=e)||void 0===t?void 0:t.error;if(n&&n.status&&n.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(Mt).indexOf(t)>=0?t:Mt.UNKNOWN}(n.status);s(new xt(e,n.message))}else s(new xt(Mt.UNKNOWN,"Server responded with status "+a.getStatus()))}else s(new xt(Mt.UNAVAILABLE,"Connection failed."));break;default:Pt(9055,{l_:e,streamId:o,h_:a.getLastErrorCode(),P_:a.getLastError()})}}finally{It(ja,"RPC '".concat(e,"' ").concat(o," completed."))}});const c=JSON.stringify(r);It(ja,"RPC '".concat(e,"' ").concat(o," sending request:"),r),a.send(t,"POST",c,n,15)})}T_(e,t,n){const r=Ua(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=mt(),s=pt(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;void 0!==c&&(a.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(a.useFetchStreams=!0),this.jo(a.initMessageHeaders,t,n),a.encodeInitMessageHeaders=!0;const l=i.join("");It(ja,"Creating RPC '".concat(e,"' stream ").concat(r,": ").concat(l),a);const u=o.createWebChannel(l,a);this.I_(u);let h=!1,d=!1;const f=new Va({Yo:t=>{d?It(ja,"Not sending because RPC '".concat(e,"' stream ").concat(r," is closed:"),t):(h||(It(ja,"Opening RPC '".concat(e,"' stream ").concat(r," transport.")),u.open(),h=!0),It(ja,"RPC '".concat(e,"' stream ").concat(r," sending:"),t),u.send(t))},Zo:()=>u.close()}),g=(e,t,n)=>{e.listen(t,e=>{try{n(e)}catch(e){setTimeout(()=>{throw e},0)}})};return g(u,ut.EventType.OPEN,()=>{d||(It(ja,"RPC '".concat(e,"' stream ").concat(r," transport opened.")),f.o_())}),g(u,ut.EventType.CLOSE,()=>{d||(d=!0,It(ja,"RPC '".concat(e,"' stream ").concat(r," transport closed")),f.a_(),this.E_(u))}),g(u,ut.EventType.ERROR,t=>{d||(d=!0,At(ja,"RPC '".concat(e,"' stream ").concat(r," transport errored. Name:"),t.name,"Message:",t.message),f.a_(new xt(Mt.UNAVAILABLE,"The operation could not be completed")))}),g(u,ut.EventType.MESSAGE,t=>{if(!d){var n;const i=t.data[0];Nt(!!i,16349);const o=i,s=(null===o||void 0===o?void 0:o.error)||(null===(n=o[0])||void 0===n?void 0:n.error);if(s){It(ja,"RPC '".concat(e,"' stream ").concat(r," received error:"),s);const t=s.status;let n=function(e){const t=Ho[e];if(void 0!==t)return Ko(t)}(t),i=s.message;void 0===n&&(n=Mt.INTERNAL,i="Unknown error status: "+t+" with message "+s.message),d=!0,f.a_(new xt(n,i)),u.close()}else It(ja,"RPC '".concat(e,"' stream ").concat(r," received:"),i),f.u_(i)}}),g(s,gt.STAT_EVENT,t=>{t.stat===ft.PROXY?It(ja,"RPC '".concat(e,"' stream ").concat(r," detected buffering proxy")):t.stat===ft.NOPROXY&&It(ja,"RPC '".concat(e,"' stream ").concat(r," detected no buffering proxy"))}),setTimeout(()=>{f.__()},0),f}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}}function Ga(){return"undefined"!=typeof document?document:null}function Qa(e){return new hs(e,!0)}class Wa{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.Mi=e,this.timerId=t,this.d_=n,this.A_=r,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-n);r>0&&It("ExponentialBackoff","Backing off for ".concat(r," ms (base delay: ").concat(this.V_," ms, delay with jitter: ").concat(t," ms, last attempt: ").concat(n," ms ago)")),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){null!==this.m_&&(this.m_.skipDelay(),this.m_=null)}cancel(){null!==this.m_&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const Ya="PersistentStream";class Ja{constructor(e,t,n,r,i,o,s,a){this.Mi=e,this.S_=n,this.b_=r,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=s,this.listener=a,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Wa(e,t)}x_(){return 1===this.state||5===this.state||this.O_()}O_(){return 2===this.state||3===this.state}start(){this.F_=0,4!==this.state?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&null===this.C_&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,4!==e?this.M_.reset():t&&t.code===Mt.RESOURCE_EXHAUSTED?(_t(t.toString()),_t("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===Mt.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(e=>{let[n,r]=e;this.D_===t&&this.G_(n,r)},t=>{e(()=>{const e=new xt(Mt.UNKNOWN,"Fetching auth token failed: "+t.message);return this.z_(e)})})}G_(e,t){const n=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(e=>{n(()=>this.z_(e))}),this.stream.onMessage(e=>{n(()=>1==++this.F_?this.J_(e):this.onNext(e))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return It(Ya,"close with error: ".concat(e)),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(It(Ya,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Xa extends Ja{constructor(e,t,n,r,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,o),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:Pt(39313,{state:e})}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],o=function(e,t){return e.useProto3Json?(Nt(void 0===t||"string"==typeof t,58123),yr.fromBase64String(t||"")):(Nt(void 0===t||t instanceof Buffer||t instanceof Uint8Array,16193),yr.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),s=t.targetChange.cause,a=s&&function(e){const t=void 0===e.code?Mt.UNKNOWN:Ko(e.code);return new xt(t,e.message||"")}(s);n=new rs(r,i,o,a||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=Cs(e,r.document.name),o=ms(r.document.updateTime),s=r.document.createTime?ms(r.document.createTime):mn.min(),a=new ei({mapValue:{fields:r.document.fields}}),c=ni.newFoundDocument(i,o,s,a),l=r.targetIds||[],u=r.removedTargetIds||[];n=new ts(l,u,c.key,c)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=Cs(e,r.document),o=r.readTime?ms(r.readTime):mn.min(),s=ni.newNoDocument(i,o),a=r.removedTargetIds||[];n=new ts([],a,s.key,s)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=Cs(e,r.document),o=r.removedTargetIds||[];n=new ts([],o,i,null)}else{if(!("filter"in t))return Pt(11601,{Rt:t});{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:i}=e,o=new Bo(r,i),s=e.targetId;n=new ns(s,o)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return mn.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?mn.min():t.readTime?ms(t.readTime):mn.min()}(e);return this.listener.H_(t,n)}Y_(e){const t={};t.database=Ts(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=Pi(r)?{documents:Es(e,r)}:{query:Ps(e,r).ft},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=gs(e,t.resumeToken);const r=ds(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(mn.min())>0){n.readTime=fs(e,t.snapshotVersion.toTimestamp());const r=ds(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Pt(28987,{purpose:e})}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.q_(t)}Z_(e){const t={};t.database=Ts(this.serializer),t.removeTarget=e,this.q_(t)}}class $a extends Ja{constructor(e,t,n,r,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Nt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Nt(!e.writeResults||0===e.writeResults.length,55816),this.listener.ta()}onNext(e){Nt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=function(e,t){return e&&e.length>0?(Nt(void 0!==t,14353),e.map(e=>function(e,t){let n=e.updateTime?ms(e.updateTime):ms(t);return n.isEqual(mn.min())&&(n=ms(t)),new ko(n,e.transformResults||[])}(e,t))):[]}(e.writeResults,e.commitTime),n=ms(e.commitTime);return this.listener.na(n,t)}ra(){const e={};e.database=Ts(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map(e=>As(this.serializer,e))};this.q_(t)}}class Za{}class ec extends Za{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new xt(Mt.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,n,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(i=>{let[o,s]=i;return this.connection.Go(e,vs(t,n),r,o,s)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===Mt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new xt(Mt.UNKNOWN,e.toString())})}Ho(e,t,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(o=>{let[s,a]=o;return this.connection.Ho(e,vs(t,n),r,s,a,i)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===Mt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new xt(Mt.UNKNOWN,e.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class tc{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){0===this.oa&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){"Online"===this.state?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,"Online"===e&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.aa?(_t(t),this.aa=!1):It("OnlineStateTracker",t)}Pa(){null!==this._a&&(this._a.cancel(),this._a=null)}}const nc="RemoteStore";class rc{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(e=>{n.enqueueAndForget(async()=>{dc(this)&&(It(nc,"Restarting streams for network reachability change."),await async function(e){const t=Ot(e);t.Ea.add(4),await oc(t),t.Ra.set("Unknown"),t.Ea.delete(4),await ic(t)}(this))})}),this.Ra=new tc(n,r)}}async function ic(e){if(dc(e))for(const t of e.da)await t(!0)}async function oc(e){for(const t of e.da)await t(!1)}function sc(e,t){const n=Ot(e);n.Ia.has(t.targetId)||(n.Ia.set(t.targetId,t),hc(n)?uc(n):Nc(n).O_()&&cc(n,t))}function ac(e,t){const n=Ot(e),r=Nc(n);n.Ia.delete(t),r.O_()&&lc(n,t),0===n.Ia.size&&(r.O_()?r.L_():dc(n)&&n.Ra.set("Unknown"))}function cc(e,t){if(e.Va.Ue(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(mn.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}Nc(e).Y_(t)}function lc(e,t){e.Va.Ue(t),Nc(e).Z_(t)}function uc(e){e.Va=new os({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),At:t=>e.Ia.get(t)||null,ht:()=>e.datastore.serializer.databaseId}),Nc(e).start(),e.Ra.ua()}function hc(e){return dc(e)&&!Nc(e).x_()&&e.Ia.size>0}function dc(e){return 0===Ot(e).Ea.size}function fc(e){e.Va=void 0}async function gc(e){e.Ra.set("Online")}async function pc(e){e.Ia.forEach((t,n)=>{cc(e,t)})}async function mc(e,t){fc(e),hc(e)?(e.Ra.ha(t),uc(e)):e.Ra.set("Unknown")}async function yc(e,t,n){if(e.Ra.set("Online"),t instanceof rs&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.Ia.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.Ia.delete(r),e.Va.removeTarget(r))}(e,t)}catch(n){It(nc,"Failed to remove targets %s: %s ",t.targetIds.join(","),n),await vc(e,n)}else if(t instanceof ts?e.Va.Ze(t):t instanceof ns?e.Va.st(t):e.Va.tt(t),!n.isEqual(mn.min()))try{const t=await _a(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Va.Tt(t);return n.targetChanges.forEach((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.Ia.get(r);i&&e.Ia.set(r,i.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach((t,n)=>{const r=e.Ia.get(t);if(!r)return;e.Ia.set(t,r.withResumeToken(yr.EMPTY_BYTE_STRING,r.snapshotVersion)),lc(e,t);const i=new zs(r.target,t,n,r.sequenceNumber);cc(e,i)}),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){It(nc,"Failed to raise snapshot:",t),await vc(e,t)}}async function vc(e,t,n){if(!En(t))throw t;e.Ea.add(1),await oc(e),e.Ra.set("Offline"),n||(n=()=>_a(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{It(nc,"Retrying IndexedDB access"),await n(),e.Ea.delete(1),await ic(e)})}function wc(e,t){return t().catch(n=>vc(e,n,t))}async function bc(e){const t=Ot(e),n=Oc(t);let r=t.Ta.length>0?t.Ta[t.Ta.length-1].batchId:Rn;for(;Cc(t);)try{const e=await Ea(t.localStore,r);if(null===e){0===t.Ta.length&&n.L_();break}r=e.batchId,kc(t,e)}catch(e){await vc(t,e)}Sc(t)&&Tc(t)}function Cc(e){return dc(e)&&e.Ta.length<10}function kc(e,t){e.Ta.push(t);const n=Oc(e);n.O_()&&n.X_&&n.ea(t.mutations)}function Sc(e){return dc(e)&&!Oc(e).x_()&&e.Ta.length>0}function Tc(e){Oc(e).start()}async function Ic(e){Oc(e).ra()}async function _c(e){const t=Oc(e);for(const n of e.Ta)t.ea(n.mutations)}async function Ac(e,t,n){const r=e.Ta.shift(),i=Uo.from(r,t,n);await wc(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),await bc(e)}async function Ec(e,t){t&&Oc(e).X_&&await async function(e,t){if(function(e){return jo(e)&&e!==Mt.ABORTED}(t.code)){const n=e.Ta.shift();Oc(e).B_(),await wc(e,()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t)),await bc(e)}}(e,t),Sc(e)&&Tc(e)}async function Pc(e,t){const n=Ot(e);n.asyncQueue.verifyOperationInProgress(),It(nc,"RemoteStore received new credentials");const r=dc(n);n.Ea.add(3),await oc(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.Ea.delete(3),await ic(n)}async function Rc(e,t){const n=Ot(e);t?(n.Ea.delete(2),await ic(n)):t||(n.Ea.add(2),await oc(n),n.Ra.set("Unknown"))}function Nc(e){return e.ma||(e.ma=function(e,t,n){const r=Ot(e);return r.sa(),new Xa(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Xo:gc.bind(null,e),t_:pc.bind(null,e),r_:mc.bind(null,e),H_:yc.bind(null,e)}),e.da.push(async t=>{t?(e.ma.B_(),hc(e)?uc(e):e.Ra.set("Unknown")):(await e.ma.stop(),fc(e))})),e.ma}function Oc(e){return e.fa||(e.fa=function(e,t,n){const r=Ot(e);return r.sa(),new $a(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Xo:()=>Promise.resolve(),t_:Ic.bind(null,e),r_:Ec.bind(null,e),ta:_c.bind(null,e),na:Ac.bind(null,e)}),e.da.push(async t=>{t?(e.fa.B_(),await bc(e)):(await e.fa.stop(),e.Ta.length>0&&(It(nc,"Stopping write stream with ".concat(e.Ta.length," pending writes")),e.Ta=[]))})),e.fa}class Mc{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Dt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,i){const o=Date.now()+n,s=new Mc(e,t,o,r,i);return s.start(n),s}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new xt(Mt.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function xc(e,t){if(_t("AsyncQueue","".concat(t,": ").concat(e)),En(e))return new xt(Mt.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}class Dc{static emptySet(e){return new Dc(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||rn.comparator(t.key,n.key):(e,t)=>rn.comparator(e.key,t.key),this.keyedMap=Ji(),this.sortedSet=new ur(this.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Dc))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new Dc;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class Lc{constructor(){this.ga=new ur(rn.comparator)}track(e){const t=e.doc.key,n=this.ga.get(t);n?0!==e.type&&3===n.type?this.ga=this.ga.insert(t,e):3===e.type&&1!==n.type?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.ga=this.ga.remove(t):1===e.type&&2===n.type?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Pt(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal((t,n)=>{e.push(n)}),e}}class Fc{constructor(e,t,n,r,i,o,s,a,c){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=a,this.hasCachedResults=c}static fromInitialDocuments(e,t,n,r,i){const o=[];return t.forEach(e=>{o.push({type:0,doc:e})}),new Fc(e,t,Dc.emptySet(t),o,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ui(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class qc{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class Uc{constructor(){this.queries=zc(),this.onlineState="Unknown",this.Ca=new Set}terminate(){!function(e,t){const n=Ot(e),r=n.queries;n.queries=zc(),r.forEach((e,n)=>{for(const r of n.Sa)r.onError(t)})}(this,new xt(Mt.ABORTED,"Firestore shutting down"))}}function zc(){return new Gi(e=>zi(e),Ui)}async function Bc(e,t){const n=Ot(e);let r=3;const i=t.query;let o=n.queries.get(i);o?!o.ba()&&t.Da()&&(r=2):(o=new qc,r=t.Da()?0:1);try{switch(r){case 0:o.wa=await n.onListen(i,!0);break;case 1:o.wa=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(e){const n=xc(e,"Initialization of query '".concat(Bi(t.query),"' failed"));return void t.onError(n)}n.queries.set(i,o),o.Sa.push(t),t.va(n.onlineState),o.wa&&t.Fa(o.wa)&&Kc(n)}async function Hc(e,t){const n=Ot(e),r=t.query;let i=3;const o=n.queries.get(r);if(o){const e=o.Sa.indexOf(t);e>=0&&(o.Sa.splice(e,1),0===o.Sa.length?i=t.Da()?0:1:!o.ba()&&t.Da()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Vc(e,t){const n=Ot(e);let r=!1;for(const i of t){const e=i.query,t=n.queries.get(e);if(t){for(const e of t.Sa)e.Fa(i)&&(r=!0);t.wa=i}}r&&Kc(n)}function jc(e,t,n){const r=Ot(e),i=r.queries.get(t);if(i)for(const o of i.Sa)o.onError(n);r.queries.delete(t)}function Kc(e){e.Ca.forEach(e=>{e.next()})}var Gc,Qc;(Qc=Gc||(Gc={})).Ma="default",Qc.Cache="cache";class Wc{constructor(e,t,n){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new Fc(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache)return!0;if(!this.Da())return!0;const n="Offline"!==t;return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}ka(e){e=Fc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Gc.Cache}}class Yc{constructor(e){this.key=e}}class Jc{constructor(e){this.key=e}}class Xc{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=ro(),this.mutatedKeys=ro(),this.eu=ji(e),this.tu=new Dc(this.eu)}get nu(){return this.Ya}ru(e,t){const n=t?t.iu:new Lc,r=t?t.tu:this.tu;let i=t?t.mutatedKeys:this.mutatedKeys,o=r,s=!1;const a="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,c="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((e,t)=>{const l=r.get(e),u=Hi(this.query,t)?t:null,h=!!l&&this.mutatedKeys.has(l.key),d=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let f=!1;l&&u?l.data.isEqual(u.data)?h!==d&&(n.track({type:3,doc:u}),f=!0):this.su(l,u)||(n.track({type:2,doc:u}),f=!0,(a&&this.eu(u,a)>0||c&&this.eu(u,c)<0)&&(s=!0)):!l&&u?(n.track({type:0,doc:u}),f=!0):l&&!u&&(n.track({type:1,doc:l}),f=!0,(a||c)&&(s=!0)),f&&(u?(o=o.add(u),i=d?i.add(e):i.delete(e)):(o=o.delete(e),i=i.delete(e)))}),null!==this.query.limit)for(;o.size>this.query.limit;){const e="F"===this.query.limitType?o.last():o.first();o=o.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{tu:o,iu:n,Cs:s,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Pt(20277,{Rt:e})}};return n(e)-n(t)}(e.type,t.type)||this.eu(e.doc,t.doc)),this.ou(n),r=null!==r&&void 0!==r&&r;const s=t&&!r?this._u():[],a=0===this.Xa.size&&this.current&&!r?1:0,c=a!==this.Za;return this.Za=a,0!==o.length||c?{snapshot:new Fc(this.query,e.tu,i,o,e.mutatedKeys,0===a,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:s}:{au:s}}va(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Lc,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(e=>this.Ya=this.Ya.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Ya=this.Ya.delete(e)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=ro(),this.tu.forEach(e=>{this.uu(e.key)&&(this.Xa=this.Xa.add(e.key))});const t=[];return e.forEach(e=>{this.Xa.has(e)||t.push(new Jc(e))}),this.Xa.forEach(n=>{e.has(n)||t.push(new Yc(n))}),t}cu(e){this.Ya=e.Qs,this.Xa=ro();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Fc.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,0===this.Za,this.hasCachedResults)}}const $c="SyncEngine";class Zc{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class el{constructor(e){this.key=e,this.hu=!1}}class tl{constructor(e,t,n,r,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Gi(e=>zi(e),Ui),this.Iu=new Map,this.Eu=new Set,this.du=new ur(rn.comparator),this.Au=new Map,this.Ru=new la,this.Vu={},this.mu=new Map,this.fu=Ys.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return!0===this.gu}}async function nl(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=Sl(e);let i;const o=r.Tu.get(t);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.lu()):i=await il(r,t,n,!0),i}async function rl(e,t){const n=Sl(e);await il(n,t,!0,!1)}async function il(e,t,n,r){const i=await Pa(e.localStore,Li(t)),o=i.targetId,s=e.sharedClientState.addLocalQueryTarget(o,n);let a;return r&&(a=await ol(e,t,o,"current"===s,i.resumeToken)),e.isPrimaryClient&&n&&sc(e.remoteStore,i),a}async function ol(e,t,n,r,i){e.pu=(t,n,r)=>async function(e,t,n,r){let i=t.view.ru(n);i.Cs&&(i=await Na(e.localStore,t.query,!1).then(e=>{let{documents:n}=e;return t.view.ru(n,i)}));const o=r&&r.targetChanges.get(t.targetId),s=r&&null!=r.targetMismatches.get(t.targetId),a=t.view.applyChanges(i,e.isPrimaryClient,o,s);return yl(e,t.targetId,a.au),a.snapshot}(e,t,n,r);const o=await Na(e.localStore,t,!0),s=new Xc(t,o.Qs),a=s.ru(o.documents),c=es.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,i),l=s.applyChanges(a,e.isPrimaryClient,c);yl(e,n,l.au);const u=new Zc(t,n,s);return e.Tu.set(t,u),e.Iu.has(n)?e.Iu.get(n).push(t):e.Iu.set(n,[t]),l.snapshot}async function sl(e,t,n){const r=Ot(e),i=r.Tu.get(t),o=r.Iu.get(i.targetId);if(o.length>1)return r.Iu.set(i.targetId,o.filter(e=>!Ui(e,t))),void r.Tu.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Ra(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&ac(r.remoteStore,i.targetId),pl(r,i.targetId)}).catch(In)):(pl(r,i.targetId),await Ra(r.localStore,i.targetId,!0))}async function al(e,t){const n=Ot(e),r=n.Tu.get(t),i=n.Iu.get(r.targetId);n.isPrimaryClient&&1===i.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),ac(n.remoteStore,r.targetId))}async function cl(e,t){const n=Ot(e);try{const e=await function(e,t){const n=Ot(e),r=t.snapshotVersion;let i=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});i=n.Ms;const s=[];t.targetChanges.forEach((o,a)=>{const c=i.get(a);if(!c)return;s.push(n.Pi.removeMatchingKeys(e,o.removedDocuments,a).next(()=>n.Pi.addMatchingKeys(e,o.addedDocuments,a)));let l=c.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(a)?l=l.withResumeToken(yr.EMPTY_BYTE_STRING,mn.min()).withLastLimboFreeSnapshotVersion(mn.min()):o.resumeToken.approximateByteSize()>0&&(l=l.withResumeToken(o.resumeToken,r)),i=i.insert(a,l),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)}(c,l,o)&&s.push(n.Pi.updateTargetData(e,l))});let a=Wi(),c=ro();if(t.documentUpdates.forEach(r=>{t.resolvedLimboDocuments.has(r)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),s.push(Aa(e,o,t.documentUpdates).next(e=>{a=e.ks,c=e.qs})),!r.isEqual(mn.min())){const t=n.Pi.getLastRemoteSnapshotVersion(e).next(t=>n.Pi.setTargetsMetadata(e,e.currentSequenceNumber,r));s.push(t)}return _n.waitFor(s).next(()=>o.apply(e)).next(()=>n.localDocuments.getLocalViewOfDocuments(e,a,c)).next(()=>a)}).then(e=>(n.Ms=i,e))}(n.localStore,t);t.targetChanges.forEach((e,t)=>{const r=n.Au.get(t);r&&(Nt(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1,22616),e.addedDocuments.size>0?r.hu=!0:e.modifiedDocuments.size>0?Nt(r.hu,14607):e.removedDocuments.size>0&&(Nt(r.hu,42227),r.hu=!1))}),await bl(n,e,t)}catch(e){await In(e)}}function ll(e,t,n){const r=Ot(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.Tu.forEach((n,r)=>{const i=r.view.va(t);i.snapshot&&e.push(i.snapshot)}),function(e,t){const n=Ot(e);n.onlineState=t;let r=!1;n.queries.forEach((e,n)=>{for(const i of n.Sa)i.va(t)&&(r=!0)}),r&&Kc(n)}(r.eventManager,t),e.length&&r.Pu.H_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function ul(e,t,n){const r=Ot(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Au.get(t),o=i&&i.key;if(o){let e=new ur(rn.comparator);e=e.insert(o,ni.newNoDocument(o,mn.min()));const n=ro().add(o),i=new Zo(mn.min(),new Map,new ur(Gt),e,n);await cl(r,i),r.du=r.du.remove(o),r.Au.delete(t),wl(r)}else await Ra(r.localStore,t,!1).then(()=>pl(r,t,n)).catch(In)}async function hl(e,t){const n=Ot(e),r=t.batch.batchId;try{const e=await function(e,t){const n=Ot(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{const r=t.batch.keys(),i=n.Ns.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,o=i.keys();let s=_n.resolve();return o.forEach(e=>{s=s.next(()=>r.getEntry(t,e)).next(t=>{const o=n.docVersions.get(e);Nt(null!==o,48541),t.version.compareTo(o)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))})}),s.next(()=>e.mutationQueue.removeMutationBatch(t,i))}(n,e,t,i).next(()=>i.apply(e)).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=ro();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))).next(()=>n.localDocuments.getDocuments(e,r))})}(n.localStore,t);gl(n,r,null),fl(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await bl(n,e)}catch(e){await In(e)}}async function dl(e,t,n){const r=Ot(e);try{const e=await function(e,t){const n=Ot(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next(t=>(Nt(null!==t,37113),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t))).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)).next(()=>n.localDocuments.getDocuments(e,r))})}(r.localStore,t);gl(r,t,n),fl(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await bl(r,e)}catch(n){await In(n)}}function fl(e,t){(e.mu.get(t)||[]).forEach(e=>{e.resolve()}),e.mu.delete(t)}function gl(e,t,n){const r=Ot(e);let i=r.Vu[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.Vu[r.currentUser.toKey()]=i}}function pl(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Iu.get(t))e.Tu.delete(r),n&&e.Pu.yu(r,n);e.Iu.delete(t),e.isPrimaryClient&&e.Ru.jr(t).forEach(t=>{e.Ru.containsKey(t)||ml(e,t)})}function ml(e,t){e.Eu.delete(t.path.canonicalString());const n=e.du.get(t);null!==n&&(ac(e.remoteStore,n),e.du=e.du.remove(t),e.Au.delete(n),wl(e))}function yl(e,t,n){for(const r of n)r instanceof Yc?(e.Ru.addReference(r.key,t),vl(e,r)):r instanceof Jc?(It($c,"Document no longer in limbo: "+r.key),e.Ru.removeReference(r.key,t),e.Ru.containsKey(r.key)||ml(e,r.key)):Pt(19791,{wu:r})}function vl(e,t){const n=t.key,r=n.path.canonicalString();e.du.get(n)||e.Eu.has(r)||(It($c,"New document in limbo: "+n),e.Eu.add(r),wl(e))}function wl(e){for(;e.Eu.size>0&&e.du.size<e.maxConcurrentLimboResolutions;){const t=e.Eu.values().next().value;e.Eu.delete(t);const n=new rn(en.fromString(t)),r=e.fu.next();e.Au.set(r,new el(n)),e.du=e.du.insert(n,r),sc(e.remoteStore,new zs(Li(Oi(n.path)),r,"TargetPurposeLimboResolution",Pn.ce))}}async function bl(e,t,n){const r=Ot(e),i=[],o=[],s=[];r.Tu.isEmpty()||(r.Tu.forEach((e,a)=>{s.push(r.pu(a,t,n).then(e=>{if((e||n)&&r.isPrimaryClient){var t;const i=e?!e.fromCache:null===n||void 0===n||null===(t=n.targetChanges.get(a.targetId))||void 0===t?void 0:t.current;r.sharedClientState.updateQueryState(a.targetId,i?"current":"not-current")}if(e){i.push(e);const t=wa.As(a.targetId,e);o.push(t)}}))}),await Promise.all(s),r.Pu.H_(i),await async function(e,t){const n=Ot(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>_n.forEach(t,t=>_n.forEach(t.Es,r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r)).next(()=>_n.forEach(t.ds,r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))}catch(e){if(!En(e))throw e;It(ka,"Failed to update sequence numbers: "+e)}for(const r of t){const e=r.targetId;if(!r.fromCache){const t=n.Ms.get(e),r=t.snapshotVersion,i=t.withLastLimboFreeSnapshotVersion(r);n.Ms=n.Ms.insert(e,i)}}}(r.localStore,o))}async function Cl(e,t){const n=Ot(e);if(!n.currentUser.isEqual(t)){It($c,"User change. New user:",t.toKey());const e=await Ia(n.localStore,t);n.currentUser=t,function(e,t){e.mu.forEach(e=>{e.forEach(e=>{e.reject(new xt(Mt.CANCELLED,t))})}),e.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await bl(n,e.Ls)}}function kl(e,t){const n=Ot(e),r=n.Au.get(t);if(r&&r.hu)return ro().add(r.key);{let e=ro();const r=n.Iu.get(t);if(!r)return e;for(const t of r){const r=n.Tu.get(t);e=e.unionWith(r.view.nu)}return e}}function Sl(e){const t=Ot(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=cl.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=kl.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=ul.bind(null,t),t.Pu.H_=Vc.bind(null,t.eventManager),t.Pu.yu=jc.bind(null,t.eventManager),t}function Tl(e){const t=Ot(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=hl.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=dl.bind(null,t),t}class Il{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Qa(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return Ta(this.persistence,new Ca,e.initialUser,this.serializer)}Cu(e){return new pa(ya.mi,this.serializer)}Du(e){return new xa}async terminate(){var e,t;null!==(e=this.gcScheduler)&&void 0!==e&&e.stop(),null!==(t=this.indexBackfillerScheduler)&&void 0!==t&&t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Il.provider={build:()=>new Il};class _l extends Il{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Nt(this.persistence.referenceDelegate instanceof va,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new ea(n,e.asyncQueue,t)}Cu(e){const t=void 0!==this.cacheSizeBytes?Ws.withCacheSize(this.cacheSizeBytes):Ws.DEFAULT;return new pa(e=>va.mi(e,t),this.serializer)}}class Al{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>ll(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=Cl.bind(null,this.syncEngine),await Rc(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new Uc}createDatastore(e){const t=Qa(e.databaseInfo.databaseId),n=function(e){return new Ka(e)}(e.databaseInfo);return function(e,t,n,r){return new ec(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,i){return new rc(e,t,n,r,i)}(this.localStore,this.datastore,e.asyncQueue,e=>ll(this.syncEngine,e,0),Fa.v()?new Fa:new Da)}createSyncEngine(e,t){return function(e,t,n,r,i,o,s){const a=new tl(e,t,n,r,i,o);return s&&(a.gu=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(e){const t=Ot(e);It(nc,"RemoteStore shutting down."),t.Ea.add(5),await oc(t),t.Aa.shutdown(),t.Ra.set("Unknown")}(this.remoteStore),null!==(e=this.datastore)&&void 0!==e&&e.terminate(),null===(t=this.eventManager)||void 0===t||t.terminate()}}Al.provider={build:()=>new Al};class El{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):_t("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}}const Pl="FirestoreClient";class Rl{constructor(e,t,n,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=Ct.UNAUTHENTICATED,this.clientId=Kt.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,async e=>{It(Pl,"Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(n,e=>(It(Pl,"Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Dt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=xc(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Nl(e,t){e.asyncQueue.verifyOperationInProgress(),It(Pl,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async e=>{r.isEqual(e)||(await Ia(t.localStore,e),r=e)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function Ol(e,t){e.asyncQueue.verifyOperationInProgress();const n=await Ml(e);It(Pl,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(e=>Pc(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,n)=>Pc(t.remoteStore,n)),e._onlineComponents=t}async function Ml(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){It(Pl,"Using user provided OfflineComponentProvider");try{await Nl(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(e){return"FirebaseError"===e.name?e.code===Mt.FAILED_PRECONDITION||e.code===Mt.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;At("Error using user provided cache. Falling back to memory cache: "+n),await Nl(e,new Il)}}else It(Pl,"Using default OfflineComponentProvider"),await Nl(e,new _l(void 0));return e._offlineComponents}async function xl(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(It(Pl,"Using user provided OnlineComponentProvider"),await Ol(e,e._uninitializedComponentsProvider._online)):(It(Pl,"Using default OnlineComponentProvider"),await Ol(e,new Al))),e._onlineComponents}function Dl(e){return xl(e).then(e=>e.syncEngine)}async function Ll(e){const t=await xl(e),n=t.eventManager;return n.onListen=nl.bind(null,t.syncEngine),n.onUnlisten=sl.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=rl.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=al.bind(null,t.syncEngine),n}function Fl(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new Dt;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,r,i){const o=new El({next:a=>{o.Nu(),t.enqueueAndForget(()=>Hc(e,s));const c=a.docs.has(n);!c&&a.fromCache?i.reject(new xt(Mt.UNAVAILABLE,"Failed to get document because the client is offline.")):c&&a.fromCache&&r&&"server"===r.source?i.reject(new xt(Mt.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(a)},error:e=>i.reject(e)}),s=new Wc(Oi(n.path),o,{includeMetadataChanges:!0,qa:!0});return Bc(e,s)}(await Ll(e),e.asyncQueue,t,n,r)),r.promise}function ql(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new Dt;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,r,i){const o=new El({next:n=>{o.Nu(),t.enqueueAndForget(()=>Hc(e,s)),n.fromCache&&"server"===r.source?i.reject(new xt(Mt.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),s=new Wc(n,o,{includeMetadataChanges:!0,qa:!0});return Bc(e,s)}(await Ll(e),e.asyncQueue,t,n,r)),r.promise}function Ul(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const zl=new Map,Bl="firestore.googleapis.com",Hl=!0;class Vl{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new xt(Mt.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Bl,this.ssl=Hl}else this.host=e.host,this.ssl=null!==(t=e.ssl)&&void 0!==t?t:Hl;if(this.isUsingEmulator=void 0!==e.emulatorOptions,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=Qs;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<Xs)throw new xt(Mt.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new xt(Mt.INVALID_ARGUMENT,"".concat(e," and ").concat(n," cannot be used together."))})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Ul(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new xt(Mt.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (must not be NaN)"));if(e.timeoutSeconds<5)throw new xt(Mt.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (minimum allowed value is 5)"));if(e.timeoutSeconds>30)throw new xt(Mt.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (maximum allowed value is 30)"))}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class jl{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Vl({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new xt(Mt.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new xt(Mt.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Vl(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new Ft;switch(e.type){case"firstParty":return new Bt(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new xt(Mt.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=zl.get(e);t&&(It("ComponentProvider","Removing Datastore"),zl.delete(e),t.terminate())}(this),Promise.resolve()}}function Kl(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e=un(e,jl);const i=b(t),o=e._getSettings(),s=l(l({},o),{},{emulatorOptions:e._getEmulatorOptions()}),a="".concat(t,":").concat(n);i&&(async function(e){(await fetch(e,{credentials:"include"})).ok}("https://".concat(a)),S("Firestore",!0)),o.host!==Bl&&o.host!==a&&At("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c=l(l({},o),{},{host:a,ssl:i,emulatorOptions:r});if(!N(c,s)&&(e._setSettings(c),r.mockUserToken)){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=Ct.MOCK_USER;else{var u;t=function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=l({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[f(JSON.stringify({alg:"none",type:"JWT"})),f(JSON.stringify(o)),""].join(".")}(r.mockUserToken,null===(u=e._app)||void 0===u?void 0:u.options.projectId);const i=r.mockUserToken.sub||r.mockUserToken.user_id;if(!i)throw new xt(Mt.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new Ct(i)}e._authCredentials=new qt(new Lt(t,n))}}class Gl{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Gl(this.firestore,e,this._query)}}class Ql{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Wl(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ql(this.firestore,e,this._key)}toJSON(){return{type:Ql._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(dn(t,Ql._jsonSchema))return new Ql(e,n||null,new rn(en.fromString(t.referencePath)))}}Ql._jsonSchemaVersion="firestore/documentReference/1.0",Ql._jsonSchema={type:hn("string",Ql._jsonSchemaVersion),referencePath:hn("string")};class Wl extends Gl{constructor(e,t,n){super(e,t,Oi(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ql(this.firestore,null,new rn(e))}withConverter(e){return new Wl(this.firestore,e,this._path)}}function Yl(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=M(e),1===arguments.length&&(t=Kt.newId()),on("doc","path",t),e instanceof jl){const n=en.fromString(t,...r);return sn(n),new Ql(e,null,new rn(n))}{if(!(e instanceof Ql||e instanceof Wl))throw new xt(Mt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(en.fromString(t,...r));return sn(n),new Ql(e.firestore,e instanceof Wl?e.converter:null,new rn(n))}}const Jl="AsyncQueue";class Xl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Wa(this,"async_queue_retry"),this._c=()=>{const e=Ga();e&&It(Jl,"Visibility state changed to "+e.visibilityState),this.M_.w_()},this.ac=e;const t=Ga();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Ga();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const t=new Dt;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(0!==this.Xu.length){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!En(e))throw e;It(Jl,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const t=this.ac.then(()=>(this.rc=!0,e().catch(e=>{throw this.nc=e,this.rc=!1,_t("INTERNAL UNHANDLED ERROR: ",$l(e)),e}).then(e=>(this.rc=!1,e))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=Mc.createAndSchedule(this,e,t,n,e=>this.hc(e));return this.tc.push(r),r}uc(){this.nc&&Pt(47125,{Pc:$l(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do{e=this.ac,await e}while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((e,t)=>e.targetTimeMs-t.targetTimeMs);for(const t of this.tc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function $l(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}class Zl extends jl{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new Xl,this._persistenceKey=(null===r||void 0===r?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Xl(e),this._firestoreClient=void 0,await e}}}function eu(e){if(e._terminated)throw new xt(Mt.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||tu(e),e._firestoreClient}function tu(e){var t,n,r;const i=e._freezeSettings(),o=function(e,t,n,r){return new Pr(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,Ul(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,i);e._componentsProvider||null!==(n=i.localCache)&&void 0!==n&&n._offlineComponentProvider&&null!==(r=i.localCache)&&void 0!==r&&r._onlineComponentProvider&&(e._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),e._firestoreClient=new Rl(e._authCredentials,e._appCheckCredentials,e._queue,o,e._componentsProvider&&function(e){const t=null===e||void 0===e?void 0:e._online.build();return{_offline:null===e||void 0===e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}class nu{constructor(e){this._byteString=e}static fromBase64String(e){try{return new nu(yr.fromBase64String(e))}catch(e){throw new xt(Mt.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new nu(yr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:nu._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(dn(e,nu._jsonSchema))return nu.fromBase64String(e.bytes)}}nu._jsonSchemaVersion="firestore/bytes/1.0",nu._jsonSchema={type:hn("string",nu._jsonSchemaVersion),bytes:hn("string")};class ru{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let r=0;r<t.length;++r)if(0===t[r].length)throw new xt(Mt.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new nn(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class iu{constructor(e){this._methodName=e}}class ou{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new xt(Mt.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new xt(Mt.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Gt(this._lat,e._lat)||Gt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ou._jsonSchemaVersion}}static fromJSON(e){if(dn(e,ou._jsonSchema))return new ou(e.latitude,e.longitude)}}ou._jsonSchemaVersion="firestore/geoPoint/1.0",ou._jsonSchema={type:hn("string",ou._jsonSchemaVersion),latitude:hn("number"),longitude:hn("number")};class su{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}toJSON(){return{type:su._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(dn(e,su._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(e=>"number"==typeof e))return new su(e.vectorValues);throw new xt(Mt.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}su._jsonSchemaVersion="firestore/vectorValue/1.0",su._jsonSchema={type:hn("string",su._jsonSchemaVersion),vectorValues:hn("object")};const au=/^__.*__$/;class cu{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new Oo(e,this.data,this.fieldMask,t,this.fieldTransforms):new No(e,this.data,t,this.fieldTransforms)}}function lu(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Pt(40011,{Ac:e})}}class uu{constructor(e,t,n,r,i,o){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new uu(l(l({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Cu(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(0===e.length)throw this.Sc("Document fields must not be empty");if(lu(this.Ac)&&au.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class hu{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||Qa(e)}Cc(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new uu({Ac:e,methodName:t,Dc:n,path:nn.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function du(e){const t=e._freezeSettings(),n=Qa(e._databaseId);return new hu(e._databaseId,!!t.ignoreUndefinedProperties,n)}function fu(e,t,n,r,i){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const s=e.Cc(o.merge||o.mergeFields?2:0,t,n,i);yu("Data must be an object, but it was:",s,r);const a=pu(r,s);let c,l;if(o.merge)c=new pr(s.fieldMask),l=s.fieldTransforms;else if(o.mergeFields){const e=[];for(const r of o.mergeFields){const i=vu(t,r,n);if(!s.contains(i))throw new xt(Mt.INVALID_ARGUMENT,"Field '".concat(i,"' is specified in your field mask but missing from your input data."));ku(e,i)||e.push(i)}c=new pr(e),l=s.fieldTransforms.filter(e=>c.covers(e.field))}else c=null,l=s.fieldTransforms;return new cu(new ei(a),c,l)}function gu(e,t){if(mu(e=M(e)))return yu("Unsupported field value:",t,e),pu(e,t);if(e instanceof iu)return function(e,t){if(!lu(t.Ac))throw t.Sc("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.Sc("".concat(e._methodName,"() is not currently supported inside arrays"));const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.fc&&4!==t.Ac)throw t.Sc("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=gu(i,t.wc(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=M(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return co(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=pn.fromDate(e);return{timestampValue:fs(t.serializer,n)}}if(e instanceof pn){const n=new pn(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:fs(t.serializer,n)}}if(e instanceof ou)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof nu)return{bytesValue:gs(t.serializer,e._byteString)};if(e instanceof Ql){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Sc("Document reference is for database ".concat(r.projectId,"/").concat(r.database," but should be for database ").concat(n.projectId,"/").concat(n.database));return{referenceValue:ys(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof su)return function(e,t){return{mapValue:{fields:{[Or]:{stringValue:Dr},[Lr]:{arrayValue:{values:e.toArray().map(e=>{if("number"!=typeof e)throw t.Sc("VectorValues must only contain numeric values.");return so(t.serializer,e)})}}}}}}(e,t);throw t.Sc("Unsupported field value: ".concat(ln(e)))}(e,t)}function pu(e,t){const n={};return lr(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):cr(e,(e,r)=>{const i=gu(r,t.mc(e));null!=i&&(n[e]=i)}),{mapValue:{fields:n}}}function mu(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof pn||e instanceof ou||e instanceof nu||e instanceof Ql||e instanceof iu||e instanceof su)}function yu(e,t,n){if(!mu(n)||!cn(n)){const r=ln(n);throw"an object"===r?t.Sc(e+" a custom object"):t.Sc(e+" "+r)}}function vu(e,t,n){if((t=M(t))instanceof ru)return t._internalPath;if("string"==typeof t)return bu(e,t);throw Cu("Field path arguments must be of type string or ",e,!1,void 0,n)}const wu=new RegExp("[~\\*/\\[\\]]");function bu(e,t,n){if(t.search(wu)>=0)throw Cu("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return new ru(...t.split("."))._internalPath}catch(r){throw Cu("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function Cu(e,t,n,r,i){const o=r&&!r.isEmpty(),s=void 0!==i;let a="Function ".concat(t,"() called with invalid data");n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(o||s)&&(c+=" (found",o&&(c+=" in field ".concat(r)),s&&(c+=" in document ".concat(i)),c+=")"),new xt(Mt.INVALID_ARGUMENT,a+e+c)}function ku(e,t){return e.some(e=>e.isEqual(t))}class Su{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Ql(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new Tu(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Iu("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class Tu extends Su{data(){return super.data()}}function Iu(e,t){return"string"==typeof t?bu(e,t):t instanceof ru?t._internalPath:t._delegate._internalPath}function _u(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new xt(Mt.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Au{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(Fr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return br(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Cr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Pt(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return cr(e,(e,r)=>{n[e]=this.convertValue(r,t)}),n}convertVectorValue(e){var t;const n=null===(t=e.fields)||void 0===t||null===(t=t[Lr].arrayValue)||void 0===t||null===(t=t.values)||void 0===t?void 0:t.map(e=>br(e.doubleValue));return new su(n)}convertGeoPoint(e){return new ou(br(e.latitude),br(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Ar(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Er(e));default:return null}}convertTimestamp(e){const t=wr(e);return new pn(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=en.fromString(e);Nt(Us(n),9688,{name:e});const r=new Nr(n.get(1),n.get(3)),i=new rn(n.popFirst(5));return r.isEqual(t)||_t("Document ".concat(i," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),i}}function Eu(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class Pu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ru extends Su{constructor(e,t,n,r,i,o){super(e,t,n,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new Nu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(Iu("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new xt(Mt.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Ru._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),e&&e.isValidDocument()&&e.isFoundDocument()?(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t):t}}Ru._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ru._jsonSchema={type:hn("string",Ru._jsonSchemaVersion),bundleSource:hn("string","DocumentSnapshot"),bundleName:hn("string"),bundle:hn("string")};class Nu extends Ru{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class Ou{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Pu(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new Nu(this._firestore,this._userDataWriter,n.key,n,new Pu(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new xt(Mt.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(n=>{const r=new Nu(e._firestore,e._userDataWriter,n.doc.key,n.doc,new Pu(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}})}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{const r=new Nu(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Pu(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,o=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),o=n.indexOf(t.doc.key)),{type:Mu(t.type),doc:r,oldIndex:i,newIndex:o}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new xt(Mt.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Ou._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Kt.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],r=[];return this.docs.forEach(e=>{null!==e._document&&(t.push(e._document),n.push(this._userDataWriter.convertObjectMap(e._document.data.value.mapValue.fields,"previous")),r.push(e.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Mu(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Pt(61501,{type:e})}}function xu(e){e=un(e,Ql);const t=un(e.firestore,Zl);return Fl(eu(t),e._key).then(n=>Fu(t,e,n))}Ou._jsonSchemaVersion="firestore/querySnapshot/1.0",Ou._jsonSchema={type:hn("string",Ou._jsonSchemaVersion),bundleSource:hn("string","QuerySnapshot"),bundleName:hn("string"),bundle:hn("string")};class Du extends Au{constructor(e){super(),this.firestore=e}convertBytes(e){return new nu(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ql(this.firestore,null,t)}}function Lu(e,t){return function(e,t){const n=new Dt;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t,n){const r=Tl(e);try{const e=await function(e,t){const n=Ot(e),r=pn.now(),i=t.reduce((e,t)=>e.add(t.key),ro());let o,s;return n.persistence.runTransaction("Locally write mutations","readwrite",e=>{let a=Wi(),c=ro();return n.Ns.getEntries(e,i).next(e=>{a=e,a.forEach((e,t)=>{t.isValidDocument()||(c=c.add(e))})}).next(()=>n.localDocuments.getOverlayedDocuments(e,a)).next(i=>{o=i;const s=[];for(const e of t){const t=Po(e,o.get(e.key).overlayedDocument);null!=t&&s.push(new Oo(e.key,t,ti(t.value.mapValue),So.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,s,t)}).next(t=>{s=t;const r=t.applyToLocalDocumentSet(o,c);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)})}).then(()=>({batchId:s.batchId,changes:Xi(o)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Vu[e.currentUser.toKey()];r||(r=new ur(Gt)),r=r.insert(t,n),e.Vu[e.currentUser.toKey()]=r}(r,e.batchId,n),await bl(r,e.changes),await bc(r.remoteStore)}catch(e){const t=xc(e,"Failed to persist write");n.reject(t)}}(await Dl(e),t,n)),n.promise}(eu(e),t)}function Fu(e,t,n){const r=n.docs.get(t._key),i=new Du(e);return new Ru(e,i,t._key,r,new Pu(n.hasPendingWrites,n.fromCache),t.converter)}new WeakMap;!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){kt=e}("12.6.0"),Ve(new x("firestore",(e,n)=>{let{instanceIdentifier:r,options:i}=n;const o=e.getProvider("app").getImmediate(),s=new Zl(new Ut(e.getProvider("auth-internal")),new Vt(o,e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new xt(Mt.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Nr(e.options.projectId,t)}(o,r),o);return i=l({useFetchStreams:t},i),s._setSettings(i),s},"PUBLIC").setMultipleInstances(!0)),We(wt,bt,e),We(wt,bt,"esm2020")}();We("firebase","12.6.0","app");const qu=function(e,t){const n="object"==typeof e?e:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fe;const t=Ue.get(e);if(!t&&e===Fe&&v())return Qe();if(!t)throw Ke.create("no-app",{appName:e});return t}(),r="string"==typeof e?e:t||Rr,i=je(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const e=y("firestore");e&&Kl(i,...e)}return i}(Qe({apiKey:"AIzaSyBNcE_KHhQd-7kiOSw5f8-uBWT2ci5B0HU",authDomain:"pangram-tolu.firebaseapp.com",projectId:"pangram-tolu",storageBucket:"pangram-tolu.firebasestorage.app",messagingSenderId:"501572215138",appId:"1:501572215138:web:31c8d183dccd93520b4c3b"})),Uu={auth:{clientId:"95003701-76d5-48e0-aed6-c65c429356bd",authority:"https://login.microsoftonline.com/".concat("2ff60116-7431-425d-b5af-077d7791bda4"),redirectUri:"https://cos350pangram.princetonhci.social/"}},zu={scopes:["User.Read"]};var Bu=n(579);const Hu=e=>{let{data:t}=e;if(!t)return"No response yet.";const n=("string"===typeof t?t:JSON.stringify(t,null,2)).replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|\b-?\d+(\.\d+)?([eE][-+]?\d+)?\b)/g,e=>{let t="";return/^"/.test(e)?t=/:$/.test(e)?"json-key":"json-string":/true|false/.test(e)?t="json-boolean":/null/.test(e)?t="json-null":/^-?\d/.test(e)&&(t="json-number"),'<span class="'.concat(t,'">').concat(e,"</span>")});return(0,Bu.jsx)("pre",{className:"terminal-output",dangerouslySetInnerHTML:{__html:n}})},Vu={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",NOT_AVAILABLE:"Not Available",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},ju=200,Ku=400,Gu=400,Qu=499,Wu=500,Yu=599,Ju="GET",Xu="POST",$u=[Vu.OPENID_SCOPE,Vu.PROFILE_SCOPE,Vu.OFFLINE_ACCESS_SCOPE],Zu=[...$u,Vu.EMAIL_SCOPE],eh="Content-Type",th="Content-Length",nh="Retry-After",rh="X-AnchorMailbox",ih="x-ms-request-id",oh="x-ms-httpver",sh="active-account-filters",ah="common",ch="organizations",lh="consumers",uh="access_token",hh="xms_cc",dh="login",fh="select_account",gh="consent",ph="none",mh="no_session",yh="code",vh="id_token token refresh_token",wh="query",bh="fragment",Ch="query",kh="authorization_code",Sh="refresh_token",Th="MSSTS",Ih="ADFS",_h="Generic",Ah="-",Eh=".",Ph={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"},Rh="appmetadata",Nh="1",Oh="authority-metadata",Mh=86400,xh="config",Dh="cache",Lh="network",Fh="hardcoded_values",qh={SCHEMA_VERSION:5,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},Uh={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},zh=60,Bh=3600,Hh="throttling",Vh="retry-after, h429",jh="invalid_grant",Kh="client_mismatch",Gh="1",Qh="3",Wh="4",Yh="2",Jh="4",Xh="5",$h="0",Zh="1",ed="2",td="3",nd="4",rd="pop",id="unexpected_error",od="post_request_failed",sd={[id]:"Unexpected error in authentication.",[od]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."};class ad extends Error{constructor(e,t,n){super(t?"".concat(e,": ").concat(t):e),Object.setPrototypeOf(this,ad.prototype),this.errorCode=e||Vu.EMPTY_STRING,this.errorMessage=t||Vu.EMPTY_STRING,this.subError=n||Vu.EMPTY_STRING,this.name="AuthError"}setCorrelationId(e){this.correlationId=e}}function cd(e,t){return new ad(e,t?"".concat(sd[e]," ").concat(t):sd[e])}const ld="storage_not_supported",ud="stubbed_public_client_application_called",hd="in_mem_redirect_unavailable",dd={[ld]:"Given storage configuration option was not supported.",[ud]:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors",[hd]:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."};class fd extends ad{constructor(e,t){super(e,t),this.name="BrowserConfigurationAuthError",Object.setPrototypeOf(this,fd.prototype)}}function gd(e){return new fd(e,dd[e])}const pd={initialize:()=>Promise.reject(gd(ud)),acquireTokenPopup:()=>Promise.reject(gd(ud)),acquireTokenRedirect:()=>Promise.reject(gd(ud)),acquireTokenSilent:()=>Promise.reject(gd(ud)),acquireTokenByCode:()=>Promise.reject(gd(ud)),getAllAccounts:()=>[],getAccount:()=>null,getAccountByHomeId:()=>null,getAccountByUsername:()=>null,getAccountByLocalId:()=>null,handleRedirectPromise:()=>Promise.reject(gd(ud)),loginPopup:()=>Promise.reject(gd(ud)),loginRedirect:()=>Promise.reject(gd(ud)),logout:()=>Promise.reject(gd(ud)),logoutRedirect:()=>Promise.reject(gd(ud)),logoutPopup:()=>Promise.reject(gd(ud)),ssoSilent:()=>Promise.reject(gd(ud)),addEventCallback:()=>null,removeEventCallback:()=>{},addPerformanceCallback:()=>"",removePerformanceCallback:()=>!1,enableAccountStorageEvents:()=>{},disableAccountStorageEvents:()=>{},getTokenCache:()=>{throw gd(ud)},getLogger:()=>{throw gd(ud)},setLogger:()=>{},setActiveAccount:()=>{},getActiveAccount:()=>null,initializeWrapperLibrary:()=>{},setNavigationClient:()=>{},getConfiguration:()=>{throw gd(ud)},hydrateCache:()=>Promise.reject(gd(ud)),clearCache:()=>Promise.reject(gd(ud))},md="invalid_grant",yd=483,vd=600,wd="msal",bd=30,Cd="msal.js.browser",kd="53ee284d-920a-4b59-9d30-a60315b26836",Sd="ppnbnpeolgkicgegkbkbjmhlideopiji",Td="MATS",Id="MicrosoftEntra",_d="DOM API",Ad="get-token-and-sign-out",Ed="PlatformAuthDOMHandler",Pd="PlatformAuthExtensionHandler",Rd="Handshake",Nd="HandshakeResponse",Od="GetToken",Md="Response",xd="localStorage",Dd="sessionStorage",Ld="memoryStorage",Fd="GET",qd="POST",Ud="signin",zd="signout",Bd="request.origin",Hd="urlHash",Vd="request.params",jd="code.verifier",Kd="interaction.status",Gd="request.native",Qd="wrapper.sku",Wd="wrapper.version",Yd=861,Jd=862,Xd=863,$d=865,Zd=866,ef=61,tf=961,nf=962;var rf;!function(e){e.Redirect="redirect",e.Popup="popup",e.Silent="silent",e.None="none"}(rf||(rf={}));const of="startup",sf="login",af="logout",cf="acquireToken",lf="ssoSilent",uf="handleRedirect",hf="none",df={scopes:$u},ff="@azure/msal-react",gf="msal.db",pf="".concat(gf,".keys"),mf=0,yf=1,vf=2,wf=3,bf=4,Cf=5,kf=[mf,Cf,bf];var Sf;!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose",e[e.Trace=4]="Trace"}(Sf||(Sf={}));class Tf{constructor(e,t,n){this.level=Sf.Info;const r=e||Tf.createDefaultLoggerOptions();this.localCallback=r.loggerCallback||(()=>{}),this.piiLoggingEnabled=r.piiLoggingEnabled||!1,this.level="number"===typeof r.logLevel?r.logLevel:Sf.Info,this.correlationId=r.correlationId||Vu.EMPTY_STRING,this.packageName=t||Vu.EMPTY_STRING,this.packageVersion=n||Vu.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:Sf.Info}}clone(e,t,n){return new Tf({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:n||this.correlationId},e,t)}logMessage(e,t){if(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)return;const n=(new Date).toUTCString(),r="[".concat(n,"] : [").concat(t.correlationId||this.correlationId||"","]"),i="".concat(r," : ").concat(this.packageName,"@").concat(this.packageVersion," : ").concat(Sf[t.logLevel]," - ").concat(e);this.executeCallback(t.logLevel,i,t.containsPii||!1)}executeCallback(e,t,n){this.localCallback&&this.localCallback(e,t,n)}error(e,t){this.logMessage(e,{logLevel:Sf.Error,containsPii:!1,correlationId:t||Vu.EMPTY_STRING})}errorPii(e,t){this.logMessage(e,{logLevel:Sf.Error,containsPii:!0,correlationId:t||Vu.EMPTY_STRING})}warning(e,t){this.logMessage(e,{logLevel:Sf.Warning,containsPii:!1,correlationId:t||Vu.EMPTY_STRING})}warningPii(e,t){this.logMessage(e,{logLevel:Sf.Warning,containsPii:!0,correlationId:t||Vu.EMPTY_STRING})}info(e,t){this.logMessage(e,{logLevel:Sf.Info,containsPii:!1,correlationId:t||Vu.EMPTY_STRING})}infoPii(e,t){this.logMessage(e,{logLevel:Sf.Info,containsPii:!0,correlationId:t||Vu.EMPTY_STRING})}verbose(e,t){this.logMessage(e,{logLevel:Sf.Verbose,containsPii:!1,correlationId:t||Vu.EMPTY_STRING})}verbosePii(e,t){this.logMessage(e,{logLevel:Sf.Verbose,containsPii:!0,correlationId:t||Vu.EMPTY_STRING})}trace(e,t){this.logMessage(e,{logLevel:Sf.Trace,containsPii:!1,correlationId:t||Vu.EMPTY_STRING})}tracePii(e,t){this.logMessage(e,{logLevel:Sf.Trace,containsPii:!0,correlationId:t||Vu.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}}const If={instance:pd,inProgress:hf,accounts:[],logger:new Tf({})},_f=r.createContext(If),Af=(_f.Consumer,"msal:initializeStart"),Ef="msal:initializeEnd",Pf="msal:accountAdded",Rf="msal:accountRemoved",Nf="msal:activeAccountChanged",Of="msal:loginStart",Mf="msal:loginSuccess",xf="msal:loginFailure",Df="msal:acquireTokenStart",Lf="msal:acquireTokenSuccess",Ff="msal:acquireTokenFailure",qf="msal:acquireTokenFromNetworkStart",Uf="msal:ssoSilentStart",zf="msal:ssoSilentSuccess",Bf="msal:ssoSilentFailure",Hf="msal:acquireTokenByCodeStart",Vf="msal:acquireTokenByCodeSuccess",jf="msal:acquireTokenByCodeFailure",Kf="msal:handleRedirectStart",Gf="msal:handleRedirectEnd",Qf="msal:popupOpened",Wf="msal:logoutStart",Yf="msal:logoutSuccess",Jf="msal:logoutFailure",Xf="msal:logoutEnd",$f="msal:restoreFromBFCache";class Zf{static getInteractionStatusFromEvent(e,t){switch(e.eventType){case Of:return sf;case Uf:return lf;case Df:if(e.interactionType===rf.Redirect||e.interactionType===rf.Popup)return cf;break;case Kf:return uf;case Wf:return af;case zf:case Bf:if(t&&t!==lf)break;return hf;case Xf:if(t&&t!==af)break;return hf;case Gf:if(t&&t!==uf)break;return hf;case Mf:case xf:case Lf:case Ff:case $f:if(e.interactionType===rf.Redirect||e.interactionType===rf.Popup){if(t&&t!==sf&&t!==cf)break;return hf}}return null}}function eg(e,t){if(e.length!==t.length)return!1;const n=[...t];return e.every(e=>{const t=n.shift();return!(!e||!t)&&(e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username)})}const tg="3.0.22",ng="UNBLOCK_INPROGRESS",rg="EVENT",ig=(e,t)=>{const{type:n,payload:r}=t;let i=e.inProgress;switch(n){case ng:e.inProgress===of&&(i=hf,r.logger.info("MsalProvider - handleRedirectPromise resolved, setting inProgress to 'none'"));break;case rg:const t=r.message,o=Zf.getInteractionStatusFromEvent(t,e.inProgress);o&&(r.logger.info("MsalProvider - ".concat(t.eventType," results in setting inProgress from ").concat(e.inProgress," to ").concat(o)),i=o);break;default:throw new Error("Unknown action type: ".concat(n))}if(i===of)return e;const o=r.instance.getAllAccounts();return i===e.inProgress||eg(o,e.accounts)?i!==e.inProgress?l(l({},e),{},{inProgress:i}):eg(o,e.accounts)?e:l(l({},e),{},{accounts:o}):l(l({},e),{},{inProgress:i,accounts:o})};function og(e){let{instance:t,children:n}=e;(0,r.useEffect)(()=>{t.initializeWrapperLibrary(ff,tg)},[t]);const i=(0,r.useMemo)(()=>t.getLogger().clone("@azure/msal-react",tg),[t]),[o,s]=(0,r.useReducer)(ig,void 0,()=>({inProgress:of,accounts:[]}));(0,r.useEffect)(()=>{const e=t.addEventCallback(e=>{s({payload:{instance:t,logger:i,message:e},type:rg})});return i.verbose("MsalProvider - Registered event callback with id: ".concat(e)),t.initialize().then(()=>{t.handleRedirectPromise().catch(()=>{}).finally(()=>{s({payload:{instance:t,logger:i},type:ng})})}).catch(()=>{}),()=>{e&&(i.verbose("MsalProvider - Removing event callback ".concat(e)),t.removeEventCallback(e))}},[t,i]);const a={instance:t,inProgress:o.inProgress,accounts:o.accounts,logger:i};return r.createElement(_f.Provider,{value:a},n)}function sg(){const{instance:e}=(0,r.useContext)(_f),[t,n]=(0,r.useState)(""),[i,o]=(0,r.useState)(null),[s,a]=(0,r.useState)(!1),[c,l]=(0,r.useState)(!1),[u,h]=(0,r.useState)(0),[d,f]=(0,r.useState)(null),[g,p]=(0,r.useState)(0),m="usage",y="1001",v="40",w="ta3928,aa6604,sa1535,ca4655,au_CharlotteAredal,ta6754,jb7936,db9599,xb4719,rb5709,lc2583,ac9406,kc0233,janeec,lc0110,mc2971,pc6487,jc4120,au_gabychoucrallah,au_alancohen,bd0855,hd0216,au_rogerdreher,td5828,au_JenniferFeddern,au_TamaraFranklin,sg4509,yg4888,rg0200,jh3315,eh1994,au_ShariHellman,eh5775,kh8407,dh3163,aj6117,jj9832,au_RituKhandelwal,korolova,dl3780,au_AlanLieberman,cl3125,al3544,pl3522,tl5559,el4923,km5839,km8443,fm8564,pn0346,arvindn,rn8333,to6377,to4203,vp9508,dp9798,dp0782,dr1547,kr5379,ar6078,jr0664,ss6363,es8155,ls0757,as6915,ms3554,js2261,rs9856,ct9762,ht1756,ov8142,aw3483,lw3501,au_watrous,bw6931,au_stevenweiss,kw8166,sw4021,jw7893,ay3776,dy5251,my4652,dy1418,arzeng,bz5989,jz4391".split(","),b="to6377@princeton.edu,janeec@princeton.edu,patty.liu@princeton.edu,kincaid@princeton.edu,korolova@princeton.edu,arvindn@cs.princeton.edu".split(","),C=Number("1000"),k=Number("100"),S=async e=>{var t;if(!e)return;const n=Yl(qu,m,e),r=await xu(n);p(r.exists()&&(null===(t=r.data())||void 0===t?void 0:t.count)||0)},T=async()=>{const e=await function(e){e=un(e,Gl);const t=un(e.firestore,Zl),n=eu(t),r=new Du(t);return _u(e._query),ql(n,e._query).then(n=>new Ou(t,r,e,n))}(function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=M(e),on("collection","path",t),e instanceof jl){const n=en.fromString(t,...r);return an(n),new Wl(e,null,n)}{if(!(e instanceof Ql||e instanceof Wl))throw new xt(Mt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(en.fromString(t,...r));return an(n),new Wl(e.firestore,null,n)}}(qu,m));let t=0;return e.forEach(e=>{var n;const r=(null===(n=e.data())||void 0===n?void 0:n.count)||0;t+=r}),t},I=async e=>{var t;if(!e)return!1;const n=Yl(qu,m,e),r=await xu(n),i=r.exists()&&(null===(t=r.data())||void 0===t?void 0:t.count)||0;if(i>=v)return alert("You have reached the maximum number of allowed tries."),!1;await function(e,t,n){e=un(e,Ql);const r=un(e.firestore,Zl),i=Eu(e.converter,t,n);return Lu(r,[fu(du(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,So.none())])}(n,{count:i+1},{merge:!0}),p(i+1);const o=await T();return o>=C&&(o-C)%k===0&&b.forEach(async e=>{await fetch("".concat("https://us-central1-pangram-tolu.cloudfunctions.net/app","/api/send-alert"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({to:[e],subject:"\u26a0\ufe0f Princeton COS 350 Pangram Terminal Usage: ".concat(o),message:"Alert! Total Pangram Terminal AI interface usage across all students for the assignment has reached ".concat(o," uses.")})})}),!0};return(0,r.useEffect)(()=>{const e=localStorage.getItem("pangram_email");e&&(f(e),S(e))},[]),(0,Bu.jsxs)("div",{className:"app-container",children:[(0,Bu.jsxs)("header",{className:"header",children:[(0,Bu.jsx)("span",{children:"Pangram COS 350 Terminal"}),(0,Bu.jsxs)("div",{style:{display:"flex",alignContent:"center"},children:[d&&(0,Bu.jsxs)("div",{style:{display:"flex"},children:[(0,Bu.jsxs)("div",{style:{fontWeight:400},children:["[Usage: ",g,"/",v,"]"]}),(0,Bu.jsx)("button",{className:"terminal-btn2",onClick:()=>{localStorage.removeItem("pangram_email"),f(null),p(0),window.location.reload()},children:"Sign Out"})]}),(0,Bu.jsx)("button",{className:"info-btn",onClick:()=>l(!0),children:"\u24d8"})]})]}),c&&(0,Bu.jsx)("div",{className:"modal-overlay",onClick:()=>l(!1),children:(0,Bu.jsxs)("div",{className:"modal",onClick:e=>e.stopPropagation(),children:[(0,Bu.jsx)("h2",{children:"About This Tool"}),(0,Bu.jsx)("p",{children:"For Assignment A4, students generate text using AI, then attempt to edit it so that Pangram no longer detects it as AI-generated."}),(0,Bu.jsx)("p",{children:"Pangram is considered one of the strongest AI detectors. The company asserts that paraphrasing high-likelihood AI text is difficult and may not be easier than writing it yourself."}),(0,Bu.jsx)("p",{children:"Because Pangram requires a subscription, the instructor proxies requests and divides the quota among students."}),(0,Bu.jsx)("button",{className:"modal-close",onClick:()=>l(!1),children:"Close"})]})}),s&&(0,Bu.jsx)("div",{className:"modal-overlay",children:(0,Bu.jsxs)("div",{className:"loading-modal",children:[(0,Bu.jsx)("h3",{children:"Processing Request..."}),(0,Bu.jsx)("div",{className:"loading-bar-outline",children:(0,Bu.jsx)("div",{className:"loading-bar-fill",style:{width:"".concat(Math.min(u,100),"%")}})}),(0,Bu.jsxs)("p",{children:[Math.floor(u),"%"]})]})}),!d&&(0,Bu.jsx)("div",{className:"modal-overlay",children:(0,Bu.jsxs)("div",{className:"loading-modal",children:[(0,Bu.jsx)("h3",{children:"Sign In"}),(0,Bu.jsx)("p",{children:"You must sign in with your institutional account to use this app."}),(0,Bu.jsx)("button",{className:"terminal-btn",onClick:()=>{e.loginPopup(zu).then(e=>{const t=w,n=e.account.username,r=n.split("@")[0];if(!t.includes(r))return alert("This NetID is not allowed.");localStorage.setItem("pangram_email",n),f(n),S(n)}).catch(e=>{console.error("Login error:",e)})},children:"Sign In with Entra ID"})]})}),(0,Bu.jsxs)("div",{className:"terminal-body",children:[(0,Bu.jsxs)("div",{className:"terminal-panel",children:[(0,Bu.jsx)("h2",{className:"panel-title",children:"Input"}),(0,Bu.jsx)("textarea",{className:"terminal-textarea",value:t,onChange:e=>{const t=e.target.value.split(/\s+/).slice(0,y);n(t.join(" "))},onPaste:e=>{e.preventDefault();const r=(e.clipboardData||window.clipboardData).getData("text").split(/\s+/),i=t.split(/\s+/),o=y-i.length;if(o<=0)return;const s=r.slice(0,o);n([...i,...s].join(" "))},placeholder:"Enter text...",disabled:!d}),(0,Bu.jsxs)("div",{style:{textAlign:"right",fontWeight:"bold",color:t.split(/\s+/).filter(Boolean).length>=1e3?"#ff0000":"#ffffff",marginTop:"4px"},children:[t.split(/\s+/).filter(Boolean).length," / ",1e3," words"]}),(0,Bu.jsx)("button",{className:"terminal-btn",onClick:async()=>{if(!d)return;if(g>=v)return void alert("You have reached the maximum number of allowed tries.");a(!0),o(null),h(0);const e=setInterval(()=>{h(t=>t>=100?(clearInterval(e),100):t+8*Math.random()+3)},120);try{const e=await fetch("https://text.api.pangram.com",{method:"POST",headers:{"Content-Type":"application/json","x-api-key":"9fef1204-68dd-4f5d-880c-04b1a33a7cb3"},body:JSON.stringify({text:t})}),n=await e.json();o(n),await I(d)}catch(n){o({error:n.message})}clearInterval(e),h(100),setTimeout(()=>a(!1),400)},disabled:!d||s,children:s?"Working...":"Send"})]}),(0,Bu.jsxs)("div",{className:"terminal-panel",children:[(0,Bu.jsx)("h2",{className:"panel-title",children:"Output"}),(0,Bu.jsx)(Hu,{data:i})]})]})]})}const ag=e=>{e&&e instanceof Function&&n.e(453).then(n.bind(n,453)).then(t=>{let{getCLS:n,getFID:r,getFCP:i,getLCP:o,getTTFB:s}=t;n(e),r(e),i(e),o(e),s(e)})},cg="AAD",lg="OIDC",ug="EAR",hg="none",dg="client_info_decoding_error",fg="client_info_empty_error",gg="token_parsing_error",pg="null_or_empty_token",mg="endpoints_resolution_error",yg="network_error",vg="openid_config_error",wg="hash_not_deserialized",bg="invalid_state",Cg="state_mismatch",kg="state_not_found",Sg="nonce_mismatch",Tg="auth_time_not_found",Ig="max_age_transpired",_g="multiple_matching_tokens",Ag="multiple_matching_accounts",Eg="multiple_matching_appMetadata",Pg="request_cannot_be_made",Rg="cannot_remove_empty_scope",Ng="cannot_append_scopeset",Og="empty_input_scopeset",Mg="device_code_polling_cancelled",xg="device_code_expired",Dg="device_code_unknown_error",Lg="no_account_in_silent_request",Fg="invalid_cache_record",qg="invalid_cache_environment",Ug="no_account_found",zg="no_crypto_object",Bg="unexpected_credential_type",Hg="invalid_assertion",Vg="invalid_client_credential",jg="token_refresh_required",Kg="user_timeout_reached",Gg="token_claims_cnf_required_for_signedjwt",Qg="authorization_code_missing_from_server_response",Wg="binding_key_not_removed",Yg="end_session_endpoint_not_supported",Jg="key_id_missing",Xg="no_network_connectivity",$g="user_canceled",Zg="missing_tenant_id_error",ep="method_not_implemented",tp="nested_app_auth_bridge_disabled",np="platform_broker_error",rp={[dg]:"The client info could not be parsed/decoded correctly",[fg]:"The client info was empty",[gg]:"Token cannot be parsed",[pg]:"The token is null or empty",[mg]:"Endpoints cannot be resolved",[yg]:"Network request failed",[vg]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[wg]:"The hash parameters could not be deserialized",[bg]:"State was not the expected format",[Cg]:"State mismatch error",[kg]:"State not found",[Sg]:"Nonce mismatch error",[Tg]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[Ig]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[_g]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[Ag]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[Eg]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[Pg]:"Token request cannot be made without authorization code or refresh token.",[Rg]:"Cannot remove null or empty scope from ScopeSet",[Ng]:"Cannot append ScopeSet",[Og]:"Empty input ScopeSet cannot be processed",[Mg]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[xg]:"Device code is expired.",[Dg]:"Device code stopped polling for unknown reasons.",[Lg]:"Please pass an account object, silent flow is not supported without account information",[Fg]:"Cache record object was null or undefined.",[qg]:"Invalid environment when attempting to create cache entry",[Ug]:"No account found in cache for given key.",[zg]:"No crypto object detected.",[Bg]:"Unexpected credential type.",[Hg]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[Vg]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[jg]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[Kg]:"User defined timeout for device code polling reached",[Gg]:"Cannot generate a POP jwt if the token_claims are not populated",[Qg]:"Server response does not contain an authorization code to proceed",[Wg]:"Could not remove the credential's binding key from storage.",[Yg]:"The provided authority does not support logout",[Jg]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[Xg]:"No network connectivity. Check your internet connection.",[$g]:"User cancelled the flow.",[Zg]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[ep]:"This method has not been implemented",[tp]:"The nested app auth bridge is disabled",[np]:"An error occurred in the native broker. See the platformBrokerError property for details."};class ip extends ad{constructor(e,t){super(e,t?"".concat(rp[e],": ").concat(t):rp[e]),this.name="ClientAuthError",Object.setPrototypeOf(this,ip.prototype)}}function op(e,t){return new ip(e,t)}const sp={createNewGuid:()=>{throw op(ep)},base64Decode:()=>{throw op(ep)},base64Encode:()=>{throw op(ep)},base64UrlEncode:()=>{throw op(ep)},encodeKid:()=>{throw op(ep)},async getPublicKeyThumbprint(){throw op(ep)},async removeTokenBindingKey(){throw op(ep)},async clearKeystore(){throw op(ep)},async signJwt(){throw op(ep)},async hashString(){throw op(ep)}},ap="@azure/msal-common",cp="15.13.2",lp="redirect_uri_empty",up="claims_request_parsing_error",hp="authority_uri_insecure",dp="url_parse_error",fp="empty_url_error",gp="empty_input_scopes_error",pp="invalid_claims",mp="token_request_empty",yp="logout_request_empty",vp="invalid_code_challenge_method",wp="pkce_params_missing",bp="invalid_cloud_discovery_metadata",Cp="invalid_authority_metadata",kp="untrusted_authority",Sp="missing_ssh_jwk",Tp="missing_ssh_kid",Ip="missing_nonce_authentication_header",_p="invalid_authentication_header",Ap="cannot_set_OIDCOptions",Ep="cannot_allow_platform_broker",Pp="authority_mismatch",Rp="invalid_request_method_for_EAR",Np="invalid_authorize_post_body_parameters",Op={[lp]:"A redirect URI is required for all calls, and none has been set.",[up]:"Could not parse the given claims request object.",[hp]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[dp]:"URL could not be parsed into appropriate segments.",[fp]:"URL was empty or null.",[gp]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[pp]:"Given claims parameter must be a stringified JSON object.",[mp]:"Token request was empty and not found in cache.",[yp]:"The logout request was null or undefined.",[vp]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[wp]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[bp]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[Cp]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[kp]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[Sp]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[Tp]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[Ip]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[_p]:"Invalid authentication header provided",[Ap]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[Ep]:"Cannot set allowPlatformBroker parameter to true when not in AAD protocol mode.",[Pp]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority.",[Np]:"Invalid authorize post body parameters provided. If you are using authorizePostBodyParameters, the request method must be POST. Please check the request method and parameters.",[Rp]:"Invalid request method for EAR protocol mode. The request method cannot be GET when using EAR protocol mode. Please change the request method to POST."};class Mp extends ad{constructor(e){super(e,Op[e]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,Mp.prototype)}}function xp(e){return new Mp(e)}class Dp{static isEmptyObj(e){if(e)try{const t=JSON.parse(e);return 0===Object.keys(t).length}catch(t){}return!0}static startsWith(e,t){return 0===e.indexOf(t)}static endsWith(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length}static queryStringToObject(e){const t={},n=e.split("&"),r=e=>decodeURIComponent(e.replace(/\+/g," "));return n.forEach(e=>{if(e.trim()){const[n,i]=e.split(/=(.+)/g,2);n&&i&&(t[r(n)]=r(i))}}),t}static trimArrayEntries(e){return e.map(e=>e.trim())}static removeEmptyStringsFromArray(e){return e.filter(e=>!!e)}static jsonParseHelper(e){try{return JSON.parse(e)}catch(t){return null}}static matchPattern(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)}}class Lp{constructor(e){const t=e?Dp.trimArrayEntries([...e]):[],n=t?Dp.removeEmptyStringsFromArray(t):[];if(!n||!n.length)throw xp(gp);this.scopes=new Set,n.forEach(e=>this.scopes.add(e))}static fromString(e){const t=(e||Vu.EMPTY_STRING).split(" ");return new Lp(t)}static createSearchScopes(e){const t=e&&e.length>0?e:[...$u],n=new Lp(t);return n.containsOnlyOIDCScopes()?n.removeScope(Vu.OFFLINE_ACCESS_SCOPE):n.removeOIDCScopes(),n}containsScope(e){const t=this.printScopesLowerCase().split(" "),n=new Lp(t);return!!e&&n.scopes.has(e.toLowerCase())}containsScopeSet(e){return!(!e||e.scopes.size<=0)&&(this.scopes.size>=e.scopes.size&&e.asArray().every(e=>this.containsScope(e)))}containsOnlyOIDCScopes(){let e=0;return Zu.forEach(t=>{this.containsScope(t)&&(e+=1)}),this.scopes.size===e}appendScope(e){e&&this.scopes.add(e.trim())}appendScopes(e){try{e.forEach(e=>this.appendScope(e))}catch(t){throw op(Ng)}}removeScope(e){if(!e)throw op(Rg);this.scopes.delete(e.trim())}removeOIDCScopes(){Zu.forEach(e=>{this.scopes.delete(e)})}unionScopeSets(e){if(!e)throw op(Og);const t=new Set;return e.scopes.forEach(e=>t.add(e.toLowerCase())),this.scopes.forEach(e=>t.add(e.toLowerCase())),t}intersectingScopeSets(e){if(!e)throw op(Og);e.containsOnlyOIDCScopes()||e.removeOIDCScopes();const t=this.unionScopeSets(e),n=e.getScopeCount(),r=this.getScopeCount();return t.size<r+n}getScopeCount(){return this.scopes.size}asArray(){const e=[];return this.scopes.forEach(t=>e.push(t)),e}printScopes(){if(this.scopes){return this.asArray().join(" ")}return Vu.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}}function Fp(e,t){if(!e)throw op(fg);try{const n=t(e);return JSON.parse(n)}catch(n){throw op(dg)}}function qp(e){if(!e)throw op(dg);const t=e.split(Eh,2);return{uid:t[0],utid:t.length<2?Vu.EMPTY_STRING:t[1]}}function Up(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}const zp=["isHomeTenant"],Bp=["isHomeTenant"];function Hp(e,t){return!!e&&!!t&&e===t.split(".")[1]}function Vp(e,t,n,r){if(r){const{oid:t,sub:n,tid:i,name:o,tfp:s,acr:a,preferred_username:c,upn:l,login_hint:u}=r,h=i||s||a||"";return{tenantId:h,localAccountId:t||n||"",name:o,username:c||l||"",loginHint:u,isHomeTenant:Hp(h,e)}}return{tenantId:n,localAccountId:t,username:"",isHomeTenant:Hp(n,e)}}function jp(e,t,n,r){let i=e;if(t){const{isHomeTenant:n}=t,r=Up(t,zp);i=l(l({},e),r)}if(n){const t=Vp(e.homeAccountId,e.localAccountId,e.tenantId,n),{isHomeTenant:o}=t,s=Up(t,Bp);return i=l(l(l({},i),s),{},{idTokenClaims:n,idToken:r}),i}return i}const Kp=0,Gp=1,Qp=2,Wp=3;function Yp(e){if(e){return e.tid||e.tfp||e.acr||null}return null}class Jp{static getAccountInfo(e){return{homeAccountId:e.homeAccountId,environment:e.environment,tenantId:e.realm,username:e.username,localAccountId:e.localAccountId,loginHint:e.loginHint,name:e.name,nativeAccountId:e.nativeAccountId,authorityType:e.authorityType,tenantProfiles:new Map((e.tenantProfiles||[]).map(e=>[e.tenantId,e])),dataBoundary:e.dataBoundary}}isSingleTenant(){return!this.tenantProfiles}static createAccount(e,t,n){var r,i,o,s,a,c,l,u,h;const d=new Jp;let f;t.authorityType===Gp?d.authorityType=Ih:t.protocolMode===lg?d.authorityType=_h:d.authorityType=Th,e.clientInfo&&n&&(f=Fp(e.clientInfo,n),f.xms_tdbr&&(d.dataBoundary="EU"===f.xms_tdbr?"EU":"None")),d.clientInfo=e.clientInfo,d.homeAccountId=e.homeAccountId,d.nativeAccountId=e.nativeAccountId;const g=e.environment||t&&t.getPreferredCache();if(!g)throw op(qg);d.environment=g,d.realm=(null===(r=f)||void 0===r?void 0:r.utid)||Yp(e.idTokenClaims)||"",d.localAccountId=(null===(i=f)||void 0===i?void 0:i.uid)||(null===(o=e.idTokenClaims)||void 0===o?void 0:o.oid)||(null===(s=e.idTokenClaims)||void 0===s?void 0:s.sub)||"";const p=(null===(a=e.idTokenClaims)||void 0===a?void 0:a.preferred_username)||(null===(c=e.idTokenClaims)||void 0===c?void 0:c.upn),m=null!==(l=e.idTokenClaims)&&void 0!==l&&l.emails?e.idTokenClaims.emails[0]:null;if(d.username=p||m||"",d.loginHint=null===(u=e.idTokenClaims)||void 0===u?void 0:u.login_hint,d.name=(null===(h=e.idTokenClaims)||void 0===h?void 0:h.name)||"",d.cloudGraphHostName=e.cloudGraphHostName,d.msGraphHost=e.msGraphHost,e.tenantProfiles)d.tenantProfiles=e.tenantProfiles;else{const t=Vp(e.homeAccountId,d.localAccountId,d.realm,e.idTokenClaims);d.tenantProfiles=[t]}return d}static createFromAccountInfo(e,t,n){var r;const i=new Jp;return i.authorityType=e.authorityType||_h,i.homeAccountId=e.homeAccountId,i.localAccountId=e.localAccountId,i.nativeAccountId=e.nativeAccountId,i.realm=e.tenantId,i.environment=e.environment,i.username=e.username,i.name=e.name,i.loginHint=e.loginHint,i.cloudGraphHostName=t,i.msGraphHost=n,i.tenantProfiles=Array.from((null===(r=e.tenantProfiles)||void 0===r?void 0:r.values())||[]),i.dataBoundary=e.dataBoundary,i}static generateHomeAccountId(e,t,n,r,i){if(t!==Gp&&t!==Qp){if(e)try{const t=Fp(e,r.base64Decode);if(t.uid&&t.utid)return"".concat(t.uid,".").concat(t.utid)}catch(o){}n.warning("No client info in response")}return(null===i||void 0===i?void 0:i.sub)||""}static isAccountEntity(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"))}static accountInfoIsEqual(e,t,n){if(!e||!t)return!1;let r=!0;if(n){const n=e.idTokenClaims||{},i=t.idTokenClaims||{};r=n.iat===i.iat&&n.nonce===i.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.loginHint===t.loginHint&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&r}}function Xp(e,t){const n=function(e){if(!e)throw op(pg);const t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);if(!t||t.length<4)throw op(gg);return t[2]}(e);try{const e=t(n);return JSON.parse(e)}catch(r){throw op(gg)}}function $p(e){if(!e.signin_state)return!1;const t=["kmsi","dvc_dmjd"];return e.signin_state.some(e=>t.includes(e.trim().toLowerCase()))}function Zp(e,t){if(0===t||Date.now()-3e5>e+t)throw op(Ig)}function em(e){if(!e)return e;let t=e.toLowerCase();return Dp.endsWith(t,"?")?t=t.slice(0,-1):Dp.endsWith(t,"?/")&&(t=t.slice(0,-2)),Dp.endsWith(t,"/")||(t+="/"),t}function tm(e){return e.startsWith("#/")?e.substring(2):e.startsWith("#")||e.startsWith("?")?e.substring(1):e}function nm(e){if(!e||e.indexOf("=")<0)return null;try{const t=tm(e),n=Object.fromEntries(new URLSearchParams(t));if(n.code||n.ear_jwe||n.error||n.error_description||n.state)return n}catch(t){throw op(wg)}return null}function rm(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0;const r=new Array;return e.forEach((e,i)=>{!t&&n&&i in n?r.push("".concat(i,"=").concat(e)):r.push("".concat(i,"=").concat(encodeURIComponent(e)))}),r.join("&")}function im(e){if(!e)return e;const t=e.split("#")[0];try{const e=new URL(t);return em(e.origin+e.pathname+e.search)}catch(n){return em(t)}}class om{get urlString(){return this._urlString}constructor(e){if(this._urlString=e,!this._urlString)throw xp(fp);e.includes("#")||(this._urlString=om.canonicalizeUri(e))}static canonicalizeUri(e){if(e){let t=e.toLowerCase();return Dp.endsWith(t,"?")?t=t.slice(0,-1):Dp.endsWith(t,"?/")&&(t=t.slice(0,-2)),Dp.endsWith(t,"/")||(t+="/"),t}return e}validateAsUri(){let e;try{e=this.getUrlComponents()}catch(t){throw xp(dp)}if(!e.HostNameAndPort||!e.PathSegments)throw xp(dp);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw xp(hp)}static appendQueryString(e,t){return t?e.indexOf("?")<0?"".concat(e,"?").concat(t):"".concat(e,"&").concat(t):e}static removeHashFromUrl(e){return om.canonicalizeUri(e.split("#")[0])}replaceTenantPath(e){const t=this.getUrlComponents(),n=t.PathSegments;return!e||0===n.length||n[0]!==ah&&n[0]!==ch||(n[0]=e),om.constructAuthorityUriFromObject(t)}getUrlComponents(){const e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw xp(dp);const n={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]};let r=n.AbsolutePath.split("/");return r=r.filter(e=>e&&e.length>0),n.PathSegments=r,n.QueryString&&n.QueryString.endsWith("/")&&(n.QueryString=n.QueryString.substring(0,n.QueryString.length-1)),n}static getDomainFromUrl(e){const t=RegExp("^([^:/?#]+://)?([^/?#]*)"),n=e.match(t);if(!n)throw xp(dp);return n[2]}static getAbsoluteUrl(e,t){if(e[0]===Vu.FORWARD_SLASH){const n=new om(t).getUrlComponents();return n.Protocol+"//"+n.HostNameAndPort+e}return e}static constructAuthorityUriFromObject(e){return new om(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))}static hashContainsKnownProperties(e){return!!nm(e)}}const sm={"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},am={metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},cm=new Set;function lm(e,t,n,r){if(null===r||void 0===r||r.trace("getAliasesFromMetadata called with source: ".concat(n)),e&&t){const i=um(t,e);if(i)return null===r||void 0===r||r.trace("getAliasesFromMetadata: found cloud discovery metadata in ".concat(n,", returning aliases")),i.aliases;null===r||void 0===r||r.trace("getAliasesFromMetadata: did not find cloud discovery metadata in ".concat(n))}return null}function um(e,t){for(let n=0;n<e.length;n++){const r=e[n];if(r.aliases.includes(t))return r}return null}am.metadata.forEach(e=>{e.aliases.forEach(e=>{cm.add(e)})});const hm="cache_quota_exceeded",dm="cache_error_unknown",fm={[hm]:"Exceeded cache storage capacity.",[dm]:"Unexpected error occurred when using cache storage."};class gm extends ad{constructor(e,t){const n=t||(fm[e]?fm[e]:fm[dm]);super("".concat(e,": ").concat(n)),Object.setPrototypeOf(this,gm.prototype),this.name="CacheError",this.errorCode=e,this.errorMessage=n}}function pm(e){return e instanceof Error?"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name||e.message.includes("exceeded the quota")?new gm(hm):new gm(e.name,e.message):new gm(dm)}class mm{constructor(e,t,n,r,i){this.clientId=e,this.cryptoImpl=t,this.commonLogger=n.clone(ap,cp),this.staticAuthorityOptions=i,this.performanceClient=r}getAllAccounts(e,t){return this.buildTenantProfiles(this.getAccountsFilteredBy(e,t),t,e)}getAccountInfoFilteredBy(e,t){if(0===Object.keys(e).length||Object.values(e).every(e=>!e))return this.commonLogger.warning("getAccountInfoFilteredBy: Account filter is empty or invalid, returning null"),null;const n=this.getAllAccounts(e,t);if(n.length>1){return n.sort(e=>e.idTokenClaims?-1:1)[0]}return 1===n.length?n[0]:null}getBaseAccountInfo(e,t){const n=this.getAccountsFilteredBy(e,t);return n.length>0?Jp.getAccountInfo(n[0]):null}buildTenantProfiles(e,t,n){return e.flatMap(e=>this.getTenantProfilesFromAccountEntity(e,t,null===n||void 0===n?void 0:n.tenantId,n))}getTenantedAccountInfoByFilter(e,t,n,r,i){let o,s=null;if(i&&!this.tenantProfileMatchesFilter(n,i))return null;const a=this.getIdToken(e,r,t,n.tenantId);return a&&(o=Xp(a.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(o,i))?null:(s=jp(e,n,o,null===a||void 0===a?void 0:a.secret),s)}getTenantProfilesFromAccountEntity(e,t,n,r){const i=Jp.getAccountInfo(e);let o=i.tenantProfiles||new Map;const s=this.getTokenKeys();if(n){const e=o.get(n);if(!e)return[];o=new Map([[n,e]])}const a=[];return o.forEach(e=>{const n=this.getTenantedAccountInfoByFilter(i,s,e,t,r);n&&a.push(n)}),a}tenantProfileMatchesFilter(e,t){return!(t.localAccountId&&!this.matchLocalAccountIdFromTenantProfile(e,t.localAccountId))&&((!t.name||e.name===t.name)&&(void 0===t.isHomeTenant||e.isHomeTenant===t.isHomeTenant))}idTokenClaimsMatchTenantProfileFilter(e,t){if(t){if(t.localAccountId&&!this.matchLocalAccountIdFromTokenClaims(e,t.localAccountId))return!1;if(t.loginHint&&!this.matchLoginHintFromTokenClaims(e,t.loginHint))return!1;if(t.username&&!this.matchUsername(e.preferred_username,t.username))return!1;if(t.name&&!this.matchName(e,t.name))return!1;if(t.sid&&!this.matchSid(e,t.sid))return!1}return!0}async saveCacheRecord(e,t,n,r){if(!e)throw op(Fg);try{e.account&&await this.setAccount(e.account,t,n),e.idToken&&!1!==(null===r||void 0===r?void 0:r.idToken)&&await this.setIdTokenCredential(e.idToken,t,n),e.accessToken&&!1!==(null===r||void 0===r?void 0:r.accessToken)&&await this.saveAccessToken(e.accessToken,t,n),e.refreshToken&&!1!==(null===r||void 0===r?void 0:r.refreshToken)&&await this.setRefreshTokenCredential(e.refreshToken,t,n),e.appMetadata&&this.setAppMetadata(e.appMetadata,t)}catch(o){var i;throw null===(i=this.commonLogger)||void 0===i||i.error("CacheManager.saveCacheRecord: failed"),o instanceof ad?o:pm(o)}}async saveAccessToken(e,t,n){const r={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},i=this.getTokenKeys(),o=Lp.fromString(e.target);i.accessToken.forEach(e=>{if(!this.accessTokenKeyMatchesFilter(e,r,!1))return;const n=this.getAccessTokenCredential(e,t);if(n&&this.credentialMatchesFilter(n,r)){Lp.fromString(n.target).intersectingScopeSets(o)&&this.removeAccessToken(e,t)}}),await this.setAccessTokenCredential(e,t,n)}getAccountsFilteredBy(e,t){const n=this.getAccountKeys(),r=[];return n.forEach(n=>{var i;const o=this.getAccount(n,t);if(!o)return;if(e.homeAccountId&&!this.matchHomeAccountId(o,e.homeAccountId))return;if(e.username&&!this.matchUsername(o.username,e.username))return;if(e.environment&&!this.matchEnvironment(o,e.environment))return;if(e.realm&&!this.matchRealm(o,e.realm))return;if(e.nativeAccountId&&!this.matchNativeAccountId(o,e.nativeAccountId))return;if(e.authorityType&&!this.matchAuthorityType(o,e.authorityType))return;const s={localAccountId:null===e||void 0===e?void 0:e.localAccountId,name:null===e||void 0===e?void 0:e.name},a=null===(i=o.tenantProfiles)||void 0===i?void 0:i.filter(e=>this.tenantProfileMatchesFilter(e,s));a&&0===a.length||r.push(o)}),r}credentialMatchesFilter(e,t){if(t.clientId&&!this.matchClientId(e,t.clientId))return!1;if(t.userAssertionHash&&!this.matchUserAssertionHash(e,t.userAssertionHash))return!1;if("string"===typeof t.homeAccountId&&!this.matchHomeAccountId(e,t.homeAccountId))return!1;if(t.environment&&!this.matchEnvironment(e,t.environment))return!1;if(t.realm&&!this.matchRealm(e,t.realm))return!1;if(t.credentialType&&!this.matchCredentialType(e,t.credentialType))return!1;if(t.familyId&&!this.matchFamilyId(e,t.familyId))return!1;if(t.target&&!this.matchTarget(e,t.target))return!1;if((t.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==t.requestedClaimsHash)return!1;if(e.credentialType===Ph.ACCESS_TOKEN_WITH_AUTH_SCHEME){if(t.tokenType&&!this.matchTokenType(e,t.tokenType))return!1;if(t.tokenType===Uh.SSH&&t.keyId&&!this.matchKeyId(e,t.keyId))return!1}return!0}getAppMetadataFilteredBy(e){const t=this.getKeys(),n={};return t.forEach(t=>{if(!this.isAppMetadata(t))return;const r=this.getAppMetadata(t);r&&(e.environment&&!this.matchEnvironment(r,e.environment)||e.clientId&&!this.matchClientId(r,e.clientId)||(n[t]=r))}),n}getAuthorityMetadataByAlias(e){const t=this.getAuthorityMetadataKeys();let n=null;return t.forEach(t=>{if(!this.isAuthorityMetadata(t)||-1===t.indexOf(this.clientId))return;const r=this.getAuthorityMetadata(t);r&&-1!==r.aliases.indexOf(e)&&(n=r)}),n}removeAllAccounts(e){this.getAllAccounts({},e).forEach(t=>{this.removeAccount(t,e)})}removeAccount(e,t){this.removeAccountContext(e,t);this.getAccountKeys().filter(t=>t.includes(e.homeAccountId)&&t.includes(e.environment)).forEach(e=>{this.removeItem(e,t),this.performanceClient.incrementFields({accountsRemoved:1},t)})}removeAccountContext(e,t){const n=this.getTokenKeys(),r=t=>t.includes(e.homeAccountId)&&t.includes(e.environment);n.idToken.filter(r).forEach(e=>{this.removeIdToken(e,t)}),n.accessToken.filter(r).forEach(e=>{this.removeAccessToken(e,t)}),n.refreshToken.filter(r).forEach(e=>{this.removeRefreshToken(e,t)})}removeAccessToken(e,t){const n=this.getAccessTokenCredential(e,t);if(this.removeItem(e,t),this.performanceClient.incrementFields({accessTokensRemoved:1},t),!n||n.credentialType.toLowerCase()!==Ph.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()||n.tokenType!==Uh.POP)return;const r=n.keyId;r&&this.cryptoImpl.removeTokenBindingKey(r).catch(()=>{var e;this.commonLogger.error("Failed to remove token binding key ".concat(r),t),null===(e=this.performanceClient)||void 0===e||e.incrementFields({removeTokenBindingKeyFailure:1},t)})}removeAppMetadata(e){return this.getKeys().forEach(t=>{this.isAppMetadata(t)&&this.removeItem(t,e)}),!0}getIdToken(e,t,n,r,i){this.commonLogger.trace("CacheManager - getIdToken called");const o={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:Ph.ID_TOKEN,clientId:this.clientId,realm:r},s=this.getIdTokensByFilter(o,t,n),a=s.size;if(a<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(a>1){let n=s;if(!r){const t=new Map;s.forEach((n,r)=>{n.realm===e.tenantId&&t.set(r,n)});const r=t.size;if(r<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),s.values().next().value;if(1===r)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),t.values().next().value;n=t}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),n.forEach((e,n)=>{this.removeIdToken(n,t)}),i&&t&&i.addFields({multiMatchedID:s.size},t),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),s.values().next().value}getIdTokensByFilter(e,t,n){const r=n&&n.idToken||this.getTokenKeys().idToken,i=new Map;return r.forEach(n=>{if(!this.idTokenKeyMatchesFilter(n,l({clientId:this.clientId},e)))return;const r=this.getIdTokenCredential(n,t);r&&this.credentialMatchesFilter(r,e)&&i.set(n,r)}),i}idTokenKeyMatchesFilter(e,t){const n=e.toLowerCase();return(!t.clientId||-1!==n.indexOf(t.clientId.toLowerCase()))&&(!t.homeAccountId||-1!==n.indexOf(t.homeAccountId.toLowerCase()))}removeIdToken(e,t){this.removeItem(e,t)}removeRefreshToken(e,t){this.removeItem(e,t)}getAccessToken(e,t,n,r){const i=t.correlationId;this.commonLogger.trace("CacheManager - getAccessToken called",i);const o=Lp.createSearchScopes(t.scopes),s=t.authenticationScheme||Uh.BEARER,a=s&&s.toLowerCase()!==Uh.BEARER.toLowerCase()?Ph.ACCESS_TOKEN_WITH_AUTH_SCHEME:Ph.ACCESS_TOKEN,c={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:a,clientId:this.clientId,realm:r||e.tenantId,target:o,tokenType:s,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},l=n&&n.accessToken||this.getTokenKeys().accessToken,u=[];l.forEach(e=>{if(this.accessTokenKeyMatchesFilter(e,c,!0)){const t=this.getAccessTokenCredential(e,i);t&&this.credentialMatchesFilter(t,c)&&u.push(t)}});const h=u.length;return h<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found",i),null):h>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them",i),u.forEach(e=>{this.removeAccessToken(this.generateCredentialKey(e),i)}),this.performanceClient.addFields({multiMatchedAT:u.length},i),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token",i),u[0])}accessTokenKeyMatchesFilter(e,t,n){const r=e.toLowerCase();if(t.clientId&&-1===r.indexOf(t.clientId.toLowerCase()))return!1;if(t.homeAccountId&&-1===r.indexOf(t.homeAccountId.toLowerCase()))return!1;if(t.realm&&-1===r.indexOf(t.realm.toLowerCase()))return!1;if(t.requestedClaimsHash&&-1===r.indexOf(t.requestedClaimsHash.toLowerCase()))return!1;if(t.target){const e=t.target.asArray();for(let t=0;t<e.length;t++){if(n&&!r.includes(e[t].toLowerCase()))return!1;if(!n&&r.includes(e[t].toLowerCase()))return!0}}return!0}getAccessTokensByFilter(e,t){const n=this.getTokenKeys(),r=[];return n.accessToken.forEach(n=>{if(!this.accessTokenKeyMatchesFilter(n,e,!0))return;const i=this.getAccessTokenCredential(n,t);i&&this.credentialMatchesFilter(i,e)&&r.push(i)}),r}getRefreshToken(e,t,n,r,i){this.commonLogger.trace("CacheManager - getRefreshToken called");const o=t?Nh:void 0,s={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:Ph.REFRESH_TOKEN,clientId:this.clientId,familyId:o},a=r&&r.refreshToken||this.getTokenKeys().refreshToken,c=[];a.forEach(e=>{if(this.refreshTokenKeyMatchesFilter(e,s)){const t=this.getRefreshTokenCredential(e,n);t&&this.credentialMatchesFilter(t,s)&&c.push(t)}});const l=c.length;return l<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(l>1&&i&&n&&i.addFields({multiMatchedRT:l},n),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),c[0])}refreshTokenKeyMatchesFilter(e,t){const n=e.toLowerCase();return(!t.familyId||-1!==n.indexOf(t.familyId.toLowerCase()))&&(!(!t.familyId&&t.clientId&&-1===n.indexOf(t.clientId.toLowerCase()))&&(!t.homeAccountId||-1!==n.indexOf(t.homeAccountId.toLowerCase())))}readAppMetadataFromCache(e){const t={environment:e,clientId:this.clientId},n=this.getAppMetadataFilteredBy(t),r=Object.keys(n).map(e=>n[e]),i=r.length;if(i<1)return null;if(i>1)throw op(Eg);return r[0]}isAppMetadataFOCI(e){const t=this.readAppMetadataFromCache(e);return!(!t||t.familyId!==Nh)}matchHomeAccountId(e,t){return!("string"!==typeof e.homeAccountId||t!==e.homeAccountId)}matchLocalAccountIdFromTokenClaims(e,t){return t===(e.oid||e.sub)}matchLocalAccountIdFromTenantProfile(e,t){return e.localAccountId===t}matchName(e,t){var n;return!(t.toLowerCase()!==(null===(n=e.name)||void 0===n?void 0:n.toLowerCase()))}matchUsername(e,t){return!(!e||"string"!==typeof e||(null===t||void 0===t?void 0:t.toLowerCase())!==e.toLowerCase())}matchUserAssertionHash(e,t){return!(!e.userAssertionHash||t!==e.userAssertionHash)}matchEnvironment(e,t){if(this.staticAuthorityOptions){const n=function(e,t){let n;const r=e.canonicalAuthority;if(r){var i;const o=new om(r).getUrlComponents().HostNameAndPort;n=lm(o,null===(i=e.cloudDiscoveryMetadata)||void 0===i?void 0:i.metadata,xh,t)||lm(o,am.metadata,Fh,t)||e.knownAuthorities}return n||[]}(this.staticAuthorityOptions,this.commonLogger);if(n.includes(t)&&n.includes(e.environment))return!0}const n=this.getAuthorityMetadataByAlias(t);return!!(n&&n.aliases.indexOf(e.environment)>-1)}matchCredentialType(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()}matchClientId(e,t){return!(!e.clientId||t!==e.clientId)}matchFamilyId(e,t){return!(!e.familyId||t!==e.familyId)}matchRealm(e,t){var n;return!((null===(n=e.realm)||void 0===n?void 0:n.toLowerCase())!==t.toLowerCase())}matchNativeAccountId(e,t){return!(!e.nativeAccountId||t!==e.nativeAccountId)}matchLoginHintFromTokenClaims(e,t){return e.login_hint===t||(e.preferred_username===t||e.upn===t)}matchSid(e,t){return e.sid===t}matchAuthorityType(e,t){return!(!e.authorityType||t.toLowerCase()!==e.authorityType.toLowerCase())}matchTarget(e,t){if(e.credentialType!==Ph.ACCESS_TOKEN&&e.credentialType!==Ph.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target)return!1;return Lp.fromString(e.target).containsScopeSet(t)}matchTokenType(e,t){return!(!e.tokenType||e.tokenType!==t)}matchKeyId(e,t){return!(!e.keyId||e.keyId!==t)}isAppMetadata(e){return-1!==e.indexOf(Rh)}isAuthorityMetadata(e){return-1!==e.indexOf(Oh)}generateAuthorityMetadataCacheKey(e){return"".concat(Oh,"-").concat(this.clientId,"-").concat(e)}static toObject(e,t){for(const n in t)e[n]=t[n];return e}}class ym extends mm{async setAccount(){throw op(ep)}getAccount(){throw op(ep)}async setIdTokenCredential(){throw op(ep)}getIdTokenCredential(){throw op(ep)}async setAccessTokenCredential(){throw op(ep)}getAccessTokenCredential(){throw op(ep)}async setRefreshTokenCredential(){throw op(ep)}getRefreshTokenCredential(){throw op(ep)}setAppMetadata(){throw op(ep)}getAppMetadata(){throw op(ep)}setServerTelemetry(){throw op(ep)}getServerTelemetry(){throw op(ep)}setAuthorityMetadata(){throw op(ep)}getAuthorityMetadata(){throw op(ep)}getAuthorityMetadataKeys(){throw op(ep)}setThrottlingCache(){throw op(ep)}getThrottlingCache(){throw op(ep)}removeItem(){throw op(ep)}getKeys(){throw op(ep)}getAccountKeys(){throw op(ep)}getTokenKeys(){throw op(ep)}generateCredentialKey(){throw op(ep)}generateAccountKey(){throw op(ep)}}const vm="acquireTokenByCode",wm="acquireTokenByRefreshToken",bm="acquireTokenSilent",Cm="acquireTokenSilentAsync",km="acquireTokenPopup",Sm="acquireTokenPreRedirect",Tm="acquireTokenRedirect",Im="cryptoOptsGetPublicKeyThumbprint",_m="cryptoOptsSignJwt",Am="silentCacheClientAcquireToken",Em="silentIframeClientAcquireToken",Pm="awaitConcurrentIframe",Rm="silentRefreshClientAcquireToken",Nm="ssoSilent",Om="standardInteractionClientGetDiscoveredAuthority",Mm="nativeInteractionClientAcquireToken",xm="networkClientSendPostRequestAsync",Dm="refreshTokenClientExecutePostToTokenEndpoint",Lm="authorizationCodeClientExecutePostToTokenEndpoint",Fm="refreshTokenClientExecuteTokenRequest",qm="refreshTokenClientAcquireToken",Um="refreshTokenClientAcquireTokenWithCachedRefreshToken",zm="refreshTokenClientAcquireTokenByRefreshToken",Bm="refreshTokenClientCreateTokenRequestBody",Hm="acquireTokenFromCache",Vm="silentFlowClientAcquireCachedToken",jm="silentFlowClientGenerateResultFromCacheRecord",Km="acquireTokenBySilentIframe",Gm="initializeBaseRequest",Qm="initializeSilentRequest",Wm="initializeClientApplication",Ym="initializeCache",Jm="silentIframeClientTokenHelper",Xm="silentHandlerInitiateAuthRequest",$m="silentHandlerMonitorIframeForHash",Zm="silentHandlerLoadFrame",ey="silentHandlerLoadFrameSync",ty="standardInteractionClientCreateAuthCodeClient",ny="standardInteractionClientGetClientConfiguration",ry="standardInteractionClientInitializeAuthorizationRequest",iy="getAuthCodeUrl",oy="getStandardParams",sy="handleCodeResponseFromServer",ay="handleCodeResponse",cy="handleResponseEar",ly="handleResponsePlatformBroker",uy="handleResponseCode",hy="updateTokenEndpointAuthority",dy="authClientAcquireToken",fy="authClientExecuteTokenRequest",gy="authClientCreateTokenRequestBody",py="popTokenGenerateCnf",my="popTokenGenerateKid",yy="handleServerTokenResponse",vy="deserializeResponse",wy="authorityFactoryCreateDiscoveredInstance",by="authorityResolveEndpointsAsync",Cy="authorityGetCloudDiscoveryMetadataFromNetwork",ky="authorityUpdateCloudDiscoveryMetadata",Sy="authorityGetEndpointMetadataFromNetwork",Ty="authorityUpdateEndpointMetadata",Iy="authorityUpdateMetadataWithRegionalInformation",_y="regionDiscoveryDetectRegion",Ay="regionDiscoveryGetRegionFromIMDS",Ey="regionDiscoveryGetCurrentVersion",Py="acquireTokenByCodeAsync",Ry="handleRedirectPromise",Ny="handleNativeRedirectPromise",Oy="nativeMessageHandlerHandshake",My="removeHiddenIframe",xy="clearTokensAndKeysWithClaims",Dy="cacheManagerGetRefreshToken",Ly="importExistingCache",Fy="setUserData",qy="localStorageUpdated",Uy="generatePkceCodes",zy="generateCodeVerifier",By="generateCodeChallengeFromVerifier",Hy="sha256Digest",Vy="getRandomValues",jy="generateHKDF",Ky="generateBaseKey",Gy="base64Decode",Qy="urlEncodeArr",Wy="encrypt",Yy="decrypt",Jy="generateEarKey",Xy="decryptEarResponse",$y=(new Map([[vm,"ATByCode"],[wm,"ATByRT"],[bm,"ATS"],[Cm,"ATSAsync"],[km,"ATPopup"],[Tm,"ATRedirect"],[Im,"CryptoGetPKThumb"],[_m,"CryptoSignJwt"],[Am,"SltCacheClientAT"],[Em,"SltIframeClientAT"],[Rm,"SltRClientAT"],[Nm,"SsoSlt"],[Om,"StdIntClientGetDiscAuth"],["fetchAccountIdWithNativeBroker","FetchAccIdWithNtvBroker"],[Mm,"NtvIntClientAT"],["baseClientCreateTokenRequestHeaders","BaseClientCreateTReqHead"],[xm,"NetClientSendPost"],[Dm,"RTClientExecPost"],[Lm,"AuthCodeClientExecPost"],["brokerHandshake","BrokerHandshake"],["acquireTokenByRefreshTokenInBroker","ATByRTInBroker"],["acquireTokenByBroker","ATByBroker"],[Fm,"RTClientExecTReq"],[qm,"RTClientAT"],[Um,"RTClientATWithCachedRT"],[zm,"RTClientATByRT"],[Bm,"RTClientCreateTReqBody"],[Hm,"ATFromCache"],[Vm,"SltFlowClientATCached"],[jm,"SltFlowClientGenResFromCache"],[Km,"ATBySltIframe"],[Gm,"InitBaseReq"],[Qm,"InitSltReq"],[Wm,"InitClientApplication"],[Ym,"InitCache"],[Ly,"importCache"],[Fy,"setUserData"],[qy,"localStorageUpdated"],[Jm,"SIClientTHelper"],[Xm,"SHandlerInitAuthReq"],[$m,"SltHandlerMonitorIframeForHash"],[Zm,"SHandlerLoadFrame"],[ey,"SHandlerLoadFrameSync"],[ty,"StdIntClientCreateAuthCodeClient"],[ny,"StdIntClientGetClientConf"],[ry,"StdIntClientInitAuthReq"],[iy,"GetAuthCodeUrl"],[sy,"HandleCodeResFromServer"],[ay,"HandleCodeResp"],[cy,"HandleRespEar"],[uy,"HandleRespCode"],[ly,"HandleRespPlatBroker"],[hy,"UpdTEndpointAuth"],[dy,"AuthClientAT"],[fy,"AuthClientExecTReq"],[gy,"AuthClientCreateTReqBody"],[py,"PopTGenCnf"],[my,"PopTGenKid"],[yy,"HandleServerTRes"],[vy,"DeserializeRes"],[wy,"AuthFactCreateDiscInst"],[by,"AuthResolveEndpointsAsync"],["authorityResolveEndpointsFromLocalSources","AuthResolveEndpointsFromLocal"],[Cy,"AuthGetCDMetaFromNet"],[ky,"AuthUpdCDMeta"],[Sy,"AuthUpdCDMetaFromNet"],[Ty,"AuthUpdEndpointMeta"],[Iy,"AuthUpdMetaWithRegInfo"],[_y,"RegDiscDetectReg"],[Ay,"RegDiscGetRegFromIMDS"],[Ey,"RegDiscGetCurrentVer"],[Py,"ATByCodeAsync"],["getEndpointMetadataFromNetwork","GetEndpointMetaFromNet"],["getCloudDiscoveryMetadataFromNetworkMeasurement","GetCDMetaFromNet"],[Ry,"HandleRedirectPromise"],[Ny,"HandleNtvRedirectPromise"],["updateCloudDiscoveryMetadataMeasurement","UpdateCDMeta"],["usernamePasswordClientAcquireToken","UserPassClientAT"],[Oy,"NtvMsgHandlerHandshake"],["nativeGenerateAuthResult","NtvGenAuthRes"],[My,"RemoveHiddenIframe"],[xy,"ClearTAndKeysWithClaims"],[Dy,"CacheManagerGetRT"],[Uy,"GenPkceCodes"],[zy,"GenCodeVerifier"],[By,"GenCodeChallengeFromVerifier"],[Hy,"Sha256Digest"],[Vy,"GetRandomValues"],[jy,"genHKDF"],[Ky,"genBaseKey"],[Gy,"b64Decode"],[Qy,"urlEncArr"],[Wy,"encrypt"],[Yy,"decrypt"],[Jy,"genEarKey"],[Xy,"decryptEarResp"]]),1);new Set(["accessTokenSize","durationMs","idTokenSize","matsSilentStatus","matsHttpStatus","refreshTokenSize","queuedTimeMs","startTimeMs","status","multiMatchedAT","multiMatchedID","multiMatchedRT","unencryptedCacheCount","encryptedCacheExpiredCount","oldAccountCount","oldAccessCount","oldIdCount","oldRefreshCount","currAccountCount","currAccessCount","currIdCount","currRefreshCount","expiredCacheRemovedCount","upgradedCacheCount"]);class Zy{startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}}class ev{generateId(){return"callback-id"}startMeasurement(e,t){return{end:()=>null,discard:()=>{},add:()=>{},increment:()=>{},event:{eventId:this.generateId(),status:$y,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:e,startTimeMs:Date.now(),correlationId:t||""},measurement:new Zy}}startPerformanceMeasurement(){return new Zy}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}}const tv={tokenRenewalOffsetSeconds:300,preventCorsPreflight:!1},nv={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:Sf.Info,correlationId:Vu.EMPTY_STRING},rv={claimsBasedCachingEnabled:!1},iv={async sendGetRequestAsync(){throw op(ep)},async sendPostRequestAsync(){throw op(ep)}},ov={sku:Vu.SKU,version:cp,cpu:Vu.EMPTY_STRING,os:Vu.EMPTY_STRING},sv={clientSecret:Vu.EMPTY_STRING,clientAssertion:void 0},av={azureCloudInstance:hg,tenant:"".concat(Vu.DEFAULT_COMMON_TENANT)},cv={application:{appName:"",appVersion:""}};function lv(e){return e.authOptions.authority.options.protocolMode===lg}const uv={sendGetRequestAsync:()=>Promise.reject(op(ep)),sendPostRequestAsync:()=>Promise.reject(op(ep))},hv="pkce_not_created",dv="ear_jwk_empty",fv="ear_jwe_empty",gv="crypto_nonexistent",pv="empty_navigate_uri",mv="hash_empty_error",yv="no_state_in_hash",vv="hash_does_not_contain_known_properties",wv="unable_to_parse_state",bv="state_interaction_type_mismatch",Cv="interaction_in_progress",kv="popup_window_error",Sv="empty_window_error",Tv="user_cancelled",Iv="monitor_popup_timeout",_v="monitor_window_timeout",Av="redirect_in_iframe",Ev="block_iframe_reload",Pv="block_nested_popups",Rv="iframe_closed_prematurely",Nv="silent_logout_unsupported",Ov="no_account_error",Mv="silent_prompt_value_error",xv="no_token_request_cache_error",Dv="unable_to_parse_token_request_cache_error",Lv="auth_request_not_set_error",Fv="invalid_cache_type",qv="non_browser_environment",Uv="database_not_open",zv="no_network_connectivity",Bv="post_request_failed",Hv="get_request_failed",Vv="failed_to_parse_response",jv="unable_to_load_token",Kv="crypto_key_not_found",Gv="auth_code_required",Qv="auth_code_or_nativeAccountId_required",Wv="spa_code_and_nativeAccountId_present",Yv="database_unavailable",Jv="unable_to_acquire_token_from_native_platform",Xv="native_handshake_timeout",$v="native_extension_not_installed",Zv="native_connection_not_established",ew="uninitialized_public_client_application",tw="native_prompt_not_supported",nw="invalid_base64_string",rw="invalid_pop_token_request",iw="failed_to_build_headers",ow="failed_to_parse_headers",sw="failed_to_decrypt_ear_response",aw="timed_out",cw="For more visit: aka.ms/msaljs/browser-errors",lw={[hv]:"The PKCE code challenge and verifier could not be generated.",[dv]:"No EAR encryption key provided. This is unexpected.",[fv]:"Server response does not contain ear_jwe property. This is unexpected.",[gv]:"The crypto object or function is not available.",[pv]:"Navigation URI is empty. Please check stack trace for more info.",[mv]:"Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. ".concat(cw),[yv]:"Hash does not contain state. Please verify that the request originated from msal.",[vv]:"Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.  ".concat(cw),[wv]:"Unable to parse state. Please verify that the request originated from msal.",[bv]:"Hash contains state but the interaction type does not match the caller.",[Cv]:"Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.   ".concat(cw),[kv]:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",[Sv]:"window.open returned null or undefined window object.",[Tv]:"User cancelled the flow.",[Iv]:"Token acquisition in popup failed due to timeout.  ".concat(cw),[_v]:"Token acquisition in iframe failed due to timeout.  ".concat(cw),[Av]:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",[Ev]:"Request was blocked inside an iframe because MSAL detected an authentication response.  ".concat(cw),[Pv]:"Request was blocked inside a popup because MSAL detected it was running in a popup.",[Rv]:"The iframe being monitored was closed prematurely.",[Nv]:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead.",[Ov]:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",[Mv]:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'.",[xv]:"No token request found in cache.",[Dv]:"The cached token request could not be parsed.",[Lv]:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",[Fv]:"Invalid cache type",[qv]:"Login and token requests are not supported in non-browser environments.",[Uv]:"Database is not open!",[zv]:"No network connectivity. Check your internet connection.",[Bv]:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",[Hv]:"Network request failed. Please check the network trace to determine root cause.",[Vv]:"Failed to parse network response. Check network trace.",[jv]:"Error loading token to cache.",[Kv]:"Cryptographic Key or Keypair not found in browser storage.",[Gv]:"An authorization code must be provided (as the `code` property on the request) to this flow.",[Qv]:"An authorization code or nativeAccountId must be provided to this flow.",[Wv]:"Request cannot contain both spa code and native account id.",[Yv]:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts.",[Jv]:"Unable to acquire token from native platform.  ".concat(cw),[Xv]:"Timed out while attempting to establish connection to browser extension",[$v]:"Native extension is not installed. If you think this is a mistake call the initialize function.",[Zv]:"Connection to native platform has not been established. Please install a compatible browser extension and run initialize().  ".concat(cw),[ew]:"You must call and await the initialize function before attempting to call any other MSAL API.  ".concat(cw),[tw]:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow.",[nw]:"Invalid base64 encoded string.",[rw]:"Invalid PoP token request. The request should not have both a popKid value and signPopToken set to true.",[iw]:"Failed to build request headers object.",[ow]:"Failed to parse response headers",[sw]:"Failed to decrypt ear response",[aw]:"The request timed out."};class uw extends ad{constructor(e,t){super(e,lw[e],t),Object.setPrototypeOf(this,uw.prototype),this.name="BrowserAuthError"}}function hw(e,t){return new uw(e,t)}class dw{navigateInternal(e,t){return dw.defaultNavigateWindow(e,t)}navigateExternal(e,t){return dw.defaultNavigateWindow(e,t)}static defaultNavigateWindow(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise((e,n)=>{setTimeout(()=>{n(hw(aw,"failed_to_redirect"))},t.timeout)})}}class fw extends ad{constructor(e,t,n){super(e.errorCode,e.errorMessage,e.subError),Object.setPrototypeOf(this,fw.prototype),this.name="NetworkError",this.error=e,this.httpStatus=t,this.responseHeaders=n}}function gw(e,t,n,r){return e.errorMessage="".concat(e.errorMessage,", additionalErrorInfo: error.name:").concat(null===r||void 0===r?void 0:r.name,", error.message:").concat(null===r||void 0===r?void 0:r.message),new fw(e,t,n)}class pw{async sendGetRequestAsync(e,t){let n,r={},i=0;const o=mw(t);try{n=await fetch(e,{method:Fd,headers:o})}catch(s){throw gw(hw(window.navigator.onLine?Hv:zv),void 0,void 0,s)}r=yw(n.headers);try{return i=n.status,{headers:r,body:await n.json(),status:i}}catch(s){throw gw(hw(Vv),i,r,s)}}async sendPostRequestAsync(e,t){const n=t&&t.body||"",r=mw(t);let i,o=0,s={};try{i=await fetch(e,{method:qd,headers:r,body:n})}catch(a){throw gw(hw(window.navigator.onLine?Bv:zv),void 0,void 0,a)}s=yw(i.headers);try{return o=i.status,{headers:s,body:await i.json(),status:o}}catch(a){throw gw(hw(Vv),o,s,a)}}}function mw(e){try{const t=new Headers;if(!e||!e.headers)return t;const n=e.headers;return Object.entries(n).forEach(e=>{let[n,r]=e;t.append(n,r)}),t}catch(t){throw gw(hw(iw),void 0,void 0,t)}}function yw(e){try{const t={};return e.forEach((e,n)=>{t[n]=e}),t}catch(t){throw hw(ow)}}const vw="client_id",ww="redirect_uri",bw="token_type",Cw="req_cnf",kw="return_spa_code",Sw="x-client-xtra-sku",Tw="brk_client_id",Iw="brk_redirect_uri",_w="instance_aware";function Aw(e,t,n){if(!t)return;const r=e.get(vw);r&&e.has(Tw)&&(null===n||void 0===n||n.addFields({embeddedClientId:r,embeddedRedirectUri:e.get(ww)},t))}function Ew(e,t){e.set("response_type",t)}function Pw(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:$u;!n||r.includes("openid")||t.includes("openid")||r.push("openid");const i=n?[...t||[],...r]:t||[],o=new Lp(i);e.set("scope",o.printScopes())}function Rw(e,t){e.set(vw,t)}function Nw(e,t){e.set(ww,t)}function Ow(e,t){e.set("login_hint",t)}function Mw(e,t){e.set(rh,"UPN:".concat(t))}function xw(e,t){e.set(rh,"Oid:".concat(t.uid,"@").concat(t.utid))}function Dw(e,t){e.set("sid",t)}function Lw(e,t,n){const r=Yw(t,n);try{JSON.parse(r)}catch(i){throw xp(pp)}e.set("claims",r)}function Fw(e,t){e.set("client-request-id",t)}function qw(e,t){e.set("x-client-SKU",t.sku),e.set("x-client-VER",t.version),t.os&&e.set("x-client-OS",t.os),t.cpu&&e.set("x-client-CPU",t.cpu)}function Uw(e,t){null!==t&&void 0!==t&&t.appName&&e.set("x-app-name",t.appName),null!==t&&void 0!==t&&t.appVersion&&e.set("x-app-ver",t.appVersion)}function zw(e,t){t&&e.set("state",t)}function Bw(e,t,n){if(!t||!n)throw xp(wp);e.set("code_challenge",t),e.set("code_challenge_method",n)}function Hw(e,t){e.set("client_secret",t)}function Vw(e,t){t&&e.set("client_assertion",t)}function jw(e,t){t&&e.set("client_assertion_type",t)}function Kw(e,t){e.set("grant_type",t)}function Gw(e){e.set("client_info","1")}function Qw(e){e.has(_w)||e.set(_w,"true")}function Ww(e,t){Object.entries(t).forEach(t=>{let[n,r]=t;!e.has(n)&&r&&e.set(n,r)})}function Yw(e,t){let n;if(e)try{n=JSON.parse(e)}catch(r){throw xp(pp)}else n={};return t&&t.length>0&&(n.hasOwnProperty(uh)||(n[uh]={}),n[uh][hh]={values:t}),JSON.stringify(n)}function Jw(e,t){t&&(e.set(bw,Uh.POP),e.set(Cw,t))}function Xw(e,t){t&&(e.set(bw,Uh.SSH),e.set(Cw,t))}function $w(e,t){e.set("x-client-current-telemetry",t.generateCurrentRequestHeaderValue()),e.set("x-client-last-telemetry",t.generateLastRequestHeaderValue())}function Zw(e){e.set("x-ms-lib-capability",Vh)}function eb(e,t,n){e.has(Tw)||e.set(Tw,t),e.has(Iw)||e.set(Iw,n)}function tb(e){return encodeURIComponent(rb(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))}function nb(e){return ib(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function rb(e){return ib((new TextEncoder).encode(e))}function ib(e){const t=Array.from(e,e=>String.fromCodePoint(e)).join("");return btoa(t)}function ob(e){return(new TextDecoder).decode(sb(e))}function sb(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw hw(nw)}const n=atob(t);return Uint8Array.from(n,e=>e.codePointAt(0)||0)}const ab="AES-GCM",cb="HKDF",lb="SHA-256",ub=new Uint8Array([1,0,1]),hb="0123456789abcdef",db=new Uint32Array(1),fb="raw",gb="encrypt",pb="decrypt",mb={name:"RSASSA-PKCS1-v1_5",hash:lb,modulusLength:2048,publicExponent:ub};async function yb(e,t,n){null===t||void 0===t||t.addQueueMeasurement(Hy,n);const r=(new TextEncoder).encode(e);return window.crypto.subtle.digest(lb,r)}function vb(e){return window.crypto.getRandomValues(e)}function wb(){return window.crypto.getRandomValues(db),db[0]}function bb(){const e=Date.now(),t=1024*wb()+(1023&wb()),n=new Uint8Array(16),r=Math.trunc(t/2**30),i=t&2**30-1,o=wb();n[0]=e/2**40,n[1]=e/2**32,n[2]=e/2**24,n[3]=e/65536,n[4]=e/256,n[5]=e,n[6]=112|r>>>8,n[7]=r,n[8]=128|i>>>24,n[9]=i>>>16,n[10]=i>>>8,n[11]=i,n[12]=o>>>24,n[13]=o>>>16,n[14]=o>>>8,n[15]=o;let s="";for(let a=0;a<n.length;a++)s+=hb.charAt(n[a]>>>4),s+=hb.charAt(15&n[a]),3!==a&&5!==a&&7!==a&&9!==a||(s+="-");return s}async function Cb(e){return window.crypto.subtle.exportKey("jwk",e)}async function kb(){const e=await Tb(),t={alg:"dir",kty:"oct",k:nb(new Uint8Array(e))};return rb(JSON.stringify(t))}async function Sb(e,t){const n=t.split(".");if(5!==n.length)throw hw(sw,"jwe_length");const r=await async function(e){const t=ob(e),n=sb(JSON.parse(t).k);return window.crypto.subtle.importKey(fb,n,ab,!1,[pb])}(e).catch(()=>{throw hw(sw,"import_key")});try{const e=(new TextEncoder).encode(n[0]),t=sb(n[2]),i=sb(n[3]),o=sb(n[4]),s=8*o.byteLength,a=new Uint8Array(i.length+o.length);a.set(i),a.set(o,i.length);const c=await window.crypto.subtle.decrypt({name:ab,iv:t,tagLength:s,additionalData:e},r,a);return(new TextDecoder).decode(c)}catch(i){throw hw(sw,"decrypt")}}async function Tb(){const e=await window.crypto.subtle.generateKey({name:ab,length:256},!0,[gb,pb]);return window.crypto.subtle.exportKey(fb,e)}async function Ib(e){return window.crypto.subtle.importKey(fb,e,cb,!1,["deriveKey"])}async function _b(e,t,n){return window.crypto.subtle.deriveKey({name:cb,salt:t,hash:lb,info:(new TextEncoder).encode(n)},e,{name:ab,length:256},!1,[gb,pb])}async function Ab(e,t,n){const r=(new TextEncoder).encode(t),i=window.crypto.getRandomValues(new Uint8Array(16)),o=await _b(e,i,n),s=await window.crypto.subtle.encrypt({name:ab,iv:new Uint8Array(12)},o,r);return{data:nb(new Uint8Array(s)),nonce:nb(i)}}async function Eb(e,t,n,r){const i=sb(r),o=await _b(e,sb(t),n),s=await window.crypto.subtle.decrypt({name:ab,iv:new Uint8Array(12)},o,i);return(new TextDecoder).decode(s)}async function Pb(e){const t=await yb(e);return nb(new Uint8Array(t))}function Rb(e){e.location.hash="","function"===typeof e.history.replaceState&&e.history.replaceState(null,"","".concat(e.location.origin).concat(e.location.pathname).concat(e.location.search))}function Nb(){return window.parent!==window}function Ob(){return"undefined"!==typeof window&&window.location?window.location.href.split("?")[0].split("#")[0]:""}function Mb(){if("undefined"!==typeof window&&window.opener&&window.opener!==window&&"string"===typeof window.name&&0===window.name.indexOf("".concat(wd,".")))throw hw(Pv)}function xb(){if("undefined"===typeof window)throw hw(qv)}function Db(e){if(!e)throw hw(ew)}function Lb(e){xb(),function(){if(om.hashContainsKnownProperties(window.location.hash)&&Nb())throw hw(Ev)}(),Mb(),Db(e)}function Fb(e,t){if(Lb(e),function(e){if(Nb()&&!e)throw hw(Av)}(t.system.allowRedirectInIframe),t.cache.cacheLocation===Ld&&!t.cache.storeAuthStateInCookie)throw gd(hd)}function qb(e){const t=document.createElement("link");t.rel="preconnect",t.href=new URL(e).origin,t.crossOrigin="anonymous",document.head.appendChild(t),window.setTimeout(()=>{try{document.head.removeChild(t)}catch(e){}},1e4)}const Ub=1e4;const zb="4.26.2",Bb="msal",Hb="browser",Vb="".concat(Bb,".").concat(Hb,".log.level"),jb="".concat(Bb,".").concat(Hb,".log.pii"),Kb=("".concat(Bb,".").concat(Hb,".performance.enabled"),"".concat(Bb,".").concat(Hb,".platform.auth.dom")),Gb="".concat(Bb,".version"),Qb="account.keys",Wb="token.keys";function Yb(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return e<1?"".concat(Bb,".").concat(Qb):"".concat(Bb,".").concat(e,".").concat(Qb)}function Jb(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return t<1?"".concat(Bb,".").concat(Wb,".").concat(e):"".concat(Bb,".").concat(t,".").concat(Wb,".").concat(e)}class Xb{static loggerCallback(e,t){switch(e){case Sf.Error:return void console.error(t);case Sf.Info:return void console.info(t);case Sf.Verbose:return void console.debug(t);case Sf.Warning:return void console.warn(t);default:return void console.log(t)}}constructor(e){var t,n;let r;this.browserEnvironment="undefined"!==typeof window,this.config=function(e,t){let{auth:n,cache:r,system:i,telemetry:o}=e;const s={clientId:Vu.EMPTY_STRING,authority:"".concat(Vu.DEFAULT_AUTHORITY),knownAuthorities:[],cloudDiscoveryMetadata:Vu.EMPTY_STRING,authorityMetadata:Vu.EMPTY_STRING,redirectUri:"undefined"!==typeof window?Ob():"",postLogoutRedirectUri:Vu.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:cg,OIDCOptions:{serverResponseType:bh,defaultScopes:[Vu.OPENID_SCOPE,Vu.PROFILE_SCOPE,Vu.OFFLINE_ACCESS_SCOPE]},azureCloudOptions:{azureCloudInstance:hg,tenant:Vu.EMPTY_STRING},skipAuthorityMetadataCache:!1,supportsNestedAppAuth:!1,instanceAware:!1,encodeExtraQueryParams:!1},a={cacheLocation:Dd,cacheRetentionDays:5,temporaryCacheLocation:Dd,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!(!r||r.cacheLocation!==xd),claimsBasedCachingEnabled:!1},c={loggerCallback:()=>{},logLevel:Sf.Info,piiLoggingEnabled:!1},u=l(l({},tv),{},{loggerOptions:c,networkClient:t?new pw:uv,navigationClient:new dw,loadFrameTimeout:0,windowHashTimeout:(null===i||void 0===i?void 0:i.loadFrameTimeout)||6e4,iframeHashTimeout:(null===i||void 0===i?void 0:i.loadFrameTimeout)||Ub,navigateFrameWait:0,redirectNavigationTimeout:3e4,asyncPopups:!1,allowRedirectInIframe:!1,allowPlatformBroker:!1,nativeBrokerHandshakeTimeout:(null===i||void 0===i?void 0:i.nativeBrokerHandshakeTimeout)||2e3,pollIntervalMilliseconds:bd}),h=l(l(l({},u),i),{},{loggerOptions:(null===i||void 0===i?void 0:i.loggerOptions)||c}),d={application:{appName:Vu.EMPTY_STRING,appVersion:Vu.EMPTY_STRING},client:new ev};(null===n||void 0===n?void 0:n.protocolMode)!==lg&&null!==n&&void 0!==n&&n.OIDCOptions&&new Tf(h.loggerOptions).warning(JSON.stringify(xp(Ap)));if(null!==n&&void 0!==n&&n.protocolMode&&n.protocolMode===lg&&null!==h&&void 0!==h&&h.allowPlatformBroker)throw xp(Ep);return{auth:l(l(l({},s),n),{},{OIDCOptions:l(l({},s.OIDCOptions),null===n||void 0===n?void 0:n.OIDCOptions)}),cache:l(l({},a),r),system:h,telemetry:l(l({},d),o)}}(e,this.browserEnvironment);try{r=window[Dd]}catch(u){}const i=null===(t=r)||void 0===t?void 0:t.getItem(Vb),o=null===(n=r)||void 0===n||null===(n=n.getItem(jb))||void 0===n?void 0:n.toLowerCase(),s="true"===o||"false"!==o&&void 0,a=l({},this.config.system.loggerOptions),c=i&&Object.keys(Sf).includes(i)?Sf[i]:void 0;c&&(a.loggerCallback=Xb.loggerCallback,a.logLevel=c),void 0!==s&&(a.piiLoggingEnabled=s),this.logger=new Tf(a,"@azure/msal-browser",zb),this.available=!1}getConfig(){return this.config}getLogger(){return this.logger}isAvailable(){return this.available}isBrowserEnvironment(){return this.browserEnvironment}}class $b extends Xb{getModuleName(){return $b.MODULE_NAME}getId(){return $b.ID}async initialize(){return this.available="undefined"!==typeof window,this.available}}$b.MODULE_NAME="",$b.ID="StandardOperatingContext";const Zb="missing_kid_error",eC="missing_alg_error",tC={[Zb]:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided.",[eC]:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."};class nC extends ad{constructor(e,t){super(e,t),this.name="JoseHeaderError",Object.setPrototypeOf(this,nC.prototype)}}function rC(e){return new nC(e,tC[e])}class iC{constructor(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}static getShrHeaderString(e){if(!e.kid)throw rC(Zb);if(!e.alg)throw rC(eC);const t=new iC({typ:e.typ||rd,kid:e.kid,alg:e.alg});return JSON.stringify(t)}}class oC{constructor(){this.dbName=gf,this.version=1,this.tableName=pf,this.dbOpen=!1}async open(){return new Promise((e,t)=>{const n=window.indexedDB.open(this.dbName,this.version);n.addEventListener("upgradeneeded",e=>{e.target.result.createObjectStore(this.tableName)}),n.addEventListener("success",t=>{const n=t;this.db=n.target.result,this.dbOpen=!0,e()}),n.addEventListener("error",()=>t(hw(Yv)))})}closeConnection(){const e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)}async validateDbIsOpen(){if(!this.dbOpen)return this.open()}async getItem(e){return await this.validateDbIsOpen(),new Promise((t,n)=>{if(!this.db)return n(hw(Uv));const r=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).get(e);r.addEventListener("success",e=>{const n=e;this.closeConnection(),t(n.target.result)}),r.addEventListener("error",e=>{this.closeConnection(),n(e)})})}async setItem(e,t){return await this.validateDbIsOpen(),new Promise((n,r)=>{if(!this.db)return r(hw(Uv));const i=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).put(t,e);i.addEventListener("success",()=>{this.closeConnection(),n()}),i.addEventListener("error",e=>{this.closeConnection(),r(e)})})}async removeItem(e){return await this.validateDbIsOpen(),new Promise((t,n)=>{if(!this.db)return n(hw(Uv));const r=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).delete(e);r.addEventListener("success",()=>{this.closeConnection(),t()}),r.addEventListener("error",e=>{this.closeConnection(),n(e)})})}async getKeys(){return await this.validateDbIsOpen(),new Promise((e,t)=>{if(!this.db)return t(hw(Uv));const n=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).getAllKeys();n.addEventListener("success",t=>{const n=t;this.closeConnection(),e(n.target.result)}),n.addEventListener("error",e=>{this.closeConnection(),t(e)})})}async containsKey(e){return await this.validateDbIsOpen(),new Promise((t,n)=>{if(!this.db)return n(hw(Uv));const r=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).count(e);r.addEventListener("success",e=>{const n=e;this.closeConnection(),t(1===n.target.result)}),r.addEventListener("error",e=>{this.closeConnection(),n(e)})})}async deleteDatabase(){return this.db&&this.dbOpen&&this.closeConnection(),new Promise((e,t)=>{const n=window.indexedDB.deleteDatabase(gf),r=setTimeout(()=>t(!1),200);n.addEventListener("success",()=>(clearTimeout(r),e(!0))),n.addEventListener("blocked",()=>(clearTimeout(r),e(!0))),n.addEventListener("error",()=>(clearTimeout(r),t(!1)))})}}class sC{constructor(){this.cache=new Map}async initialize(){}getItem(e){return this.cache.get(e)||null}getUserData(e){return this.getItem(e)}setItem(e,t){this.cache.set(e,t)}async setUserData(e,t){this.setItem(e,t)}removeItem(e){this.cache.delete(e)}getKeys(){const e=[];return this.cache.forEach((t,n)=>{e.push(n)}),e}containsKey(e){return this.cache.has(e)}clear(){this.cache.clear()}decryptData(){return Promise.resolve(null)}}class aC{constructor(e){this.inMemoryCache=new sC,this.indexedDBCache=new oC,this.logger=e}handleDatabaseAccessError(e){if(!(e instanceof uw&&e.errorCode===Yv))throw e;this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.")}async getItem(e){const t=this.inMemoryCache.getItem(e);if(!t)try{return this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.getItem(e)}catch(n){this.handleDatabaseAccessError(n)}return t}async setItem(e,t){this.inMemoryCache.setItem(e,t);try{await this.indexedDBCache.setItem(e,t)}catch(n){this.handleDatabaseAccessError(n)}}async removeItem(e){this.inMemoryCache.removeItem(e);try{await this.indexedDBCache.removeItem(e)}catch(t){this.handleDatabaseAccessError(t)}}async getKeys(){const e=this.inMemoryCache.getKeys();if(0===e.length)try{return this.logger.verbose("In-memory cache is empty, now querying persistent storage."),await this.indexedDBCache.getKeys()}catch(t){this.handleDatabaseAccessError(t)}return e}async containsKey(e){const t=this.inMemoryCache.containsKey(e);if(!t)try{return this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.containsKey(e)}catch(n){this.handleDatabaseAccessError(n)}return t}clearInMemory(){this.logger.verbose("Deleting in-memory keystore"),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore deleted")}async clearPersistent(){try{this.logger.verbose("Deleting persistent keystore");const e=await this.indexedDBCache.deleteDatabase();return e&&this.logger.verbose("Persistent keystore deleted"),e}catch(e){return this.handleDatabaseAccessError(e),!1}}}class cC{constructor(e,t,n){this.logger=e,function(e){if(!window)throw hw(qv);if(!window.crypto)throw hw(gv);if(!e&&!window.crypto.subtle)throw hw(gv,"crypto_subtle_undefined")}(null!==n&&void 0!==n&&n),this.cache=new aC(this.logger),this.performanceClient=t}createNewGuid(){return bb()}base64Encode(e){return rb(e)}base64Decode(e){return ob(e)}base64UrlEncode(e){return tb(e)}encodeKid(e){return this.base64UrlEncode(JSON.stringify({kid:e}))}async getPublicKeyThumbprint(e){var t;const n=null===(t=this.performanceClient)||void 0===t?void 0:t.startMeasurement(Im,e.correlationId),r=await async function(e,t){return window.crypto.subtle.generateKey(mb,e,t)}(cC.EXTRACTABLE,cC.POP_KEY_USAGES),i=await Cb(r.publicKey),o=lC({e:i.e,kty:i.kty,n:i.n}),s=await this.hashString(o),a=await Cb(r.privateKey),c=await async function(e,t,n){return window.crypto.subtle.importKey("jwk",e,mb,t,n)}(a,!1,["sign"]);return await this.cache.setItem(s,{privateKey:c,publicKey:r.publicKey,requestMethod:e.resourceRequestMethod,requestUri:e.resourceRequestUri}),n&&n.end({success:!0}),s}async removeTokenBindingKey(e){await this.cache.removeItem(e);if(await this.cache.containsKey(e))throw op(Wg)}async clearKeystore(){this.cache.clearInMemory();try{return await this.cache.clearPersistent(),!0}catch(e){return e instanceof Error?this.logger.error("Clearing keystore failed with error: ".concat(e.message)):this.logger.error("Clearing keystore failed with unknown error"),!1}}async signJwt(e,t,n,r){var i;const o=null===(i=this.performanceClient)||void 0===i?void 0:i.startMeasurement(_m,r),s=await this.cache.getItem(t);if(!s)throw hw(Kv);const a=await Cb(s.publicKey),c=lC(a),u=tb(JSON.stringify({kid:t})),h=tb(iC.getShrHeaderString(l(l({},null===n||void 0===n?void 0:n.header),{},{alg:a.alg,kid:u})));e.cnf={jwk:JSON.parse(c)};const d=tb(JSON.stringify(e)),f="".concat(h,".").concat(d),g=(new TextEncoder).encode(f),p=await async function(e,t){return window.crypto.subtle.sign(mb,e,t)}(s.privateKey,g),m=nb(new Uint8Array(p)),y="".concat(f,".").concat(m);return o&&o.end({success:!0}),y}async hashString(e){return Pb(e)}}function lC(e){return JSON.stringify(e,Object.keys(e).sort())}cC.POP_KEY_USAGES=["sign","verify"],cC.EXTRACTABLE=!0;const uC=(e,t,n,r,i)=>function(){n.trace("Executing function ".concat(t));const o=null===r||void 0===r?void 0:r.startMeasurement(t,i);if(i){const e=t+"CallCount";null===r||void 0===r||r.incrementFields({[e]:1},i)}try{const r=e(...arguments);return null===o||void 0===o||o.end({success:!0}),n.trace("Returning result from ".concat(t)),r}catch(s){n.trace("Error occurred in ".concat(t));try{n.trace(JSON.stringify(s))}catch(s){n.trace("Unable to print error message.")}throw null===o||void 0===o||o.end({success:!1},s),s}},hC=(e,t,n,r,i)=>function(){n.trace("Executing function ".concat(t));const o=null===r||void 0===r?void 0:r.startMeasurement(t,i);if(i){const e=t+"CallCount";null===r||void 0===r||r.incrementFields({[e]:1},i)}return null===r||void 0===r||r.setPreQueueTime(t,i),e(...arguments).then(e=>(n.trace("Returning result from ".concat(t)),null===o||void 0===o||o.end({success:!0}),e)).catch(e=>{n.trace("Error occurred in ".concat(t));try{n.trace(JSON.stringify(e))}catch(e){n.trace("Unable to print error message.")}throw null===o||void 0===o||o.end({success:!1},e),e})};class dC{constructor(e,t,n,r){this.networkInterface=e,this.logger=t,this.performanceClient=n,this.correlationId=r}async detectRegion(e,t){var n;null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(_y,this.correlationId);let r=e;if(r)t.region_source=Qh;else{const e=dC.IMDS_OPTIONS;try{const n=await hC(this.getRegionFromIMDS.bind(this),Ay,this.logger,this.performanceClient,this.correlationId)(Vu.IMDS_VERSION,e);if(n.status===ju&&(r=n.body,t.region_source=Wh),n.status===Gu){const n=await hC(this.getCurrentVersion.bind(this),Ey,this.logger,this.performanceClient,this.correlationId)(e);if(!n)return t.region_source=Gh,null;const i=await hC(this.getRegionFromIMDS.bind(this),Ay,this.logger,this.performanceClient,this.correlationId)(n,e);i.status===ju&&(r=i.body,t.region_source=Wh)}}catch(i){return t.region_source=Gh,null}}return r||(t.region_source=Gh),r||null}async getRegionFromIMDS(e,t){var n;return null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(Ay,this.correlationId),this.networkInterface.sendGetRequestAsync("".concat(Vu.IMDS_ENDPOINT,"?api-version=").concat(e,"&format=text"),t,Vu.IMDS_TIMEOUT)}async getCurrentVersion(e){var t;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(Ey,this.correlationId);try{const t=await this.networkInterface.sendGetRequestAsync("".concat(Vu.IMDS_ENDPOINT,"?format=json"),e);return t.status===Gu&&t.body&&t.body["newest-versions"]&&t.body["newest-versions"].length>0?t.body["newest-versions"][0]:null}catch(n){return null}}}function fC(){return Math.round((new Date).getTime()/1e3)}function gC(e){return e.getTime()/1e3}function pC(e){return e?new Date(1e3*Number(e)):new Date}function mC(e,t){const n=Number(e)||0;return fC()+t>n}function yC(e,t){const n=Number(e)+24*t*60*60*1e3;return Date.now()>n}function vC(e,t,n,r,i){return{credentialType:Ph.ID_TOKEN,homeAccountId:e,environment:t,clientId:r,secret:n,realm:i,lastUpdatedAt:Date.now().toString()}}function wC(e,t,n,r,i,o,s,a,c,l,u,h,d,f,g){var p,m;const y={homeAccountId:e,credentialType:Ph.ACCESS_TOKEN,secret:n,cachedAt:fC().toString(),expiresOn:s.toString(),extendedExpiresOn:a.toString(),environment:t,clientId:r,realm:i,target:o,tokenType:u||Uh.BEARER,lastUpdatedAt:Date.now().toString()};if(h&&(y.userAssertionHash=h),l&&(y.refreshOn=l.toString()),f&&(y.requestedClaims=f,y.requestedClaimsHash=g),(null===(p=y.tokenType)||void 0===p?void 0:p.toLowerCase())!==Uh.BEARER.toLowerCase())switch(y.credentialType=Ph.ACCESS_TOKEN_WITH_AUTH_SCHEME,y.tokenType){case Uh.POP:const e=Xp(n,c);if(null===e||void 0===e||null===(m=e.cnf)||void 0===m||!m.kid)throw op(Gg);y.keyId=e.cnf.kid;break;case Uh.SSH:y.keyId=d}return y}function bC(e,t,n,r,i,o,s){const a={credentialType:Ph.REFRESH_TOKEN,homeAccountId:e,environment:t,clientId:r,secret:n,lastUpdatedAt:Date.now().toString()};return o&&(a.userAssertionHash=o),i&&(a.familyId=i),s&&(a.expiresOn=s.toString()),a}function CC(e){return e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")}function kC(e){return!!e&&(CC(e)&&e.hasOwnProperty("realm")&&e.hasOwnProperty("target")&&(e.credentialType===Ph.ACCESS_TOKEN||e.credentialType===Ph.ACCESS_TOKEN_WITH_AUTH_SCHEME))}function SC(e){return!!e&&(CC(e)&&e.credentialType===Ph.REFRESH_TOKEN)}function TC(){return fC()+Mh}function IC(e,t,n){e.authorization_endpoint=t.authorization_endpoint,e.token_endpoint=t.token_endpoint,e.end_session_endpoint=t.end_session_endpoint,e.issuer=t.issuer,e.endpointsFromNetwork=n,e.jwks_uri=t.jwks_uri}function _C(e,t,n){e.aliases=t.aliases,e.preferred_cache=t.preferred_cache,e.preferred_network=t.preferred_network,e.aliasesFromNetwork=n}function AC(e){return e.expiresAt<=fC()}dC.IMDS_OPTIONS={headers:{Metadata:"true"}};class EC{constructor(e,t,n,r,i,o,s,a){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=n,this.authorityOptions=r,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=i,this.performanceClient=s,this.correlationId=o,this.managedIdentity=a||!1,this.regionDiscovery=new dC(t,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(e){if(e.HostNameAndPort.endsWith(Vu.CIAM_AUTH_URL))return Wp;const t=e.PathSegments;if(t.length)switch(t[0].toLowerCase()){case Vu.ADFS:return Gp;case Vu.DSTS:return Qp}return Kp}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(e){this._canonicalAuthority=new om(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw op(mg)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw op(mg)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw op(mg)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw op(Yg);return this.replacePath(this.metadata.end_session_endpoint)}throw op(mg)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw op(mg)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw op(mg)}canReplaceTenant(e){return 1===e.PathSegments.length&&!EC.reservedTenantDomains.has(e.PathSegments[0])&&this.getAuthorityType(e)===Kp&&this.protocolMode!==lg}replaceTenant(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(e){let t=e;const n=new om(this.metadata.canonical_authority).getUrlComponents(),r=n.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((e,i)=>{let o=r[i];if(0===i&&this.canReplaceTenant(n)){const e=new om(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];o!==e&&(this.logger.verbose("Replacing tenant domain name ".concat(o," with id ").concat(e)),o=e)}e!==o&&(t=t.replace("/".concat(o,"/"),"/".concat(e,"/")))}),this.replaceTenant(t)}get defaultOpenIdConfigurationEndpoint(){const e=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||this.authorityType===Gp||this.protocolMode===lg&&!this.isAliasOfKnownMicrosoftAuthority(e)?"".concat(this.canonicalAuthority,".well-known/openid-configuration"):"".concat(this.canonicalAuthority,"v2.0/.well-known/openid-configuration")}discoveryComplete(){return!!this.metadata}async resolveEndpointsAsync(){var e,t;null===(e=this.performanceClient)||void 0===e||e.addQueueMeasurement(by,this.correlationId);const n=this.getCurrentMetadataEntity(),r=await hC(this.updateCloudDiscoveryMetadata.bind(this),ky,this.logger,this.performanceClient,this.correlationId)(n);this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,n.preferred_network);const i=await hC(this.updateEndpointMetadata.bind(this),Ty,this.logger,this.performanceClient,this.correlationId)(n);this.updateCachedMetadata(n,r,{source:i}),null===(t=this.performanceClient)||void 0===t||t.addFields({cloudDiscoverySource:r,authorityEndpointSource:i},this.correlationId)}getCurrentMetadataEntity(){let e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return e||(e={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:TC(),jwks_uri:""}),e}updateCachedMetadata(e,t,n){t!==Dh&&(null===n||void 0===n?void 0:n.source)!==Dh&&(e.expiresAt=TC(),e.canonical_authority=this.canonicalAuthority);const r=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(r,e),this.metadata=e}async updateEndpointMetadata(e){var t;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(Ty,this.correlationId);const n=this.updateEndpointMetadataFromLocalSources(e);if(n){var r;if(n.source===Fh)if(null!==(r=this.authorityOptions.azureRegionConfiguration)&&void 0!==r&&r.azureRegion&&n.metadata){IC(e,await hC(this.updateMetadataWithRegionalInformation.bind(this),Iy,this.logger,this.performanceClient,this.correlationId)(n.metadata),!1),e.canonical_authority=this.canonicalAuthority}return n.source}let i=await hC(this.getEndpointMetadataFromNetwork.bind(this),Sy,this.logger,this.performanceClient,this.correlationId)();var o;if(i)return null!==(o=this.authorityOptions.azureRegionConfiguration)&&void 0!==o&&o.azureRegion&&(i=await hC(this.updateMetadataWithRegionalInformation.bind(this),Iy,this.logger,this.performanceClient,this.correlationId)(i)),IC(e,i,!0),Lh;throw op(vg,this.defaultOpenIdConfigurationEndpoint)}updateEndpointMetadataFromLocalSources(e){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");const t=this.getEndpointMetadataFromConfig();if(t)return this.logger.verbose("Found endpoint metadata in authority configuration"),IC(e,t,!1),{source:xh};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{const t=this.getEndpointMetadataFromHardcodedValues();if(t)return IC(e,t,!1),{source:Fh,metadata:t};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}const n=AC(e);return this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!n?(this.logger.verbose("Found endpoint metadata in the cache."),{source:Dh}):(n&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(e){return new om(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(e){throw xp(Cp)}return null}async getEndpointMetadataFromNetwork(){var e;null===(e=this.performanceClient)||void 0===e||e.addQueueMeasurement(Sy,this.correlationId);const t={},n=this.defaultOpenIdConfigurationEndpoint;this.logger.verbose("Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ".concat(n));try{const e=await this.networkInterface.sendGetRequestAsync(n,t),r=function(e){return e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("jwks_uri")}(e.body);return r?e.body:(this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(r){return this.logger.verbose("Authority.getEndpointMetadataFromNetwork: ".concat(r)),null}}getEndpointMetadataFromHardcodedValues(){return this.hostnameAndPort in sm?sm[this.hostnameAndPort]:null}async updateMetadataWithRegionalInformation(e){var t,n;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(Iy,this.correlationId);const r=null===(n=this.authorityOptions.azureRegionConfiguration)||void 0===n?void 0:n.azureRegion;if(r){var i;if(r!==Vu.AZURE_REGION_AUTO_DISCOVER_FLAG)return this.regionDiscoveryMetadata.region_outcome=Yh,this.regionDiscoveryMetadata.region_used=r,EC.replaceWithRegionalInformation(e,r);const t=await hC(this.regionDiscovery.detectRegion.bind(this.regionDiscovery),_y,this.logger,this.performanceClient,this.correlationId)(null===(i=this.authorityOptions.azureRegionConfiguration)||void 0===i?void 0:i.environmentRegion,this.regionDiscoveryMetadata);if(t)return this.regionDiscoveryMetadata.region_outcome=Jh,this.regionDiscoveryMetadata.region_used=t,EC.replaceWithRegionalInformation(e,t);this.regionDiscoveryMetadata.region_outcome=Xh}return e}async updateCloudDiscoveryMetadata(e){var t;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(ky,this.correlationId);const n=this.updateCloudDiscoveryMetadataFromLocalSources(e);if(n)return n;const r=await hC(this.getCloudDiscoveryMetadataFromNetwork.bind(this),Cy,this.logger,this.performanceClient,this.correlationId)();if(r)return _C(e,r,!0),Lh;throw xp(kp)}updateCloudDiscoveryMetadataFromLocalSources(e){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii("Known Authorities: ".concat(this.authorityOptions.knownAuthorities||Vu.NOT_APPLICABLE)),this.logger.verbosePii("Authority Metadata: ".concat(this.authorityOptions.authorityMetadata||Vu.NOT_APPLICABLE)),this.logger.verbosePii("Canonical Authority: ".concat(e.canonical_authority||Vu.NOT_APPLICABLE));const t=this.getCloudDiscoveryMetadataFromConfig();if(t)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),_C(e,t,!1),xh;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{const t=(n=this.hostnameAndPort,um(am.metadata,n));if(t)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),_C(e,t,!1),Fh;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}var n;const r=AC(e);return this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!r?(this.logger.verbose("Found cloud discovery metadata in the cache."),Dh):(r&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(this.authorityType===Wp)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),EC.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");const e=um(JSON.parse(this.authorityOptions.cloudDiscoveryMetadata).metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),e)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),e;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch(e){throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),xp(bp)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),EC.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}async getCloudDiscoveryMetadataFromNetwork(){var e;null===(e=this.performanceClient)||void 0===e||e.addQueueMeasurement(Cy,this.correlationId);const t="".concat(Vu.AAD_INSTANCE_DISCOVERY_ENDPT).concat(this.canonicalAuthority,"oauth2/v2.0/authorize"),n={};let r=null;try{const e=await this.networkInterface.sendGetRequestAsync(t,n);let i,o;if(function(e){return e.hasOwnProperty("tenant_discovery_endpoint")&&e.hasOwnProperty("metadata")}(e.body))i=e.body,o=i.metadata,this.logger.verbosePii("tenant_discovery_endpoint is: ".concat(i.tenant_discovery_endpoint));else{if(!function(e){return e.hasOwnProperty("error")&&e.hasOwnProperty("error_description")}(e.body))return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;if(this.logger.warning("A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ".concat(e.status)),i=e.body,i.error===Vu.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;this.logger.warning("The CloudInstanceDiscoveryErrorResponse error is ".concat(i.error)),this.logger.warning("The CloudInstanceDiscoveryErrorResponse error description is ".concat(i.error_description)),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),o=[]}this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),r=um(o,this.hostnameAndPort)}catch(i){if(i instanceof ad)this.logger.error("There was a network error while attempting to get the cloud discovery instance metadata.\nError: ".concat(i.errorCode,"\nError Description: ").concat(i.errorMessage));else{const e=i;this.logger.error("A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.\nError: ".concat(e.name,"\nError Description: ").concat(e.message))}return null}return r||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),r=EC.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),r}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter(e=>e&&om.getDomainFromUrl(e).toLowerCase()===this.hostnameAndPort).length>0}static generateAuthority(e,t){let n;if(t&&t.azureCloudInstance!==hg){const e=t.tenant?t.tenant:Vu.DEFAULT_COMMON_TENANT;n="".concat(t.azureCloudInstance,"/").concat(e,"/")}return n||e}static createCloudDiscoveryMetadataFromHost(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}getPreferredCache(){if(this.managedIdentity)return Vu.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw op(mg)}isAlias(e){return this.metadata.aliases.indexOf(e)>-1}isAliasOfKnownMicrosoftAuthority(e){return cm.has(e)}static isPublicCloudAuthority(e){return Vu.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}static buildRegionalAuthorityString(e,t,n){const r=new om(e);r.validateAsUri();const i=r.getUrlComponents();let o="".concat(t,".").concat(i.HostNameAndPort);this.isPublicCloudAuthority(i.HostNameAndPort)&&(o="".concat(t,".").concat(Vu.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX));const s=om.constructAuthorityUriFromObject(l(l({},r.getUrlComponents()),{},{HostNameAndPort:o})).urlString;return n?"".concat(s,"?").concat(n):s}static replaceWithRegionalInformation(e,t){const n=l({},e);return n.authorization_endpoint=EC.buildRegionalAuthorityString(n.authorization_endpoint,t),n.token_endpoint=EC.buildRegionalAuthorityString(n.token_endpoint,t),n.end_session_endpoint&&(n.end_session_endpoint=EC.buildRegionalAuthorityString(n.end_session_endpoint,t)),n}static transformCIAMAuthority(e){let t=e;const n=new om(e).getUrlComponents();if(0===n.PathSegments.length&&n.HostNameAndPort.endsWith(Vu.CIAM_AUTH_URL)){const e=n.HostNameAndPort.split(".")[0];t="".concat(t).concat(e).concat(Vu.AAD_TENANT_DOMAIN_SUFFIX)}return t}}function PC(e){return e.endsWith(Vu.FORWARD_SLASH)?e:"".concat(e).concat(Vu.FORWARD_SLASH)}EC.reservedTenantDomains=new Set(["{tenant}","{tenantid}",ah,lh,ch]);const RC="no_tokens_found",NC="native_account_unavailable",OC="refresh_token_expired",MC="ux_not_allowed",xC="bad_token",DC=["interaction_required","consent_required","login_required",xC,MC],LC=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],FC={[RC]:"No refresh token found in the cache. Please sign-in.",[NC]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",[OC]:"Refresh token has expired.",[xC]:"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve.",[MC]:"`canShowUI` flag in Edge was set to false. User interaction required on web page. Please invoke an interactive API to resolve."};class qC extends ad{constructor(e,t,n,r,i,o,s,a){super(e,t,n),Object.setPrototypeOf(this,qC.prototype),this.timestamp=r||Vu.EMPTY_STRING,this.traceId=i||Vu.EMPTY_STRING,this.correlationId=o||Vu.EMPTY_STRING,this.claims=s||Vu.EMPTY_STRING,this.name="InteractionRequiredAuthError",this.errorNo=a}}function UC(e,t,n){const r=!!e&&DC.indexOf(e)>-1,i=!!n&&LC.indexOf(n)>-1,o=!!t&&DC.some(e=>t.indexOf(e)>-1);return r||o||i}function zC(e){return new qC(e,FC[e])}function BC(e,t,n){var r;return{clientId:e,authority:t.authority,scopes:t.scopes,homeAccountIdentifier:n,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid,embeddedClientId:t.embeddedClientId||(null===(r=t.tokenBodyParameters)||void 0===r?void 0:r.clientId)}}const HC=864e5,VC="Lax",jC="None";class KC{initialize(){return Promise.resolve()}getItem(e){const t="".concat(encodeURIComponent(e)),n=document.cookie.split(";");for(let r=0;r<n.length;r++){const e=n[r],[i,...o]=decodeURIComponent(e).trim().split("="),s=o.join("=");if(i===t)return s}return""}getUserData(){throw op(ep)}setItem(e,t,n){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:VC,o="".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(t),";path=/;SameSite=").concat(i,";");if(n){const e=function(e){const t=new Date,n=new Date(t.getTime()+e*HC);return n.toUTCString()}(n);o+="expires=".concat(e,";")}(r||i===jC)&&(o+="Secure;"),document.cookie=o}async setUserData(){return Promise.reject(op(ep))}removeItem(e){this.setItem(e,"",-1)}getKeys(){const e=document.cookie.split(";"),t=[];return e.forEach(e=>{const n=decodeURIComponent(e).trim().split("=");t.push(n[0])}),t}containsKey(e){return this.getKeys().includes(e)}decryptData(){return Promise.resolve(null)}}function GC(e,t){const n=e.getItem(Yb(t));return n?JSON.parse(n):[]}function QC(e,t,n){const r=t.getItem(Jb(e,n));if(r){const e=JSON.parse(r);if(e&&e.hasOwnProperty("idToken")&&e.hasOwnProperty("accessToken")&&e.hasOwnProperty("refreshToken"))return e}return{idToken:[],accessToken:[],refreshToken:[]}}function WC(e){return e.hasOwnProperty("id")&&e.hasOwnProperty("nonce")&&e.hasOwnProperty("data")}const YC="msal.cache.encryption";class JC{constructor(e,t,n){if(!window.localStorage)throw gd(ld);this.memoryStorage=new sC,this.initialized=!1,this.clientId=e,this.logger=t,this.performanceClient=n,this.broadcast=new BroadcastChannel("msal.broadcast.cache")}async initialize(e){const t=new KC,n=t.getItem(YC);let r={key:"",id:""};if(n)try{r=JSON.parse(n)}catch(i){}if(r.key&&r.id){const t=uC(sb,Gy,this.logger,this.performanceClient,e)(r.key);this.encryptionCookie={id:r.id,key:await hC(Ib,jy,this.logger,this.performanceClient,e)(t)}}else{const n=bb(),r=await hC(Tb,Ky,this.logger,this.performanceClient,e)(),i=uC(nb,Qy,this.logger,this.performanceClient,e)(new Uint8Array(r));this.encryptionCookie={id:n,key:await hC(Ib,jy,this.logger,this.performanceClient,e)(r)};const o={id:n,key:i};t.setItem(YC,JSON.stringify(o),0,!0,jC)}await hC(this.importExistingCache.bind(this),Ly,this.logger,this.performanceClient,e)(e),this.broadcast.addEventListener("message",this.updateCache.bind(this)),this.initialized=!0}getItem(e){return window.localStorage.getItem(e)}getUserData(e){if(!this.initialized)throw hw(ew);return this.memoryStorage.getItem(e)}async decryptData(e,t,n){if(!this.initialized||!this.encryptionCookie)throw hw(ew);if(t.id!==this.encryptionCookie.id)return this.performanceClient.incrementFields({encryptedCacheExpiredCount:1},n),null;const r=await hC(Eb,Yy,this.logger,this.performanceClient,n)(this.encryptionCookie.key,t.nonce,this.getContext(e),t.data);if(!r)return null;try{return l(l({},JSON.parse(r)),{},{lastUpdatedAt:t.lastUpdatedAt})}catch(i){return this.performanceClient.incrementFields({encryptedCacheCorruptionCount:1},n),null}}setItem(e,t){window.localStorage.setItem(e,t)}async setUserData(e,t,n,r,i){if(!this.initialized||!this.encryptionCookie)throw hw(ew);if(i)this.setItem(e,t);else{const{data:i,nonce:o}=await hC(Ab,Wy,this.logger,this.performanceClient,n)(this.encryptionCookie.key,t,this.getContext(e)),s={id:this.encryptionCookie.id,nonce:o,data:i,lastUpdatedAt:r};this.setItem(e,JSON.stringify(s))}this.memoryStorage.setItem(e,t),this.broadcast.postMessage({key:e,value:t,context:this.getContext(e)})}removeItem(e){this.memoryStorage.containsKey(e)&&(this.memoryStorage.removeItem(e),this.broadcast.postMessage({key:e,value:null,context:this.getContext(e)})),window.localStorage.removeItem(e)}getKeys(){return Object.keys(window.localStorage)}containsKey(e){return window.localStorage.hasOwnProperty(e)}clear(){this.memoryStorage.clear();GC(this).forEach(e=>this.removeItem(e));const e=QC(this.clientId,this);e.idToken.forEach(e=>this.removeItem(e)),e.accessToken.forEach(e=>this.removeItem(e)),e.refreshToken.forEach(e=>this.removeItem(e)),this.getKeys().forEach(e=>{(e.startsWith(Bb)||-1!==e.indexOf(this.clientId))&&this.removeItem(e)})}async importExistingCache(e){if(!this.encryptionCookie)return;let t=GC(this);t=await this.importArray(t,e),t.length?this.setItem(Yb(),JSON.stringify(t)):this.removeItem(Yb());const n=QC(this.clientId,this);n.idToken=await this.importArray(n.idToken,e),n.accessToken=await this.importArray(n.accessToken,e),n.refreshToken=await this.importArray(n.refreshToken,e),n.idToken.length||n.accessToken.length||n.refreshToken.length?this.setItem(Jb(this.clientId),JSON.stringify(n)):this.removeItem(Jb(this.clientId))}async getItemFromEncryptedCache(e,t){if(!this.encryptionCookie)return null;const n=this.getItem(e);if(!n)return null;let r;try{r=JSON.parse(n)}catch(i){return null}return WC(r)?r.id!==this.encryptionCookie.id?(this.performanceClient.incrementFields({encryptedCacheExpiredCount:1},t),null):(this.performanceClient.incrementFields({encryptedCacheCount:1},t),hC(Eb,Yy,this.logger,this.performanceClient,t)(this.encryptionCookie.key,r.nonce,this.getContext(e),r.data)):(this.performanceClient.incrementFields({unencryptedCacheCount:1},t),n)}async importArray(e,t){const n=[],r=[];return e.forEach(e=>{const i=this.getItemFromEncryptedCache(e,t).then(t=>{t?(this.memoryStorage.setItem(e,t),n.push(e)):this.removeItem(e)});r.push(i)}),await Promise.all(r),n}getContext(e){let t="";return e.includes(this.clientId)&&(t=this.clientId),t}updateCache(e){this.logger.trace("Updating internal cache from broadcast event");const t=this.performanceClient.startMeasurement(qy);t.add({isBackground:!0});const{key:n,value:r,context:i}=e.data;return n?i&&i!==this.clientId?(this.logger.trace("Ignoring broadcast event from clientId: ".concat(i)),void t.end({success:!1,errorCode:"contextMismatch"})):(r?(this.memoryStorage.setItem(n,r),this.logger.verbose("Updated item in internal cache")):(this.memoryStorage.removeItem(n),this.logger.verbose("Removed item from internal cache")),void t.end({success:!0})):(this.logger.error("Broadcast event missing key"),void t.end({success:!1,errorCode:"noKey"}))}}class XC{constructor(){if(!window.sessionStorage)throw gd(ld)}async initialize(){}getItem(e){return window.sessionStorage.getItem(e)}getUserData(e){return this.getItem(e)}setItem(e,t){window.sessionStorage.setItem(e,t)}async setUserData(e,t){this.setItem(e,t)}removeItem(e){window.sessionStorage.removeItem(e)}getKeys(){return Object.keys(window.sessionStorage)}containsKey(e){return window.sessionStorage.hasOwnProperty(e)}decryptData(){return Promise.resolve(null)}}function $C(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}class ZC extends mm{constructor(e,t,n,r,i,o,s){super(e,n,r,i,s),this.cacheConfig=t,this.logger=r,this.internalStorage=new sC,this.browserStorage=ek(e,t.cacheLocation,r,i),this.temporaryCacheStorage=ek(e,t.temporaryCacheLocation,r,i),this.cookieStorage=new KC,this.eventHandler=o}async initialize(e){this.performanceClient.addFields({cacheLocation:this.cacheConfig.cacheLocation,cacheRetentionDays:this.cacheConfig.cacheRetentionDays},e),await this.browserStorage.initialize(e),await this.migrateExistingCache(e),this.trackVersionChanges(e)}async migrateExistingCache(e){let t=GC(this.browserStorage),n=QC(this.clientId,this.browserStorage);this.performanceClient.addFields({preMigrateAcntCount:t.length,preMigrateATCount:n.accessToken.length,preMigrateITCount:n.idToken.length,preMigrateRTCount:n.refreshToken.length},e);for(let i=0;i<2;i++){const t=i;await this.removeStaleAccounts(i,t,e)}for(let i=0;i<2;i++){const t=i;await this.migrateIdTokens(i,t,e)}const r=this.getKMSIValues();for(let i=0;i<2;i++)await this.migrateAccessTokens(i,r,e),await this.migrateRefreshTokens(i,r,e);t=GC(this.browserStorage),n=QC(this.clientId,this.browserStorage),this.performanceClient.addFields({postMigrateAcntCount:t.length,postMigrateATCount:n.accessToken.length,postMigrateITCount:n.idToken.length,postMigrateRTCount:n.refreshToken.length},e)}async updateOldEntry(e,t){const n=this.browserStorage.getItem(e),r=this.validateAndParseJson(n||"");if(!r)return this.browserStorage.removeItem(e),null;if(r.lastUpdatedAt){if(yC(r.lastUpdatedAt,this.cacheConfig.cacheRetentionDays))return this.browserStorage.removeItem(e),this.performanceClient.incrementFields({expiredCacheRemovedCount:1},t),null}else r.lastUpdatedAt=Date.now().toString(),this.setItem(e,JSON.stringify(r),t);const i=WC(r)?await this.browserStorage.decryptData(e,r,t):r;return i&&CC(i)?(kC(i)||SC(i))&&i.expiresOn&&mC(i.expiresOn,300)?(this.browserStorage.removeItem(e),this.performanceClient.incrementFields({expiredCacheRemovedCount:1},t),null):i:(this.performanceClient.incrementFields({invalidCacheCount:1},t),null)}async removeStaleAccounts(e,t,n){const r=GC(this.browserStorage,e);if(0!==r.length){for(const e of[...r]){this.performanceClient.incrementFields({oldAcntCount:1},n);const i=this.browserStorage.getItem(e),o=this.validateAndParseJson(i||"");o?o.lastUpdatedAt?yC(o.lastUpdatedAt,this.cacheConfig.cacheRetentionDays)&&(await this.removeAccountOldSchema(e,o,t,n),$C(r,e)):(o.lastUpdatedAt=Date.now().toString(),this.setItem(e,JSON.stringify(o),n)):$C(r,e)}this.setAccountKeys(r,n,e)}}async removeAccountOldSchema(e,t,n,r){const i=WC(t)?await this.browserStorage.decryptData(e,t,r):t,o=null===i||void 0===i?void 0:i.homeAccountId;if(o){const e=this.getTokenKeys(n);[...e.idToken].filter(e=>e.includes(o)).forEach(t=>{this.browserStorage.removeItem(t),$C(e.idToken,t)}),[...e.accessToken].filter(e=>e.includes(o)).forEach(t=>{this.browserStorage.removeItem(t),$C(e.accessToken,t)}),[...e.refreshToken].filter(e=>e.includes(o)).forEach(t=>{this.browserStorage.removeItem(t),$C(e.refreshToken,t)}),this.setTokenKeys(e,r,n)}this.performanceClient.incrementFields({expiredAcntRemovedCount:1},r),this.browserStorage.removeItem(e)}getKMSIValues(){const e={},t=this.getTokenKeys().idToken;for(const n of t){const t=this.browserStorage.getUserData(n);if(t){const n=JSON.parse(t),r=Xp(n.secret,ob);r&&(e[n.homeAccountId]=$p(r))}}return e}async migrateIdTokens(e,t,n){const r=QC(this.clientId,this.browserStorage,e);if(0===r.idToken.length)return;const i=QC(this.clientId,this.browserStorage,2),o=GC(this.browserStorage),s=GC(this.browserStorage,t);for(const a of[...r.idToken]){this.performanceClient.incrementFields({oldITCount:1},n);const e=await this.updateOldEntry(a,n);if(!e){$C(r.idToken,a);continue}const t=o.find(t=>t.includes(e.homeAccountId)),c=s.find(t=>t.includes(e.homeAccountId));let l=null;if(t)l=this.getAccount(t,n);else if(c){const e=this.browserStorage.getItem(c),t=this.validateAndParseJson(e||"");l=t&&WC(t)?await this.browserStorage.decryptData(c,t,n):t}if(!l){this.performanceClient.incrementFields({skipITMigrateCount:1},n);continue}const u=Xp(e.secret,ob),h=this.generateCredentialKey(e),d=this.getIdTokenCredential(h,n),f=Object.keys(u).includes("signin_state"),g=d&&Object.keys(Xp(d.secret,ob)||{}).includes("signin_state");if(!d||e.lastUpdatedAt>d.lastUpdatedAt&&(f||!g)){const t=l.tenantProfiles||[],r=Yp(u)||l.realm;if(r&&!t.find(e=>e.tenantId===r)){const e=Vp(l.homeAccountId,l.localAccountId,r,u);t.push(e)}l.tenantProfiles=t;const s=this.generateAccountKey(Jp.getAccountInfo(l)),a=$p(u);await this.setUserData(s,JSON.stringify(l),n,l.lastUpdatedAt,a),o.includes(s)||o.push(s),await this.setUserData(h,JSON.stringify(e),n,e.lastUpdatedAt,a),this.performanceClient.incrementFields({migratedITCount:1},n),i.idToken.push(h)}}this.setTokenKeys(r,n,e),this.setTokenKeys(i,n),this.setAccountKeys(o,n)}async migrateAccessTokens(e,t,n){const r=QC(this.clientId,this.browserStorage,e);if(0===r.accessToken.length)return;const i=QC(this.clientId,this.browserStorage,2);for(const o of[...r.accessToken]){this.performanceClient.incrementFields({oldATCount:1},n);const e=await this.updateOldEntry(o,n);if(!e){$C(r.accessToken,o);continue}if(!Object.keys(t).includes(e.homeAccountId)){this.performanceClient.incrementFields({skipATMigrateCount:1},n);continue}const s=this.generateCredentialKey(e),a=t[e.homeAccountId];if(i.accessToken.includes(s)){const t=this.getAccessTokenCredential(s,n);(!t||e.lastUpdatedAt>t.lastUpdatedAt)&&(await this.setUserData(s,JSON.stringify(e),n,e.lastUpdatedAt,a),this.performanceClient.incrementFields({migratedATCount:1},n))}else await this.setUserData(s,JSON.stringify(e),n,e.lastUpdatedAt,a),this.performanceClient.incrementFields({migratedATCount:1},n),i.accessToken.push(s)}this.setTokenKeys(r,n,e),this.setTokenKeys(i,n)}async migrateRefreshTokens(e,t,n){const r=QC(this.clientId,this.browserStorage,e);if(0===r.refreshToken.length)return;const i=QC(this.clientId,this.browserStorage,2);for(const o of[...r.refreshToken]){this.performanceClient.incrementFields({oldRTCount:1},n);const e=await this.updateOldEntry(o,n);if(!e){$C(r.refreshToken,o);continue}if(!Object.keys(t).includes(e.homeAccountId)){this.performanceClient.incrementFields({skipRTMigrateCount:1},n);continue}const s=this.generateCredentialKey(e),a=t[e.homeAccountId];if(i.refreshToken.includes(s)){const t=this.getRefreshTokenCredential(s,n);(!t||e.lastUpdatedAt>t.lastUpdatedAt)&&(await this.setUserData(s,JSON.stringify(e),n,e.lastUpdatedAt,a),this.performanceClient.incrementFields({migratedRTCount:1},n))}else await this.setUserData(s,JSON.stringify(e),n,e.lastUpdatedAt,a),this.performanceClient.incrementFields({migratedRTCount:1},n),i.refreshToken.push(s)}this.setTokenKeys(r,n,e),this.setTokenKeys(i,n)}trackVersionChanges(e){const t=this.browserStorage.getItem(Gb);t&&(this.logger.info("MSAL.js was last initialized by version: ".concat(t)),this.performanceClient.addFields({previousLibraryVersion:t},e)),t!==zb&&this.setItem(Gb,zb,e)}validateAndParseJson(e){if(!e)return null;try{const t=JSON.parse(e);return t&&"object"===typeof t?t:null}catch(t){return null}}setItem(e,t,n){const r=new Array(3).fill(0),i=[];for(let s=0;s<=20;s++)try{if(this.browserStorage.setItem(e,t),s>0)for(let e=0;e<=2;e++){const t=r.slice(0,e).reduce((e,t)=>e+t,0);if(t>=s)break;const o=s>t+r[e]?t+r[e]:s;s>t&&r[e]>0&&this.removeAccessTokenKeys(i.slice(t,o),n,e)}break}catch(o){const a=pm(o);if(!(a.errorCode===hm&&s<20))throw a;if(!i.length)for(let n=0;n<=2;n++)if(e===Jb(this.clientId,n)){const e=JSON.parse(t).accessToken;i.push(...e),r[n]=e.length}else{const e=this.getTokenKeys(n).accessToken;i.push(...e),r[n]=e.length}if(i.length<=s)throw a;this.removeAccessToken(i[s],n,!1)}}async setUserData(e,t,n,r,i){const o=new Array(3).fill(0),s=[];for(let c=0;c<=20;c++)try{if(await hC(this.browserStorage.setUserData.bind(this.browserStorage),Fy,this.logger,this.performanceClient)(e,t,n,r,i),c>0)for(let e=0;e<=2;e++){const t=o.slice(0,e).reduce((e,t)=>e+t,0);if(t>=c)break;const r=c>t+o[e]?t+o[e]:c;c>t&&o[e]>0&&this.removeAccessTokenKeys(s.slice(t,r),n,e)}break}catch(a){const e=pm(a);if(!(e.errorCode===hm&&c<20))throw e;if(!s.length)for(let t=0;t<=2;t++){const e=this.getTokenKeys(t).accessToken;s.push(...e),o[t]=e.length}if(s.length<=c)throw e;this.removeAccessToken(s[c],n,!1)}}getAccount(e,t){this.logger.trace("BrowserCacheManager.getAccount called");const n=this.browserStorage.getUserData(e);if(!n)return this.removeAccountKeyFromMap(e,t),null;const r=this.validateAndParseJson(n);return r&&Jp.isAccountEntity(r)?mm.toObject(new Jp,r):null}async setAccount(e,t,n){this.logger.trace("BrowserCacheManager.setAccount called");const r=this.generateAccountKey(Jp.getAccountInfo(e)),i=Date.now().toString();e.lastUpdatedAt=i,await this.setUserData(r,JSON.stringify(e),t,i,n);const o=this.addAccountKeyToMap(r,t);this.performanceClient.addFields({kmsi:n},t),this.cacheConfig.cacheLocation===xd&&o&&this.eventHandler.emitEvent(Pf,void 0,Jp.getAccountInfo(e))}getAccountKeys(){return GC(this.browserStorage)}setAccountKeys(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;0===e.length?this.removeItem(Yb(n)):this.setItem(Yb(n),JSON.stringify(e),t)}addAccountKeyToMap(e,t){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii("BrowserCacheManager.addAccountKeyToMap called with key: ".concat(e));const n=this.getAccountKeys();return-1===n.indexOf(e)?(n.push(e),this.setItem(Yb(),JSON.stringify(n),t),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added"),!0):(this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map"),!1)}removeAccountKeyFromMap(e,t){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii("BrowserCacheManager.removeAccountKeyFromMap called with key: ".concat(e));const n=this.getAccountKeys(),r=n.indexOf(e);r>-1?(n.splice(r,1),this.setAccountKeys(n,t),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")):this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")}removeAccount(e,t){const n=this.getActiveAccount(t);(null===n||void 0===n?void 0:n.homeAccountId)===e.homeAccountId&&(null===n||void 0===n?void 0:n.environment)===e.environment&&this.setActiveAccount(null,t),super.removeAccount(e,t),this.removeAccountKeyFromMap(this.generateAccountKey(e),t),this.browserStorage.getKeys().forEach(t=>{t.includes(e.homeAccountId)&&t.includes(e.environment)&&this.browserStorage.removeItem(t)}),this.cacheConfig.cacheLocation===xd&&this.eventHandler.emitEvent(Rf,void 0,e)}removeIdToken(e,t){super.removeIdToken(e,t);const n=this.getTokenKeys(),r=n.idToken.indexOf(e);r>-1&&(this.logger.info("idToken removed from tokenKeys map"),n.idToken.splice(r,1),this.setTokenKeys(n,t))}removeAccessToken(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super.removeAccessToken(e,t),n&&this.removeAccessTokenKeys([e],t)}removeAccessTokenKeys(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;this.logger.trace("removeAccessTokenKey called");const r=this.getTokenKeys(n);let i=0;if(e.forEach(e=>{const t=r.accessToken.indexOf(e);t>-1&&(r.accessToken.splice(t,1),i++)}),i>0)return this.logger.info("removed ".concat(i," accessToken keys from tokenKeys map")),void this.setTokenKeys(r,t,n)}removeRefreshToken(e,t){super.removeRefreshToken(e,t);const n=this.getTokenKeys(),r=n.refreshToken.indexOf(e);r>-1&&(this.logger.info("refreshToken removed from tokenKeys map"),n.refreshToken.splice(r,1),this.setTokenKeys(n,t))}getTokenKeys(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return QC(this.clientId,this.browserStorage,e)}setTokenKeys(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;0!==e.idToken.length||0!==e.accessToken.length||0!==e.refreshToken.length?this.setItem(Jb(this.clientId,n),JSON.stringify(e),t):this.removeItem(Jb(this.clientId,n))}getIdTokenCredential(e,t){const n=this.browserStorage.getUserData(e);if(!n)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeIdToken(e,t),null;const r=this.validateAndParseJson(n);return r&&(i=r)&&CC(i)&&i.hasOwnProperty("realm")&&i.credentialType===Ph.ID_TOKEN?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),r):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null);var i}async setIdTokenCredential(e,t,n){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");const r=this.generateCredentialKey(e),i=Date.now().toString();e.lastUpdatedAt=i,await this.setUserData(r,JSON.stringify(e),t,i,n);const o=this.getTokenKeys();-1===o.idToken.indexOf(r)&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),o.idToken.push(r),this.setTokenKeys(o,t))}getAccessTokenCredential(e,t){const n=this.browserStorage.getUserData(e);if(!n)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeAccessTokenKeys([e],t),null;const r=this.validateAndParseJson(n);return r&&kC(r)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),r):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null)}async setAccessTokenCredential(e,t,n){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");const r=this.generateCredentialKey(e),i=Date.now().toString();e.lastUpdatedAt=i,await this.setUserData(r,JSON.stringify(e),t,i,n);const o=this.getTokenKeys(),s=o.accessToken.indexOf(r);-1!==s&&o.accessToken.splice(s,1),this.logger.trace("access token ".concat(-1===s?"added to":"updated in"," map")),o.accessToken.push(r),this.setTokenKeys(o,t)}getRefreshTokenCredential(e,t){const n=this.browserStorage.getUserData(e);if(!n)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeRefreshToken(e,t),null;const r=this.validateAndParseJson(n);return r&&SC(r)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),r):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null)}async setRefreshTokenCredential(e,t,n){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");const r=this.generateCredentialKey(e),i=Date.now().toString();e.lastUpdatedAt=i,await this.setUserData(r,JSON.stringify(e),t,i,n);const o=this.getTokenKeys();-1===o.refreshToken.indexOf(r)&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),o.refreshToken.push(r),this.setTokenKeys(o,t))}getAppMetadata(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;const n=this.validateAndParseJson(t);return n&&(r=e,(i=n)&&0===r.indexOf(Rh)&&i.hasOwnProperty("clientId")&&i.hasOwnProperty("environment"))?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),n):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null);var r,i}setAppMetadata(e,t){this.logger.trace("BrowserCacheManager.setAppMetadata called");const n=function(e){let{environment:t,clientId:n}=e;return[Rh,t,n].join(Ah).toLowerCase()}(e);this.setItem(n,JSON.stringify(e),t)}getServerTelemetry(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;const n=this.validateAndParseJson(t);return n&&function(e,t){const n=0===e.indexOf(qh.CACHE_KEY);let r=!0;return t&&(r=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")),n&&r}(e,n)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),n):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)}setServerTelemetry(e,t,n){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(t),n)}getAuthorityMetadata(e){const t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;const n=this.validateAndParseJson(t);return n&&function(e,t){return!!t&&0===e.indexOf(Oh)&&t.hasOwnProperty("aliases")&&t.hasOwnProperty("preferred_cache")&&t.hasOwnProperty("preferred_network")&&t.hasOwnProperty("canonical_authority")&&t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("aliasesFromNetwork")&&t.hasOwnProperty("endpointsFromNetwork")&&t.hasOwnProperty("expiresAt")&&t.hasOwnProperty("jwks_uri")}(e,n)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),n):null}getAuthorityMetadataKeys(){return this.internalStorage.getKeys().filter(e=>this.isAuthorityMetadata(e))}setWrapperMetadata(e,t){this.internalStorage.setItem(Qd,e),this.internalStorage.setItem(Wd,t)}getWrapperMetadata(){return[this.internalStorage.getItem(Qd)||Vu.EMPTY_STRING,this.internalStorage.getItem(Wd)||Vu.EMPTY_STRING]}setAuthorityMetadata(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))}getActiveAccount(e){const t=this.generateCacheKey(sh),n=this.browserStorage.getItem(t);if(!n)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters found"),null;const r=this.validateAndParseJson(n);return r?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoFilteredBy({homeAccountId:r.homeAccountId,localAccountId:r.localAccountId,tenantId:r.tenantId},e)):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)}setActiveAccount(e,t){const n=this.generateCacheKey(sh);if(e){this.logger.verbose("setActiveAccount: Active account set");const r={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId,tenantId:e.tenantId,lastUpdatedAt:fC().toString()};this.setItem(n,JSON.stringify(r),t)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(n);this.eventHandler.emitEvent(Nf)}getThrottlingCache(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;const n=this.validateAndParseJson(t);return n&&function(e,t){let n=!1;e&&(n=0===e.indexOf(Hh));let r=!0;return t&&(r=t.hasOwnProperty("throttleTime")),n&&r}(e,n)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),n):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)}setThrottlingCache(e,t,n){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(t),n)}getTemporaryCache(e,t){const n=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){const e=this.cookieStorage.getItem(n);if(e)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),e}const r=this.temporaryCacheStorage.getItem(n);if(!r){if(this.cacheConfig.cacheLocation===xd){const e=this.browserStorage.getItem(n);if(e)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),e}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),r}setTemporaryCache(e,t,n){const r=n?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(r,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.cookieStorage.setItem(r,t,void 0,this.cacheConfig.secureCookies))}removeItem(e){this.browserStorage.removeItem(e)}removeTemporaryItem(e){this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.cookieStorage.removeItem(e))}getKeys(){return this.browserStorage.getKeys()}clear(e){this.removeAllAccounts(e),this.removeAppMetadata(e),this.temporaryCacheStorage.getKeys().forEach(e=>{-1===e.indexOf(Bb)&&-1===e.indexOf(this.clientId)||this.removeTemporaryItem(e)}),this.browserStorage.getKeys().forEach(e=>{-1===e.indexOf(Bb)&&-1===e.indexOf(this.clientId)||this.browserStorage.removeItem(e)}),this.internalStorage.clear()}clearTokensAndKeysWithClaims(e){this.performanceClient.addQueueMeasurement(xy,e);const t=this.getTokenKeys();let n=0;t.accessToken.forEach(t=>{const r=this.getAccessTokenCredential(t,e);null!==r&&void 0!==r&&r.requestedClaimsHash&&t.includes(r.requestedClaimsHash.toLowerCase())&&(this.removeAccessToken(t,e),n++)}),n>0&&this.logger.warning("".concat(n," access tokens with claims in the cache keys have been removed from the cache."))}generateCacheKey(e){return Dp.startsWith(e,Bb)?e:"".concat(Bb,".").concat(this.clientId,".").concat(e)}generateCredentialKey(e){const t=e.credentialType===Ph.REFRESH_TOKEN&&e.familyId||e.clientId,n=e.tokenType&&e.tokenType.toLowerCase()!==Uh.BEARER.toLowerCase()?e.tokenType.toLowerCase():"";return["".concat(Bb,".").concat(2),e.homeAccountId,e.environment,e.credentialType,t,e.realm||"",e.target||"",e.requestedClaimsHash||"",n].join("|").toLowerCase()}generateAccountKey(e){const t=e.homeAccountId.split(".")[1];return["".concat(Bb,".").concat(2),e.homeAccountId,e.environment,t||e.tenantId||""].join("|").toLowerCase()}resetRequestCache(){this.logger.trace("BrowserCacheManager.resetRequestCache called"),this.removeTemporaryItem(this.generateCacheKey(Vd)),this.removeTemporaryItem(this.generateCacheKey(jd)),this.removeTemporaryItem(this.generateCacheKey(Bd)),this.removeTemporaryItem(this.generateCacheKey(Hd)),this.removeTemporaryItem(this.generateCacheKey(Gd)),this.setInteractionInProgress(!1)}cacheAuthorizeRequest(e,t){this.logger.trace("BrowserCacheManager.cacheAuthorizeRequest called");const n=rb(JSON.stringify(e));if(this.setTemporaryCache(Vd,n,!0),t){const e=rb(t);this.setTemporaryCache(jd,e,!0)}}getCachedRequest(){this.logger.trace("BrowserCacheManager.getCachedRequest called");const e=this.getTemporaryCache(Vd,!0);if(!e)throw hw(xv);const t=this.getTemporaryCache(jd,!0);let n,r="";try{n=JSON.parse(ob(e)),t&&(r=ob(t))}catch(i){throw this.logger.errorPii("Attempted to parse: ".concat(e)),this.logger.error("Parsing cached token request threw with error: ".concat(i)),hw(Dv)}return[n,r]}getCachedNativeRequest(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");const e=this.getTemporaryCache(Gd,!0);if(!e)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;const t=this.validateAndParseJson(e);return t||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)}isInteractionInProgress(e){var t;const n=null===(t=this.getInteractionInProgress())||void 0===t?void 0:t.clientId;return e?n===this.clientId:!!n}getInteractionInProgress(){const e="".concat(Bb,".").concat(Kd),t=this.getTemporaryCache(e,!1);try{return t?JSON.parse(t):null}catch(n){return this.logger.error("Cannot parse interaction status. Removing temporary cache items and clearing url hash. Retrying interaction should fix the error"),this.removeTemporaryItem(e),this.resetRequestCache(),Rb(window),null}}setInteractionInProgress(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ud;const r="".concat(Bb,".").concat(Kd);if(e){if(this.getInteractionInProgress())throw hw(Cv);this.setTemporaryCache(r,JSON.stringify({clientId:this.clientId,type:n}),!1)}else e||(null===(t=this.getInteractionInProgress())||void 0===t?void 0:t.clientId)!==this.clientId||this.removeTemporaryItem(r)}async hydrateCache(e,t){var n,r,i;const o=vC(null===(n=e.account)||void 0===n?void 0:n.homeAccountId,null===(r=e.account)||void 0===r?void 0:r.environment,e.idToken,this.clientId,e.tenantId);let s;t.claims&&(s=await this.cryptoImpl.hashString(t.claims));const a={idToken:o,accessToken:wC(null===(i=e.account)||void 0===i?void 0:i.homeAccountId,e.account.environment,e.accessToken,this.clientId,e.tenantId,e.scopes.join(" "),e.expiresOn?gC(e.expiresOn):0,e.extExpiresOn?gC(e.extExpiresOn):0,ob,void 0,e.tokenType,void 0,t.sshKid,t.claims,s)};return this.saveCacheRecord(a,e.correlationId,$p(Xp(e.idToken,ob)))}async saveCacheRecord(e,t,n,r){try{await super.saveCacheRecord(e,t,n,r)}catch(i){if(i instanceof gm&&this.performanceClient&&t)try{const e=this.getTokenKeys();this.performanceClient.addFields({cacheRtCount:e.refreshToken.length,cacheIdCount:e.idToken.length,cacheAtCount:e.accessToken.length},t)}catch(i){}throw i}}}function ek(e,t,n,r){try{switch(t){case xd:return new JC(e,n,r);case Dd:return new XC}}catch(i){n.error(i)}return new sC}class tk{constructor(e){this.eventCallbacks=new Map,this.logger=e||new Tf({}),"undefined"!==typeof BroadcastChannel&&(this.broadcastChannel=new BroadcastChannel("msal.broadcast.event")),this.invokeCrossTabCallbacks=this.invokeCrossTabCallbacks.bind(this)}addEventCallback(e,t,n){if("undefined"!==typeof window){const r=n||bb();return this.eventCallbacks.has(r)?(this.logger.error("Event callback with id: ".concat(r," is already registered. Please provide a unique id or remove the existing callback and try again.")),null):(this.eventCallbacks.set(r,[e,t||[]]),this.logger.verbose("Event callback registered with id: ".concat(r)),r)}return null}removeEventCallback(e){this.eventCallbacks.delete(e),this.logger.verbose("Event callback ".concat(e," removed."))}emitEvent(e,t,n,r){var i;const o={eventType:e,interactionType:t||null,payload:n||null,error:r||null,timestamp:Date.now()};switch(e){case Pf:case Rf:case Nf:null===(i=this.broadcastChannel)||void 0===i||i.postMessage(o);break;default:this.invokeCallbacks(o)}}invokeCallbacks(e){this.eventCallbacks.forEach((t,n)=>{let[r,i]=t;(0===i.length||i.includes(e.eventType))&&(this.logger.verbose("Emitting event to callback ".concat(n,": ").concat(e.eventType)),r.apply(null,[e]))})}invokeCrossTabCallbacks(e){const t=e.data;this.invokeCallbacks(t)}subscribeCrossTab(){var e;null===(e=this.broadcastChannel)||void 0===e||e.addEventListener("message",this.invokeCrossTabCallbacks)}unsubscribeCrossTab(){var e;null===(e=this.broadcastChannel)||void 0===e||e.removeEventListener("message",this.invokeCrossTabCallbacks)}}const nk="home_account_id",rk="UPN";async function ik(e,t,n,r,i,o,s){null===s||void 0===s||s.addQueueMeasurement(wy,o);const a=EC.transformCIAMAuthority(PC(e)),c=new EC(a,t,n,r,i,o,s);try{return await hC(c.resolveEndpointsAsync.bind(c),by,i,s,o)(),c}catch(l){throw op(mg)}}class ok extends ad{constructor(e,t,n,r,i){super(e,t,n),this.name="ServerError",this.errorNo=r,this.status=i,Object.setPrototypeOf(this,ok.prototype)}}class sk{static generateThrottlingStorageKey(e){return"".concat(Hh,".").concat(JSON.stringify(e))}static preProcess(e,t,n){const r=sk.generateThrottlingStorageKey(t),i=e.getThrottlingCache(r);if(i){var o;if(i.throttleTime<Date.now())return void e.removeItem(r,n);throw new ok((null===(o=i.errorCodes)||void 0===o?void 0:o.join(" "))||Vu.EMPTY_STRING,i.errorMessage,i.subError)}}static postProcess(e,t,n,r){if(sk.checkResponseStatus(n)||sk.checkResponseForRetryAfter(n)){const i={throttleTime:sk.calculateThrottleTime(parseInt(n.headers[nh])),error:n.body.error,errorCodes:n.body.error_codes,errorMessage:n.body.error_description,subError:n.body.suberror};e.setThrottlingCache(sk.generateThrottlingStorageKey(t),i,r)}}static checkResponseStatus(e){return 429===e.status||e.status>=500&&e.status<600}static checkResponseForRetryAfter(e){return!!e.headers&&(e.headers.hasOwnProperty(nh)&&(e.status<200||e.status>=300))}static calculateThrottleTime(e){const t=e<=0?0:e,n=Date.now()/1e3;return Math.floor(1e3*Math.min(n+(t||zh),n+Bh))}static removeThrottle(e,t,n,r){const i=BC(t,n,r),o=this.generateThrottlingStorageKey(i);e.removeItem(o,n.correlationId)}}class ak{constructor(e,t){this.config=function(e){let{authOptions:t,systemOptions:n,loggerOptions:r,cacheOptions:i,storageInterface:o,networkInterface:s,cryptoInterface:a,clientCredentials:c,libraryInfo:u,telemetry:h,serverTelemetryManager:d,persistencePlugin:f,serializableCache:g}=e;const p=l(l({},nv),r);return{authOptions:(m=t,l({clientCapabilities:[],azureCloudOptions:av,skipAuthorityMetadataCache:!1,instanceAware:!1,encodeExtraQueryParams:!1},m)),systemOptions:l(l({},tv),n),loggerOptions:p,cacheOptions:l(l({},rv),i),storageInterface:o||new ym(t.clientId,sp,new Tf(p),new ev),networkInterface:s||iv,cryptoInterface:a||sp,clientCredentials:c||sv,libraryInfo:l(l({},ov),u),telemetry:l(l({},cv),h),serverTelemetryManager:d||null,persistencePlugin:f||null,serializableCache:g||null};var m}(e),this.logger=new Tf(this.config.loggerOptions,ap,cp),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}createTokenRequestHeaders(e){const t={};if(t[eh]=Vu.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case nk:try{const n=qp(e.credential);t[rh]="Oid:".concat(n.uid,"@").concat(n.utid)}catch(n){this.logger.verbose("Could not parse home account ID for CCS Header: "+n)}break;case rk:t[rh]="UPN: ".concat(e.credential)}return t}async executePostToTokenEndpoint(e,t,n,r,i,o){var s;o&&(null===(s=this.performanceClient)||void 0===s||s.addQueueMeasurement(o,i));const a=await this.sendPostRequest(r,e,{body:t,headers:n},i);return this.config.serverTelemetryManager&&a.status<500&&429!==a.status&&this.config.serverTelemetryManager.clearTelemetryCache(),a}async sendPostRequest(e,t,n,r){let i;sk.preProcess(this.cacheManager,e,r);try{var o,s;i=await hC(this.networkClient.sendPostRequestAsync.bind(this.networkClient),xm,this.logger,this.performanceClient,r)(t,n);const e=i.headers||{};null===(o=this.performanceClient)||void 0===o||o.addFields({refreshTokenSize:(null===(s=i.body.refresh_token)||void 0===s?void 0:s.length)||0,httpVerToken:e[oh]||"",requestId:e[ih]||""},r)}catch(c){if(c instanceof fw){const e=c.responseHeaders;var a;if(e)null===(a=this.performanceClient)||void 0===a||a.addFields({httpVerToken:e[oh]||"",requestId:e[ih]||"",contentTypeHeader:e[eh]||void 0,contentLengthHeader:e[th]||void 0,httpStatus:c.httpStatus},r);throw c.error}throw c instanceof ad?c:op(yg)}return sk.postProcess(this.cacheManager,e,i,r),i}async updateAuthority(e,t){var n;null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(hy,t);const r="https://".concat(e,"/").concat(this.authority.tenant,"/"),i=await ik(r,this.networkClient,this.cacheManager,this.authority.options,this.logger,t,this.performanceClient);this.authority=i}createTokenQueryParameters(e){const t=new Map;return e.embeddedClientId&&eb(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenQueryParameters&&Ww(t,e.tokenQueryParameters),Fw(t,e.correlationId),Aw(t,e.correlationId,this.performanceClient),rm(t)}}class ck{static setRequestState(e,t,n){const r=ck.generateLibraryState(e,n);return t?"".concat(r).concat(Vu.RESOURCE_DELIM).concat(t):r}static generateLibraryState(e,t){if(!e)throw op(zg);const n={id:e.createNewGuid()};t&&(n.meta=t);const r=JSON.stringify(n);return e.base64Encode(r)}static parseRequestState(e,t){if(!e)throw op(zg);if(!t)throw op(bg);try{const n=t.split(Vu.RESOURCE_DELIM),r=n[0],i=n.length>1?n.slice(1).join(Vu.RESOURCE_DELIM):Vu.EMPTY_STRING,o=e.base64Decode(r),s=JSON.parse(o);return{userRequestState:i||Vu.EMPTY_STRING,libraryState:s}}catch(n){throw op(bg)}}}const lk="sw";class uk{constructor(e,t){this.cryptoUtils=e,this.performanceClient=t}async generateCnf(e,t){var n;null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(py,e.correlationId);const r=await hC(this.generateKid.bind(this),py,t,this.performanceClient,e.correlationId)(e),i=this.cryptoUtils.base64UrlEncode(JSON.stringify(r));return{kid:r.kid,reqCnfString:i}}async generateKid(e){var t;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(my,e.correlationId);return{kid:await this.cryptoUtils.getPublicKeyThumbprint(e),xms_ksl:lk}}async signPopToken(e,t,n){return this.signPayload(e,t,n)}async signPayload(e,t,n,r){const{resourceRequestMethod:i,resourceRequestUri:o,shrClaims:s,shrNonce:a,shrOptions:c}=n,u=o?new om(o):void 0,h=null===u||void 0===u?void 0:u.getUrlComponents();return this.cryptoUtils.signJwt(l({at:e,ts:fC(),m:null===i||void 0===i?void 0:i.toUpperCase(),u:null===h||void 0===h?void 0:h.HostNameAndPort,nonce:a||this.cryptoUtils.createNewGuid(),p:null===h||void 0===h?void 0:h.AbsolutePath,q:null!==h&&void 0!==h&&h.QueryString?[[],h.QueryString]:void 0,client_claims:s||void 0},r),t,c,n.correlationId)}}class hk{constructor(e,t){this.cache=e,this.hasChanged=t}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}}class dk{constructor(e,t,n,r,i,o,s){this.clientId=e,this.cacheStorage=t,this.cryptoObj=n,this.logger=r,this.serializableCache=i,this.persistencePlugin=o,this.performanceClient=s}validateTokenResponse(e,t){if(e.error||e.error_description||e.suberror){var n;const r="Error(s): ".concat(e.error_codes||Vu.NOT_AVAILABLE," - Timestamp: ").concat(e.timestamp||Vu.NOT_AVAILABLE," - Description: ").concat(e.error_description||Vu.NOT_AVAILABLE," - Correlation ID: ").concat(e.correlation_id||Vu.NOT_AVAILABLE," - Trace ID: ").concat(e.trace_id||Vu.NOT_AVAILABLE),i=null!==(n=e.error_codes)&&void 0!==n&&n.length?e.error_codes[0]:void 0,o=new ok(e.error,r,e.suberror,i,e.status);if(t&&e.status&&e.status>=Wu&&e.status<=Yu)return void this.logger.warning("executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.\n".concat(o));if(t&&e.status&&e.status>=Ku&&e.status<=Qu)return void this.logger.warning("executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.\n".concat(o));if(UC(e.error,e.error_description,e.suberror))throw new qC(e.error,e.error_description,e.suberror,e.timestamp||Vu.EMPTY_STRING,e.trace_id||Vu.EMPTY_STRING,e.correlation_id||Vu.EMPTY_STRING,e.claims||Vu.EMPTY_STRING,i);throw o}}async handleServerTokenResponse(e,t,n,r,i,o,s,a,c){var l;let u,h;if(null===(l=this.performanceClient)||void 0===l||l.addQueueMeasurement(yy,e.correlation_id),e.id_token){if(u=Xp(e.id_token||Vu.EMPTY_STRING,this.cryptoObj.base64Decode),i&&i.nonce&&u.nonce!==i.nonce)throw op(Sg);if(r.maxAge||0===r.maxAge){const e=u.auth_time;if(!e)throw op(Tg);Zp(e,r.maxAge)}}this.homeAccountIdentifier=Jp.generateHomeAccountId(e.client_info||Vu.EMPTY_STRING,t.authorityType,this.logger,this.cryptoObj,u),i&&i.state&&(h=ck.parseRequestState(this.cryptoObj,i.state)),e.key_id=e.key_id||r.sshKid||void 0;const d=this.generateCacheRecord(e,t,n,r,u,o,i);let f;try{if(this.persistencePlugin&&this.serializableCache&&(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),f=new hk(this.serializableCache,!0),await this.persistencePlugin.beforeCacheAccess(f)),s&&!a&&d.account){const e=this.cacheStorage.generateAccountKey(Jp.getAccountInfo(d.account));if(!this.cacheStorage.getAccount(e,r.correlationId))return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),await dk.generateAuthenticationResult(this.cryptoObj,t,d,!1,r,u,h,void 0,c)}await this.cacheStorage.saveCacheRecord(d,r.correlationId,$p(u||{}),r.storeInCache)}finally{this.persistencePlugin&&this.serializableCache&&f&&(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),await this.persistencePlugin.afterCacheAccess(f))}return dk.generateAuthenticationResult(this.cryptoObj,t,d,!1,r,u,h,e,c)}generateCacheRecord(e,t,n,r,i,o,s){const a=t.getPreferredCache();if(!a)throw op(qg);const c=Yp(i);let l,u;e.id_token&&i&&(l=vC(this.homeAccountIdentifier,a,e.id_token,this.clientId,c||""),u=fk(this.cacheStorage,t,this.homeAccountIdentifier,this.cryptoObj.base64Decode,r.correlationId,i,e.client_info,a,c,s,void 0,this.logger));let h=null;if(e.access_token){const i=e.scope?Lp.fromString(e.scope):new Lp(r.scopes||[]),s=("string"===typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0,l=("string"===typeof e.ext_expires_in?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,u=("string"===typeof e.refresh_in?parseInt(e.refresh_in,10):e.refresh_in)||void 0,d=n+s,f=d+l,g=u&&u>0?n+u:void 0;h=wC(this.homeAccountIdentifier,a,e.access_token,this.clientId,c||t.tenant||"",i.printScopes(),d,f,this.cryptoObj.base64Decode,g,e.token_type,o,e.key_id,r.claims,r.requestedClaimsHash)}let d=null;if(e.refresh_token){let t;if(e.refresh_token_expires_in){t=n+("string"===typeof e.refresh_token_expires_in?parseInt(e.refresh_token_expires_in,10):e.refresh_token_expires_in)}d=bC(this.homeAccountIdentifier,a,e.refresh_token,this.clientId,e.foci,o,t)}let f=null;return e.foci&&(f={clientId:this.clientId,environment:a,familyId:e.foci}),{account:u,idToken:l,accessToken:h,refreshToken:d,appMetadata:f}}static async generateAuthenticationResult(e,t,n,r,i,o,s,a,c){var l,u,h,d,f;let g,p,m=Vu.EMPTY_STRING,y=[],v=null,w=Vu.EMPTY_STRING;if(n.accessToken){if(n.accessToken.tokenType!==Uh.POP||i.popKid)m=n.accessToken.secret;else{const t=new uk(e),{secret:r,keyId:o}=n.accessToken;if(!o)throw op(Jg);m=await t.signPopToken(r,o,i)}y=Lp.fromString(n.accessToken.target).asArray(),v=pC(n.accessToken.expiresOn),g=pC(n.accessToken.extendedExpiresOn),n.accessToken.refreshOn&&(p=pC(n.accessToken.refreshOn))}n.appMetadata&&(w=n.appMetadata.familyId===Nh?Nh:"");const b=(null===o||void 0===o?void 0:o.oid)||(null===o||void 0===o?void 0:o.sub)||"",C=(null===o||void 0===o?void 0:o.tid)||"";null!==a&&void 0!==a&&a.spa_accountid&&n.account&&(n.account.nativeAccountId=null===a||void 0===a?void 0:a.spa_accountid);const k=n.account?jp(Jp.getAccountInfo(n.account),void 0,o,null===(l=n.idToken)||void 0===l?void 0:l.secret):null;return{authority:t.canonicalAuthority,uniqueId:b,tenantId:C,scopes:y,account:k,idToken:(null===n||void 0===n||null===(u=n.idToken)||void 0===u?void 0:u.secret)||"",idTokenClaims:o||{},accessToken:m,fromCache:r,expiresOn:v,extExpiresOn:g,refreshOn:p,correlationId:i.correlationId,requestId:c||Vu.EMPTY_STRING,familyId:w,tokenType:(null===(h=n.accessToken)||void 0===h?void 0:h.tokenType)||Vu.EMPTY_STRING,state:s?s.userRequestState:Vu.EMPTY_STRING,cloudGraphHostName:(null===(d=n.account)||void 0===d?void 0:d.cloudGraphHostName)||Vu.EMPTY_STRING,msGraphHost:(null===(f=n.account)||void 0===f?void 0:f.msGraphHost)||Vu.EMPTY_STRING,code:null===a||void 0===a?void 0:a.spa_code,fromNativeBroker:!1}}}function fk(e,t,n,r,i,o,s,a,c,l,u,h){null===h||void 0===h||h.verbose("setCachedAccount called");const d=e.getAccountKeys().find(e=>e.startsWith(n));let f=null;d&&(f=e.getAccount(d,i));const g=f||Jp.createAccount({homeAccountId:n,idTokenClaims:o,clientInfo:s,environment:a,cloudGraphHostName:null===l||void 0===l?void 0:l.cloud_graph_host_name,msGraphHost:null===l||void 0===l?void 0:l.msgraph_host,nativeAccountId:u},t,r),p=g.tenantProfiles||[],m=c||g.realm;if(m&&!p.find(e=>e.tenantId===m)){const e=Vp(n,g.localAccountId,m,o);p.push(e)}return g.tenantProfiles=p,g}async function gk(e,t,n){if("string"===typeof e)return e;return e({clientId:t,tokenEndpoint:n})}class pk extends ak{constructor(e,t){var n;super(e,t),this.includeRedirectUri=!0,this.oidcDefaultScopes=null===(n=this.config.authOptions.authority.options.OIDCOptions)||void 0===n?void 0:n.defaultScopes}async acquireToken(e,t){var n,r;if(null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(dy,e.correlationId),!e.code)throw op(Pg);const i=fC(),o=await hC(this.executeTokenRequest.bind(this),fy,this.logger,this.performanceClient,e.correlationId)(this.authority,e),s=null===(r=o.headers)||void 0===r?void 0:r[ih],a=new dk(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient);return a.validateTokenResponse(o.body),hC(a.handleServerTokenResponse.bind(a),yy,this.logger,this.performanceClient,e.correlationId)(o.body,this.authority,i,e,t,void 0,void 0,void 0,s)}getLogoutUri(e){if(!e)throw xp(yp);const t=this.createLogoutUrlQueryString(e);return om.appendQueryString(this.authority.endSessionEndpoint,t)}async executeTokenRequest(e,t){var n;null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(fy,t.correlationId);const r=this.createTokenQueryParameters(t),i=om.appendQueryString(e.tokenEndpoint,r),o=await hC(this.createTokenRequestBody.bind(this),gy,this.logger,this.performanceClient,t.correlationId)(t);let s;if(t.clientInfo)try{const e=Fp(t.clientInfo,this.cryptoUtils.base64Decode);s={credential:"".concat(e.uid).concat(Eh).concat(e.utid),type:nk}}catch(l){this.logger.verbose("Could not parse client info for CCS Header: "+l)}const a=this.createTokenRequestHeaders(s||t.ccsCredential),c=BC(this.config.authOptions.clientId,t);return hC(this.executePostToTokenEndpoint.bind(this),Lm,this.logger,this.performanceClient,t.correlationId)(i,o,a,c,t.correlationId,Lm)}async createTokenRequestBody(e){var t,n;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(gy,e.correlationId);const r=new Map;if(Rw(r,e.embeddedClientId||(null===(n=e.tokenBodyParameters)||void 0===n?void 0:n[vw])||this.config.authOptions.clientId),this.includeRedirectUri)Nw(r,e.redirectUri);else if(!e.redirectUri)throw xp(lp);if(Pw(r,e.scopes,!0,this.oidcDefaultScopes),function(e,t){e.set("code",t)}(r,e.code),qw(r,this.config.libraryInfo),Uw(r,this.config.telemetry.application),Zw(r),this.serverTelemetryManager&&!lv(this.config)&&$w(r,this.serverTelemetryManager),e.codeVerifier&&function(e,t){e.set("code_verifier",t)}(r,e.codeVerifier),this.config.clientCredentials.clientSecret&&Hw(r,this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const t=this.config.clientCredentials.clientAssertion;Vw(r,await gk(t.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),jw(r,t.assertionType)}if(Kw(r,kh),Gw(r),e.authenticationScheme===Uh.POP){const t=new uk(this.cryptoUtils,this.performanceClient);let n;if(e.popKid)n=this.cryptoUtils.encodeKid(e.popKid);else{n=(await hC(t.generateCnf.bind(t),py,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString}Jw(r,n)}else if(e.authenticationScheme===Uh.SSH){if(!e.sshJwk)throw xp(Sp);Xw(r,e.sshJwk)}let i;if((!Dp.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&Lw(r,e.claims,this.config.authOptions.clientCapabilities),e.clientInfo)try{const t=Fp(e.clientInfo,this.cryptoUtils.base64Decode);i={credential:"".concat(t.uid).concat(Eh).concat(t.utid),type:nk}}catch(o){this.logger.verbose("Could not parse client info for CCS Header: "+o)}else i=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&i)switch(i.type){case nk:try{xw(r,qp(i.credential))}catch(o){this.logger.verbose("Could not parse home account ID for CCS Header: "+o)}break;case rk:Mw(r,i.credential)}return e.embeddedClientId&&eb(r,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenBodyParameters&&Ww(r,e.tokenBodyParameters),!e.enableSpaAuthorizationCode||e.tokenBodyParameters&&e.tokenBodyParameters[kw]||Ww(r,{[kw]:"1"}),Aw(r,e.correlationId,this.performanceClient),rm(r)}createLogoutUrlQueryString(e){const t=new Map;return e.postLogoutRedirectUri&&function(e,t){e.set("post_logout_redirect_uri",t)}(t,e.postLogoutRedirectUri),e.correlationId&&Fw(t,e.correlationId),e.idTokenHint&&function(e,t){e.set("id_token_hint",t)}(t,e.idTokenHint),e.state&&zw(t,e.state),e.logoutHint&&function(e,t){e.set("logout_hint",t)}(t,e.logoutHint),e.extraQueryParameters&&Ww(t,e.extraQueryParameters),this.config.authOptions.instanceAware&&Qw(t),rm(t,this.config.authOptions.encodeExtraQueryParams,e.extraQueryParameters)}}function mk(e){const{skus:t,libraryName:n,libraryVersion:r,extensionName:i,extensionVersion:o}=e,s=new Map([[0,[n,r]],[2,[i,o]]]);let a=[];if(null!==t&&void 0!==t&&t.length){if(a=t.split(","),a.length<4)return t}else a=Array.from({length:4},()=>"|");return s.forEach((e,t)=>{var n,r;2===e.length&&null!==(n=e[0])&&void 0!==n&&n.length&&null!==(r=e[1])&&void 0!==r&&r.length&&function(e){const{skuArr:t,index:n,skuName:r,skuVersion:i}=e;if(n>=t.length)return;t[n]=[r,i].join("|")}({skuArr:a,index:t,skuName:e[0],skuVersion:e[1]})}),a.join(",")}class yk{constructor(e,t){this.cacheOutcome=$h,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||Vu.EMPTY_STRING,this.wrapperVer=e.wrapperVer||Vu.EMPTY_STRING,this.telemetryCacheKey=qh.CACHE_KEY+Ah+e.clientId}generateCurrentRequestHeaderValue(){const e="".concat(this.apiId).concat(qh.VALUE_SEPARATOR).concat(this.cacheOutcome),t=[this.wrapperSKU,this.wrapperVer],n=this.getNativeBrokerErrorCode();null!==n&&void 0!==n&&n.length&&t.push("broker_error=".concat(n));const r=t.join(qh.VALUE_SEPARATOR),i=[e,this.getRegionDiscoveryFields()].join(qh.VALUE_SEPARATOR);return[qh.SCHEMA_VERSION,i,r].join(qh.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){const e=this.getLastRequests(),t=yk.maxErrorsToSend(e),n=e.failedRequests.slice(0,2*t).join(qh.VALUE_SEPARATOR),r=e.errors.slice(0,t).join(qh.VALUE_SEPARATOR),i=e.errors.length,o=[i,t<i?qh.OVERFLOW_TRUE:qh.OVERFLOW_FALSE].join(qh.VALUE_SEPARATOR);return[qh.SCHEMA_VERSION,e.cacheHits,n,r,o].join(qh.CATEGORY_SEPARATOR)}cacheFailedRequest(e){const t=this.getLastRequests();t.errors.length>=qh.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?e instanceof ad?e.subError?t.errors.push(e.subError):e.errorCode?t.errors.push(e.errorCode):t.errors.push(e.toString()):t.errors.push(e.toString()):t.errors.push(qh.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t,this.correlationId)}incrementCacheHits(){const e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e,this.correlationId),e.cacheHits}getLastRequests(){return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||{failedRequests:[],errors:[],cacheHits:0}}clearTelemetryCache(){const e=this.getLastRequests(),t=yk.maxErrorsToSend(e);if(t===e.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey,this.correlationId);else{const n={failedRequests:e.failedRequests.slice(2*t),errors:e.errors.slice(t),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,n,this.correlationId)}}static maxErrorsToSend(e){let t,n=0,r=0;const i=e.errors.length;for(t=0;t<i;t++){const i=e.failedRequests[2*t]||Vu.EMPTY_STRING,o=e.failedRequests[2*t+1]||Vu.EMPTY_STRING,s=e.errors[t]||Vu.EMPTY_STRING;if(r+=i.toString().length+o.toString().length+s.length+3,!(r<qh.MAX_LAST_HEADER_BYTES))break;n+=1}return n}getRegionDiscoveryFields(){const e=[];return e.push(this.regionUsed||Vu.EMPTY_STRING),e.push(this.regionSource||Vu.EMPTY_STRING),e.push(this.regionOutcome||Vu.EMPTY_STRING),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}setNativeBrokerErrorCode(e){const t=this.getLastRequests();t.nativeBrokerErrorCode=e,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t,this.correlationId)}getNativeBrokerErrorCode(){return this.getLastRequests().nativeBrokerErrorCode}clearNativeBrokerErrorCode(){const e=this.getLastRequests();delete e.nativeBrokerErrorCode,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e,this.correlationId)}static makeExtraSkuString(e){return mk(e)}}class vk{constructor(e,t,n,r,i,o,s,a,c){this.config=e,this.browserStorage=t,this.browserCrypto=n,this.networkClient=this.config.system.networkClient,this.eventHandler=i,this.navigationClient=o,this.platformAuthProvider=a,this.correlationId=c||bb(),this.logger=r.clone(Cd,zb,this.correlationId),this.performanceClient=s}async clearCacheOnLogout(e,t){if(t)try{this.browserStorage.removeAccount(t,e),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request.")}catch(n){this.logger.error("Account provided in logout request was not found. Local cache unchanged.")}else try{this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),this.browserStorage.clear(e),await this.browserCrypto.clearKeystore()}catch(r){this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged.")}}getRedirectUri(e){this.logger.verbose("getRedirectUri called");const t=e||this.config.auth.redirectUri;return om.getAbsoluteUrl(t,Ob())}initializeServerTelemetryManager(e,t){this.logger.verbose("initializeServerTelemetryManager called");const n={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new yk(n,this.browserStorage)}async getDiscoveredAuthority(e){const{account:t}=e,n=e.requestExtraQueryParameters&&e.requestExtraQueryParameters.hasOwnProperty("instance_aware")?e.requestExtraQueryParameters.instance_aware:void 0;this.performanceClient.addQueueMeasurement(Om,this.correlationId);const r={protocolMode:this.config.auth.protocolMode,OIDCOptions:this.config.auth.OIDCOptions,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},i=e.requestAuthority||this.config.auth.authority,o=null!==n&&void 0!==n&&n.length?"true"===n:this.config.auth.instanceAware,s=t&&o?this.config.auth.authority.replace(om.getDomainFromUrl(i),t.environment):i,a=EC.generateAuthority(s,e.requestAzureCloudOptions||this.config.auth.azureCloudOptions),c=await hC(ik,wy,this.logger,this.performanceClient,this.correlationId)(a,this.config.system.networkClient,this.browserStorage,r,this.logger,this.correlationId,this.performanceClient);if(t&&!c.isAlias(t.environment))throw xp(Pp);return c}}async function wk(e,t,n,r){n.addQueueMeasurement(Gm,e.correlationId);const i=e.authority||t.auth.authority,o=[...e&&e.scopes||[]],s=l(l({},e),{},{correlationId:e.correlationId,authority:i,scopes:o});if(s.authenticationScheme){if(s.authenticationScheme===Uh.SSH){if(!e.sshJwk)throw xp(Sp);if(!e.sshKid)throw xp(Tp)}r.verbose('Authentication Scheme set to "'.concat(s.authenticationScheme,'" as configured in Auth request'))}else s.authenticationScheme=Uh.BEARER,r.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request');return t.cache.claimsBasedCachingEnabled&&e.claims&&!Dp.isEmptyObj(e.claims)&&(s.requestedClaimsHash=await Pb(e.claims)),s}async function bk(e,t,n,r,i){r.addQueueMeasurement(Qm,e.correlationId);const o=await hC(wk,Gm,i,r,e.correlationId)(e,n,r,i);return l(l(l({},e),o),{},{account:t,forceRefresh:e.forceRefresh||!1})}function Ck(e,t){let n;const r=e.httpMethod;if(t===ug){if(n=r||Xu,n!==Xu)throw xp(Rp)}else n=r||Ju;if(e.authorizePostBodyParameters&&n!==Xu)throw xp(Np);return n}class kk extends vk{initializeLogoutRequest(e){this.logger.verbose("initializeLogoutRequest called",null===e||void 0===e?void 0:e.correlationId);const t=l({correlationId:this.correlationId||bb()},e);if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){const n=this.getLogoutHintFromIdTokenClaims(e.account);n&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),t.logoutHint=n)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return e&&null===e.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId):e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=om.getAbsoluteUrl(e.postLogoutRedirectUri,Ob())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=om.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,Ob())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=om.getAbsoluteUrl(Ob(),Ob())),t}getLogoutHintFromIdTokenClaims(e){const t=e.idTokenClaims;if(t){if(t.login_hint)return t.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null}async createAuthCodeClient(e){this.performanceClient.addQueueMeasurement(ty,this.correlationId);const t=await hC(this.getClientConfiguration.bind(this),ny,this.logger,this.performanceClient,this.correlationId)(e);return new pk(t,this.performanceClient)}async getClientConfiguration(e){const{serverTelemetryManager:t,requestAuthority:n,requestAzureCloudOptions:r,requestExtraQueryParameters:i,account:o}=e;this.performanceClient.addQueueMeasurement(ny,this.correlationId);const s=e.authority||await hC(this.getDiscoveredAuthority.bind(this),Om,this.logger,this.performanceClient,this.correlationId)({requestAuthority:n,requestAzureCloudOptions:r,requestExtraQueryParameters:i,account:o}),a=this.config.system.loggerOptions;return{authOptions:{clientId:this.config.auth.clientId,authority:s,clientCapabilities:this.config.auth.clientCapabilities,redirectUri:this.config.auth.redirectUri},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:a.loggerCallback,piiLoggingEnabled:a.piiLoggingEnabled,logLevel:a.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:t,libraryInfo:{sku:Cd,version:zb,cpu:Vu.EMPTY_STRING,os:Vu.EMPTY_STRING},telemetry:this.config.telemetry}}async initializeAuthorizationRequest(e,t){this.performanceClient.addQueueMeasurement(ry,this.correlationId);const n=this.getRedirectUri(e.redirectUri),r={interactionType:t},i=ck.setRequestState(this.browserCrypto,e&&e.state||Vu.EMPTY_STRING,r),o=await hC(wk,Gm,this.logger,this.performanceClient,this.correlationId)(l(l({},e),{},{correlationId:this.correlationId}),this.config,this.performanceClient,this.logger),s=l(l({},o),{},{redirectUri:n,state:i,nonce:e.nonce||bb(),responseMode:this.config.auth.OIDCOptions.serverResponseType}),a=l(l({},s),{},{httpMethod:Ck(s,this.config.auth.protocolMode)});if(e.loginHint||e.sid)return a;const c=e.account||this.browserStorage.getActiveAccount(this.correlationId);return c&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii("Setting validated request account: ".concat(c.homeAccountId),this.correlationId),a.account=c),a}}function Sk(e,t,n){const r=nm(e);if(!r)throw tm(e)?(n.error("A ".concat(t," is present in the iframe but it does not contain known properties. It's likely that the ").concat(t," has been replaced by code running on the redirectUri page.")),n.errorPii("The ".concat(t," detected is: ").concat(e)),hw(vv)):(n.error("The request has returned to the redirectUri but a ".concat(t," is not present. It's likely that the ").concat(t," has been removed or the page has been redirected by code running on the redirectUri page.")),hw(mv));return r}function Tk(e,t,n){if(!e.state)throw hw(yv);const r=function(e,t){if(!t)return null;try{return ck.parseRequestState(e,t).libraryState.meta}catch(n){throw op(bg)}}(t,e.state);if(!r)throw hw(wv);if(r.interactionType!==n)throw hw(bv)}function Ik(e,t,n,r){var i,o;const s=t.correlationId,a=new Map;Rw(a,t.embeddedClientId||(null===(i=t.extraQueryParameters)||void 0===i?void 0:i[vw])||e.clientId);if(Pw(a,[...t.scopes||[],...t.extraScopesToConsent||[]],!0,null===(o=e.authority.options.OIDCOptions)||void 0===o?void 0:o.defaultScopes),Nw(a,t.redirectUri),Fw(a,s),function(e,t){e.set("response_mode",t||Ch)}(a,t.responseMode),Gw(a),t.prompt&&(!function(e,t){e.set("prompt",t)}(a,t.prompt),null===r||void 0===r||r.addFields({prompt:t.prompt},s)),t.domainHint&&(!function(e,t){e.set("domain_hint",t)}(a,t.domainHint),null===r||void 0===r||r.addFields({domainHintFromRequest:!0},s)),t.prompt!==fh)if(t.sid&&t.prompt===ph)n.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),Dw(a,t.sid),null===r||void 0===r||r.addFields({sidFromRequest:!0},s);else if(t.account){const e=function(e){var t;return(null===(t=e.idTokenClaims)||void 0===t?void 0:t.sid)||null}(t.account);let i=function(e){var t;return e.loginHint||(null===(t=e.idTokenClaims)||void 0===t?void 0:t.login_hint)||null}(t.account);if(i&&t.domainHint&&(n.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),i=null),i){n.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),Ow(a,i),null===r||void 0===r||r.addFields({loginHintFromClaim:!0},s);try{xw(a,qp(t.account.homeAccountId))}catch(c){n.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e&&t.prompt===ph){n.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),Dw(a,e),null===r||void 0===r||r.addFields({sidFromClaim:!0},s);try{xw(a,qp(t.account.homeAccountId))}catch(c){n.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(t.loginHint)n.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),Ow(a,t.loginHint),Mw(a,t.loginHint),null===r||void 0===r||r.addFields({loginHintFromRequest:!0},s);else if(t.account.username){n.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),Ow(a,t.account.username),null===r||void 0===r||r.addFields({loginHintFromUpn:!0},s);try{xw(a,qp(t.account.homeAccountId))}catch(c){n.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else t.loginHint&&(n.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),Ow(a,t.loginHint),Mw(a,t.loginHint),null===r||void 0===r||r.addFields({loginHintFromRequest:!0},s));else n.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");return t.nonce&&function(e,t){e.set("nonce",t)}(a,t.nonce),t.state&&zw(a,t.state),(t.claims||e.clientCapabilities&&e.clientCapabilities.length>0)&&Lw(a,t.claims,e.clientCapabilities),t.embeddedClientId&&eb(a,e.clientId,e.redirectUri),!e.instanceAware||t.extraQueryParameters&&Object.keys(t.extraQueryParameters).includes(_w)||Qw(a),a}function _k(e,t,n,r){const i=rm(t,n,r);return om.appendQueryString(e.authorizationEndpoint,i)}function Ak(e,t){if(!e.state||!t)throw e.state?op(kg,"Cached State"):op(kg,"Server State");let n,r;try{n=decodeURIComponent(e.state)}catch(i){throw op(bg,e.state)}try{r=decodeURIComponent(t)}catch(i){throw op(bg,e.state)}if(n!==r)throw op(Cg);if(e.error||e.error_description||e.suberror){const t=function(e){var t,n;const r="code=",i=null===(t=e.error_uri)||void 0===t?void 0:t.lastIndexOf(r);return i&&i>=0?null===(n=e.error_uri)||void 0===n?void 0:n.substring(i+r.length):void 0}(e);if(UC(e.error,e.error_description,e.suberror))throw new qC(e.error||"",e.error_description,e.suberror,e.timestamp||"",e.trace_id||"",e.correlation_id||"",e.claims||"",t);throw new ok(e.error||"",e.error_description,e.suberror,t)}}class Ek{constructor(e,t,n,r,i){this.authModule=e,this.browserStorage=t,this.authCodeRequest=n,this.logger=r,this.performanceClient=i}async handleCodeResponse(e,t){let n;this.performanceClient.addQueueMeasurement(ay,t.correlationId);try{n=function(e,t){if(Ak(e,t),!e.code)throw op(Qg);return e}(e,t.state)}catch(r){throw r instanceof ok&&r.subError===Tv?hw(Tv):r}return hC(this.handleCodeResponseFromServer.bind(this),sy,this.logger,this.performanceClient,t.correlationId)(n,t)}async handleCodeResponseFromServer(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.performanceClient.addQueueMeasurement(sy,t.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),this.authCodeRequest.code=e.code,e.cloud_instance_host_name&&await hC(this.authModule.updateAuthority.bind(this.authModule),hy,this.logger,this.performanceClient,t.correlationId)(e.cloud_instance_host_name,t.correlationId),n&&(e.nonce=t.nonce||void 0),e.state=t.state,e.client_info)this.authCodeRequest.clientInfo=e.client_info;else{const e=this.createCcsCredentials(t);e&&(this.authCodeRequest.ccsCredential=e)}return await hC(this.authModule.acquireToken.bind(this.authModule),dy,this.logger,this.performanceClient,t.correlationId)(this.authCodeRequest,e)}createCcsCredentials(e){return e.account?{credential:e.account.homeAccountId,type:nk}:e.loginHint?{credential:e.loginHint,type:rk}:null}}const Pk="user_switch",Rk={[Pk]:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."};class Nk extends ad{constructor(e,t,n){super(e,t),Object.setPrototypeOf(this,Nk.prototype),this.name="NativeAuthError",this.ext=n}}function Ok(e){if(e.ext&&e.ext.status&&"DISABLED"===e.ext.status)return!0;if(e.ext&&e.ext.error&&-2147186943===e.ext.error)return!0;switch(e.errorCode){case"ContentError":case"PageException":return!0;default:return!1}}function Mk(e,t,n){if(n&&n.status)switch(n.status){case"ACCOUNT_UNAVAILABLE":return zC(NC);case"USER_INTERACTION_REQUIRED":return new qC(e,t);case"USER_CANCEL":return hw(Tv);case"NO_NETWORK":return hw(zv);case"UX_NOT_ALLOWED":return zC(MC)}return new Nk(e,Rk[e]||t,n)}class xk extends ak{constructor(e,t){super(e,t)}async acquireCachedToken(e){var t;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(Vm,e.correlationId);let n=$h;if(e.forceRefresh||!this.config.cacheOptions.claimsBasedCachingEnabled&&!Dp.isEmptyObj(e.claims))throw this.setCacheOutcome(Zh,e.correlationId),op(jg);if(!e.account)throw op(Lg);const r=e.account.tenantId||function(e){var t;const n=null===(t=new om(e).getUrlComponents().PathSegments.slice(-1)[0])||void 0===t?void 0:t.toLowerCase();switch(n){case ah:case ch:case lh:return;default:return n}}(e.authority),i=this.cacheManager.getTokenKeys(),o=this.cacheManager.getAccessToken(e.account,e,i,r);if(!o)throw this.setCacheOutcome(ed,e.correlationId),op(jg);if(s=o.cachedAt,Number(s)>fC()||mC(o.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.setCacheOutcome(td,e.correlationId),op(jg);var s;o.refreshOn&&mC(o.refreshOn,0)&&(n=nd);const a=e.authority||this.authority.getPreferredCache(),c={account:this.cacheManager.getAccount(this.cacheManager.generateAccountKey(e.account),e.correlationId),accessToken:o,idToken:this.cacheManager.getIdToken(e.account,e.correlationId,i,r,this.performanceClient),refreshToken:null,appMetadata:this.cacheManager.readAppMetadataFromCache(a)};return this.setCacheOutcome(n,e.correlationId),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[await hC(this.generateResultFromCacheRecord.bind(this),jm,this.logger,this.performanceClient,e.correlationId)(c,e),n]}setCacheOutcome(e,t){var n,r;null===(n=this.serverTelemetryManager)||void 0===n||n.setCacheOutcome(e),null===(r=this.performanceClient)||void 0===r||r.addFields({cacheOutcome:e},t),e!==$h&&this.logger.info("Token refresh is required due to cache outcome: ".concat(e))}async generateResultFromCacheRecord(e,t){var n;let r;if(null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(jm,t.correlationId),e.idToken&&(r=Xp(e.idToken.secret,this.config.cryptoInterface.base64Decode)),t.maxAge||0===t.maxAge){var i;const e=null===(i=r)||void 0===i?void 0:i.auth_time;if(!e)throw op(Tg);Zp(e,t.maxAge)}return dk.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,r)}}class Dk extends kk{async acquireToken(e){this.performanceClient.addQueueMeasurement(Am,e.correlationId);const t=this.initializeServerTelemetryManager(ef),n=await hC(this.getClientConfiguration.bind(this),ny,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:t,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,account:e.account}),r=new xk(n,this.performanceClient);this.logger.verbose("Silent auth client created");try{const t=(await hC(r.acquireCachedToken.bind(r),Vm,this.logger,this.performanceClient,e.correlationId)(e))[0];return this.performanceClient.addFields({fromCache:!0},e.correlationId),t}catch(i){throw i instanceof uw&&i.errorCode===Kv&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),i}}logout(e){this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e);return this.clearCacheOnLogout(t.correlationId,null===t||void 0===t?void 0:t.account)}}const Lk=["prompt"],Fk=["scopes"];class qk extends vk{constructor(e,t,n,r,i,o,s,a,c,l,u,h){super(e,t,n,r,i,o,a,c,h),this.apiId=s,this.accountId=l,this.platformAuthProvider=c,this.nativeStorageManager=u,this.silentCacheClient=new Dk(e,this.nativeStorageManager,n,r,i,o,a,c,h);const d=this.platformAuthProvider.getExtensionName();this.skus=yk.makeExtraSkuString({libraryName:Cd,libraryVersion:zb,extensionName:d,extensionVersion:this.platformAuthProvider.getExtensionVersion()})}addRequestSKUs(e){e.extraParameters=l(l({},e.extraParameters),{},{[Sw]:this.skus})}async acquireToken(e,t){this.performanceClient.addQueueMeasurement(Mm,this.correlationId),this.logger.trace("NativeInteractionClient - acquireToken called.");const n=this.performanceClient.startMeasurement(Mm,this.correlationId),r=fC(),i=this.initializeServerTelemetryManager(this.apiId);try{const s=await this.initializeNativeRequest(e);try{const e=await this.acquireTokensFromCache(this.accountId,s);return n.end({success:!0,isNativeBroker:!1,fromCache:!0}),e}catch(o){if(t===yf)throw this.logger.info("MSAL internal Cache does not contain tokens, return error as per cache policy"),n.end({success:!1,brokerErrorCode:"cache_request_failed"}),o;this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call")}const a=await this.platformAuthProvider.sendMessage(s);return await this.handleNativeResponse(a,s,r).then(e=>(n.end({success:!0,isNativeBroker:!0,requestId:e.requestId}),i.clearNativeBrokerErrorCode(),e)).catch(e=>{throw n.end({success:!1,errorCode:e.errorCode,subErrorCode:e.subError}),e})}catch(o){throw o instanceof Nk&&i.setNativeBrokerErrorCode(o.errorCode),n.end({success:!1}),o}}createSilentCacheRequest(e,t){return{authority:e.authority,correlationId:this.correlationId,scopes:Lp.fromString(e.scope).asArray(),account:t,forceRefresh:!1}}async acquireTokensFromCache(e,t){if(!e)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),op(Ug);const n=this.browserStorage.getBaseAccountInfo({nativeAccountId:e},this.correlationId);if(!n)throw op(Ug);try{const e=this.createSilentCacheRequest(t,n),r=await this.silentCacheClient.acquireToken(e),i=l(l({},n),{},{idTokenClaims:null===r||void 0===r?void 0:r.idTokenClaims,idToken:null===r||void 0===r?void 0:r.idToken});return l(l({},r),{},{account:i})}catch(r){throw r}}async acquireTokenRedirect(e,t){this.logger.trace("NativeInteractionClient - acquireTokenRedirect called.");const n=Object.assign({},(function(e){if(null==e)throw new TypeError("Cannot destructure "+e)}(e),e));delete n.onRedirectNavigate;const r=await this.initializeNativeRequest(n);try{await this.platformAuthProvider.sendMessage(r)}catch(s){if(s instanceof Nk){if(this.initializeServerTelemetryManager(this.apiId).setNativeBrokerErrorCode(s.errorCode),Ok(s))throw s}}this.browserStorage.setTemporaryCache(Gd,JSON.stringify(r),!0);const i={apiId:Yd,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},o=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(e.redirectUri);t.end({success:!0}),await this.navigationClient.navigateExternal(o,i)}async handleRedirectPromise(e,t){if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const n=this.browserStorage.getCachedNativeRequest();if(!n)return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),e&&t&&(null===e||void 0===e||e.addFields({errorCode:"no_cached_request"},t)),null;const{prompt:r}=n,i=Up(n,Lk);r&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Gd));const o=fC();try{this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker.");const t=await this.platformAuthProvider.sendMessage(i),n=await this.handleNativeResponse(t,i,o);return this.initializeServerTelemetryManager(this.apiId).clearNativeBrokerErrorCode(),e&&this.correlationId&&this.performanceClient.addFields({isNativeBroker:!0},this.correlationId),n}catch(s){throw s}}logout(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")}async handleNativeResponse(e,t,n){var r,i;this.logger.trace("NativeInteractionClient - handleNativeResponse called.");const o=Xp(e.id_token,ob),s=this.createHomeAccountIdentifier(e,o),a=null===(r=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:t.accountId},this.correlationId))||void 0===r?void 0:r.homeAccountId;if(null!==(i=t.extraParameters)&&void 0!==i&&i.child_client_id&&e.account.id!==t.accountId)this.logger.info("handleNativeServerResponse: Double broker flow detected, ignoring accountId mismatch");else if(s!==a&&e.account.id!==t.accountId)throw Mk(Pk);const c=await this.getDiscoveredAuthority({requestAuthority:t.authority}),l=fk(this.browserStorage,c,s,ob,this.correlationId,o,e.client_info,void 0,o.tid,void 0,e.account.id,this.logger);e.expires_in=Number(e.expires_in);const u=await this.generateAuthenticationResult(e,t,o,l,c.canonicalAuthority,n);return await this.cacheAccount(l,this.correlationId,$p(o)),await this.cacheNativeTokens(e,t,s,o,e.access_token,u.tenantId,n),u}createHomeAccountIdentifier(e,t){return Jp.generateHomeAccountId(e.client_info||Vu.EMPTY_STRING,Kp,this.logger,this.browserCrypto,t)}generateScopes(e,t){return t?Lp.fromString(t):Lp.fromString(e)}async generatePopAccessToken(e,t){if(t.tokenType===Uh.POP&&t.signPopToken){if(e.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),e.shr;const n=new uk(this.browserCrypto),r={resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,shrNonce:t.shrNonce};if(!t.keyId)throw op(Jg);return n.signPopToken(e.access_token,t.keyId,r)}return e.access_token}async generateAuthenticationResult(e,t,n,r,i,o){const s=this.addTelemetryFromNativeResponse(e.properties.MATS),a=this.generateScopes(t.scope,e.scope),c=e.account.properties||{},l=c.UID||n.oid||n.sub||Vu.EMPTY_STRING,u=c.TenantId||n.tid||Vu.EMPTY_STRING,h=jp(Jp.getAccountInfo(r),void 0,n,e.id_token);h.nativeAccountId!==e.account.id&&(h.nativeAccountId=e.account.id);const d=await this.generatePopAccessToken(e,t),f=t.tokenType===Uh.POP?Uh.POP:Uh.BEARER;return{authority:i,uniqueId:l,tenantId:u,scopes:a.asArray(),account:h,idToken:e.id_token,idTokenClaims:n,accessToken:d,fromCache:!!s&&this.isResponseFromCache(s),expiresOn:pC(o+e.expires_in),tokenType:f,correlationId:this.correlationId,state:e.state,fromNativeBroker:!0}}async cacheAccount(e,t,n){await this.browserStorage.setAccount(e,this.correlationId,n),this.browserStorage.removeAccountContext(Jp.getAccountInfo(e),t)}cacheNativeTokens(e,t,n,r,i,o,s){const a=vC(n,t.authority,e.id_token||"",t.clientId,r.tid||""),c=s+(t.tokenType===Uh.POP?Vu.SHR_NONCE_VALIDITY:("string"===typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0),l=this.generateScopes(e.scope,t.scope),u={idToken:a,accessToken:wC(n,t.authority,i,t.clientId,r.tid||o,l.printScopes(),c,0,ob,void 0,t.tokenType,void 0,t.keyId)};return this.nativeStorageManager.saveCacheRecord(u,this.correlationId,$p(r),t.storeInCache)}getExpiresInValue(e,t){return e===Uh.POP?Vu.SHR_NONCE_VALIDITY:("string"===typeof t?parseInt(t,10):t)||0}addTelemetryFromNativeResponse(e){const t=this.getMATSFromResponse(e);return t?(this.performanceClient.addFields({extensionId:this.platformAuthProvider.getExtensionId(),extensionVersion:this.platformAuthProvider.getExtensionVersion(),matsBrokerVersion:t.broker_version,matsAccountJoinOnStart:t.account_join_on_start,matsAccountJoinOnEnd:t.account_join_on_end,matsDeviceJoin:t.device_join,matsPromptBehavior:t.prompt_behavior,matsApiErrorCode:t.api_error_code,matsUiVisible:t.ui_visible,matsSilentCode:t.silent_code,matsSilentBiSubCode:t.silent_bi_sub_code,matsSilentMessage:t.silent_message,matsSilentStatus:t.silent_status,matsHttpStatus:t.http_status,matsHttpEventCount:t.http_event_count},this.correlationId),t):null}getMATSFromResponse(e){if(e)try{return JSON.parse(e)}catch(t){this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null}isResponseFromCache(e){return"undefined"===typeof e.is_cached?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached}async initializeNativeRequest(e){this.logger.trace("NativeInteractionClient - initializeNativeRequest called");const t=await this.getCanonicalAuthority(e),{scopes:n}=e,r=Up(e,Fk),i=new Lp(n||[]);i.appendScopes($u);const o=l(l({},r),{},{accountId:this.accountId,clientId:this.config.auth.clientId,authority:t.urlString,scope:i.printScopes(),redirectUri:this.getRedirectUri(e.redirectUri),prompt:this.getPrompt(e.prompt),correlationId:this.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:l(l({},e.extraQueryParameters),e.tokenQueryParameters),extendedExpiryToken:!1,keyId:e.popKid});if(o.signPopToken&&e.popKid)throw hw(rw);if(this.handleExtraBrokerParams(o),o.extraParameters=o.extraParameters||{},o.extraParameters.telemetry=Td,e.authenticationScheme===Uh.POP){const t={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},n=new uk(this.browserCrypto);let r;if(o.keyId)r=this.browserCrypto.base64UrlEncode(JSON.stringify({kid:o.keyId})),o.signPopToken=!1;else{const e=await hC(n.generateCnf.bind(n),py,this.logger,this.performanceClient,this.correlationId)(t,this.logger);r=e.reqCnfString,o.keyId=e.kid,o.signPopToken=!0}o.reqCnf=r}return this.addRequestSKUs(o),o}async getCanonicalAuthority(e){const t=e.authority||this.config.auth.authority;e.account&&await this.getDiscoveredAuthority({requestAuthority:t,requestAzureCloudOptions:e.azureCloudOptions,account:e.account});const n=new om(t);return n.validateAsUri(),n}getPrompt(e){switch(this.apiId){case Xd:case ef:return this.logger.trace("initializeNativeRequest: silent request sets prompt to none"),ph}if(e)switch(e){case ph:case gh:case dh:case fh:return this.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e;default:throw this.logger.trace("initializeNativeRequest: prompt = ".concat(e," is not compatible with native flow")),hw(tw)}else this.logger.trace("initializeNativeRequest: prompt was not provided")}handleExtraBrokerParams(e){var t;const n=e.extraParameters&&e.extraParameters.hasOwnProperty(Tw)&&e.extraParameters.hasOwnProperty(Iw)&&e.extraParameters.hasOwnProperty(vw);if(!e.embeddedClientId&&!n)return;let r="";const i=e.redirectUri;e.embeddedClientId?(e.redirectUri=this.config.auth.redirectUri,r=e.embeddedClientId):e.extraParameters&&(e.redirectUri=e.extraParameters[Iw],r=e.extraParameters[vw]),e.extraParameters={child_client_id:r,child_redirect_uri:i},null===(t=this.performanceClient)||void 0===t||t.addFields({embeddedClientId:r,embeddedRedirectUri:i},this.correlationId)}}async function Uk(e,t,n,r,i){const o=Ik(l(l({},e.auth),{},{authority:t}),n,r,i);if(qw(o,{sku:Cd,version:zb,os:"",cpu:""}),e.auth.protocolMode!==lg&&Uw(o,e.telemetry.application),n.platformBroker&&(function(e){e.set("nativebroker","1")}(o),i.addFields({isPlatformAuthorizeRequest:!0},n.correlationId),n.authenticationScheme===Uh.POP)){const e=new cC(r,i),t=new uk(e);let s;if(n.popKid)s=e.encodeKid(n.popKid);else{s=(await hC(t.generateCnf.bind(t),py,r,i,n.correlationId)(n,r)).reqCnfString}Jw(o,s)}return Aw(o,n.correlationId,i),o}async function zk(e,t,n,r,i){if(!n.codeChallenge)throw xp(wp);const o=await hC(Uk,oy,r,i,n.correlationId)(e,t,n,r,i);return Ew(o,yh),Bw(o,n.codeChallenge,Vu.S256_CODE_CHALLENGE_METHOD),Ww(o,n.extraQueryParameters||{}),_k(t,o,e.auth.encodeExtraQueryParams,n.extraQueryParameters)}async function Bk(e,t,n,r,i,o){if(!r.earJwk)throw hw(dv);const s=await Uk(t,n,r,i,o);Ew(s,vh),function(e,t){e.set("ear_jwk",encodeURIComponent(t)),e.set("ear_jwe_crypto","eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2R0NNIn0")}(s,r.earJwk),Bw(s,r.codeChallenge,Vu.S256_CODE_CHALLENGE_METHOD);const a=new Map;Ww(a,r.extraQueryParameters||{});return Vk(e,_k(n,a,t.auth.encodeExtraQueryParams,r.extraQueryParameters),s)}async function Hk(e,t,n,r,i,o){const s=await Uk(t,n,r,i,o);Ew(s,yh),Bw(s,r.codeChallenge,r.codeChallengeMethod||Vu.S256_CODE_CHALLENGE_METHOD),function(e,t){Object.entries(t).forEach(t=>{let[n,r]=t;r&&e.set(n,r)})}(s,r.authorizePostBodyParameters||{});const a=new Map;Ww(a,r.extraQueryParameters||{});return Vk(e,_k(n,a,t.auth.encodeExtraQueryParams,r.extraQueryParameters),s)}function Vk(e,t,n){const r=e.createElement("form");return r.method="post",r.action=t,n.forEach((t,n)=>{const i=e.createElement("input");i.hidden=!0,i.name=n,i.value=t,r.appendChild(i)}),e.body.appendChild(r),r}async function jk(e,t,n,r,i,o,s,a,c,u){if(a.verbose("Account id found, calling WAM for token"),!u)throw hw(Zv);const h=new cC(a,c),d=new qk(r,i,h,a,s,r.system.navigationClient,n,c,u,t,o,e.correlationId),{userRequestState:f}=ck.parseRequestState(h,e.state);return hC(d.acquireToken.bind(d),Mm,a,c,e.correlationId)(l(l({},e),{},{state:f,prompt:void 0}))}async function Kk(e,t,n,r,i,o,s,a,c,u,h,d){if(sk.removeThrottle(s,i.auth.clientId,e),t.accountId)return hC(jk,ly,u,h,e.correlationId)(e,t.accountId,r,i,s,a,c,u,h,d);const f=l(l({},e),{},{code:t.code||"",codeVerifier:n}),g=new Ek(o,s,f,u,h);return await hC(g.handleCodeResponse.bind(g),ay,u,h,e.correlationId)(t,e)}async function Gk(e,t,n,r,i,o,s,a,c,l,u){if(sk.removeThrottle(o,r.auth.clientId,e),Ak(t,e.state),!t.ear_jwe)throw hw(fv);if(!e.earJwk)throw hw(dv);const h=JSON.parse(await hC(Sb,Xy,c,l,e.correlationId)(e.earJwk,t.ear_jwe));if(h.accountId)return hC(jk,ly,c,l,e.correlationId)(e,h.accountId,n,r,o,s,a,c,l,u);const d=new dk(r.auth.clientId,o,new cC(c,l),c,null,null,l);d.validateTokenResponse(h);const f={code:"",state:e.state,nonce:e.nonce,client_info:h.client_info,cloud_graph_host_name:h.cloud_graph_host_name,cloud_instance_host_name:h.cloud_instance_host_name,cloud_instance_name:h.cloud_instance_name,msgraph_host:h.msgraph_host};return await hC(d.handleServerTokenResponse.bind(d),yy,c,l,e.correlationId)(h,i,fC(),e,f,void 0,void 0,void 0,void 0)}async function Qk(e,t,n){e.addQueueMeasurement(Uy,n);const r=uC(Wk,zy,t,e,n)(e,t,n);return{verifier:r,challenge:await hC(Yk,By,t,e,n)(r,e,t,n)}}function Wk(e,t,n){try{const r=new Uint8Array(32);uC(vb,Vy,t,e,n)(r);return nb(r)}catch(r){throw hw(hv)}}async function Yk(e,t,n,r){t.addQueueMeasurement(By,r);try{const i=await hC(yb,Hy,n,t,r)(e,t,r);return nb(new Uint8Array(i))}catch(i){throw hw(hv)}}class Jk{constructor(e,t,n,r){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=r,this.resolvers=new Map,this.handshakeResolvers=new Map,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=n,this.handshakeEvent=n.startMeasurement(Oy),this.platformAuthType=Pd}async sendMessage(e){this.logger.trace(this.platformAuthType+" - sendMessage called.");const t={method:Od,request:e},n={channel:kd,extensionId:this.extensionId,responseId:bb(),body:t};this.logger.trace(this.platformAuthType+" - Sending request to browser extension"),this.logger.tracePii(this.platformAuthType+" - Sending request to browser extension: ".concat(JSON.stringify(n))),this.messageChannel.port1.postMessage(n);const r=await new Promise((e,t)=>{this.resolvers.set(n.responseId,{resolve:e,reject:t})});return this.validatePlatformBrokerResponse(r)}static async createProvider(e,t,n){e.trace("PlatformAuthExtensionHandler - createProvider called.");try{const r=new Jk(e,t,n,Sd);return await r.sendHandshakeRequest(),r}catch(r){const i=new Jk(e,t,n);return await i.sendHandshakeRequest(),i}}async sendHandshakeRequest(){this.logger.trace(this.platformAuthType+" - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1);const e={channel:kd,extensionId:this.extensionId,responseId:bb(),body:{method:Rd}};return this.handshakeEvent.add({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=e=>{this.onChannelMessage(e)},window.postMessage(e,window.origin,[this.messageChannel.port2]),new Promise((t,n)=>{this.handshakeResolvers.set(e.responseId,{resolve:t,reject:n}),this.timeoutId=window.setTimeout(()=>{window.removeEventListener("message",this.windowListener,!1),this.messageChannel.port1.close(),this.messageChannel.port2.close(),this.handshakeEvent.end({extensionHandshakeTimedOut:!0,success:!1}),n(hw(Xv)),this.handshakeResolvers.delete(e.responseId)},this.handshakeTimeoutMs)})}onWindowMessage(e){if(this.logger.trace(this.platformAuthType+" - onWindowMessage called"),e.source!==window)return;const t=e.data;if(t.channel&&t.channel===kd&&(!t.extensionId||t.extensionId===this.extensionId)&&t.body.method===Rd){const e=this.handshakeResolvers.get(t.responseId);if(!e)return void this.logger.trace(this.platformAuthType+".onWindowMessage - resolver can't be found for request ".concat(t.responseId));this.logger.verbose(t.extensionId?"Extension with id: ".concat(t.extensionId," not installed"):"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1),this.handshakeEvent.end({success:!1,extensionInstalled:!1}),e.reject(hw($v))}}onChannelMessage(e){this.logger.trace(this.platformAuthType+" - onChannelMessage called.");const t=e.data,n=this.resolvers.get(t.responseId),r=this.handshakeResolvers.get(t.responseId);try{const e=t.body.method;if(e===Md){if(!n)return;const e=t.body.response;if(this.logger.trace(this.platformAuthType+" - Received response from browser extension"),this.logger.tracePii(this.platformAuthType+" - Received response from browser extension: ".concat(JSON.stringify(e))),"Success"!==e.status)n.reject(Mk(e.code,e.description,e.ext));else{if(!e.result)throw cd(id,"Event does not contain result.");e.result.code&&e.result.description?n.reject(Mk(e.result.code,e.result.description,e.result.ext)):n.resolve(e.result)}this.resolvers.delete(t.responseId)}else if(e===Nd){if(!r)return void this.logger.trace(this.platformAuthType+".onChannelMessage - resolver can't be found for request ".concat(t.responseId));clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.extensionVersion=t.body.version,this.logger.verbose(this.platformAuthType+" - Received HandshakeResponse from extension: ".concat(this.extensionId)),this.handshakeEvent.end({extensionInstalled:!0,success:!0}),r.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(i){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii("Error parsing response from WAM Extension: ".concat(i)),this.logger.errorPii("Unable to parse ".concat(e)),n?n.reject(i):r&&r.reject(i)}}validatePlatformBrokerResponse(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw cd(id,"Response missing expected properties.")}getExtensionId(){return this.extensionId}getExtensionVersion(){return this.extensionVersion}getExtensionName(){var e;return this.getExtensionId()===Sd?"chrome":null!==(e=this.getExtensionId())&&void 0!==e&&e.length?"unknown":void 0}}const Xk=["accountId","clientId","authority","scope","redirectUri","correlationId","state","storeInCache","embeddedClientId","extraParameters"];class $k{constructor(e,t,n){this.logger=e,this.performanceClient=t,this.correlationId=n,this.platformAuthType=Ed}static async createProvider(e,t,n){var r;if(e.trace("PlatformAuthDOMHandler: createProvider called"),null!==(r=window.navigator)&&void 0!==r&&r.platformAuthentication){const r=await window.navigator.platformAuthentication.getSupportedContracts(Id);if(null!==r&&void 0!==r&&r.includes(Ad))return e.trace("Platform auth api available in DOM"),new $k(e,t,n)}}getExtensionId(){return Id}getExtensionVersion(){return""}getExtensionName(){return _d}async sendMessage(e){this.logger.trace(this.platformAuthType+" - Sending request to browser DOM API");try{const t=this.initializePlatformDOMRequest(e),n=await window.navigator.platformAuthentication.executeGetToken(t);return this.validatePlatformBrokerResponse(n)}catch(t){throw this.logger.error(this.platformAuthType+" - executeGetToken DOM API error"),t}}initializePlatformDOMRequest(e){this.logger.trace(this.platformAuthType+" - initializeNativeDOMRequest called");const{accountId:t,clientId:n,authority:r,scope:i,redirectUri:o,correlationId:s,state:a,storeInCache:c,embeddedClientId:u,extraParameters:h}=e,d=Up(e,Xk),f=this.getDOMExtraParams(d);return{accountId:t,brokerId:this.getExtensionId(),authority:r,clientId:n,correlationId:s||this.correlationId,extraParameters:l(l({},h),f),isSecurityTokenService:!1,redirectUri:o,scope:i,state:a,storeInCache:c,embeddedClientId:u}}validatePlatformBrokerResponse(e){if(e.hasOwnProperty("isSuccess")){if(e.hasOwnProperty("accessToken")&&e.hasOwnProperty("idToken")&&e.hasOwnProperty("clientInfo")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scopes")&&e.hasOwnProperty("expiresIn"))return this.logger.trace(this.platformAuthType+" - platform broker returned successful and valid response"),this.convertToPlatformBrokerResponse(e);if(e.hasOwnProperty("error")){const t=e;if(!1===t.isSuccess&&t.error&&t.error.code)throw this.logger.trace(this.platformAuthType+" - platform broker returned error response"),Mk(t.error.code,t.error.description,{error:parseInt(t.error.errorCode),protocol_error:t.error.protocolError,status:t.error.status,properties:t.error.properties})}}throw cd(id,"Response missing expected properties.")}convertToPlatformBrokerResponse(e){var t;this.logger.trace(this.platformAuthType+" - convertToNativeResponse called");return{access_token:e.accessToken,id_token:e.idToken,client_info:e.clientInfo,account:e.account,expires_in:e.expiresIn,scope:e.scopes,state:e.state||"",properties:e.properties||{},extendedLifetimeToken:null!==(t=e.extendedLifetimeToken)&&void 0!==t&&t,shr:e.proofOfPossessionPayload}}getDOMExtraParams(e){return l({},Object.entries(e).reduce((e,t)=>{let[n,r]=t;return e[n]=String(r),e},{}))}}async function Zk(e,t,n,r){e.trace("getPlatformAuthProvider called",n);const i=function(){let e;try{var t;return e=window[Dd],"true"===(null===(t=e)||void 0===t?void 0:t.getItem(Kb))}catch(n){return!1}}();let o;e.trace("Has client allowed platform auth via DOM API: "+i);try{i&&(o=await $k.createProvider(e,t,n)),o||(e.trace("Platform auth via DOM API not available, checking for extension"),o=await Jk.createProvider(e,r||2e3,t))}catch(s){e.trace("Platform auth not available",s)}return o}function eS(e,t,n,r){if(t.trace("isPlatformAuthAllowed called"),!e.system.allowPlatformBroker)return t.trace("isPlatformAuthAllowed: allowPlatformBroker is not enabled, returning false"),!1;if(!n)return t.trace("isPlatformAuthAllowed: Platform auth provider is not initialized, returning false"),!1;if(r)switch(r){case Uh.BEARER:case Uh.POP:return t.trace("isPlatformAuthAllowed: authenticationScheme is supported, returning true"),!0;default:return t.trace("isPlatformAuthAllowed: authenticationScheme is not supported, returning false"),!1}return!0}class tS extends kk{constructor(e,t,n,r,i,o,s,a,c,l){super(e,t,n,r,i,o,s,c,l),this.unloadWindow=this.unloadWindow.bind(this),this.nativeStorage=a,this.eventHandler=i}acquireToken(e,t){let n;try{var r;if(n={popupName:this.generatePopupName(e.scopes||$u,e.authority||this.config.auth.authority),popupWindowAttributes:e.popupWindowAttributes||{},popupWindowParent:null!==(r=e.popupWindowParent)&&void 0!==r?r:window},this.performanceClient.addFields({isAsyncPopup:this.config.system.asyncPopups},this.correlationId),this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,n,t);{const r=l(l({},e),{},{httpMethod:Ck(e,this.config.auth.protocolMode)});return this.logger.verbose("asyncPopup set to false, opening popup before acquiring token"),n.popup=this.openSizedPopup("about:blank",n),this.acquireTokenPopupAsync(r,n,t)}}catch(i){return Promise.reject(i)}}logout(e){try{var t;this.logger.verbose("logoutPopup called");const n=this.initializeLogoutRequest(e),r={popupName:this.generateLogoutPopupName(n),popupWindowAttributes:(null===e||void 0===e?void 0:e.popupWindowAttributes)||{},popupWindowParent:null!==(t=null===e||void 0===e?void 0:e.popupWindowParent)&&void 0!==t?t:window},i=e&&e.authority,o=e&&e.mainWindowRedirectUri;return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(n,r,i,o)):(this.logger.verbose("asyncPopup set to false, opening popup"),r.popup=this.openSizedPopup("about:blank",r),this.logoutPopupAsync(n,r,i,o))}catch(n){return Promise.reject(n)}}async acquireTokenPopupAsync(e,t,n){this.logger.verbose("acquireTokenPopupAsync called");const r=await hC(this.initializeAuthorizationRequest.bind(this),ry,this.logger,this.performanceClient,this.correlationId)(e,rf.Popup);t.popup&&qb(r.authority);const i=eS(this.config,this.logger,this.platformAuthProvider,e.authenticationScheme);return r.platformBroker=i,this.config.auth.protocolMode===ug?this.executeEarFlow(r,t,n):this.executeCodeFlow(r,t,n)}async executeCodeFlow(e,t,n){const r=e.correlationId,i=this.initializeServerTelemetryManager(Jd),o=n||await hC(Qk,Uy,this.logger,this.performanceClient,r)(this.performanceClient,this.logger,r),s=l(l({},e),{},{codeChallenge:o.challenge});try{const n=await hC(this.createAuthCodeClient.bind(this),ty,this.logger,this.performanceClient,r)({serverTelemetryManager:i,requestAuthority:s.authority,requestAzureCloudOptions:s.azureCloudOptions,requestExtraQueryParameters:s.extraQueryParameters,account:s.account});if(s.httpMethod===Xu)return await this.executeCodeFlowWithPost(s,t,n,o.verifier);{const i=await hC(zk,iy,this.logger,this.performanceClient,r)(this.config,n.authority,s,this.logger,this.performanceClient),a=this.initiateAuthRequest(i,t);this.eventHandler.emitEvent(Qf,rf.Popup,{popupWindow:a},null);const c=await this.monitorPopupForHash(a,t.popupWindowParent),l=uC(Sk,vy,this.logger,this.performanceClient,this.correlationId)(c,this.config.auth.OIDCOptions.serverResponseType,this.logger);return await hC(Kk,uy,this.logger,this.performanceClient,r)(e,l,o.verifier,Jd,this.config,n,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}}catch(c){var a;throw null===(a=t.popup)||void 0===a||a.close(),c instanceof ad&&(c.setCorrelationId(this.correlationId),i.cacheFailedRequest(c)),c}}async executeEarFlow(e,t,n){const r=e.correlationId,i=await hC(this.getDiscoveredAuthority.bind(this),Om,this.logger,this.performanceClient,r)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),o=await hC(kb,Jy,this.logger,this.performanceClient,r)(),s=n||await hC(Qk,Uy,this.logger,this.performanceClient,r)(this.performanceClient,this.logger,r),a=l(l({},e),{},{earJwk:o,codeChallenge:s.challenge}),c=t.popup||this.openPopup("about:blank",t);(await Bk(c.document,this.config,i,a,this.logger,this.performanceClient)).submit();const u=await hC(this.monitorPopupForHash.bind(this),$m,this.logger,this.performanceClient,r)(c,t.popupWindowParent),h=uC(Sk,vy,this.logger,this.performanceClient,this.correlationId)(u,this.config.auth.OIDCOptions.serverResponseType,this.logger);if(!h.ear_jwe&&h.code){const t=await hC(this.createAuthCodeClient.bind(this),ty,this.logger,this.performanceClient,r)({serverTelemetryManager:this.initializeServerTelemetryManager(Jd),requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account,authority:i});return hC(Kk,uy,this.logger,this.performanceClient,r)(a,h,s.verifier,Jd,this.config,t,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}return hC(Gk,cy,this.logger,this.performanceClient,r)(a,h,Jd,this.config,i,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}async executeCodeFlowWithPost(e,t,n,r){const i=e.correlationId,o=await hC(this.getDiscoveredAuthority.bind(this),Om,this.logger,this.performanceClient,i)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),s=t.popup||this.openPopup("about:blank",t);(await Hk(s.document,this.config,o,e,this.logger,this.performanceClient)).submit();const a=await hC(this.monitorPopupForHash.bind(this),$m,this.logger,this.performanceClient,i)(s,t.popupWindowParent),c=uC(Sk,vy,this.logger,this.performanceClient,this.correlationId)(a,this.config.auth.OIDCOptions.serverResponseType,this.logger);return hC(Kk,uy,this.logger,this.performanceClient,i)(e,c,r,Jd,this.config,n,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}async logoutPopupAsync(e,t,n,r){this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(Wf,rf.Popup,e);const i=this.initializeServerTelemetryManager(nf);try{await this.clearCacheOnLogout(this.correlationId,e.account);const a=await hC(this.createAuthCodeClient.bind(this),ty,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:i,requestAuthority:n,account:e.account||void 0});try{a.authority.endSessionEndpoint}catch(c){var o;if(null!==(o=e.account)&&void 0!==o&&o.homeAccountId&&e.postLogoutRedirectUri&&a.authority.protocolMode===lg){var s;if(this.eventHandler.emitEvent(Yf,rf.Popup,e),r){const e={apiId:nf,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},t=om.getAbsoluteUrl(r,Ob());await this.navigationClient.navigateInternal(t,e)}return void(null===(s=t.popup)||void 0===s||s.close())}}const l=a.getLogoutUri(e);this.eventHandler.emitEvent(Yf,rf.Popup,e);const u=this.openPopup(l,t);if(this.eventHandler.emitEvent(Qf,rf.Popup,{popupWindow:u},null),await this.monitorPopupForHash(u,t.popupWindowParent).catch(()=>{}),r){const e={apiId:nf,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},t=om.getAbsoluteUrl(r,Ob());this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii("Redirecting main window to: ".concat(t)),await this.navigationClient.navigateInternal(t,e)}else this.logger.verbose("No main window navigation requested")}catch(l){var a;throw null===(a=t.popup)||void 0===a||a.close(),l instanceof ad&&(l.setCorrelationId(this.correlationId),i.cacheFailedRequest(l)),this.eventHandler.emitEvent(Jf,rf.Popup,null,l),this.eventHandler.emitEvent(Xf,rf.Popup),l}this.eventHandler.emitEvent(Xf,rf.Popup)}initiateAuthRequest(e,t){if(e)return this.logger.infoPii("Navigate to: ".concat(e)),this.openPopup(e,t);throw this.logger.error("Navigate url is empty"),hw(pv)}monitorPopupForHash(e,t){return new Promise((t,n)=>{this.logger.verbose("PopupHandler.monitorPopupForHash - polling started");const r=setInterval(()=>{if(e.closed)return this.logger.error("PopupHandler.monitorPopupForHash - window closed"),clearInterval(r),void n(hw(Tv));let i="";try{i=e.location.href}catch(a){}if(!i||"about:blank"===i)return;clearInterval(r);let o="";const s=this.config.auth.OIDCOptions.serverResponseType;e&&(o=s===wh?e.location.search:e.location.hash),this.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),t(o)},this.config.system.pollIntervalMilliseconds)}).finally(()=>{this.cleanPopup(e,t)})}openPopup(e,t){try{let n;if(t.popup?(n=t.popup,this.logger.verbosePii("Navigating popup window to: ".concat(e)),n.location.assign(e)):"undefined"===typeof t.popup&&(this.logger.verbosePii("Opening popup window to: ".concat(e)),n=this.openSizedPopup(e,t)),!n)throw hw(Sv);return n.focus&&n.focus(),this.currentWindow=n,t.popupWindowParent.addEventListener("beforeunload",this.unloadWindow),n}catch(n){throw this.logger.error("error opening popup "+n.message),hw(kv)}}openSizedPopup(e,t){var n,r,i,o;let{popupName:s,popupWindowAttributes:a,popupWindowParent:c}=t;const l=c.screenLeft?c.screenLeft:c.screenX,u=c.screenTop?c.screenTop:c.screenY,h=c.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,d=c.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;let f=null===(n=a.popupSize)||void 0===n?void 0:n.width,g=null===(r=a.popupSize)||void 0===r?void 0:r.height,p=null===(i=a.popupPosition)||void 0===i?void 0:i.top,m=null===(o=a.popupPosition)||void 0===o?void 0:o.left;return(!f||f<0||f>h)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),f=yd),(!g||g<0||g>d)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),g=vd),(!p||p<0||p>d)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),p=Math.max(0,d/2-vd/2+u)),(!m||m<0||m>h)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),m=Math.max(0,h/2-yd/2+l)),c.open(e,s,"width=".concat(f,", height=").concat(g,", top=").concat(p,", left=").concat(m,", scrollbars=yes"))}unloadWindow(e){this.currentWindow&&this.currentWindow.close(),e.preventDefault()}cleanPopup(e,t){e.close(),t.removeEventListener("beforeunload",this.unloadWindow)}generatePopupName(e,t){return"".concat(wd,".").concat(this.config.auth.clientId,".").concat(e.join("-"),".").concat(t,".").concat(this.correlationId)}generateLogoutPopupName(e){const t=e.account&&e.account.homeAccountId;return"".concat(wd,".").concat(this.config.auth.clientId,".").concat(t,".").concat(this.correlationId)}}class nS extends kk{constructor(e,t,n,r,i,o,s,a,c,l){super(e,t,n,r,i,o,s,c,l),this.nativeStorage=a}async acquireToken(e){const t=await hC(this.initializeAuthorizationRequest.bind(this),ry,this.logger,this.performanceClient,this.correlationId)(e,rf.Redirect);t.platformBroker=eS(this.config,this.logger,this.platformAuthProvider,e.authenticationScheme);const n=e=>{e.persisted&&(this.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),this.browserStorage.resetRequestCache(),this.eventHandler.emitEvent($f,rf.Redirect))},r=this.getRedirectStartPage(e.redirectStartPage);this.logger.verbosePii("Redirect start page: ".concat(r)),this.browserStorage.setTemporaryCache(Bd,r,!0),window.addEventListener("pageshow",n);try{this.config.auth.protocolMode===ug?await this.executeEarFlow(t):await this.executeCodeFlow(t,e.onRedirectNavigate)}catch(i){throw i instanceof ad&&i.setCorrelationId(this.correlationId),window.removeEventListener("pageshow",n),i}}async executeCodeFlow(e,t){const n=e.correlationId,r=this.initializeServerTelemetryManager(Yd),i=await hC(Qk,Uy,this.logger,this.performanceClient,n)(this.performanceClient,this.logger,n),o=l(l({},e),{},{codeChallenge:i.challenge});this.browserStorage.cacheAuthorizeRequest(o,i.verifier);try{if(o.httpMethod===Xu)return await this.executeCodeFlowWithPost(o);{const n=await hC(this.createAuthCodeClient.bind(this),ty,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:o.authority,requestAzureCloudOptions:o.azureCloudOptions,requestExtraQueryParameters:o.extraQueryParameters,account:o.account}),i=await hC(zk,iy,this.logger,this.performanceClient,e.correlationId)(this.config,n.authority,o,this.logger,this.performanceClient);return await this.initiateAuthRequest(i,t)}}catch(s){throw s instanceof ad&&(s.setCorrelationId(this.correlationId),r.cacheFailedRequest(s)),s}}async executeEarFlow(e){const t=e.correlationId,n=await hC(this.getDiscoveredAuthority.bind(this),Om,this.logger,this.performanceClient,t)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),r=await hC(kb,Jy,this.logger,this.performanceClient,t)(),i=await hC(Qk,Uy,this.logger,this.performanceClient,t)(this.performanceClient,this.logger,t),o=l(l({},e),{},{earJwk:r,codeChallenge:i.challenge});this.browserStorage.cacheAuthorizeRequest(o,i.verifier);return(await Bk(document,this.config,n,o,this.logger,this.performanceClient)).submit(),new Promise((e,t)=>{setTimeout(()=>{t(hw(aw,"failed_to_redirect"))},this.config.system.redirectNavigationTimeout)})}async executeCodeFlowWithPost(e){const t=e.correlationId,n=await hC(this.getDiscoveredAuthority.bind(this),Om,this.logger,this.performanceClient,t)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account});this.browserStorage.cacheAuthorizeRequest(e);return(await Hk(document,this.config,n,e,this.logger,this.performanceClient)).submit(),new Promise((e,t)=>{setTimeout(()=>{t(hw(aw,"failed_to_redirect"))},this.config.system.redirectNavigationTimeout)})}async handleRedirectPromise(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;const i=this.initializeServerTelemetryManager($d);try{const[o,s]=this.getRedirectResponse(e||"");if(!o)return this.logger.info("handleRedirectPromise did not detect a response as a result of a redirect. Cleaning temporary cache."),this.browserStorage.resetRequestCache(),"back_forward"!==function(){if("undefined"===typeof window||"undefined"===typeof window.performance||"function"!==typeof window.performance.getEntriesByType)return;const e=window.performance.getEntriesByType("navigation"),t=e.length?e[0]:void 0;return null===t||void 0===t?void 0:t.type}()?r.event.errorCode="no_server_response":this.logger.verbose("Back navigation event detected. Muting no_server_response error"),null;const a=this.browserStorage.getTemporaryCache(Bd,!0)||Vu.EMPTY_STRING,c=im(a);if(c===im(window.location.href)&&this.config.auth.navigateToLoginRequestUrl){this.logger.verbose("Current page is loginRequestUrl, handling response"),a.indexOf("#")>-1&&function(e){const t=e.split("#");t.shift(),window.location.hash=t.length>0?t.join("#"):""}(a);return await this.handleResponse(o,t,n,i)}if(!this.config.auth.navigateToLoginRequestUrl)return this.logger.verbose("NavigateToLoginRequestUrl set to false, handling response"),await this.handleResponse(o,t,n,i);if(!Nb()||this.config.system.allowRedirectInIframe){this.browserStorage.setTemporaryCache(Hd,s,!0);const e={apiId:$d,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0};let r=!0;if(a&&"null"!==a)this.logger.verbose("Navigating to loginRequestUrl: ".concat(a)),r=await this.navigationClient.navigateInternal(a,e);else{const t=function(){const e=new om(window.location.href).getUrlComponents();return"".concat(e.Protocol,"//").concat(e.HostNameAndPort,"/")}();this.browserStorage.setTemporaryCache(Bd,t,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),r=await this.navigationClient.navigateInternal(t,e)}if(!r)return await this.handleResponse(o,t,n,i)}return null}catch(o){throw o instanceof ad&&(o.setCorrelationId(this.correlationId),i.cacheFailedRequest(o)),o}}getRedirectResponse(e){this.logger.verbose("getRedirectResponseHash called");let t=e;t||(t=this.config.auth.OIDCOptions.serverResponseType===wh?window.location.search:window.location.hash);let n=nm(t);if(n){try{Tk(n,this.browserCrypto,rf.Redirect)}catch(i){return i instanceof ad&&this.logger.error("Interaction type validation failed due to ".concat(i.errorCode,": ").concat(i.errorMessage)),[null,""]}return Rb(window),this.logger.verbose("Hash contains known properties, returning response hash"),[n,t]}const r=this.browserStorage.getTemporaryCache(Hd,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Hd)),r&&(n=nm(r),n)?(this.logger.verbose("Hash does not contain known properties, returning cached hash"),[n,r]):[null,""]}async handleResponse(e,t,n,r){if(!e.state)throw hw(yv);if(e.ear_jwe){const n=await hC(this.getDiscoveredAuthority.bind(this),Om,this.logger,this.performanceClient,t.correlationId)({requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account});return hC(Gk,cy,this.logger,this.performanceClient,t.correlationId)(t,e,Yd,this.config,n,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}const i=await hC(this.createAuthCodeClient.bind(this),ty,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:t.authority});return hC(Kk,uy,this.logger,this.performanceClient,t.correlationId)(t,e,n,Yd,this.config,i,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}async initiateAuthRequest(e,t){if(this.logger.verbose("RedirectHandler.initiateAuthRequest called"),e){this.logger.infoPii("RedirectHandler.initiateAuthRequest: Navigate to: ".concat(e));const n={apiId:Yd,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},r=t||this.config.auth.onRedirectNavigate;if("function"===typeof r){this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback");return!1!==r(e)?(this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),void await this.navigationClient.navigateExternal(e,n)):void this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation")}return this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),void await this.navigationClient.navigateExternal(e,n)}throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),hw(pv)}async logout(e){this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e),n=this.initializeServerTelemetryManager(tf);try{this.eventHandler.emitEvent(Wf,rf.Redirect,e),await this.clearCacheOnLogout(this.correlationId,t.account);const o={apiId:tf,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},s=await hC(this.createAuthCodeClient.bind(this),ty,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:n,requestAuthority:e&&e.authority,requestExtraQueryParameters:null===e||void 0===e?void 0:e.extraQueryParameters,account:e&&e.account||void 0});if(s.authority.protocolMode===lg)try{s.authority.endSessionEndpoint}catch(i){var r;if(null!==(r=t.account)&&void 0!==r&&r.homeAccountId)return void this.eventHandler.emitEvent(Yf,rf.Redirect,t)}const a=s.getLogoutUri(t);if(this.eventHandler.emitEvent(Yf,rf.Redirect,t),!e||"function"!==typeof e.onRedirectNavigate)return this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0,zd),void await this.navigationClient.navigateExternal(a,o);if(!1!==e.onRedirectNavigate(a))return this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0,zd),void await this.navigationClient.navigateExternal(a,o);this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation")}catch(o){throw o instanceof ad&&(o.setCorrelationId(this.correlationId),n.cacheFailedRequest(o)),this.eventHandler.emitEvent(Jf,rf.Redirect,null,o),this.eventHandler.emitEvent(Xf,rf.Redirect),o}this.eventHandler.emitEvent(Xf,rf.Redirect)}getRedirectStartPage(e){const t=e||window.location.href;return om.getAbsoluteUrl(t,Ob())}}async function rS(e,t,n,r,i){if(t.addQueueMeasurement(Xm,r),!e)throw n.info("Navigate url is empty"),hw(pv);return i?hC(aS,Zm,n,t,r)(e,i,t,r):uC(cS,ey,n,t,r)(e)}async function iS(e,t,n,r,i){const o=lS();if(!o.contentDocument)throw"No document associated with iframe!";return(await Hk(o.contentDocument,e,t,n,r,i)).submit(),o}async function oS(e,t,n,r,i){const o=lS();if(!o.contentDocument)throw"No document associated with iframe!";return(await Bk(o.contentDocument,e,t,n,r,i)).submit(),o}async function sS(e,t,n,r,i,o,s){return r.addQueueMeasurement($m,o),new Promise((r,o)=>{t<Ub&&i.warning("system.loadFrameTimeout or system.iframeHashTimeout set to lower (".concat(t,"ms) than the default (").concat(Ub,"ms). This may result in timeouts."));const a=window.setTimeout(()=>{window.clearInterval(c),o(hw(_v))},t),c=window.setInterval(()=>{let t="";const n=e.contentWindow;try{t=n?n.location.href:""}catch(o){}if(!t||"about:blank"===t)return;let i="";n&&(i=s===wh?n.location.search:n.location.hash),window.clearTimeout(a),window.clearInterval(c),r(i)},n)}).finally(()=>{uC(uS,My,i,r,o)(e)})}function aS(e,t,n,r){return n.addQueueMeasurement(Zm,r),new Promise((n,r)=>{const i=lS();window.setTimeout(()=>{i?(i.src=e,n(i)):r("Unable to load iframe")},t)})}function cS(e){const t=lS();return t.src=e,t}function lS(){const e=document.createElement("iframe");return e.className="msalSilentIframe",e.style.visibility="hidden",e.style.position="absolute",e.style.width=e.style.height="0",e.style.border="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),e.setAttribute("allow","local-network-access *"),document.body.appendChild(e),e}function uS(e){document.body===e.parentNode&&document.body.removeChild(e)}class hS extends kk{constructor(e,t,n,r,i,o,s,a,c,l,u){super(e,t,n,r,i,o,a,l,u),this.apiId=s,this.nativeStorage=c}async acquireToken(e){this.performanceClient.addQueueMeasurement(Em,e.correlationId),e.loginHint||e.sid||e.account&&e.account.username||this.logger.warning("No user hint provided. The authorization server may need more information to complete this request.");const t=l({},e);t.prompt?t.prompt!==ph&&t.prompt!==mh&&(this.logger.warning("SilentIframeClient. Replacing invalid prompt ".concat(t.prompt," with ").concat(ph)),t.prompt=ph):t.prompt=ph;const n=await hC(this.initializeAuthorizationRequest.bind(this),ry,this.logger,this.performanceClient,e.correlationId)(t,rf.Silent);return n.platformBroker=eS(this.config,this.logger,this.platformAuthProvider,n.authenticationScheme),qb(n.authority),this.config.auth.protocolMode===ug?this.executeEarFlow(n):this.executeCodeFlow(n)}async executeCodeFlow(e){let t;const n=this.initializeServerTelemetryManager(this.apiId);try{return t=await hC(this.createAuthCodeClient.bind(this),ty,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:n,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),await hC(this.silentTokenHelper.bind(this),Jm,this.logger,this.performanceClient,e.correlationId)(t,e)}catch(r){if(r instanceof ad&&(r.setCorrelationId(this.correlationId),n.cacheFailedRequest(r)),!t||!(r instanceof ad)||r.errorCode!==md)throw r;return this.performanceClient.addFields({retryError:r.errorCode},this.correlationId),await hC(this.silentTokenHelper.bind(this),Jm,this.logger,this.performanceClient,this.correlationId)(t,e)}}async executeEarFlow(e){const t=e.correlationId,n=await hC(this.getDiscoveredAuthority.bind(this),Om,this.logger,this.performanceClient,t)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),r=await hC(kb,Jy,this.logger,this.performanceClient,t)(),i=await hC(Qk,Uy,this.logger,this.performanceClient,t)(this.performanceClient,this.logger,t),o=l(l({},e),{},{earJwk:r,codeChallenge:i.challenge}),s=await hC(oS,Xm,this.logger,this.performanceClient,t)(this.config,n,o,this.logger,this.performanceClient),a=this.config.auth.OIDCOptions.serverResponseType,c=await hC(sS,$m,this.logger,this.performanceClient,t)(s,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,t,a),u=uC(Sk,vy,this.logger,this.performanceClient,t)(c,a,this.logger);if(!u.ear_jwe&&u.code){const r=await hC(this.createAuthCodeClient.bind(this),ty,this.logger,this.performanceClient,t)({serverTelemetryManager:this.initializeServerTelemetryManager(this.apiId),requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account,authority:n});return hC(Kk,uy,this.logger,this.performanceClient,t)(o,u,i.verifier,this.apiId,this.config,r,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}return hC(Gk,cy,this.logger,this.performanceClient,t)(o,u,this.apiId,this.config,n,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}logout(){return Promise.reject(hw(Nv))}async silentTokenHelper(e,t){const n=t.correlationId;this.performanceClient.addQueueMeasurement(Jm,n);const r=await hC(Qk,Uy,this.logger,this.performanceClient,n)(this.performanceClient,this.logger,n),i=l(l({},t),{},{codeChallenge:r.challenge});let o;if(t.httpMethod===Xu)o=await hC(iS,Xm,this.logger,this.performanceClient,n)(this.config,e.authority,i,this.logger,this.performanceClient);else{const t=await hC(zk,iy,this.logger,this.performanceClient,n)(this.config,e.authority,i,this.logger,this.performanceClient);o=await hC(rS,Xm,this.logger,this.performanceClient,n)(t,this.performanceClient,this.logger,n,this.config.system.navigateFrameWait)}const s=this.config.auth.OIDCOptions.serverResponseType,a=await hC(sS,$m,this.logger,this.performanceClient,n)(o,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,n,s),c=uC(Sk,vy,this.logger,this.performanceClient,n)(a,s,this.logger);return hC(Kk,uy,this.logger,this.performanceClient,n)(t,c,r.verifier,this.apiId,this.config,e,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}}class dS extends ak{constructor(e,t){super(e,t)}async acquireToken(e){var t,n;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(qm,e.correlationId);const r=fC(),i=await hC(this.executeTokenRequest.bind(this),Fm,this.logger,this.performanceClient,e.correlationId)(e,this.authority),o=null===(n=i.headers)||void 0===n?void 0:n[ih],s=new dk(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return s.validateTokenResponse(i.body),hC(s.handleServerTokenResponse.bind(s),yy,this.logger,this.performanceClient,e.correlationId)(i.body,this.authority,r,e,void 0,void 0,!0,e.forceCache,o)}async acquireTokenByRefreshToken(e){var t;if(!e)throw xp(mp);if(null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(zm,e.correlationId),!e.account)throw op(Lg);if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return await hC(this.acquireTokenWithCachedRefreshToken.bind(this),Um,this.logger,this.performanceClient,e.correlationId)(e,!0)}catch(n){const t=n instanceof qC&&n.errorCode===RC,r=n instanceof ok&&n.errorCode===jh&&n.subError===Kh;if(t||r)return hC(this.acquireTokenWithCachedRefreshToken.bind(this),Um,this.logger,this.performanceClient,e.correlationId)(e,!1);throw n}return hC(this.acquireTokenWithCachedRefreshToken.bind(this),Um,this.logger,this.performanceClient,e.correlationId)(e,!1)}async acquireTokenWithCachedRefreshToken(e,t){var n;null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(Um,e.correlationId);const r=uC(this.cacheManager.getRefreshToken.bind(this.cacheManager),Dy,this.logger,this.performanceClient,e.correlationId)(e.account,t,e.correlationId,void 0,this.performanceClient);if(!r)throw zC(RC);var i;if(r.expiresOn&&mC(r.expiresOn,e.refreshTokenExpirationOffsetSeconds||300))throw null===(i=this.performanceClient)||void 0===i||i.addFields({rtExpiresOnMs:Number(r.expiresOn)},e.correlationId),zC(OC);const o=l(l({},e),{},{refreshToken:r.secret,authenticationScheme:e.authenticationScheme||Uh.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:nk}});try{return await hC(this.acquireToken.bind(this),qm,this.logger,this.performanceClient,e.correlationId)(o)}catch(a){var s;if(a instanceof qC)if(null===(s=this.performanceClient)||void 0===s||s.addFields({rtExpiresOnMs:Number(r.expiresOn)},e.correlationId),a.subError===xC){this.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache");const t=this.cacheManager.generateCredentialKey(r);this.cacheManager.removeRefreshToken(t,e.correlationId)}throw a}}async executeTokenRequest(e,t){var n;null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(Fm,e.correlationId);const r=this.createTokenQueryParameters(e),i=om.appendQueryString(t.tokenEndpoint,r),o=await hC(this.createTokenRequestBody.bind(this),Bm,this.logger,this.performanceClient,e.correlationId)(e),s=this.createTokenRequestHeaders(e.ccsCredential),a=BC(this.config.authOptions.clientId,e);return hC(this.executePostToTokenEndpoint.bind(this),Dm,this.logger,this.performanceClient,e.correlationId)(i,o,s,a,e.correlationId,Dm)}async createTokenRequestBody(e){var t,n,r;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(Bm,e.correlationId);const i=new Map;if(Rw(i,e.embeddedClientId||(null===(n=e.tokenBodyParameters)||void 0===n?void 0:n[vw])||this.config.authOptions.clientId),e.redirectUri&&Nw(i,e.redirectUri),Pw(i,e.scopes,!0,null===(r=this.config.authOptions.authority.options.OIDCOptions)||void 0===r?void 0:r.defaultScopes),Kw(i,Sh),Gw(i),qw(i,this.config.libraryInfo),Uw(i,this.config.telemetry.application),Zw(i),this.serverTelemetryManager&&!lv(this.config)&&$w(i,this.serverTelemetryManager),function(e,t){e.set("refresh_token",t)}(i,e.refreshToken),this.config.clientCredentials.clientSecret&&Hw(i,this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const t=this.config.clientCredentials.clientAssertion;Vw(i,await gk(t.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),jw(i,t.assertionType)}if(e.authenticationScheme===Uh.POP){const t=new uk(this.cryptoUtils,this.performanceClient);let n;if(e.popKid)n=this.cryptoUtils.encodeKid(e.popKid);else{n=(await hC(t.generateCnf.bind(t),py,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString}Jw(i,n)}else if(e.authenticationScheme===Uh.SSH){if(!e.sshJwk)throw xp(Sp);Xw(i,e.sshJwk)}if((!Dp.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&Lw(i,e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case nk:try{xw(i,qp(e.ccsCredential.credential))}catch(o){this.logger.verbose("Could not parse home account ID for CCS Header: "+o)}break;case rk:Mw(i,e.ccsCredential.credential)}return e.embeddedClientId&&eb(i,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenBodyParameters&&Ww(i,e.tokenBodyParameters),Aw(i,e.correlationId,this.performanceClient),rm(i)}}class fS extends kk{async acquireToken(e){this.performanceClient.addQueueMeasurement(Rm,e.correlationId);const t=await hC(wk,Gm,this.logger,this.performanceClient,e.correlationId)(e,this.config,this.performanceClient,this.logger),n=l(l({},e),t);e.redirectUri&&(n.redirectUri=this.getRedirectUri(e.redirectUri));const r=this.initializeServerTelemetryManager(ef),i=await this.createRefreshTokenClient({serverTelemetryManager:r,authorityUrl:n.authority,azureCloudOptions:n.azureCloudOptions,account:n.account});return hC(i.acquireTokenByRefreshToken.bind(i),zm,this.logger,this.performanceClient,e.correlationId)(n).catch(e=>{throw e.setCorrelationId(this.correlationId),r.cacheFailedRequest(e),e})}logout(){return Promise.reject(hw(Nv))}async createRefreshTokenClient(e){const t=await hC(this.getClientConfiguration.bind(this),ny,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:e.serverTelemetryManager,requestAuthority:e.authorityUrl,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account});return new dS(t,this.performanceClient)}}class gS{constructor(e,t,n,r){this.isBrowserEnvironment="undefined"!==typeof window,this.config=e,this.storage=t,this.logger=n,this.cryptoObj=r}async loadExternalTokens(e,t,n){if(!this.isBrowserEnvironment)throw hw(qv);const r=e.correlationId||bb(),i=t.id_token?Xp(t.id_token,ob):void 0,o=$p(i||{}),s={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},a=e.authority?new EC(EC.generateAuthority(e.authority,e.azureCloudOptions),this.config.system.networkClient,this.storage,s,this.logger,e.correlationId||bb()):void 0,c=await this.loadAccount(e,n.clientInfo||t.client_info||"",r,i,a),l=await this.loadIdToken(t,c.homeAccountId,c.environment,c.realm,r,o),u=await this.loadAccessToken(e,t,c.homeAccountId,c.environment,c.realm,n,r,o),h=await this.loadRefreshToken(t,c.homeAccountId,c.environment,r,o);return this.generateAuthenticationResult(e,{account:c,idToken:l,accessToken:u,refreshToken:h},i,a)}async loadAccount(e,t,n,r,i){if(this.logger.verbose("TokenCache - loading account"),e.account){const t=Jp.createFromAccountInfo(e.account);return await this.storage.setAccount(t,n,$p(r||{})),t}if(!i||!t&&!r)throw this.logger.error("TokenCache - if an account is not provided on the request, authority and either clientInfo or idToken must be provided instead."),hw(jv);const o=Jp.generateHomeAccountId(t,i.authorityType,this.logger,this.cryptoObj,r),s=null===r||void 0===r?void 0:r.tid,a=fk(this.storage,i,o,ob,n,r,t,i.hostnameAndPort,s,void 0,void 0,this.logger);return await this.storage.setAccount(a,n,$p(r||{})),a}async loadIdToken(e,t,n,r,i,o){if(!e.id_token)return this.logger.verbose("TokenCache - no id token found in response"),null;this.logger.verbose("TokenCache - loading id token");const s=vC(t,n,e.id_token,this.config.auth.clientId,r);return await this.storage.setIdTokenCredential(s,i,o),s}async loadAccessToken(e,t,n,r,i,o,s,a){if(!t.access_token)return this.logger.verbose("TokenCache - no access token found in response"),null;if(!t.expires_in)return this.logger.error("TokenCache - no expiration set on the access token. Cannot add it to the cache."),null;if(!t.scope&&(!e.scopes||!e.scopes.length))return this.logger.error("TokenCache - scopes not specified in the request or response. Cannot add token to the cache."),null;this.logger.verbose("TokenCache - loading access token");const c=t.scope?Lp.fromString(t.scope):new Lp(e.scopes),l=o.expiresOn||t.expires_in+fC(),u=o.extendedExpiresOn||(t.ext_expires_in||t.expires_in)+fC(),h=wC(n,r,t.access_token,this.config.auth.clientId,i,c.printScopes(),l,u,ob);return await this.storage.setAccessTokenCredential(h,s,a),h}async loadRefreshToken(e,t,n,r,i){if(!e.refresh_token)return this.logger.verbose("TokenCache - no refresh token found in response"),null;this.logger.verbose("TokenCache - loading refresh token");const o=bC(t,n,e.refresh_token,this.config.auth.clientId,e.foci,void 0,e.refresh_token_expires_in);return await this.storage.setRefreshTokenCredential(o,r,i),o}generateAuthenticationResult(e,t,n,r){var i,o,s;let a,c="",l=[],u=null;null!==t&&void 0!==t&&t.accessToken&&(c=t.accessToken.secret,l=Lp.fromString(t.accessToken.target).asArray(),u=pC(t.accessToken.expiresOn),a=pC(t.accessToken.extendedExpiresOn));const h=t.account;return{authority:r?r.canonicalAuthority:"",uniqueId:t.account.localAccountId,tenantId:t.account.realm,scopes:l,account:Jp.getAccountInfo(h),idToken:(null===(i=t.idToken)||void 0===i?void 0:i.secret)||"",idTokenClaims:n||{},accessToken:c,fromCache:!0,expiresOn:u,correlationId:e.correlationId||"",requestId:"",extExpiresOn:a,familyId:(null===(o=t.refreshToken)||void 0===o?void 0:o.familyId)||"",tokenType:(null===t||void 0===t||null===(s=t.accessToken)||void 0===s?void 0:s.tokenType)||"",state:e.state||"",cloudGraphHostName:h.cloudGraphHostName||"",msGraphHost:h.msGraphHost||"",fromNativeBroker:!1}}}class pS extends pk{constructor(e){super(e),this.includeRedirectUri=!1}}class mS extends kk{constructor(e,t,n,r,i,o,s,a,c,l){super(e,t,n,r,i,o,a,c,l),this.apiId=s}async acquireToken(e){if(!e.code)throw hw(Gv);const t=await hC(this.initializeAuthorizationRequest.bind(this),ry,this.logger,this.performanceClient,e.correlationId)(e,rf.Silent),n=this.initializeServerTelemetryManager(this.apiId);try{const r=l(l({},t),{},{code:e.code}),i=await hC(this.getClientConfiguration.bind(this),ny,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:n,requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account}),o=new pS(i);this.logger.verbose("Auth code client created");const s=new Ek(o,this.browserStorage,r,this.logger,this.performanceClient);return await hC(s.handleCodeResponseFromServer.bind(s),sy,this.logger,this.performanceClient,e.correlationId)({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},t,!1)}catch(r){throw r instanceof ad&&(r.setCorrelationId(this.correlationId),n.cacheFailedRequest(r)),r}}logout(){return Promise.reject(hw(Nv))}}function yS(e,t,n){try{Lb(e)}catch(r){throw t.end({success:!1},r,n),r}}class vS{constructor(e){this.operatingContext=e,this.isBrowserEnvironment=this.operatingContext.isBrowserEnvironment(),this.config=e.getConfig(),this.initialized=!1,this.logger=this.operatingContext.getLogger(),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.config.telemetry.client,this.browserCrypto=this.isBrowserEnvironment?new cC(this.logger,this.performanceClient):sp,this.eventHandler=new tk(this.logger),this.browserStorage=this.isBrowserEnvironment?new ZC(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,this.performanceClient,this.eventHandler,function(e){const t=e.cloudDiscoveryMetadata;let n;if(t)try{n=JSON.parse(t)}catch(r){throw xp(bp)}return{canonicalAuthority:e.authority?PC(e.authority):void 0,knownAuthorities:e.knownAuthorities,cloudDiscoveryMetadata:n}}(this.config.auth)):((e,t,n,r)=>new ZC(e,{cacheLocation:Ld,cacheRetentionDays:5,temporaryCacheLocation:Ld,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1},sp,t,n,r))(this.config.auth.clientId,this.logger,this.performanceClient,this.eventHandler);const t={cacheLocation:Ld,cacheRetentionDays:5,temporaryCacheLocation:Ld,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};this.nativeInternalStorage=new ZC(this.config.auth.clientId,t,this.browserCrypto,this.logger,this.performanceClient,this.eventHandler),this.tokenCache=new gS(this.config,this.browserStorage,this.logger,this.browserCrypto),this.activeSilentTokenRequests=new Map,this.trackPageVisibility=this.trackPageVisibility.bind(this),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this)}static async createController(e,t){const n=new vS(e);return await n.initialize(t),n}trackPageVisibility(e){e&&(this.logger.info("Perf: Visibility change detected"),this.performanceClient.incrementFields({visibilityChangeCount:1},e))}async initialize(e,t){if(this.logger.trace("initialize called"),this.initialized)return void this.logger.info("initialize has already been called, exiting early.");if(!this.isBrowserEnvironment)return this.logger.info("in non-browser environment, exiting early."),this.initialized=!0,void this.eventHandler.emitEvent(Ef);const n=(null===e||void 0===e?void 0:e.correlationId)||this.getRequestCorrelationId(),r=this.config.system.allowPlatformBroker,i=this.performanceClient.startMeasurement(Wm,n);if(this.eventHandler.emitEvent(Af),!t)try{this.logMultipleInstances(i)}catch(o){}if(await hC(this.browserStorage.initialize.bind(this.browserStorage),Ym,this.logger,this.performanceClient,n)(n),r)try{this.platformAuthProvider=await Zk(this.logger,this.performanceClient,n,this.config.system.nativeBrokerHandshakeTimeout)}catch(s){this.logger.verbose(s)}this.config.cache.claimsBasedCachingEnabled||(this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),uC(this.browserStorage.clearTokensAndKeysWithClaims.bind(this.browserStorage),xy,this.logger,this.performanceClient,n)(n)),this.config.system.asyncPopups&&await this.preGeneratePkceCodes(n),this.initialized=!0,this.eventHandler.emitEvent(Ef),i.end({allowPlatformBroker:r,success:!0})}async handleRedirectPromise(e){if(this.logger.verbose("handleRedirectPromise called"),Db(this.initialized),this.isBrowserEnvironment){const t=e||"";let n=this.redirectResponse.get(t);return"undefined"===typeof n?(n=this.handleRedirectPromiseInternal(e),this.redirectResponse.set(t,n),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise")):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),n}return this.logger.verbose("handleRedirectPromise returns null, not browser environment"),null}async handleRedirectPromiseInternal(e){var t;if(!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;if((null===(t=this.browserStorage.getInteractionInProgress())||void 0===t?void 0:t.type)===zd)return this.logger.verbose("handleRedirectPromise removing interaction_in_progress flag and returning null after sign-out"),this.browserStorage.setInteractionInProgress(!1),Promise.resolve(null);const n=this.getAllAccounts(),r=this.browserStorage.getCachedNativeRequest(),i=r&&this.platformAuthProvider&&!e;let o,s;this.eventHandler.emitEvent(Kf,rf.Redirect);try{if(i&&this.platformAuthProvider){o=this.performanceClient.startMeasurement(Tm,(null===r||void 0===r?void 0:r.correlationId)||""),this.logger.trace("handleRedirectPromise - acquiring token from native platform"),o.add({isPlatformBrokerRequest:!0});const e=new qk(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,$d,this.performanceClient,this.platformAuthProvider,r.accountId,this.nativeInternalStorage,r.correlationId);s=hC(e.handleRedirectPromise.bind(e),Ny,this.logger,this.performanceClient,o.event.correlationId)(this.performanceClient,o.event.correlationId)}else{const[t,n]=this.browserStorage.getCachedRequest(),r=t.correlationId;o=this.performanceClient.startMeasurement(Tm,r),this.logger.trace("handleRedirectPromise - acquiring token from web flow");const i=this.createRedirectClient(r);s=hC(i.handleRedirectPromise.bind(i),Ry,this.logger,this.performanceClient,o.event.correlationId)(e,t,n,o)}}catch(a){throw this.browserStorage.resetRequestCache(),a}return s.then(e=>{if(e){this.browserStorage.resetRequestCache();n.length<this.getAllAccounts().length?(this.eventHandler.emitEvent(Mf,rf.Redirect,e),this.logger.verbose("handleRedirectResponse returned result, login success")):(this.eventHandler.emitEvent(Lf,rf.Redirect,e),this.logger.verbose("handleRedirectResponse returned result, acquire token success")),o.end({success:!0},void 0,e.account)}else o.event.errorCode?o.end({success:!1},void 0):o.discard();return this.eventHandler.emitEvent(Gf,rf.Redirect),e}).catch(e=>{this.browserStorage.resetRequestCache();const t=e;throw n.length>0?this.eventHandler.emitEvent(Ff,rf.Redirect,null,t):this.eventHandler.emitEvent(xf,rf.Redirect,null,t),this.eventHandler.emitEvent(Gf,rf.Redirect),o.end({success:!1},t),e})}async acquireTokenRedirect(e){const t=this.getRequestCorrelationId(e);this.logger.verbose("acquireTokenRedirect called",t);const n=this.performanceClient.startMeasurement(Sm,t);n.add({scenarioId:e.scenarioId});const r=e.onRedirectNavigate;if(r)e.onRedirectNavigate=t=>{const i="function"===typeof r?r(t):void 0;return n.add({navigateCallbackResult:!1!==i}),n.event=n.end({success:!0},void 0,e.account)||n.event,i};else{const t=this.config.auth.onRedirectNavigate;this.config.auth.onRedirectNavigate=r=>{const i="function"===typeof t?t(r):void 0;return n.add({navigateCallbackResult:!1!==i}),n.event=n.end({success:!0},void 0,e.account)||n.event,i}}const i=this.getAllAccounts().length>0;try{let r;if(Fb(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0,Ud),i?this.eventHandler.emitEvent(Df,rf.Redirect,e):this.eventHandler.emitEvent(Of,rf.Redirect,e),this.platformAuthProvider&&this.canUsePlatformBroker(e)){r=new qk(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Yd,this.performanceClient,this.platformAuthProvider,this.getNativeAccountId(e),this.nativeInternalStorage,t).acquireTokenRedirect(e,n).catch(r=>{if(n.add({brokerErrorName:r.name,brokerErrorCode:r.errorCode}),r instanceof Nk&&Ok(r)){this.platformAuthProvider=void 0;return this.createRedirectClient(t).acquireToken(e)}if(r instanceof qC){this.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow");return this.createRedirectClient(t).acquireToken(e)}throw r})}else{r=this.createRedirectClient(t).acquireToken(e)}return await r}catch(o){throw this.browserStorage.resetRequestCache(),2===n.event.status?this.performanceClient.startMeasurement(Tm,t).end({success:!1},o,e.account):n.end({success:!1},o,e.account),i?this.eventHandler.emitEvent(Ff,rf.Redirect,null,o):this.eventHandler.emitEvent(xf,rf.Redirect,null,o),o}}acquireTokenPopup(e){const t=this.getRequestCorrelationId(e),n=this.performanceClient.startMeasurement(km,t);n.add({scenarioId:e.scenarioId});try{this.logger.verbose("acquireTokenPopup called",t),yS(this.initialized,n,e.account),this.browserStorage.setInteractionInProgress(!0,Ud)}catch(s){return Promise.reject(s)}const r=this.getAllAccounts();let i;r.length>0?this.eventHandler.emitEvent(Df,rf.Popup,e):this.eventHandler.emitEvent(Of,rf.Popup,e);const o=this.getPreGeneratedPkceCodes(t);if(this.canUsePlatformBroker(e))n.add({isPlatformBrokerRequest:!0}),i=this.acquireTokenNative(l(l({},e),{},{correlationId:t}),Jd).then(e=>(n.end({success:!0},void 0,e.account),e)).catch(r=>{if(n.add({brokerErrorName:r.name,brokerErrorCode:r.errorCode}),r instanceof Nk&&Ok(r)){this.platformAuthProvider=void 0;return this.createPopupClient(t).acquireToken(e,o)}if(r instanceof qC){this.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow");return this.createPopupClient(t).acquireToken(e,o)}throw r});else{i=this.createPopupClient(t).acquireToken(e,o)}return i.then(e=>(r.length<this.getAllAccounts().length?this.eventHandler.emitEvent(Mf,rf.Popup,e):this.eventHandler.emitEvent(Lf,rf.Popup,e),n.end({success:!0,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length},void 0,e.account),e)).catch(t=>(r.length>0?this.eventHandler.emitEvent(Ff,rf.Popup,null,t):this.eventHandler.emitEvent(xf,rf.Popup,null,t),n.end({success:!1},t,e.account),Promise.reject(t))).finally(async()=>{this.browserStorage.setInteractionInProgress(!1),this.config.system.asyncPopups&&await this.preGeneratePkceCodes(t)})}trackPageVisibilityWithMeasurement(){const e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))}async ssoSilent(e){var t,n;const r=this.getRequestCorrelationId(e),i=l(l({},e),{},{prompt:e.prompt,correlationId:r});let o;if(this.ssoSilentMeasurement=this.performanceClient.startMeasurement(Nm,r),null===(t=this.ssoSilentMeasurement)||void 0===t||t.add({scenarioId:e.scenarioId}),yS(this.initialized,this.ssoSilentMeasurement,e.account),null===(n=this.ssoSilentMeasurement)||void 0===n||n.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",r),this.eventHandler.emitEvent(Uf,rf.Silent,i),this.canUsePlatformBroker(i)){var s;null===(s=this.ssoSilentMeasurement)||void 0===s||s.add({isPlatformBrokerRequest:!0}),o=this.acquireTokenNative(i,Xd).catch(e=>{var t;if(null===(t=this.ssoSilentMeasurement)||void 0===t||t.add({brokerErrorName:e.name,brokerErrorCode:e.errorCode}),e instanceof Nk&&Ok(e)){this.platformAuthProvider=void 0;return this.createSilentIframeClient(i.correlationId).acquireToken(i)}throw e})}else{o=this.createSilentIframeClient(i.correlationId).acquireToken(i)}return o.then(e=>{var t;return this.eventHandler.emitEvent(zf,rf.Silent,e),null===(t=this.ssoSilentMeasurement)||void 0===t||t.end({success:!0,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length},void 0,e.account),e}).catch(t=>{var n;throw this.eventHandler.emitEvent(Bf,rf.Silent,null,t),null===(n=this.ssoSilentMeasurement)||void 0===n||n.end({success:!1},t,e.account),t}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenByCode(e){const t=this.getRequestCorrelationId(e);this.logger.trace("acquireTokenByCode called",t);const n=this.performanceClient.startMeasurement(vm,t);yS(this.initialized,n),this.eventHandler.emitEvent(Hf,rf.Silent,e),n.add({scenarioId:e.scenarioId});try{if(e.code&&e.nativeAccountId)throw hw(Wv);if(e.code){const r=e.code;let i=this.hybridAuthCodeResponses.get(r);return i?(this.logger.verbose("Existing acquireTokenByCode request found",t),n.discard()):(this.logger.verbose("Initiating new acquireTokenByCode request",t),i=this.acquireTokenByCodeAsync(l(l({},e),{},{correlationId:t})).then(e=>(this.eventHandler.emitEvent(Vf,rf.Silent,e),this.hybridAuthCodeResponses.delete(r),n.end({success:!0,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length},void 0,e.account),e)).catch(e=>{throw this.hybridAuthCodeResponses.delete(r),this.eventHandler.emitEvent(jf,rf.Silent,null,e),n.end({success:!1},e),e}),this.hybridAuthCodeResponses.set(r,i)),await i}if(e.nativeAccountId){if(this.canUsePlatformBroker(e,e.nativeAccountId)){n.add({isPlatformBrokerRequest:!0});const r=await this.acquireTokenNative(l(l({},e),{},{correlationId:t}),Zd,e.nativeAccountId).catch(e=>{throw e instanceof Nk&&Ok(e)&&(this.platformAuthProvider=void 0),n.add({brokerErrorName:e.name,brokerErrorCode:e.errorCode}),e});return n.end({success:!0},void 0,r.account),r}throw hw(Jv)}throw hw(Qv)}catch(r){throw this.eventHandler.emitEvent(jf,rf.Silent,null,r),n.end({success:!1},r),r}}async acquireTokenByCodeAsync(e){var t;this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(Py,e.correlationId),null===(t=this.acquireTokenByCodeAsyncMeasurement)||void 0===t||t.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement);const n=this.createSilentAuthCodeClient(e.correlationId);return await n.acquireToken(e).then(e=>{var t;return null===(t=this.acquireTokenByCodeAsyncMeasurement)||void 0===t||t.end({success:!0,fromCache:e.fromCache}),e}).catch(e=>{var t;throw null===(t=this.acquireTokenByCodeAsyncMeasurement)||void 0===t||t.end({success:!1},e),e}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenFromCache(e,t){switch(this.performanceClient.addQueueMeasurement(Hm,e.correlationId),t){case mf:case yf:case vf:const t=this.createSilentCacheClient(e.correlationId);return hC(t.acquireToken.bind(t),Am,this.logger,this.performanceClient,e.correlationId)(e);default:throw op(jg)}}async acquireTokenByRefreshToken(e,t){switch(this.performanceClient.addQueueMeasurement(wm,e.correlationId),t){case mf:case vf:case wf:case bf:const t=this.createSilentRefreshClient(e.correlationId);return hC(t.acquireToken.bind(t),Rm,this.logger,this.performanceClient,e.correlationId)(e);default:throw op(jg)}}async acquireTokenBySilentIframe(e){this.performanceClient.addQueueMeasurement(Km,e.correlationId);const t=this.createSilentIframeClient(e.correlationId);return hC(t.acquireToken.bind(t),Em,this.logger,this.performanceClient,e.correlationId)(e)}async logout(e){const t=this.getRequestCorrelationId(e);return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",t),this.logoutRedirect(l({correlationId:t},e))}async logoutRedirect(e){const t=this.getRequestCorrelationId(e);Fb(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0,zd);return this.createRedirectClient(t).logout(e)}logoutPopup(e){try{const t=this.getRequestCorrelationId(e);Lb(this.initialized),this.browserStorage.setInteractionInProgress(!0,zd);return this.createPopupClient(t).logout(e).finally(()=>{this.browserStorage.setInteractionInProgress(!1)})}catch(t){return Promise.reject(t)}}async clearCache(e){if(!this.isBrowserEnvironment)return void this.logger.info("in non-browser environment, returning early.");const t=this.getRequestCorrelationId(e);return this.createSilentCacheClient(t).logout(e)}getAllAccounts(e){const t=this.getRequestCorrelationId();return function(e,t,n,r,i){return e.verbose("getAllAccounts called"),n?t.getAllAccounts(i||{},r):[]}(this.logger,this.browserStorage,this.isBrowserEnvironment,t,e)}getAccount(e){const t=this.getRequestCorrelationId();return function(e,t,n,r){const i=n.getAccountInfoFilteredBy(e,r);return i?(t.verbose("getAccount: Account matching provided filter found, returning"),i):(t.verbose("getAccount: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage,t)}getAccountByUsername(e){const t=this.getRequestCorrelationId();return function(e,t,n,r){if(t.trace("getAccountByUsername called"),!e)return t.warning("getAccountByUsername: No username provided"),null;const i=n.getAccountInfoFilteredBy({username:e},r);return i?(t.verbose("getAccountByUsername: Account matching username found, returning"),t.verbosePii("getAccountByUsername: Returning signed-in accounts matching username: ".concat(e)),i):(t.verbose("getAccountByUsername: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage,t)}getAccountByHomeId(e){const t=this.getRequestCorrelationId();return function(e,t,n,r){if(t.trace("getAccountByHomeId called"),!e)return t.warning("getAccountByHomeId: No homeAccountId provided"),null;const i=n.getAccountInfoFilteredBy({homeAccountId:e},r);return i?(t.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),t.verbosePii("getAccountByHomeId: Returning signed-in accounts matching homeAccountId: ".concat(e)),i):(t.verbose("getAccountByHomeId: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage,t)}getAccountByLocalId(e){const t=this.getRequestCorrelationId();return function(e,t,n,r){if(t.trace("getAccountByLocalId called"),!e)return t.warning("getAccountByLocalId: No localAccountId provided"),null;const i=n.getAccountInfoFilteredBy({localAccountId:e},r);return i?(t.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),t.verbosePii("getAccountByLocalId: Returning signed-in accounts matching localAccountId: ".concat(e)),i):(t.verbose("getAccountByLocalId: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage,t)}setActiveAccount(e){const t=this.getRequestCorrelationId();!function(e,t,n){t.setActiveAccount(e,n)}(e,this.browserStorage,t)}getActiveAccount(){const e=this.getRequestCorrelationId();return function(e,t){return e.getActiveAccount(t)}(this.browserStorage,e)}async hydrateCache(e,t){this.logger.verbose("hydrateCache called");const n=Jp.createFromAccountInfo(e.account,e.cloudGraphHostName,e.msGraphHost);return await this.browserStorage.setAccount(n,e.correlationId,$p(e.idTokenClaims)),e.fromNativeBroker?(this.logger.verbose("Response was from native broker, storing in-memory"),this.nativeInternalStorage.hydrateCache(e,t)):this.browserStorage.hydrateCache(e,t)}async acquireTokenNative(e,t,n,r){if(this.logger.trace("acquireTokenNative called"),!this.platformAuthProvider)throw hw(Zv);return new qk(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t,this.performanceClient,this.platformAuthProvider,n||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireToken(e,r)}canUsePlatformBroker(e,t){if(this.logger.trace("canUsePlatformBroker called"),!this.platformAuthProvider)return this.logger.trace("canUsePlatformBroker: platform broker unavilable, returning false"),!1;if(!eS(this.config,this.logger,this.platformAuthProvider,e.authenticationScheme))return this.logger.trace("canUsePlatformBroker: isBrokerAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case ph:case gh:case dh:case fh:this.logger.trace("canUsePlatformBroker: prompt is compatible with platform broker flow");break;default:return this.logger.trace("canUsePlatformBroker: prompt = ".concat(e.prompt," is not compatible with platform broker flow, returning false")),!1}return!(!t&&!this.getNativeAccountId(e))||(this.logger.trace("canUsePlatformBroker: nativeAccountId is not available, returning false"),!1)}getNativeAccountId(e){const t=e.account||this.getAccount({loginHint:e.loginHint,sid:e.sid})||this.getActiveAccount();return t&&t.nativeAccountId||""}createPopupClient(e){return new tS(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.platformAuthProvider,e)}createRedirectClient(e){return new nS(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.platformAuthProvider,e)}createSilentIframeClient(e){return new hS(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Xd,this.performanceClient,this.nativeInternalStorage,this.platformAuthProvider,e)}createSilentCacheClient(e){return new Dk(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.platformAuthProvider,e)}createSilentRefreshClient(e){return new fS(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.platformAuthProvider,e)}createSilentAuthCodeClient(e){return new mS(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Zd,this.performanceClient,this.platformAuthProvider,e)}addEventCallback(e,t){return this.eventHandler.addEventCallback(e,t)}removeEventCallback(e){this.eventHandler.removeEventCallback(e)}addPerformanceCallback(e){return xb(),this.performanceClient.addPerformanceCallback(e)}removePerformanceCallback(e){return this.performanceClient.removePerformanceCallback(e)}enableAccountStorageEvents(){this.config.cache.cacheLocation===xd?this.eventHandler.subscribeCrossTab():this.logger.info("Account storage events are only available when cacheLocation is set to localStorage")}disableAccountStorageEvents(){this.config.cache.cacheLocation===xd?this.eventHandler.unsubscribeCrossTab():this.logger.info("Account storage events are only available when cacheLocation is set to localStorage")}getTokenCache(){return this.tokenCache}getLogger(){return this.logger}setLogger(e){this.logger=e}initializeWrapperLibrary(e,t){this.browserStorage.setWrapperMetadata(e,t)}setNavigationClient(e){this.navigationClient=e}getConfiguration(){return this.config}getPerformanceClient(){return this.performanceClient}isBrowserEnv(){return this.isBrowserEnvironment}getRequestCorrelationId(e){return null!==e&&void 0!==e&&e.correlationId?e.correlationId:this.isBrowserEnvironment?bb():Vu.EMPTY_STRING}async loginRedirect(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginRedirect called",t),this.acquireTokenRedirect(l({correlationId:t},e||df))}loginPopup(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",t),this.acquireTokenPopup(l({correlationId:t},e||df))}async acquireTokenSilent(e){const t=this.getRequestCorrelationId(e),n=this.performanceClient.startMeasurement(bm,t);n.add({cacheLookupPolicy:e.cacheLookupPolicy,scenarioId:e.scenarioId}),yS(this.initialized,n,e.account),this.logger.verbose("acquireTokenSilent called",t);const r=e.account||this.getActiveAccount();if(!r)throw hw(Ov);return this.acquireTokenSilentDeduped(e,r,t).then(r=>(n.end({success:!0,fromCache:r.fromCache,accessTokenSize:r.accessToken.length,idTokenSize:r.idToken.length},void 0,r.account),l(l({},r),{},{state:e.state,correlationId:t}))).catch(e=>{throw e instanceof ad&&e.setCorrelationId(t),n.end({success:!1},e,r),e})}async acquireTokenSilentDeduped(e,t,n){const r=BC(this.config.auth.clientId,l(l({},e),{},{authority:e.authority||this.config.auth.authority,correlationId:n}),t.homeAccountId),i=JSON.stringify(r),o=this.activeSilentTokenRequests.get(i);if("undefined"===typeof o){this.logger.verbose("acquireTokenSilent called for the first time, storing active request",n),this.performanceClient.addFields({deduped:!1},n);const r=hC(this.acquireTokenSilentAsync.bind(this),Cm,this.logger,this.performanceClient,n)(l(l({},e),{},{correlationId:n}),t);return this.activeSilentTokenRequests.set(i,r),r.finally(()=>{this.activeSilentTokenRequests.delete(i)})}return this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",n),this.performanceClient.addFields({deduped:!0},n),o}async acquireTokenSilentAsync(e,t){const n=()=>this.trackPageVisibility(e.correlationId);this.performanceClient.addQueueMeasurement(Cm,e.correlationId),this.eventHandler.emitEvent(Df,rf.Silent,e),e.correlationId&&this.performanceClient.incrementFields({visibilityChangeCount:0},e.correlationId),document.addEventListener("visibilitychange",n);const r=await hC(bk,Qm,this.logger,this.performanceClient,e.correlationId)(e,t,this.config,this.performanceClient,this.logger),i=e.cacheLookupPolicy||mf;return this.acquireTokenSilentNoIframe(r,i).catch(async e=>{const t=function(e,t){const n=!(e instanceof qC&&e.subError!==xC),r=e.errorCode===md||e.errorCode===jg,i=n&&r||e.errorCode===RC||e.errorCode===OC,o=kf.includes(t);return i&&o}(e,i);if(t){if(this.activeIframeRequest){if(i!==Cf){const[t,n]=this.activeIframeRequest;this.logger.verbose("Iframe request is already in progress, awaiting resolution for request with correlationId: ".concat(n),r.correlationId);const o=this.performanceClient.startMeasurement(Pm,r.correlationId);o.add({awaitIframeCorrelationId:n});const s=await t;if(o.end({success:s}),s)return this.logger.verbose("Parallel iframe request with correlationId: ".concat(n," succeeded. Retrying cache and/or RT redemption"),r.correlationId),this.acquireTokenSilentNoIframe(r,i);throw this.logger.info("Iframe request with correlationId: ".concat(n," failed. Interaction is required.")),e}return this.logger.warning("Another iframe request is currently in progress and CacheLookupPolicy is set to Skip. This may result in degraded performance and/or reliability for both calls. Please consider changing the CacheLookupPolicy to take advantage of request queuing and token cache.",r.correlationId),hC(this.acquireTokenBySilentIframe.bind(this),Km,this.logger,this.performanceClient,r.correlationId)(r)}{let e;return this.activeIframeRequest=[new Promise(t=>{e=t}),r.correlationId],this.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",r.correlationId),hC(this.acquireTokenBySilentIframe.bind(this),Km,this.logger,this.performanceClient,r.correlationId)(r).then(t=>(e(!0),t)).catch(t=>{throw e(!1),t}).finally(()=>{this.activeIframeRequest=void 0})}}throw e}).then(t=>(this.eventHandler.emitEvent(Lf,rf.Silent,t),this.performanceClient.addFields({fromCache:t.fromCache},e.correlationId),t)).catch(e=>{throw this.eventHandler.emitEvent(Ff,rf.Silent,null,e),e}).finally(()=>{document.removeEventListener("visibilitychange",n)})}async acquireTokenSilentNoIframe(e,t){return eS(this.config,this.logger,this.platformAuthProvider,e.authenticationScheme)&&e.account.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),this.performanceClient.addFields({isPlatformBrokerRequest:!0},e.correlationId),this.acquireTokenNative(e,ef,e.account.nativeAccountId,t).catch(async t=>{if(this.performanceClient.addFields({brokerErrorName:t.name,brokerErrorCode:t.errorCode},e.correlationId),t instanceof Nk&&Ok(t))throw this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.platformAuthProvider=void 0,op(jg);throw t})):(this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),t===yf&&this.logger.verbose("acquireTokenSilent - cache lookup policy set to AccessToken, attempting to acquire token from local cache"),hC(this.acquireTokenFromCache.bind(this),Hm,this.logger,this.performanceClient,e.correlationId)(e,t).catch(n=>{if(t===yf)throw n;return this.eventHandler.emitEvent(qf,rf.Silent,e),hC(this.acquireTokenByRefreshToken.bind(this),wm,this.logger,this.performanceClient,e.correlationId)(e,t)}))}async preGeneratePkceCodes(e){return this.logger.verbose("Generating new PKCE codes"),this.pkceCode=await hC(Qk,Uy,this.logger,this.performanceClient,e)(this.performanceClient,this.logger,e),Promise.resolve()}getPreGeneratedPkceCodes(e){this.logger.verbose("Attempting to pick up pre-generated PKCE codes");const t=this.pkceCode?l({},this.pkceCode):void 0;return this.pkceCode=void 0,this.logger.verbose("".concat(t?"Found":"Did not find"," pre-generated PKCE codes")),this.performanceClient.addFields({usePreGeneratedPkce:!!t},e),t}logMultipleInstances(e){const t=this.config.auth.clientId;if(!window)return;window.msal=window.msal||{},window.msal.clientIds=window.msal.clientIds||[];window.msal.clientIds.length>0&&this.logger.verbose("There is already an instance of MSAL.js in the window."),window.msal.clientIds.push(t),function(e,t,n){var r;const i=(null===(r=window.msal)||void 0===r?void 0:r.clientIds)||[],o=i.length,s=i.filter(t=>t===e).length;s>1&&n.warning("There is already an instance of MSAL.js in the window with the same client id."),t.add({msalInstanceCount:o,sameClientIdInstanceCount:s})}(t,e,this.logger)}}class wS{static async createPublicClientApplication(e){const t=await async function(e,t){const n=new $b(e);return await n.initialize(),vS.createController(n,t)}(e);return new wS(e,t)}constructor(e,t){this.isBroker=!1,this.controller=t||new vS(new $b(e))}async initialize(e){return this.controller.initialize(e,this.isBroker)}async acquireTokenPopup(e){return this.controller.acquireTokenPopup(e)}acquireTokenRedirect(e){return this.controller.acquireTokenRedirect(e)}acquireTokenSilent(e){return this.controller.acquireTokenSilent(e)}acquireTokenByCode(e){return this.controller.acquireTokenByCode(e)}addEventCallback(e,t){return this.controller.addEventCallback(e,t)}removeEventCallback(e){return this.controller.removeEventCallback(e)}addPerformanceCallback(e){return this.controller.addPerformanceCallback(e)}removePerformanceCallback(e){return this.controller.removePerformanceCallback(e)}enableAccountStorageEvents(){this.controller.enableAccountStorageEvents()}disableAccountStorageEvents(){this.controller.disableAccountStorageEvents()}getAccount(e){return this.controller.getAccount(e)}getAccountByHomeId(e){return this.controller.getAccountByHomeId(e)}getAccountByLocalId(e){return this.controller.getAccountByLocalId(e)}getAccountByUsername(e){return this.controller.getAccountByUsername(e)}getAllAccounts(e){return this.controller.getAllAccounts(e)}handleRedirectPromise(e){return this.controller.handleRedirectPromise(e)}loginPopup(e){return this.controller.loginPopup(e)}loginRedirect(e){return this.controller.loginRedirect(e)}logout(e){return this.controller.logout(e)}logoutRedirect(e){return this.controller.logoutRedirect(e)}logoutPopup(e){return this.controller.logoutPopup(e)}ssoSilent(e){return this.controller.ssoSilent(e)}getTokenCache(){return this.controller.getTokenCache()}getLogger(){return this.controller.getLogger()}setLogger(e){this.controller.setLogger(e)}setActiveAccount(e){this.controller.setActiveAccount(e)}getActiveAccount(){return this.controller.getActiveAccount()}initializeWrapperLibrary(e,t){return this.controller.initializeWrapperLibrary(e,t)}setNavigationClient(e){this.controller.setNavigationClient(e)}getConfiguration(){return this.controller.getConfiguration()}async hydrateCache(e,t){return this.controller.hydrateCache(e,t)}clearCache(e){return this.controller.clearCache(e)}}const bS=new wS(Uu);i.createRoot(document.getElementById("root")).render((0,Bu.jsx)(og,{instance:bS,children:(0,Bu.jsx)(sg,{})})),ag()})();
//# sourceMappingURL=main.69417e64.js.map